!function(e){function t(t){for(var r,o,l=t[0],u=t[1],c=t[2],d=0,f=[];d<l.length;d++)o=l[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(s&&s(t);f.length;)f.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,l=1;l<n.length;l++){var u=n[l];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var l=window.webpackJsonp=window.webpackJsonp||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var s=u;i.push([528,1]),n()}([,,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuConfigProvider=t.MenuButton=t.Menu=t.MemberRow=t.InheritedMembersBlock=t.LinkedPageSelect=t.LicenseSelect=t.LengthIndicator=t.LegalBanner=t.LayoutEditor=t.Layout=t.InputField=t.ImageUpload=t.ImageCropper=t.Icon=t.Header=t.GridWrapper=t.GlobalControls=t.FormattingBar=t.Footer=t.FileUploadButton=t.Editor=t.DropdownButton=t.DragHandle=t.DragDropOrdering=t.DragDropListing=t.DownloadChooser=t.DialogLauncher=t.DevCommunitySwitcherMenuItems=t.DevCommunitySwitcherMenu=t.DatePicker=t.DashboardRowListing=t.DashboardRow=t.DashboardFrame=t.ContributorsList=t.ContributorAvatars=t.ConfirmDialog=t.CommunityPreview=t.ColorInput=t.CollectionMultiSelect=t.ClientOnlyContext=t.ClientOnly=t.ClickToCopyButton=t.Byline=t.Avatars=t.Banner=t.Avatar=t.AttributionEditor=t.AssignDoi=t.AccentStyle=void 0,t.TimelineCondenser=t.Timeline=t.TimeAgo=t.ThreadInput=t.Thread=t.TitleEditor=t.TabToShow=t.SubscriptionButton=t.SubmissionEmail=t.SkipLink=t.SliderInput=t.SimpleEditor=t.SharingCard=t.SettingsSection=t.ScopeDropdown=t.QueryListDropdown=t.ReferencesDropdown=t.PubTitle=t.PubThemePicker=t.PubShareDialog=t.PubReleaseReviewDialog=t.PubReleaseDialog=t.PubPreview=t.PubNoteContent=t.PubMenuItem=t.PubHistoryViewer=t.PubEdgeListingCard=t.PubEdgeListing=t.PubEdgeEditor=t.PubEdge=t.PubCollectionsListing=t.PubByline=t.PubHeaderBackground=t.PubAttributionEditor=t.PubAttributionDialog=t.PrimaryCollectionExplanation=t.adaptDisclosureElementForBlueprintButton=t.PopoverButton=t.Popover=t.PreviewImage=t.PermissionsDropdown=t.PendingChangesProvider=t.PagePreview=t.Overlay=t.OrderPicker=t.NavBar=t.MobileAware=t.MinimalEditor=t.MenuSelect=t.MenuItem=void 0,t.UserNotificationsPopover=t.UserAutocomplete=t.TimelineItem=void 0;var a=n(538);Object.defineProperty(t,"AccentStyle",{enumerable:!0,get:function(){return r(a).default}});var i=n(541);Object.defineProperty(t,"AssignDoi",{enumerable:!0,get:function(){return r(i).default}});var o=n(570);Object.defineProperty(t,"AttributionEditor",{enumerable:!0,get:function(){return r(o).default}});var l=n(237);Object.defineProperty(t,"Avatar",{enumerable:!0,get:function(){return r(l).default}});var u=n(620);Object.defineProperty(t,"Banner",{enumerable:!0,get:function(){return r(u).default}});var c=n(338);Object.defineProperty(t,"Avatars",{enumerable:!0,get:function(){return r(c).default}});var s=n(339);Object.defineProperty(t,"Byline",{enumerable:!0,get:function(){return r(s).default}});var d=n(659);Object.defineProperty(t,"ClickToCopyButton",{enumerable:!0,get:function(){return r(d).default}});var f=n(662);Object.defineProperty(t,"ClientOnly",{enumerable:!0,get:function(){return r(f).default}}),Object.defineProperty(t,"ClientOnlyContext",{enumerable:!0,get:function(){return f.ClientOnlyContext}});var m=n(344);Object.defineProperty(t,"CollectionMultiSelect",{enumerable:!0,get:function(){return r(m).default}});var p=n(345);Object.defineProperty(t,"ColorInput",{enumerable:!0,get:function(){return r(p).default}});var h=n(830);Object.defineProperty(t,"CommunityPreview",{enumerable:!0,get:function(){return r(h).default}});var b=n(380);Object.defineProperty(t,"ConfirmDialog",{enumerable:!0,get:function(){return r(b).default}});var v=n(381);Object.defineProperty(t,"ContributorAvatars",{enumerable:!0,get:function(){return r(v).default}});var y=n(382);Object.defineProperty(t,"ContributorsList",{enumerable:!0,get:function(){return r(y).default}});var g=n(835);Object.defineProperty(t,"DashboardFrame",{enumerable:!0,get:function(){return r(g).default}});var _=n(837);Object.defineProperty(t,"DashboardRow",{enumerable:!0,get:function(){return r(_).default}});var E=n(383);Object.defineProperty(t,"DashboardRowListing",{enumerable:!0,get:function(){return r(E).default}});var P=n(840);Object.defineProperty(t,"DatePicker",{enumerable:!0,get:function(){return r(P).default}});var w=n(841);Object.defineProperty(t,"DevCommunitySwitcherMenu",{enumerable:!0,get:function(){return w.DevCommunitySwitcherMenu}}),Object.defineProperty(t,"DevCommunitySwitcherMenuItems",{enumerable:!0,get:function(){return w.DevCommunitySwitcherMenuItems}});var O=n(848);Object.defineProperty(t,"DialogLauncher",{enumerable:!0,get:function(){return r(O).default}});var C=n(849);Object.defineProperty(t,"DownloadChooser",{enumerable:!0,get:function(){return r(C).default}});var S=n(978);Object.defineProperty(t,"DragDropListing",{enumerable:!0,get:function(){return S.DragDropListing}}),Object.defineProperty(t,"DragDropOrdering",{enumerable:!0,get:function(){return S.DragDropOrdering}}),Object.defineProperty(t,"DragHandle",{enumerable:!0,get:function(){return S.DragHandle}});var D=n(981);Object.defineProperty(t,"DropdownButton",{enumerable:!0,get:function(){return r(D).default}});var k=n(41);Object.defineProperty(t,"Editor",{enumerable:!0,get:function(){return r(k).default}});var j=n(983);Object.defineProperty(t,"FileUploadButton",{enumerable:!0,get:function(){return r(j).default}});var M=n(985);Object.defineProperty(t,"Footer",{enumerable:!0,get:function(){return r(M).default}});var N=n(421);Object.defineProperty(t,"FormattingBar",{enumerable:!0,get:function(){return r(N).default}});var I=n(1e3);Object.defineProperty(t,"GlobalControls",{enumerable:!0,get:function(){return r(I).default}});var x=n(1007);Object.defineProperty(t,"GridWrapper",{enumerable:!0,get:function(){return r(x).default}});var T=n(1008);Object.defineProperty(t,"Header",{enumerable:!0,get:function(){return r(T).default}});var A=n(58);Object.defineProperty(t,"Icon",{enumerable:!0,get:function(){return r(A).default}});var R=n(426);Object.defineProperty(t,"ImageCropper",{enumerable:!0,get:function(){return r(R).default}});var B=n(270);Object.defineProperty(t,"ImageUpload",{enumerable:!0,get:function(){return r(B).default}});var F=n(215);Object.defineProperty(t,"InputField",{enumerable:!0,get:function(){return r(F).default}});var L=n(428);Object.defineProperty(t,"Layout",{enumerable:!0,get:function(){return r(L).default}});var U=n(1029);Object.defineProperty(t,"LayoutEditor",{enumerable:!0,get:function(){return r(U).default}});var z=n(1098);Object.defineProperty(t,"LegalBanner",{enumerable:!0,get:function(){return r(z).default}});var H=n(1102);Object.defineProperty(t,"LengthIndicator",{enumerable:!0,get:function(){return r(H).default}});var V=n(1104);Object.defineProperty(t,"LicenseSelect",{enumerable:!0,get:function(){return r(V).default}});var q=n(1107);Object.defineProperty(t,"LinkedPageSelect",{enumerable:!0,get:function(){return r(q).default}});var W=n(1108);Object.defineProperty(t,"InheritedMembersBlock",{enumerable:!0,get:function(){return r(W).default}});var G=n(449);Object.defineProperty(t,"MemberRow",{enumerable:!0,get:function(){return r(G).default}});var K=n(57);Object.defineProperty(t,"Menu",{enumerable:!0,get:function(){return K.Menu}}),Object.defineProperty(t,"MenuButton",{enumerable:!0,get:function(){return K.MenuButton}}),Object.defineProperty(t,"MenuConfigProvider",{enumerable:!0,get:function(){return K.MenuConfigProvider}}),Object.defineProperty(t,"MenuItem",{enumerable:!0,get:function(){return K.MenuItem}}),Object.defineProperty(t,"MenuSelect",{enumerable:!0,get:function(){return K.MenuSelect}});var J=n(1114);Object.defineProperty(t,"MinimalEditor",{enumerable:!0,get:function(){return r(J).default}});var Y=n(1116);Object.defineProperty(t,"MobileAware",{enumerable:!0,get:function(){return r(Y).default}});var $=n(1119);Object.defineProperty(t,"NavBar",{enumerable:!0,get:function(){return r($).default}});var Q=n(1121);Object.defineProperty(t,"OrderPicker",{enumerable:!0,get:function(){return r(Q).default}});var Z=n(427);Object.defineProperty(t,"Overlay",{enumerable:!0,get:function(){return r(Z).default}});var X=n(432);Object.defineProperty(t,"PagePreview",{enumerable:!0,get:function(){return r(X).default}});var ee=n(1124);Object.defineProperty(t,"PendingChangesProvider",{enumerable:!0,get:function(){return r(ee).default}});var te=n(1125);Object.defineProperty(t,"PermissionsDropdown",{enumerable:!0,get:function(){return r(te).default}});var ne=n(1126);Object.defineProperty(t,"PreviewImage",{enumerable:!0,get:function(){return r(ne).default}});var re=n(1128);Object.defineProperty(t,"Popover",{enumerable:!0,get:function(){return re.Popover}}),Object.defineProperty(t,"PopoverButton",{enumerable:!0,get:function(){return re.PopoverButton}}),Object.defineProperty(t,"adaptDisclosureElementForBlueprintButton",{enumerable:!0,get:function(){return re.adaptDisclosureElementForBlueprintButton}});var ae=n(1131);Object.defineProperty(t,"PrimaryCollectionExplanation",{enumerable:!0,get:function(){return r(ae).default}});var ie=n(1132);Object.defineProperty(t,"PubAttributionDialog",{enumerable:!0,get:function(){return r(ie).default}});var oe=n(452);Object.defineProperty(t,"PubAttributionEditor",{enumerable:!0,get:function(){return r(oe).default}});var le=n(1134);Object.defineProperty(t,"PubHeaderBackground",{enumerable:!0,get:function(){return r(le).default}});var ue=n(1136);Object.defineProperty(t,"PubByline",{enumerable:!0,get:function(){return r(ue).default}});var ce=n(1137);Object.defineProperty(t,"PubCollectionsListing",{enumerable:!0,get:function(){return r(ce).default}});var se=n(1140);Object.defineProperty(t,"PubEdge",{enumerable:!0,get:function(){return r(se).default}});var de=n(1143);Object.defineProperty(t,"PubEdgeEditor",{enumerable:!0,get:function(){return r(de).default}});var fe=n(456);Object.defineProperty(t,"PubEdgeListing",{enumerable:!0,get:function(){return r(fe).default}});var me=n(283);Object.defineProperty(t,"PubEdgeListingCard",{enumerable:!0,get:function(){return r(me).default}});var pe=n(1149);Object.defineProperty(t,"PubHistoryViewer",{enumerable:!0,get:function(){return r(pe).default}});var he=n(1151);Object.defineProperty(t,"PubMenuItem",{enumerable:!0,get:function(){return r(he).default}});var be=n(1153);Object.defineProperty(t,"PubNoteContent",{enumerable:!0,get:function(){return r(be).default}});var ve=n(1155);Object.defineProperty(t,"PubPreview",{enumerable:!0,get:function(){return r(ve).default}});var ye=n(1164);Object.defineProperty(t,"PubReleaseDialog",{enumerable:!0,get:function(){return r(ye).default}});var ge=n(1168);Object.defineProperty(t,"PubReleaseReviewDialog",{enumerable:!0,get:function(){return r(ge).default}});var _e=n(1170);Object.defineProperty(t,"PubShareDialog",{enumerable:!0,get:function(){return r(_e).default}});var Ee=n(1172);Object.defineProperty(t,"PubThemePicker",{enumerable:!0,get:function(){return r(Ee).default}});var Pe=n(1176);Object.defineProperty(t,"PubTitle",{enumerable:!0,get:function(){return r(Pe).default}});var we=n(1177);Object.defineProperty(t,"ReferencesDropdown",{enumerable:!0,get:function(){return r(we).default}});var Oe=n(1178);Object.defineProperty(t,"QueryListDropdown",{enumerable:!0,get:function(){return r(Oe).default}});var Ce=n(1180);Object.defineProperty(t,"ScopeDropdown",{enumerable:!0,get:function(){return r(Ce).default}});var Se=n(1182);Object.defineProperty(t,"SettingsSection",{enumerable:!0,get:function(){return r(Se).default}});var De=n(1184);Object.defineProperty(t,"SharingCard",{enumerable:!0,get:function(){return r(De).default}});var ke=n(1186);Object.defineProperty(t,"SimpleEditor",{enumerable:!0,get:function(){return r(ke).default}});var je=n(1189);Object.defineProperty(t,"SliderInput",{enumerable:!0,get:function(){return r(je).default}});var Me=n(1191);Object.defineProperty(t,"SkipLink",{enumerable:!0,get:function(){return r(Me).default}});var Ne=n(1193);Object.defineProperty(t,"SubmissionEmail",{enumerable:!0,get:function(){return r(Ne).default}});var Ie=n(1194);Object.defineProperty(t,"SubscriptionButton",{enumerable:!0,get:function(){return r(Ie).default}});var xe=n(1196);Object.defineProperty(t,"TabToShow",{enumerable:!0,get:function(){return r(xe).default}});var Te=n(1198);Object.defineProperty(t,"TitleEditor",{enumerable:!0,get:function(){return r(Te).default}});var Ae=n(1200);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return r(Ae).default}});var Re=n(1206);Object.defineProperty(t,"ThreadInput",{enumerable:!0,get:function(){return r(Re).default}});var Be=n(1208);Object.defineProperty(t,"TimeAgo",{enumerable:!0,get:function(){return r(Be).default}});var Fe=n(1209);Object.defineProperty(t,"Timeline",{enumerable:!0,get:function(){return Fe.Timeline}}),Object.defineProperty(t,"TimelineCondenser",{enumerable:!0,get:function(){return Fe.TimelineCondenser}}),Object.defineProperty(t,"TimelineItem",{enumerable:!0,get:function(){return Fe.TimelineItem}});var Le=n(1213);Object.defineProperty(t,"UserAutocomplete",{enumerable:!0,get:function(){return r(Le).default}});var Ue=n(1215);Object.defineProperty(t,"UserNotificationsPopover",{enumerable:!0,get:function(){return r(Ue).default}})},,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useThrottled=t.usePendingChanges=t.usePageContext=t.PendingChanges=t.PageContext=void 0;var u=i(n(0)),c=l(n(618));t.PageContext=u.default.createContext({}),t.PendingChanges=u.default.createContext({pendingPromise:function(e){return e},pendingCount:0});t.usePageContext=function(e){void 0===e&&(e=null);var n=(0,u.useContext)(t.PageContext);return e||n};t.usePendingChanges=function(){return(0,u.useContext)(t.PendingChanges)};t.useThrottled=function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!0);var a=o((0,u.useState)(e),2),i=a[0],l=a[1],s=(0,u.useMemo)((function(){return(0,c.default)(l,t,{leading:n,trailing:r})}),[t,n,r]);return(0,u.useEffect)((function(){s(e)}),[s,e]),i}},,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.apiFetch=void 0;t.apiFetch=function(e,t){return fetch(e,r(r({},t),{headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"})).then((function(e){return e.ok?e.json():e.json().then((function(e){throw e}))}))};var a=function(e){return function(n,a,i){return(0,t.apiFetch)(n,r(r({},i),{method:e.toUpperCase(),body:"string"==typeof a?a:JSON.stringify(a)}))}};["get","head","post","put","delete","connect","options","trace"].forEach((function(e){return Object.defineProperty(t.apiFetch,e,{writable:!1,value:a(e)})}))},,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pageUrl=t.doiUrl=t.bestPubUrl=t.pubUrl=t.pubShortUrl=t.collectionUrl=t.communityUrl=t.profileUrl=void 0;var i=a(n(435)),o=n(130);t.profileUrl=function(e){return"/user/"+e};t.communityUrl=function(e){return(0,o.isDuqDuq)()?"https://"+e.subdomain+".duqduq.org":e.domain?e.domain.includes("localhost:")?"http://"+e.domain:"https://"+e.domain:"https://"+e.subdomain+".pubpub.org"};t.collectionUrl=function(e,n){return(0,t.communityUrl)(e)+"/"+n.slug};t.pubShortUrl=function(e){return"https://pubpub.org/pub/"+e.slug};t.pubUrl=function(e,n,a){void 0===a&&(a={});var l=null===e||(0,o.isQubQub)()?"":(0,t.communityUrl)(e),u=l+"/pub/"+n.slug,c=a.isDraft,s=a.historyKey,d=a.releaseNumber,f=a.releaseId,m=a.discussionId,p=a.accessHash,h=a.query,b=a.download,v=a.hash;if(a.isReview&&s&&p)return u=l+"/pub/"+n.slug+"/review/"+s,i.default.stringifyUrl({url:u,query:r({access:p},h)},{skipNull:!0});if(b)u=u+"/download"+("string"==typeof b?"/"+b:"");else if(c){u=u+"/draft"+(void 0!==s?"/"+s:"")}else void 0!==d?u=u+"/release/"+d:f?u=u+"/release-id/"+f:m&&(u=u+"/discussion-id/"+m);var y=i.default.stringifyUrl({url:u,query:r({access:p},h)},{skipNull:!0});return v?y+"#"+v:y};t.bestPubUrl=function(e,n){var r=e.pubData,a=e.communityData;return void 0===n&&(n={}),a?(0,t.pubUrl)(a,r,n):(0,t.pubShortUrl)(r)};t.doiUrl=function(e){return"https://doi.org/"+e};t.pageUrl=function(e,n){return(0,t.communityUrl)(e)+"/"+n.slug}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePubData=t.usePubHistory=t.useCollab=t.usePubContext=void 0;var r=n(0),a=n(440);t.usePubContext=function(e){var t=(null!=e?e:{}).immediate,n=void 0!==t&&t;return(0,r.useContext)(n?a.ImmediatePubContext:a.SuspendedPubContext)};t.useCollab=function(){return(0,t.usePubContext)().collabData};t.usePubHistory=function(){return(0,t.usePubContext)().historyData};t.usePubData=function(){return(0,t.usePubContext)().pubData}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.groupPubs=t.getDashUrl=void 0;t.getDashUrl=function(e){var t=e.collectionSlug,n=e.pubSlug,r=e.mode,a=e.subMode,i=e.section,o=void 0===i?"":i,l="/dash";t&&(l="/dash/collection/"+t),n&&(l="/dash/pub/"+n);var u="";return t&&n&&(u="?collectionSlug="+t),""+l+(r&&"overview"!==r?"/"+r.toLowerCase().replace(/ /gi,"-"):"")+(a?"/"+String(a).toLowerCase().replace(/ /gi,"-"):"")+u+(o&&"#"+o)};t.groupPubs=function(e){var t=e.pubs,n=e.collections,o={},l=[];return t.forEach((function(e){e.collectionPubs.length?e.collectionPubs.forEach((function(t){var n=o[t.collectionId]||[];o[t.collectionId]=i(i([],a(n),!1),[e],!1)})):l.push(e)})),{collections:n.map((function(e){return r(r({},e),{pubs:o[e.id]||[]})})),pubs:l}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(850);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(o).default}}),a(n(77),t),a(n(212),t)},,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuConfigProvider=t.MenuSelect=t.MenuButton=t.MenuItemDivider=t.MenuItem=t.Menu=void 0;var a=n(255);Object.defineProperty(t,"Menu",{enumerable:!0,get:function(){return a.Menu}});var i=n(385);Object.defineProperty(t,"MenuItem",{enumerable:!0,get:function(){return i.MenuItem}}),Object.defineProperty(t,"MenuItemDivider",{enumerable:!0,get:function(){return i.MenuItemDivider}});var o=n(386);Object.defineProperty(t,"MenuButton",{enumerable:!0,get:function(){return o.MenuButton}});var l=n(845);Object.defineProperty(t,"MenuSelect",{enumerable:!0,get:function(){return l.MenuSelect}});var u=n(846);Object.defineProperty(t,"MenuConfigProvider",{enumerable:!0,get:function(){return r(u).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(5),l=r(n(843));n(844);t.default=function(e){var t=e.ariaHidden,n=void 0===t||t,r=e.ariaLabel,u=void 0===r?"":r,c=e.className,s=e.color,d=e.icon,f=e.iconSize,m=void 0===f?16:f,p=e.useColor,h=void 0!==p&&p,b=e.intent;if(l.default[d]){var v=l.default[d],y=v.squareViewboxDimension,g=v.path,_=v.viewbox||"0 0 "+y+" "+y;return a.default.createElement("span",{className:(0,i.default)("bp3-icon",h&&"color",c),"data-icon":d.toLowerCase().replace(/_/gi,"-"),"aria-label":u,"aria-hidden":n},a.default.createElement("svg",{width:m+"px",height:m+"px",viewBox:_,fill:s},g))}return a.default.createElement(o.Icon,{icon:d,color:s,iconSize:m,className:c,title:n?null:u,intent:b})}},,,,function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.flattenOnce=t.bucketBy=t.pruneFalsyValues=t.arraysHaveSameElements=t.splitArrayOn=t.arraysAreEqual=t.unique=t.indexById=t.indexByProperty=t.intersperse=void 0;t.intersperse=function(e,t){var n=[];return e.forEach((function(r,a){if(n.push(r),a!==e.length-1){var i=t instanceof Function?t(a):t;n.push(i)}})),n};t.indexByProperty=function(e,t){var n={};return e.forEach((function(e){n[e[t]]=e})),n};t.indexById=function(e){return(0,t.indexByProperty)(e,"id")};var i=function(e){return e};t.unique=function(e,t){void 0===t&&(t=i);var n=Symbol("unique"),r=[],a=new Set;return e.forEach((function(e){var i=t(e,n);a.has(i)&&i!==n||(a.add(i),r.push(e))})),r};t.arraysAreEqual=function(e,t,n){if(void 0===n&&(n=null),e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var a=e[r],i=t[r];if(!(n?n(a,i):a===i))return!1}return!0};t.splitArrayOn=function(e,t){var n=[],r=[];return e.forEach((function(e){t(e)?r.push(e):n.push(e)})),[r,n]};t.arraysHaveSameElements=function(e,t){return e.every((function(e){return t.includes(e)}))&&t.every((function(t){return e.includes(t)}))};t.pruneFalsyValues=function(e){return e.filter(Boolean)};t.bucketBy=function(e,t){var n={};return e.forEach((function(e){var r=t(e),a=n[r]||[];a.push(e),n[r]=a})),n};t.flattenOnce=function(e){return e.reduce((function(e,t){return a(a([],r(e),!1),r(t),!1)}),[])}},,function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.btoaUniversal=t.joinOxford=t.enIndefiniteArticle=t.toTitleCase=t.capitalize=t.naivePluralize=t.slugifyString=void 0;var r=n(617);t.slugifyString=function(e){return"string"!=typeof e?(console.error("input is not a valid string"),""):(0,r.remove)(e).replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/gi,"").toLowerCase()};t.naivePluralize=function(e,t){return 1===t?e:e+"s"};t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};t.toTitleCase=function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))};t.enIndefiniteArticle=function(e){var t=e.toLowerCase();return["a","e","i","o","u"].some((function(e){return t.charAt(0)===e}))?"an":"a"};var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return e+t}),"")};t.joinOxford=function(e,t){var n=void 0===t?{}:t,r=n.joiner,i=void 0===r?a:r,o=n.empty,l=void 0===o?"":o,u=n.ampersand,c=void 0!==u&&u,s=c?" & ":" and ",d=c?" & ":", and ";return 0===e.length?l:e.reduce((function(t,n,r){return i(t,2===e.length?s:r===e.length-1?d:", ",n)}))};t.btoaUniversal=function(t){try{return btoa(t)}catch(n){return e.from(t).toString("base64")}}}).call(this,n(613).Buffer)},,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getSundayOfThisWeek=t.isValidDate=t.getReadableDateInYear=t.getLocalDateMatchingUtcCalendarDate=t.timeAgoBaseProps=t.datesAreSameCalendarDate=t.formatDate=void 0;var a=r(n(87)),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.formatDate=function(e,t){var n=void 0===t?{}:t,r=n.includeTime,i=void 0!==r&&r,o=n.includeDate,l=void 0===o||o,u=n.includePreposition,c=void 0!==u&&u,s=n.use12HourDate,d=void 0===s||s,f=n.inUtcTime,m=(void 0!==f&&f?"UTC:":"")+"mmm dd, yyyy",p=l?(c?"on ":"")+(0,a.default)(e,m):"";return i?p+" "+((c?"at ":"")+(0,a.default)(e,d?"h:MM TT":"HH:MM")):p};t.datesAreSameCalendarDate=function(e,t){return e.toDateString()===t.toDateString()},t.timeAgoBaseProps={minPeriod:60,formatter:function(e,t,n){if("second"===t)return"just now";var r=t;return e>1&&(r+="s"),e+" "+r+" "+n}};t.getLocalDateMatchingUtcCalendarDate=function(e){var t=(0,a.default)(e,"UTC:yyyy-mm-dd"),n=new Date(t),r=new Date(e);return r.setMinutes(r.getMinutes()+n.getTimezoneOffset()),r};t.getReadableDateInYear=function(e){return i[e.getMonth()]+" "+e.getDate()};t.isValidDate=function(e){return!Number.isNaN(new Date(e).getTime())};t.getSundayOfThisWeek=function(){var e=new Date,t=e.getDate()-e.getDay();return new Date(e.setDate(t))}},,,,,,,function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.getIconForCollectionKind=t.getSchemaForKind=void 0;var a=n(35),i=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/,o=/^([0-9]{4})$/,l={date:{name:"date",deserialize:function(e){var t=r(i.exec(e).slice(1),3),n=t[0],a=t[1],o=t[2],l=new Date;return l.setFullYear(parseInt(n,10)),l.setMonth(parseInt(a,10)-1),l.setDate(parseInt(o,10)),l},validate:function(e){return i.test(e)},labelInfo:"(in YYYY-MM-DD format)"},year:{name:"year",validate:function(e){return o.test(e)},deserialize:function(e){return e},labelInfo:"(YYYY)"}},u={doi:{name:"doi",label:"DOI",derivedFrom:function(e){var t=e.collection;return t&&t.doi},derivedLabelInfo:"(Registered and cannot be changed)"},url:{name:"url",label:"URL",defaultDerivedFrom:function(e){var t=e.community,n=e.collection;return t&&n&&n.id&&(0,a.collectionUrl)(t,n)}}},c=[{kind:"tag",label:{singular:"tag",plural:"tags"},bpDisplayIcon:"tag",metadata:[],contextHints:[]},{kind:"issue",label:{singular:"issue",plural:"issues"},bpDisplayIcon:"manual",contextHints:[{value:"article",label:"Article",isDefault:!0}],metadata:[u.doi,u.url,{name:"printIssn",label:"Print ISSN"},{name:"electronicIssn",label:"Electronic ISSN"},{name:"volume",label:"Volume"},{name:"issue",label:"Issue"},{name:"printPublicationDate",label:"Print publication date",type:l.date},{name:"publicationDate",label:"Publication date",type:l.date}]},{kind:"book",label:{singular:"book",plural:"books"},bpDisplayIcon:"book",contextHints:[{value:"foreword",label:"Foreword",crossrefComponentType:"section"},{value:"preface",label:"Preface",crossrefComponentType:"section"},{value:"supplementaryMaterial",label:"Supplementary Material",crossrefComponentType:"reference_entry"},{value:"chapter",label:"Chapter",isDefault:!0,crossrefComponentType:"chapter"},{value:"appendix",label:"Appendix",crossrefComponentType:"reference_entry"},{value:"glossary",label:"Glossary",crossrefComponentType:"reference_entry"},{value:"acknowledgements",label:"Acknowledgements",crossrefComponentType:"section"}],metadata:[u.doi,u.url,{name:"isbn",label:"ISBN"},{name:"copyrightYear",label:"Copyright year",pattern:"^[0-9]*$",type:l.year},{name:"publicationDate",label:"Publication date",type:l.date},{name:"edition",label:"Edition no.",pattern:"^[0-9]*$"}]},{kind:"conference",label:{singular:"conference",plural:"conferences"},bpDisplayIcon:"presentation",contextHints:[{value:"paper",label:"Paper",isDefault:!0}],metadata:[u.doi,u.url,{name:"theme",label:"Theme"},{name:"acronym",label:"Acronym"},{name:"location",label:"Location"},{name:"date",label:"Date",type:l.date}]}];t.default=c;t.getSchemaForKind=function(e){var t=c.find((function(t){return t.kind===e}));return t||null};t.getIconForCollectionKind=function(e){var n=(0,t.getSchemaForKind)(e);return n?n.bpDisplayIcon:null}},,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(851),t),a(n(210),t),a(n(405),t),a(n(897),t),a(n(395),t),a(n(898),t),a(n(899),t),a(n(900),t),a(n(115),t),a(n(129),t),a(n(902),t),a(n(388),t),a(n(923),t),a(n(924),t)},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSrcSet=t.getResizedUrl=void 0;var r=n(64),a=["jpg","jpeg","png"];t.getResizedUrl=function(e,t,n,i){if(!e||-1===e.indexOf("https://assets.pubpub.org/"))return e||"";var o=e.split(".").pop().toLowerCase();if(-1===a.indexOf(o))return e;var l={bucket:"assets.pubpub.org",key:e.replace("https://assets.pubpub.org/",""),edits:{resize:{width:n,height:i,fit:t,withoutEnlargement:!0}}};return"https://resize-v3.pubpub.org/"+(0,r.btoaUniversal)(JSON.stringify(l))};t.getSrcSet=function(e,n,r){return[1,2,3].map((function(a){return(0,t.getResizedUrl)(e,n,r*a)+" "+a+"x"})).join(",")}},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.s3Upload=void 0;var r=n(130),a=n(161);t.s3Upload=function(e,t,n,i){var o=function(e){var t=(0,r.isProd)()?(0,a.generateHash)(8):"_testing",n=void 0!==e.name?e.name.split(".").pop():"jpg";return t+"/"+Math.floor(8*Math.random())+(new Date).getTime()+"."+n}(e),l=void 0!==e.type?e.type:"image/jpeg";var u=new XMLHttpRequest;u.addEventListener("load",(function(){var r=JSON.parse(this.responseText),a=r.policy,u=r.signature,c=r.acl,s=r.awsAccessKeyId,d=r.bucket,f=new FormData;f.append("key",o),f.append("AWSAccessKeyId",s),f.append("acl",c),f.append("policy",a),f.append("signature",u),f.append("Content-Type",l),f.append("success_action_status","200"),f.append("file",e);var m=new XMLHttpRequest,p=function(e){return"https://s3-external-1.amazonaws.com/"+e}(d);m.upload.addEventListener("progress",(function(e){return t(e,i)}),!1),m.upload.addEventListener("load",(function(t){return(r=p+"/"+o,a=0,new Promise((function(e,t){var n=function(){fetch(r,{method:"HEAD"}).then((function(r){return r.ok?e():a<10?(a+=1,setTimeout(n,1e3)):t()}))};n()}))).then((function(){return n(t,i,e.type,o,e.name)}));var r,a}),!1),m.open("POST",p,!0),m.send(f)})),u.open("GET","/api/uploadPolicy?contentType="+encodeURIComponent(e.type)),u.send()}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPubCopyrightYear=t.getPubUpdatedDate=t.getPubLatestReleaseDate=t.getPubPublishedDateString=t.getPubPublishedDate=t.getPubCreatedDate=t.getPubLatestReleasedDate=void 0;var i=a(n(87)),o=n(67),l=n(131);t.getPubLatestReleasedDate=function(e){return 0===e.releases.length?null:e.releases.map((function(e){return new Date(e.createdAt)})).reduce((function(e,t){return t>e?t:e}))};t.getPubCreatedDate=function(e){return e.createdAt};t.getPubPublishedDate=function(e,t){if(void 0===t&&(t=!0),e.customPublishedAt&&t)return(0,o.getLocalDateMatchingUtcCalendarDate)(e.customPublishedAt);var n=e.releases;if(n.length>0){var a=r(n,1)[0];return new Date(a.createdAt)}return null};t.getPubPublishedDateString=function(e){var n=(0,t.getPubPublishedDate)(e,!0),r="";return n&&(r=(0,o.formatDate)(n)),n&&0===e.releases.length&&(r+=" (Not yet released)"),r||null};t.getPubLatestReleaseDate=function(e,t){var n=(void 0===t?{}:t).excludeFirstRelease,r=void 0!==n&&n,a=e.releases;if(1===a.length&&r)return null;var i=a[a.length-1];return i?new Date(i.createdAt):null};t.getPubUpdatedDate=function(e){var t,n=e.pub,r=e.historyData,a=void 0===r?null:r;if(a){var i=a.timestamps,o=a.latestKey;if(i&&"number"==typeof o){var l=i[o];return new Date(l)}}return"draft"in n&&(null===(t=n.draft)||void 0===t?void 0:t.latestKeyAt)?n.draft.latestKeyAt:null};t.getPubCopyrightYear=function(e){var n=(0,l.getPrimaryCollection)(e.collectionPubs);if(n){var r=n.metadata;if(r){var a=r.copyrightYear,u=r.date,c=r.publicationDate,s=a||u||c;if(s&&(0,o.isValidDate)(s))return(0,i.default)((0,o.getLocalDateMatchingUtcCalendarDate)(s),"yyyy")}}var d=(0,t.getPubPublishedDate)(e);return d?(0,i.default)(d,"yyyy"):(0,i.default)("yyyy")}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserFromContext=t.getReviewFromContext=t.getPubEdgeFromContext=t.getPubFromContext=t.getCollectionFromContext=t.getCommunityFromContext=void 0;var r=function(e){return function(t,n){var r=e,a=t,i=n.associations[r][a];return i||null}};t.getCommunityFromContext=r("community"),t.getCollectionFromContext=r("collection"),t.getPubFromContext=r("pub"),t.getPubEdgeFromContext=r("pubEdge"),t.getReviewFromContext=r("review"),t.getUserFromContext=r("user")},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.counter=void 0;var r=n(105),a=n(77);t.counter=function(e){return void 0===e&&(e={}),function(t){var n=e.counterType,i=void 0===n?t.type.name:n,o=e.useNodeLabels,l=void 0!==o&&o,u=e.nodeFingerprintFn,c=(0,r.useDocumentState)().nodeLabels,s=i;if(l){var d=(0,a.isNodeLabelEnabled)(t,c);if(!d)return null;s=d}var f=(0,r.useTransactionState)(["counter",s],{countsMap:{},maxCount:0});if(u){var m=JSON.stringify(u(t));return f.countsMap[m]||(f.maxCount++,f.countsMap[m]=f.maxCount),f.countsMap[m]}return f.maxCount++,f.maxCount}}},function(e,t,n){"use strict";var r,a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeLabelText=t.getDefaultNodeLabels=t.getCurrentNodeLabels=t.getReferenceableNodes=t.getReferenceForNode=t.isNodeLabelEnabled=t.buildLabel=t.nodeDefaults=t.getReferenceableNodeType=void 0;var o=n(105),l=n(396),u=n(212);t.getReferenceableNodeType=function(e){return"math_display"===e.type.name?"block_equation":e.type.name},t.nodeDefaults=((r={})[u.ReferenceableNodeType.Image]={icon:"media",text:"Image"},r[u.ReferenceableNodeType.Video]={icon:"media",text:"Video"},r[u.ReferenceableNodeType.Audio]={icon:"media",text:"Audio"},r[u.ReferenceableNodeType.Table]={icon:"th",text:"Table"},r[u.ReferenceableNodeType.BlockEquation]={icon:"function",text:"Equation"},r);t.buildLabel=function(e,n){var r=e.attrs,a=r.count,i=r.label,o=(0,t.getReferenceableNodeType)(e);if(!a&&!i)return null;var l=t.nodeDefaults[o];return l?(n||i||l.text)+" "+a:null};t.isNodeLabelEnabled=function(e,n){var r,a=(0,t.getReferenceableNodeType)(e),i=null===(r=n[a])||void 0===r?void 0:r.enabled;return e.attrs.hideLabel||!i?null:a};t.getReferenceForNode=function(e,n,r){var a=e.type.spec.reactive,i=(0,t.getReferenceableNodeType)(e);if(!a)return null;var l=r[i],u=t.nodeDefaults[i],c=(0,o.getReactedCopyOfNode)(e,n);return u&&c&&"number"==typeof c.attrs.count&&l&&(0,t.isNodeLabelEnabled)(e,r)?{node:c,icon:u.icon,label:(0,t.buildLabel)(c,l.text)}:null};t.getReferenceableNodes=function(e,n){var r=[];return e.doc.descendants((function(a){if(a.attrs&&a.attrs.id){var i=(0,t.getReferenceForNode)(a,e,n);i&&r.push(i)}})),r};t.getCurrentNodeLabels=function(e){return l.referencesPluginKey.getState(e).nodeLabels};t.getDefaultNodeLabels=function(e){var n=Object.entries(t.nodeDefaults).reduce((function(e,t){var n,r=i(t,2),o=r[0],l=r[1].text;return a(a({},e),((n={})[o]={enabled:!1,text:l},n))}),{});return Object.assign(n,e.nodeLabels)};t.getNodeLabelText=function(e,n){var r;return null===(r=n[(0,t.getReferenceableNodeType)(e)])||void 0===r?void 0:r.text}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FormattingBar=t.buttons=void 0;var u=i(n(1044));t.buttons=u;var c=n(421);Object.defineProperty(t,"FormattingBar",{enumerable:!0,get:function(){return l(c).default}}),o(n(267),t)},,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderHtmlChildren=void 0;var a=r(n(0));t.renderHtmlChildren=function(e,t,n){if(void 0===n&&(n="span"),e)return a.default.createElement(n,{dangerouslySetInnerHTML:{__html:t}});var r=document.createElement(n);return r.innerHTML=t,r}},function(e,t,n){"use strict";var r,a;Object.defineProperty(t,"__esModule",{value:!0}),t.getAppCommit=t.setAppCommit=t.isDevelopment=t.isQubQub=t.isDuqDuq=t.isProd=t.setEnvironment=void 0;t.setEnvironment=function(e,t,n){r=e?"production":t?"duqduq":n?"qubqub":"development"};t.isProd=function(){return"production"===r};t.isDuqDuq=function(){return"duqduq"===r};t.isQubQub=function(){return"qubqub"===r};t.isDevelopment=function(){return"development"===r};t.setAppCommit=function(e){a=e};t.getAppCommit=function(){return a}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.sortByPrimaryStatus=t.getPrimaryCollectionPub=t.getPrimaryCollection=void 0;var i=n(164),o=function(e){var t=e.collection;return t&&"tag"!==t.kind&&t.isPublic};t.getPrimaryCollection=function(e){var t=(0,i.sortByRank)(e,"pubRank").find(o);return t?t.collection:null};t.getPrimaryCollectionPub=function(e){return(0,i.sortByRank)(e,"pubRank").find(o)};t.sortByPrimaryStatus=function(e){var t=(0,i.sortByRank)(e,"pubRank"),n=t.findIndex(o);if(-1!==n){var l=t[n],u=t.filter((function(e){return e!==l}));return a([l],r(u),!1)}return t}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthorString=t.getContributorName=t.getAllCollectionContributors=t.getAllPubContributors=void 0;var o=i(n(199)),l=n(64),u=n(62),c=n(131),s=function(e){return(e||[]).concat().sort((function(e,t){return e.order!==t.order?e.order-t.order:e.createdAt&&t.createdAt&&t.createdAt!==e.createdAt?t.createdAt.toString()>e.createdAt.toString()?1:-1:0}))},d=["Editor","Writing â€“ Review & Editing"],f=["Illustrator","Visualization"],m=d.concat(f,["Translator","Series Editor","Chair"]),p=function(e){return e.roles?e.roles[0]:""},h=function(e,t,n){var r=e.filter((function(e){return(!t||!e.isAuthor)&&!(n&&!e.isAuthor)}));return(0,u.unique)(r,(function(e,t){var n;return e.user?JSON.stringify({userId:e.user.id,roles:(null!==(n=e.roles)&&void 0!==n?n:[]).sort((function(e,t){return e.localeCompare(t)}))}):t}))};t.getAllPubContributors=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var l=e.collectionPubs,u=l&&(0,c.getPrimaryCollection)(l),b=a(a([],r(s(e.attributions)),!1),r(s(u&&u.attributions)),!1).map(o.default);if("contributors"===t)return h(b,n,i);if("author"===t){var v=b.filter((function(e){return!e.roles||!m.includes(p(e))}));return h(v,n,i)}if("editor"===t){var y=b.filter((function(e){return d.includes(p(e))}));return h(y,n,i)}if("illustrator"===t){var g=b.filter((function(e){return f.includes(p(e))}));return h(g,n,i)}var _=b.filter((function(e){return p(e)===t}));return h(_,n,i)};t.getAllCollectionContributors=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),h(s(e.attributions).map(o.default),t,n)};t.getContributorName=function(e){return e.user?e.user.fullName:e.name};t.getAuthorString=function(e){var n=(0,t.getAllPubContributors)(e,"author",!1,!0);return(0,l.joinOxford)(n.map((function(e){return e.user.fullName})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useManyPubs=void 0;var r=n(1039);Object.defineProperty(t,"useManyPubs",{enumerable:!0,get:function(){return r.useManyPubs}})},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderLatexString=t.getEmbedType=t.getIframeSrc=void 0;t.getIframeSrc=function(e){var t=/<iframe.*?src="(.*?)"/;return e.indexOf("<iframe")>-1&&e.match(t)&&e.match(t)[1]||null};t.getEmbedType=function(e){var t={youtube:["https://www.youtube.com","https://youtu.be"],codepen:["https://codepen.io"],vimeo:["https://vimeo.com","https://player.vimeo.com"],soundcloud:["https://soundcloud.com"],github:["https://gist.github.com"],twitter:["https://twitter.com","https://publish.twitter.com"]};return Object.keys(t).reduce((function(n,r){return t[r].reduce((function(t,n){return 0===e.indexOf(n)||t}),!1)?r:n}),null)};t.renderLatexString=function(e,t,n){fetch("/api/editor/latex-render",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({value:e,isBlock:t}),credentials:"include"}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw e}))})).then((function(e){n(e)})).catch((function(e){n(e)}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(463),t),a(n(464),t),a(n(1227),t),a(n(1228),t),a(n(465),t),a(n(1229),t),a(n(1230),t),a(n(1231),t),a(n(1232),t),a(n(1233),t),a(n(1234),t)},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withValue=void 0;t.withValue=function(e,t){return e?t(e):null}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.collabDocPluginKey=void 0;var a=n(8),i=n(415),o=n(161),l=r(n(930)),u=r(n(931));t.collabDocPluginKey=new a.PluginKey("collaborative"),t.default=function(e,n){var r;if(!(null===(r=n.collaborativeOptions)||void 0===r?void 0:r.firebaseRef))return[];var a=n.collaborativeOptions.clientData.id+"-"+(0,o.generateHash)(6);return[(0,i.collab)({clientID:a}),(0,l.default)(e,n,t.collabDocPluginKey,a),(0,u.default)(e,n,t.collabDocPluginKey)]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateHash=void 0;t.generateHash=function(e){for(var t=e||32,n="abcdefghijklmnopqrstuvwxyz0123456789",r="",a=0;a<t;a+=1)r+=n.charAt(Math.floor(Math.random()*n.length));return r}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeToggle=t.createCommandSpec=void 0;t.createCommandSpec=function(e){return function(t){return function(n){return e(t.dispatch,n)}}};t.createTypeToggle=function(e){var n=e.getTypeFromSchema,a=e.withAttrs,i=e.commandFn,o=e.isActiveFn;return(0,t.createCommandSpec)((function(e,t){var l=n(t.schema),u={state:t,type:l,withAttrs:a};return{run:function(){return i(r(r({},u),{dispatch:e}))},canRun:i(u),isActive:l&&o(u)}}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(986),t),a(n(987),t)},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.findRankInRankedList=t.generateRanks=t.findRank=t.sortByRank=void 0;var i=a(n(1018));t.sortByRank=function(e,t){return void 0===t&&(t="rank"),e.concat().sort((function(e,n){return(e[t]||"").localeCompare(n[t]||"")}))};t.findRank=function(e,t,n){void 0===n&&(n=1);var a=r(function(e,t){return 0===t?["0",e[0]||"z"]:t===e.length?[e[e.length-1],"z"]:e.slice(t-1,t+1)}(e,t),2),o=a[0],l=a[1];return r(i.default.base36.mudder(o,l,n),1)[0]};t.generateRanks=function(e){return i.default.base36.mudder("0","z",e)};t.findRankInRankedList=function(e,n,r){return void 0===r&&(r="rank"),(0,t.findRank)((0,t.sortByRank)(e,r).map((function(e){return e[r]})),n)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.RelationType=t.relationTypeDefinitions=t.relationTypes=void 0;var i=n(280);Object.defineProperty(t,"relationTypes",{enumerable:!0,get:function(){return i.relationTypes}}),Object.defineProperty(t,"relationTypeDefinitions",{enumerable:!0,get:function(){return i.relationTypeDefinitions}}),Object.defineProperty(t,"RelationType",{enumerable:!0,get:function(){return i.RelationType}}),a(n(1141),t)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.itemRenderer=void 0;var a=r(n(0)),i=n(35),o=n(1235),l=n(136),u=function(e,t){var n=e.title,r=e.href,l=e.prefix,u=e.suffix,c=Object.values(t.associations.community)[0],s=r&&(!r.startsWith("http")&&c?(0,i.communityUrl)(Object.values(t.associations.community)[0])+"/"+r.replace(/^\//,""):r),d=s?a.default.createElement("a",{href:s,target:(0,o.isExternalUrl)(r)?"_blank":void 0,rel:"noreferrer"},n):n;return a.default.createElement(a.default.Fragment,null,l?l+" ":null,a.default.createElement("strong",null,d),u?" "+u:null)};t.itemRenderer=function(e){var t=e.icon,n=e.titleRenderers,r=e.message,a=e.excerpt;return function(e,i){var o=e.communityId,c=e.collectionId,s=e.pubId,d=function(e,t,n){var r={actor:u((0,l.actorTitle)(e,n),n)};return Object.keys(t).forEach((function(a){var i=(0,t[a])(e,n);r[a]=u(i,n)})),r}(e,n,i),f=e,m=f.id,p=f.timestamp;return{id:m,icon:"function"==typeof t?t({context:i}):t,actor:e.actorId?i.associations.user[e.actorId]:null,context:i,timestamp:new Date(p),message:r({item:e,titles:d,context:i}),excerpt:null==a?void 0:a({item:e,context:i}),scope:{communityId:o,collectionId:c,pubId:s}}}}},,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.removeDiscussionsById=t.mapDiscussionThroughSteps=t.mapDiscussionSelectionThroughSteps=t.getSelectionFromRange=t.getRangeFromSelection=t.isEmptySelection=void 0;t.isEmptySelection=function(e){return!e||e.anchor===e.head};t.getRangeFromSelection=function(e){var t=e.anchor,n=e.head;return{from:Math.min(t,n),to:Math.max(t,n)}};t.getSelectionFromRange=function(e){return{type:"text",anchor:e.from,head:e.to}};t.mapDiscussionSelectionThroughSteps=function(e,n){if((0,t.isEmptySelection)(e))return null;var r=(0,t.getRangeFromSelection)(e),a=n.reduce((function(e,t){if(null===e)return null;var n=t.getMap(),r=n.map(e.from,1),a=n.map(e.to,-1);return r===a||0===r?null:{from:r,to:a}}),r);return a?(0,t.getSelectionFromRange)(a):null};t.mapDiscussionThroughSteps=function(e,n){return n.length?r(r({},e),{selection:(0,t.mapDiscussionSelectionThroughSteps)(e.selection,n)}):e};t.removeDiscussionsById=function(e,t){if(0===t.size)return e;var n={};return Object.entries(e).forEach((function(e){var r=a(e,2),i=r[0],o=r[1];t.has(i)||(n[i]=o)})),n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(958),t),a(n(959),t),a(n(960),t),a(n(961),t),a(n(962),t),a(n(963),t),a(n(964),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useInfiniteScroll=void 0;var r=n(0);t.useInfiniteScroll=function(e){var t=e.enabled,n=e.onRequestMoreItems,a=e.scrollTolerance,i=void 0===a?0:a,o=function(e){return"useDocumentElement"in e?"undefined"!=typeof document?document.documentElement:null:e.element}(e);(0,r.useEffect)((function(){if(o&&t&&n){var e=function(){o&&t&&function(e,t){return e.scrollHeight-e.scrollTop-t<=e.clientHeight}(o,i)&&n()};e();var r=o===document.documentElement?window:o;return r.addEventListener("scroll",e),function(){return r.removeEventListener("scroll",e)}}return function(){}}),[o,t,i,n])}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isSticky=t.useSticky=void 0;var a=n(0),i=r(n(438));t.useSticky=function(e){var t,n,r=e.target,o=e.offset,l=void 0===o?0:o,u=e.isActive,c=void 0===u||u,s=(0,a.useRef)(null);return(0,a.useEffect)((function(){return c?(s.current=(0,i.default)(r,{stickyBitStickyOffset:l,useStickyClasses:!0}),function(){try{s.current.cleanup()}catch(e){}}):function(){}}),[c,l,r]),t=function(){return s.current&&s.current.update()},n=(0,a.useRef)(null),(0,a.useEffect)((function(){if("undefined"!=typeof window){if("ResizeObserver"in window){var e=new window.ResizeObserver(t);return e.observe(document.body),function(){return e.disconnect()}}var r=setInterval((function(){var e=document.body.offsetHeight;e!==n.current&&(n.current=e,t())}),100);return function(){return clearInterval(r)}}return function(){}}),[t]),s.current};t.isSticky=function(e){return e.classList.contains("js-is-sticky")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SpecialRow=t.LoadMorePubsRow=t.PubOverviewRow=t.OverviewRows=t.ExpandableCollectionOverviewRow=t.CollectionOverviewRow=void 0;var a=n(472);Object.defineProperty(t,"CollectionOverviewRow",{enumerable:!0,get:function(){return r(a).default}});var i=n(1309);Object.defineProperty(t,"ExpandableCollectionOverviewRow",{enumerable:!0,get:function(){return r(i).default}});var o=n(475);Object.defineProperty(t,"OverviewRows",{enumerable:!0,get:function(){return r(o).default}});var l=n(476);Object.defineProperty(t,"PubOverviewRow",{enumerable:!0,get:function(){return r(l).default}});var u=n(477);Object.defineProperty(t,"LoadMorePubsRow",{enumerable:!0,get:function(){return r(u).default}});var c=n(285);Object.defineProperty(t,"SpecialRow",{enumerable:!0,get:function(){return r(c).default}})},,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(340),i=n(342);t.default=function(e){if((0,a.isAttributionWithUser)(e)&&e.user.id!==e.id)return e;var t=e.id,n=e.name,o=e.avatar,l=e.title,u=e.orcid,c=(0,i.getPartsOfFullName)(n),s=c.firstName,d=c.lastName,f=c.initials,m="function"==typeof e.toJSON?e.toJSON():e;return r(r({},m),{user:{isShadowUser:!0,id:t,initials:f,fullName:n,firstName:s,lastName:d,avatar:o,title:l,orcid:u}})}},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jsonToNode=t.getDocForHtmlString=t.isEmptyDocNode=t.isEmptyDoc=t.getEmptyDoc=void 0;var r=n(7),a=n(388);t.getEmptyDoc=function(){return{type:"doc",attrs:{meta:{}},content:[{type:"paragraph"}]}};t.isEmptyDoc=function(e){return!e.content||0===e.content.length||e.content.every((function(e){return!e.content||0===e.content.length}))};t.isEmptyDocNode=function(e){if(0===e.childCount)return!0;if(1===e.childCount){var t=e.firstChild,n=t.isTextblock,r=t.content,a=t.attrs;return n&&0===r.size&&!a.textAlign}return!1};t.getDocForHtmlString=function(e,t){var n=document.createElement("div");return n.innerHTML=e,r.DOMParser.fromSchema(t).parse(n)};t.jsonToNode=function(e,t){return void 0===t&&(t=a.editorSchema),r.Node.fromJSON(t,e)}},,function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.referenceableNodeTypes=t.ReferenceableNodeType=void 0,function(e){e.Image="image",e.Video="video",e.Audio="audio",e.Table="table",e.BlockEquation="block_equation"}(r=t.ReferenceableNodeType||(t.ReferenceableNodeType={})),t.referenceableNodeTypes=Object.values(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.label=void 0;var r=n(105),a=n(77);t.label=function(){return function(e){var t=(0,r.useDocumentState)().nodeLabels;return(0,a.isNodeLabelEnabled)(e,t)?(0,a.getNodeLabelText)(e,t):null}}},,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=r(n(3));n(1014);var l={autocomplete:i.default.string,children:i.default.node,defaultValue:i.default.string,error:i.default.string,helperText:i.default.node,htmlFor:i.default.string,inputRef:i.default.object,isDisabled:i.default.bool,isRequired:i.default.bool,isTextarea:i.default.bool,label:i.default.node,onBlur:i.default.func,onChange:i.default.func,placeholder:i.default.string,type:i.default.string,value:i.default.string,wrapperClassName:i.default.string},u=function(e){return a.default.createElement("div",{className:(0,o.default)("input-field-component","bp3-form-group",e.wrapperClassName,e.error?"bp3-intent-danger":"")},a.default.createElement("label",{className:"bp3-label",htmlFor:"input-"+(e.htmlFor||e.label)},e.label,e.isRequired&&a.default.createElement("span",{className:"bp3-text-muted required-text"}," (required)")),a.default.createElement("div",{className:"bp3-form-content"},e.children,a.default.createElement("div",{className:"bp3-input-group "+(e.error?"bp3-intent-danger":"")},!e.children&&!e.isTextarea&&a.default.createElement("input",{id:"input-"+(e.htmlFor||e.label),className:"bp3-input",disabled:e.isDisabled,placeholder:e.placeholder,value:e.value,defaultValue:e.defaultValue,onChange:e.onChange,onBlur:e.onBlur,type:e.type,autoComplete:e.autocomplete,dir:"auto",ref:e.inputRef}),!e.children&&e.isTextarea&&a.default.createElement("textarea",{id:"input-"+e.label,className:"bp3-input",disabled:e.isDisabled,placeholder:e.placeholder,value:e.value,defaultValue:e.defaultValue,onChange:e.onChange,onBlur:e.onBlur,type:e.type,dir:"auto",ref:e.inputRef}),a.default.createElement("div",{className:"bp3-form-helper-text"},e.error||e.helperText))))};u.defaultProps={autocomplete:void 0,children:void 0,defaultValue:void 0,error:void 0,helperText:"",htmlFor:"",inputRef:void 0,isDisabled:!1,isRequired:!1,isTextarea:!1,label:void 0,onBlur:void 0,onChange:void 0,placeholder:void 0,type:"text",value:void 0,wrapperClassName:""},u.propTypes=l,t.default=u},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useCollectionPubs=t.chooseCollectionForPub=t.createReadingParamUrl=t.getNeighborsInCollectionPub=void 0;var i=n(0),o=n(18),l=n(9),u=n(131);t.getNeighborsInCollectionPub=function(e,t){if(!e)return{previousPub:null,nextPub:null};var n=e&&e.indexOf(e.find((function(e){return e.id===t.id})));return{previousPub:e&&n>0&&e[n-1],nextPub:e&&n!==e.length-1&&e[n+1]}};t.createReadingParamUrl=function(e,t){var n=new URL(e);return n.searchParams.append("readingCollection",t.split("-")[0]),n.toString()};t.chooseCollectionForPub=function(e,t){var n,r=(0,u.getPrimaryCollection)(e.collectionPubs);return n=t.query,e.collectionPubs.map((function(e){return e.collection})).find((function(e){return e.id.startsWith(n.readingCollection)}))||r};t.useCollectionPubs=function(e,t){var n=a((0,i.useState)(!1),2),u=n[0],c=n[1],s=a((0,i.useState)(!0),2),d=s[0],f=s[1],m=a((0,i.useState)(t&&t.pubs),2),p=m[0],h=m[1],b=(0,l.usePageContext)().communityData;return(0,i.useEffect)((function(){t&&(Array.isArray(t.pubs)&&f(!1),function(e){var t=e.collectionId,n=e.communityId;return(0,o.apiFetch)("/api/collectionPubs?collectionId="+t+"&communityId="+n)}({collectionId:t.id,communityId:b.id}).then((function(n){var a;h(a=n),e("pub",(function(e){return{collectionPubs:e.collectionPubs.map((function(e){return e.collection.id===t.id?r(r({},e),{collection:r(r({},e.collection),{pubs:a})}):e}))}})),f(!1)})).catch((function(e){c(e),f(!1)})))}),[t&&t.id]),{isLoading:d,error:u,pubs:p}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(339)),l=n(9),u=n(5);t.default=function(e){var t=(0,l.usePageContext)().communityData,n=e.contributors,a=e.bylinePrefix,c="1a71ef4d-f6fe-40d3-8379-42fa2141db58"===t.id?function(e){return e.sort((function(e,t){return e.user.lastName===t.user.lastName?e.user.firstName-t.user.firstName:e.user.lastName>t.user.lastName?1:-1}))}(n):n;return a="1a71ef4d-f6fe-40d3-8379-42fa2141db58"===t.id?a=i.default.createElement(u.Tooltip,{content:"Contributors (A-Z)",children:i.default.createElement(u.Icon,{iconSize:12,icon:"sort-alphabetical",className:"byline-icon"})}):a,i.default.createElement(o.default,r({},e,{bylinePrefix:a,contributors:c}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useIdlyUpdatedState=void 0;var o,l,u,c,s=n(0),d=i(n(31)),f=(o=50,l=[],u=null,c=function(){d.default.unstable_batchedUpdates((function(){for(var e=0;e<l.length;e++)l[e]();u=null,l=[]}))},{requestBatchedIdleCallback:function(e){l.includes(e)||l.push(e),"requestIdleCallback"in window?null===u&&(u=requestIdleCallback(c,{timeout:o})):c()}}).requestBatchedIdleCallback;t.useIdlyUpdatedState=function(e){var t=a((0,s.useState)(e),2),n=t[0],i=t[1],o=(0,s.useRef)([]),l=(0,s.useCallback)((function(){return i((function(e){for(var t=e,n=o.current,a=0;a<n.length;a++){var i=n[a],l="function"==typeof i?i(t):i;t=r(r({},t),l)}return o.current=[],t}))}),[]),u=(0,s.useMemo)((function(){return Object.assign((function(e){o.current.push(e),f(l)}),{immediately:function(e){return void 0===e&&(e=!0),function(t){e?(o.current.push(t),l()):u(t)}}})}),[l]);return[n,u]}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateGdprConsent=t.shouldShowGdprBanner=t.getGdprConsentElection=t.gdprCookiePersistsSignup=void 0;var a=r(n(170)),i=n(18),o=n(447),l=["heap"];t.gdprCookiePersistsSignup=function(){return"yes"===a.default.get("gdpr-consent-survives-login")};t.getGdprConsentElection=function(e){void 0===e&&(e=null);var t=a.default.get("gdpr-consent");return e&&e.id&&null!==e.gdprConsent?!0===e.gdprConsent:t?"accept"===t:null};t.shouldShowGdprBanner=function(e){return!(!e.id||null!==e.gdprConsent)||null===(0,t.getGdprConsentElection)(e)};t.updateGdprConsent=function(e,t){var n,r=!!e.id,u=(0,o.getCookieOptions)();return a.default.set("gdpr-consent",t?"accept":"decline",u),a.default.set("gdpr-consent-survives-login","yes",u),t||(r||null===(n=window.heap)||void 0===n||n.identify(Math.random()),function(){var e,t;null===(e=window.heap)||void 0===e||e.resetIdentity(),null===(t=window.heap)||void 0===t||t.clearEventProperties(),l.map((function(e){return a.default.remove(e,{path:""})}))}()),r?(0,i.apiFetch)("/api/users",{method:"PUT",body:JSON.stringify({userId:e.id,gdprConsent:t})}):Promise.resolve()}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.adaptDisclosureElementForBlueprintButton=void 0;var i=a(n(0)),o=n(5),l=i.default.forwardRef((function(e,t){return i.default.createElement(o.Button,r({},e,{elementRef:t}))}));t.adaptDisclosureElementForBlueprintButton=function(e,t,n){return e.type===o.Button?i.default.createElement(l,r({},e.props,t,{active:n})):i.default.cloneElement(e,t)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.useNotificationsContext=t.UserNotificationsContext=void 0;var o=i(n(0));t.UserNotificationsContext=o.default.createContext(null);t.useNotificationsContext=function(){return(0,o.useContext)(t.UserNotificationsContext)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSlugError=void 0;t.getSlugError=function(e,t){return e?"used"===t?"This URL is not available because it is in use by another Page or Collection.":"reserved"===t?"This URL is not available because it is reserved by PubPub.":"":"Collection requires a slug"}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RecentVisitList=t.ScopeSummaryList=t.QuickActions=t.OverviewSearchGroup=t.OverviewSection=t.OverviewFrame=t.KindToggle=void 0;var a=n(1314);Object.defineProperty(t,"KindToggle",{enumerable:!0,get:function(){return r(a).default}});var i=n(1316);Object.defineProperty(t,"OverviewFrame",{enumerable:!0,get:function(){return r(i).default}});var o=n(1318);Object.defineProperty(t,"OverviewSection",{enumerable:!0,get:function(){return r(o).default}});var l=n(1320);Object.defineProperty(t,"OverviewSearchGroup",{enumerable:!0,get:function(){return r(l).default}});var u=n(1323);Object.defineProperty(t,"QuickActions",{enumerable:!0,get:function(){return r(u).default}});var c=n(1325);Object.defineProperty(t,"ScopeSummaryList",{enumerable:!0,get:function(){return r(c).default}});var s=n(1327);Object.defineProperty(t,"RecentVisitList",{enumerable:!0,get:function(){return r(s).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(78),l=n(6);n(1429);var u=a.default.forwardRef((function(e,t){var n=e.className,r=void 0===n?"":n,u=e.disabled,c=void 0!==u&&u,s=e.href,d=void 0===s?null:s,f=e.icon,m=e.label,p=void 0===m?null:m,h=e.labelPosition,b=void 0===h?"left":h,v=e.onClick,y=void 0===v?null:v,g=e.tagName,_=void 0===g?"button":g;return a.default.createElement(o.Button,{as:_,href:d,ref:t,onClick:y,className:(0,i.default)("small-header-button-component","pub-header-themed-box-hover-target","left"===b?"label-left":"label-right",c&&"disabled",r)},a.default.createElement("div",{className:"pub-header-themed-box icon-container"},a.default.createElement(l.Icon,{icon:f,iconSize:14})),p&&a.default.createElement("div",{className:"label"},p))}));t.default=u},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SectionBullets=t.AccentedIconButton=void 0;var s=o(n(0)),d=c(n(3)),f=n(5);n(1494),t.AccentedIconButton=s.default.forwardRef((function(e,t){var n=e.accentColor,a=e.icon,i=e.title,o=void 0===i?null:i,u=l(e,["accentColor","icon","title"]);return s.default.createElement(f.Button,r({minimal:!0,elementRef:t,icon:s.default.createElement(f.Icon,{title:o,color:n,icon:a,iconSize:14})},u))}));t.SectionBullets=function(e){var t=e.children;return s.default.createElement(s.default.Fragment,null,s.default.Children.map(t,(function(e,t){return s.default.createElement("div",{key:t,className:"center-content-item"},e)})))};t.default=function(e){var n=e.accentColor,a=void 0===n?"back":n,i=e.centerItems,o=void 0===i?[]:i,l=e.children,c=void 0===l?null:l,f=e.className,m=void 0===f?"":f,p=e.defaultExpanded,h=void 0!==p&&p,b=e.iconItems,v=void 0===b?function(){return null}:b,y=e.isExpandable,g=void 0===y||y,_=e.isSearchable,E=void 0!==_&&_,P=e.onSearch,w=void 0===P?function(){}:P,O=e.searchPlaceholder,C=void 0===O?"Enter keywords to search for...":O,S=e.title,D=(0,s.useRef)(null),k=u((0,s.useState)(h),2),j=k[0],M=k[1],N=u((0,s.useState)(null),2),I=N[0],x=N[1],T=null!==I,A=T?{color:"white"}:{};(0,s.useEffect)((function(){T&&D.current&&D.current.focus()}),[T]);var R=g&&!T;return s.default.createElement("div",{className:(0,d.default)("pub-bottom-section-component",m,T&&"searching",j&&"expanded")},s.default.createElement("div",{role:R?"button":"none",onClick:R?function(){return M(!j)}:void 0,className:"top-row",style:r(r({},T&&{background:a}),R&&{cursor:"pointer"})},s.default.createElement("div",{className:"left-title",style:A},S),s.default.createElement("div",{className:"center-content"},T?s.default.createElement("input",{ref:D,type:"text",className:"search-bar",onChange:function(e){var t=e.target.value.trim();w(t),x(t)},placeholder:C}):"function"==typeof o?o({isExpanded:j}):o),s.default.createElement("div",{className:"right-icons",style:A,onClick:function(e){return e.stopPropagation()},role:"none"},j&&E&&!T&&s.default.createElement(t.AccentedIconButton,{accentColor:a,icon:"search",onClick:function(){return x("")}}),"function"==typeof v?v({isExpanded:j,isSearching:T,iconColor:T?"white":a}):v,T?s.default.createElement(t.AccentedIconButton,{accentColor:"white",icon:"cross",title:"Search this section",onClick:function(){return x(null)}}):g?s.default.createElement(t.AccentedIconButton,{title:j?"Collapse this section":"Expand this section",accentColor:a,icon:j?"collapse-all":"expand-all",onClick:function(){return M(!j)}}):null)),j&&s.default.createElement("div",{className:"section-content"},"function"==typeof c?c({searchTerm:I,isSearching:T}):c))}},,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(3)),l=n(118);n(611);var u=function(e){return e.id};t.default=function(e){var t=e.className,n=void 0===t?null:t,a=e.droppableId,c=e.droppableType,s=e.disabled,d=void 0!==s&&s,f=e.items,m=e.itemId,p=void 0===m?u:m,h=e.renderEmptyState,b=void 0===h?null:h,v=e.renderDragElementInPortal,y=void 0!==v&&v,g=function(e){return function(t,n,a){var l=e.items,u=e.withDragHandles,c=e.renderItem,s=l[a.source.index],d=t.innerRef,f=t.draggableProps,m=t.dragHandleProps,p=n.isDragging,h=r({},m);p&&(h.tabIndex=void 0);var b=u?{}:h;return i.default.createElement("div",r({role:"listitem",className:(0,o.default)("drag-container",p&&"is-dragging"),ref:d},f,b),c(s,u&&h,p))}}(e);return i.default.createElement(l.Droppable,{type:c,droppableId:a,renderClone:y?g:void 0},(function(e){return i.default.createElement("div",r({},e.droppableProps,{className:(0,o.default)(n,"drag-drop-listing-component"),role:"list",ref:e.innerRef}),b&&0===f.length&&i.default.createElement("div",{className:"empty-state-container"},b()),f.map((function(e,t){var n=p(e);return i.default.createElement(l.Draggable,{draggableId:n,index:t,key:n,isDragDisabled:d},g)})),e.placeholder)}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(88),l=n(9);n(619);t.default=function(e){var t=e.initials,n=void 0===t?"?":t,r=e.avatar,u=e.instanceNumber,c=e.borderColor,s=e.borderWidth,d=e.width,f=e.doesOverlap,m=e.isBlock,p=e.className,h=(0,l.usePageContext)().communityData,b={width:d,minWidth:d,height:d,borderColor:c,borderWidth:c?s||Math.floor(d/50)+1:0,fontSize:m?Math.floor(d/1.5):Math.floor(d/2.5),backgroundColor:h.accentColorDark,zIndex:"number"==typeof u?-1*u:"initial",borderRadius:m?"2px":"50%"},v=d<=50?50:250,y=(0,o.getResizedUrl)(r,"cover",v,v);return f&&(b.marginRight=.45*d*-1+"px"),r&&(b.backgroundImage='url("'+y+'")'),a.default.createElement("div",{className:(0,i.default)(["avatar-component",p]),style:b},!r&&a.default.createElement("div",null,n))}},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Menu=void 0;var c=o(n(0)),s=u(n(3)),d=n(5),f=o(n(384)),m=n(256);t.Menu=c.default.forwardRef((function(e,t){var n=e["aria-label"],a=e.children,i=void 0===a?"":a,o=e.className,u=e.disclosure,p=e.placement,h=e.onDismiss,b=void 0===h?function(){}:h,v=e.gutter,y=e.unstable_fixed,g=void 0!==y&&y,_=e.menuStyle,E=void 0===_?{}:_,P=l(e,["aria-label","children","className","disclosure","placement","onDismiss","gutter","unstable_fixed","menuStyle"]),w=(0,c.useContext)(m.MenuConfigContext),O=f.useMenuState({placement:p,gutter:v,unstable_preventOverflow:!1,unstable_flip:!1,unstable_fixed:g});return c.default.createElement(c.default.Fragment,null,c.default.createElement(f.MenuDisclosure,r({ref:t,style:{display:"inline-flex",WebkitAppearance:"unset"}},O,P),(function(e){return function(e,t){return"function"==typeof e?e(t):c.default.cloneElement(e,t)}(u,r(r({},e),{"aria-label":n}))})),c.default.createElement(f.Menu,r({"aria-label":n,as:"ul",style:r({zIndex:20},E),className:(0,s.default)(d.Classes.MENU,d.Classes.ELEVATION_1,o),unstable_portal:w.usePortal},O),c.default.createElement(m.MenuContext.Provider,{value:{parentMenu:O,dismissMenu:function(){O.hide(),b&&b()}}},i)))}))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuConfigContext=t.MenuContext=void 0;var a=r(n(0));t.MenuContext=a.default.createContext(null),t.MenuConfigContext=a.default.createContext({usePortal:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPubHeadings=t.getFormattedDownload=void 0;var r=n(41);t.getFormattedDownload=function(e){return e?e.reduce((function(e,t){var n=!e||!e.createdAt||t.createdAt>e.createdAt;return"formatted"===t.type&&n?t:e}),null):null};t.getPubHeadings=function(e,t){var n=e;return t&&t.view&&(n=(0,r.getJSON)(t.view)),n?function(e){return e.content.filter((function(e){return"heading"===e.type&&e.attrs.level<3})).map((function(e,t){return{title:e.content&&e.content.filter((function(e){return"text"===e.type})).reduce((function(e,t){return""+e+t.text}),""),level:e.attrs.level,href:e.attrs.fixedId||e.attrs.id,index:t}})).filter((function(e){return e.title}))}(n):[]}},,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.mapDiscussionSelectionThroughSteps=t.getAnchoredDiscussionIds=t.addDiscussionToView=t.discussionsPluginKey=t.default=void 0;var a=n(925);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}}),Object.defineProperty(t,"discussionsPluginKey",{enumerable:!0,get:function(){return a.discussionsPluginKey}}),Object.defineProperty(t,"addDiscussionToView",{enumerable:!0,get:function(){return a.addDiscussionToView}}),Object.defineProperty(t,"getAnchoredDiscussionIds",{enumerable:!0,get:function(){return a.getAnchoredDiscussionIds}});var i=n(180);Object.defineProperty(t,"mapDiscussionSelectionThroughSteps",{enumerable:!0,get:function(){return i.mapDiscussionSelectionThroughSteps}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pastePluginKey=void 0;var r=n(8);t.pastePluginKey=new r.PluginKey("paste-drop-media")},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkMemberPermission=void 0;var r=["view","edit","manage","admin"];t.checkMemberPermission=function(e,t){return r.indexOf(e)>=r.indexOf(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pubPubIcons=void 0,t.pubPubIcons={overview:"home2",activity:"pulse",page:"page-layout",layout:"page-layout",review:"social-media",submission:"manually-entered-data",connection:"layout-auto",impact:"dashboard",member:"people",settings:"cog",collection:"collection",pub:"pubDoc",community:"office"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepMap=t.getButtonPopoverComponent=void 0;var r=n(267);t.getButtonPopoverComponent=function(e,t){return e.popover&&Boolean(r.FormattingBarButtonPopoverCondition.Always||e.popover.condition===r.FormattingBarButtonPopoverCondition.Disabled&&t)?e.popover.component:null};t.deepMap=function(e,t){return e.map((function(e){return e.map(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormattingBarButtonPopoverCondition=void 0,function(e){e[e.Always=0]="Always",e[e.Disabled=1]="Disabled"}(t.FormattingBarButtonPopoverCondition||(t.FormattingBarButtonPopoverCondition={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.positionNearSelection=t.positionNearLink=void 0;var r=function(e){return function(t,n){var r=n.container,a=n.isAbsolutelyPositioned,i=e(t),o=i.left,l=i.bottom,u=r.getBoundingClientRect(),c=u.top,s="translateX("+(o-u.left)+"px) translateY("+(l-c)+"px)";return a?{position:"absolute",transform:s,top:0,left:0}:{transform:s}}};t.positionNearLink=r((function(e){return e.activeLink.boundingBox})),t.positionNearSelection=r((function(e){return e.selectionBoundingBox}))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(5),c=i(n(1004)),s=n(6),d=o.default.forwardRef((function(e,t){var n=e.href,i=e.onClick,d=e.className,f=e.minimal,m=void 0===f||f,p=a(e,["href","onClick","className","minimal"]),h=function(t,f){var h=r(r(r({},(0,c.default)(p,"mobile","desktop","mobileOrDesktop")),function(e,t,n){var i=function(e,t){return"mobileOrDesktop"in e?e.mobileOrDesktop:t?e.mobile:e.desktop}(e,t),l=i.icon,u=a(i,["icon"]),c=l?o.default.createElement(s.Icon,r({},n,{icon:l})):null;return r(r({},u),{icon:c})}(e,t)),{minimal:m,elementRef:f.ref,large:!t,className:(0,l.default)(d,f.className)});return n?o.default.createElement(u.AnchorButton,r({href:n},h)):o.default.createElement(u.Button,r({onClick:i},h))};return o.default.createElement(s.MobileAware,{ref:t,desktop:function(e){return h(!1,e)},mobile:function(e){return h(!0,e)}})}));t.default=d},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=u(n(0)),f=n(5),m=s(n(427)),p=s(n(426)),h=s(n(58)),b=n(98);n(1013);var v=function(e){},y={canClear:!1,children:null,defaultImage:"",height:75,helperText:null,htmlFor:String((new Date).getTime()),isRequired:!1,label:null,onNewImage:v,onImageSelect:v,useAccentBackground:!1,useCrop:!1,width:75},g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={imageFile:void 0,imageBlob:n.props.defaultImage,uploading:!1},n.inputRef=d.default.createRef(),n.onUploadFinish=n.onUploadFinish.bind(n),n.onCropUploaded=n.onCropUploaded.bind(n),n.setBlob=n.setBlob.bind(n),n.handleImageSelect=n.handleImageSelect.bind(n),n.clearImage=n.clearImage.bind(n),n.cancelImageUpload=n.cancelImageUpload.bind(n),n.openFileDialog=n.openFileDialog.bind(n),n}return a(t,e),t.prototype.onUploadFinish=function(e,t,n,r){var a="https://assets.pubpub.org/"+r;this.setState({uploading:!1}),this.props.onNewImage(a)},t.prototype.onCropUploaded=function(e,t){this.setState({imageFile:void 0,imageBlob:t,uploading:!1}),this.props.onNewImage(e)},t.prototype.setBlob=function(e){var t=this,n=new FileReader;n.onload=function(e){t.setState({imageBlob:e.target.result})},n.readAsDataURL(e)},t.prototype.openFileDialog=function(){var e=this.inputRef.current;e&&e.click()},t.prototype.handleImageSelect=function(e){var t=this.props,n=t.onImageSelect,r=t.useCrop,a=e.target.files;if(a.length>0){var i=c(a,1)[0];r?this.setState({imageFile:i}):((0,b.s3Upload)(i,(function(){}),this.onUploadFinish,0),this.setState({uploading:!0}),this.setBlob(i)),n(i)}},t.prototype.cancelImageUpload=function(){this.setState({imageFile:null,uploading:!1})},t.prototype.clearImage=function(e){e.preventDefault(),this.setState({imageFile:void 0,imageBlob:void 0,uploading:!1}),this.props.onNewImage(null)},t.prototype.renderInput=function(){return d.default.createElement("input",{ref:this.inputRef,id:"input-"+this.props.htmlFor,name:"logo image",type:"file",accept:"image/png, image/jpeg",style:{display:"none"},onChange:this.handleImageSelect})},t.prototype.renderDefaultPicker=function(){var e={width:this.props.width+"px",height:this.props.height+"px"},t=i(i({},e),{backgroundImage:'url("'+this.state.imageBlob+'")'});return d.default.createElement("div",{className:"image-upload-component"},d.default.createElement("label",{htmlFor:"input-"+this.props.htmlFor},this.props.label,this.props.isRequired&&d.default.createElement("span",{className:"bp3-text-muted required-text"}," (required)"),this.props.label&&d.default.createElement("br",null),(this.state.uploading||!this.state.imageBlob)&&d.default.createElement(f.AnchorButton,{className:"upload-button bp3-minimal",style:e,loading:this.state.uploading,title:"Upload new header image","aria-label":"Upload new header image",icon:"media"}),!this.state.uploading&&this.state.imageBlob&&d.default.createElement("div",{className:"image-wrapper "+(this.props.useAccentBackground?"accent-background":""),style:t}),d.default.createElement("div",{className:"image-options"},!this.state.uploading&&this.state.imageBlob&&d.default.createElement(f.AnchorButton,{className:"bp3-minimal",title:"Upload new header image","aria-label":"Upload new header image",icon:d.default.createElement(h.default,{icon:"edit2"})}),!this.state.uploading&&this.state.imageBlob&&d.default.createElement(f.AnchorButton,{className:"bp3-minimal",href:this.state.imageBlob,target:"_blank",icon:"download",title:"Download header image","aria-label":"Download header image",download:!0}),!this.state.uploading&&this.state.imageBlob&&this.props.canClear&&d.default.createElement(f.AnchorButton,{className:"bp3-minimal bp3-intent-danger",icon:"trash",title:"Remove header image","aria-label":"Remove header image",onClick:this.clearImage})),this.renderInput()),d.default.createElement("div",{className:"helper-text"},this.props.helperText),d.default.createElement(m.default,{maxWidth:300,isOpen:!!this.state.imageFile,onClose:this.cancelImageUpload},d.default.createElement(p.default,{image:this.state.imageFile,onCancel:this.cancelImageUpload,onUploaded:this.onCropUploaded})))},t.prototype.render=function(){var e=this.props.children;return e?d.default.createElement(d.default.Fragment,null,this.renderInput(),e({selectImage:this.openFileDialog,clearImage:this.clearImage})):this.renderDefaultPicker()},t.defaultProps=y,t}(d.Component);t.default=g},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(1015),t),a(n(1016),t),a(n(1017),t)},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getButtonText=void 0;var c=l(n(0)),s=u(n(80)),d=n(5),f=n(88),m=n(18);n(1019);t.getButtonText=function(e,t,n){return void 0===n&&(n=!0),n||"create-pub"!==e?t||(n&&"create-pub"===e?"Create Pub":"signup"===e?"Create an Account":"link"===e?"Go to Link":void 0):"Login to Create Pub"};var p=function(e){function n(t){var n=e.call(this,t)||this;return n.state={isLoading:!1,buttonError:null},n.createPub=n.createPub.bind(n),n}return a(n,e),n.prototype.createPub=function(){var e=this,t=this.props,n=t.communityData,r=t.content;return this.setState({isLoading:!0,buttonError:null}),(0,m.apiFetch)("/api/pubs",{method:"POST",body:JSON.stringify({communityId:n.id,createPubToken:r.createPubToken})}).then((function(t){window.location.href="/pub/"+t.slug,e.setState({isLoading:!1})})).catch((function(t){console.error(t),e.setState({isLoading:!1,buttonError:"Error creating a new Pub. You may want to refresh the page and try again."})}))},n.prototype.renderButton=function(){var e=this.state.buttonError,n=!!this.props.loginData.id;if(!this.props.content.showButton)return null;var r=this.props.content.buttonType||this.props.content.showButton&&"create-pub",a=(0,t.getButtonText)(r,this.props.content.buttonText,n),i="link"===r?this.props.content.buttonUrl:n&&"create-pub"===r?"/login?redirect="+this.props.locationData.path:"signup"===r?"/signup":void 0,o=n&&"create-pub"===r&&this.createPub||void 0,l=c.default.createElement(d.AnchorButton,{className:"bp3-large",onClick:o,loading:this.state.isLoading,text:a,href:i});return e?c.default.createElement(d.Tooltip,{content:e,defaultIsOpen:!0},l):l},n.prototype.render=function(){var e=this.props.content.backgroundImage?'url("'+(0,f.getResizedUrl)(this.props.content.backgroundImage,"inside",1500,600)+'")':void 0,t={textAlign:this.props.content.align||"left"},n={color:this.props.content.backgroundImage||!(0,s.default)(this.props.content.backgroundColor).isLight()?"#FFFFFF":"#000000",lineHeight:"1em",fontSize:"narrow"===this.props.content.backgroundHeight?"18px":"28px"},r={backgroundColor:this.props.content.backgroundColor,backgroundImage:e,minHeight:"narrow"===this.props.content.backgroundHeight?"60px":"200px",display:"flex",alignItems:"center",maxWidth:"none"};return c.default.createElement("div",{className:"layout-banner-component"},c.default.createElement("div",{className:"block-content",style:"full"===this.props.content.backgroundSize?r:void 0},this.props.content.backgroundImage&&"full"===this.props.content.backgroundSize&&c.default.createElement("div",{className:"dim"}),c.default.createElement("div",{className:"container"},c.default.createElement("div",{className:"row",style:"standard"===this.props.content.backgroundSize?r:void 0},this.props.content.backgroundImage&&"standard"===this.props.content.backgroundSize&&c.default.createElement("div",{className:"dim"}),c.default.createElement("div",{className:"col-12",style:t},this.props.content.text&&c.default.createElement("h2",{style:n},this.props.content.text),this.renderButton())))))},n}(c.Component);t.default=p},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(432));t.default=function(e){var t=e.content,n=e.collections,r=e.pages,o="center"===t.justify?"auto-fit":"auto-fill";return a.default.createElement("div",{className:"block-content"},a.default.createElement("div",{className:"container"},e.content.title&&a.default.createElement("div",{className:"row"},a.default.createElement("div",{className:"col-12"},a.default.createElement("h1",null,e.content.title))),a.default.createElement("div",{className:"row"},a.default.createElement("div",{className:"col-12"},a.default.createElement("div",{className:"pages-wrapper",style:t.justify?{justifyContent:t.justify,gridTemplateColumns:"repeat("+o+", 175px)"}:{}},function(e,t,n){return e.items.map((function(e){return("collection"===e.type?t:n).find((function(t){return t.id===e.id}))})).filter((function(e){return!!e}))}(t,n,r).map((function(e){return a.default.createElement(i.default,{key:e.id,pageData:e})})))))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LayoutSubmissionBannerSkeleton=t.LayoutCollectionHeader=t.LayoutText=t.LayoutPubs=t.LayoutPagesCollections=t.LayoutHtml=t.LayoutBanner=t.Layout=void 0;var a=n(428);Object.defineProperty(t,"Layout",{enumerable:!0,get:function(){return r(a).default}});var i=n(272);Object.defineProperty(t,"LayoutBanner",{enumerable:!0,get:function(){return r(i).default}});var o=n(430);Object.defineProperty(t,"LayoutHtml",{enumerable:!0,get:function(){return r(o).default}});var l=n(273);Object.defineProperty(t,"LayoutPagesCollections",{enumerable:!0,get:function(){return r(l).default}});var u=n(429);Object.defineProperty(t,"LayoutPubs",{enumerable:!0,get:function(){return r(u).default}});var c=n(431);Object.defineProperty(t,"LayoutText",{enumerable:!0,get:function(){return r(c).default}});var s=n(434);Object.defineProperty(t,"LayoutCollectionHeader",{enumerable:!0,get:function(){return r(s).default}});var d=n(437);Object.defineProperty(t,"LayoutSubmissionBannerSkeleton",{enumerable:!0,get:function(){return r(d).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomColor=t.calculateBackgroundColor=void 0;var a=r(n(80));t.calculateBackgroundColor=function(e,t){return e&&"community"===e?(0,a.default)(t).darken(.2).alpha(.75).toString():"dark"===e?"rgba(0, 0, 0, 0.65)":"light"===e?"rgba(0, 0, 0, 0.0275)":e};t.getRandomColor=function(e){var t=["244,67,54","63,81,181","0,150,136","255,152,0","96,125,139","233,30,99","3,169,244","156,39,176","139,195,74","103,58,183","121,85,72","33,150,243","255,193,7","0,188,212","76,175,80","205,220,57","255,87,34"];return e?t[e.charCodeAt(e.length-1)%t.length]:t[0]}},,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubSuspendWhileTyping=t.PubSuspendWhileTypingProvider=t.PubSuspendWhileTypingContext=void 0;var o=i(n(0));t.PubSuspendWhileTypingContext=o.default.createContext({markLastInput:function(){},getTimeRemainingToUpdate:function(){return 0}});t.PubSuspendWhileTypingProvider=function(e){var n=(0,o.useRef)(null),r=(0,o.useCallback)((function(e,t){if(!n.current)return 0;var r=t-n.current;return Math.max(0,e-r)}),[]),a=(0,o.useCallback)((function(){n.current=Date.now()}),[]),i=(0,o.useMemo)((function(){return{markLastInput:a,getTimeRemainingToUpdate:r}}),[r,a]);return o.default.createElement(t.PubSuspendWhileTypingContext.Provider,{value:i},e.children)};t.usePubSuspendWhileTyping=function(e,n){void 0===n&&(n=1e3);var r=(0,o.useContext)(t.PubSuspendWhileTypingContext).getTimeRemainingToUpdate,a=(0,o.useRef)(null),i=(0,o.useState)(null)[1],l=r(n,Date.now()),u=0===l,c=(0,o.useMemo)((function(){return e}),[u]),s=(0,o.useCallback)((function(){a.current&&clearTimeout(a.current)}),[]);return(0,o.useEffect)((function(){u||(s(),a.current=setTimeout((function(){return i(Date.now())}),l))}),[s,i,u,l]),(0,o.useEffect)((function(){return s})),u?e:c}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useViewport=void 0;var a=n(0),i="undefined"!=typeof window?{earlyViewportWidth:window.innerWidth,earlyViewportHeight:window.innerHeight}:{earlyViewportWidth:null,earlyViewportHeight:null},o=i.earlyViewportWidth,l=i.earlyViewportHeight;t.useViewport=function(e){void 0===e&&(e={});var t=e.withEarlyMeasurement,n=void 0!==t&&t,i=r((0,a.useState)(n?o:null),2),u=i[0],c=i[1],s=r((0,a.useState)(n?l:null),2),d=s[0],f=s[1];return(0,a.useEffect)((function(){c(window.innerWidth),f(window.innerHeight);var e=function(){f(window.innerHeight),c(window.innerWidth)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),{viewportWidth:u,viewportHeight:d,isMobile:"number"==typeof u?u<=750:null}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCollection=t.updateCollection=t.removeCollectionPub=t.updateCollectionPub=t.addCollectionPub=t.createTagCollection=void 0;var a=n(18);t.createTagCollection=function(e){var t=e.title,n=e.communityId,r=e.isPublic,i=void 0!==r&&r;return(0,a.apiFetch)("/api/collections",{method:"POST",body:JSON.stringify({communityId:n,title:t,kind:"tag",isPublic:i})})};t.addCollectionPub=function(e){var t=e.pubId,n=e.collectionId,r=e.communityId;return(0,a.apiFetch)("/api/collectionPubs",{method:"POST",body:JSON.stringify({pubId:t,collectionId:n,communityId:r})})};t.updateCollectionPub=function(e){var t=e.communityId,n=e.id,i=e.update;return(0,a.apiFetch)("/api/collectionPubs",{method:"PUT",body:JSON.stringify(r(r({},i),{id:n,communityId:t}))})};t.removeCollectionPub=function(e){var t=e.communityId,n=e.id;return(0,a.apiFetch)("/api/collectionPubs",{method:"DELETE",body:JSON.stringify({id:n,communityId:t})})};t.updateCollection=function(e){var t=e.communityId,n=e.collectionId,i=e.updatedCollection;return(0,a.apiFetch)("/api/collections",{method:"PUT",body:JSON.stringify(r(r({},i),{id:n,communityId:t}))})};t.deleteCollection=function(e){var t=e.communityId,n=e.collectionId;return(0,a.apiFetch)("/api/collections",{method:"DELETE",body:JSON.stringify({id:n,communityId:t})})}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.findParentEdgeByRelationTypes=t.RelationType=t.relationTypes=t.getRelationTypeName=t.relationTypeDefinitions=void 0;var a=n(164),i=n(64);t.relationTypeDefinitions={comment:{name:"Comment",article:"a",preposition:"on",isIntraWork:!1,crossrefRelationshipTypes:["isCommentOn","hasComment"]},commentary:{name:"Commentary",plural:"Commentaries",article:"a",preposition:"on",isIntraWork:!1,crossrefRelationshipTypes:["isCommentOn","hasComment"]},preprint:{name:"Preprint",article:"a",preposition:"of",isIntraWork:!0,crossrefRelationshipTypes:["isPreprintOf","hasPreprint"]},rejoinder:{name:"Rejoinder",article:"a",preposition:"to",isIntraWork:!1,crossrefRelationshipTypes:["isReplyTo","hasReply"]},reply:{name:"Reply",plural:"Replies",article:"a",preposition:"to",isIntraWork:!1,crossrefRelationshipTypes:["isReplyTo","hasReply"]},review:{name:"Review",article:"a",preposition:"of",isIntraWork:!1,crossrefRelationshipTypes:["isReviewOf","hasReview"]},supplement:{name:"Supplement",article:"a",preposition:"to",isIntraWork:!1,crossrefRelationshipTypes:["isSupplementTo","isSupplementedBy"]},translation:{name:"Translation",article:"a",preposition:"of",isIntraWork:!0,crossrefRelationshipTypes:["isTranslationOf","hasTranslation"]},version:{name:"Version",article:"a",preposition:"of",isIntraWork:!0,crossrefRelationshipTypes:["isVersionOf","hasVersion"]}};var o;t.getRelationTypeName=function(e,n){var r=t.relationTypeDefinitions[e];if(r){var a=r.name,i=r.plural;return n?i||a+"s":a}return null},t.relationTypes=Object.keys(t.relationTypeDefinitions),t.RelationType=(o={},Object.entries(t.relationTypeDefinitions).forEach((function(e){var t=r(e,1)[0];o[(0,i.toTitleCase)(t)]=t})),o);var l=function(e,t,n){for(var r=(0,a.sortByRank)(e),i=0;i<r.length;i++){var o=r[i],l=o.pubIsParent,u=o.relationType;if(n?l:!l)for(var c=0;c<t.length;c++)if(u===t[c])return o}return null};t.findParentEdgeByRelationTypes=function(e,t){var n=e.inboundEdges,r=e.outboundEdges;return l(n,t,!0)||l(r,t)||null}},function(e,t,n){},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.filterToPlural=t.Mode=t.allFilters=t.Filter=void 0,t.Filter={Parent:"parent",Sibling:"sibling",Child:"child"},t.allFilters=Object.values(t.Filter),t.Mode={Carousel:"carousel",List:"list"};var a=((r={})[t.Filter.Parent]="parents",r[t.Filter.Sibling]="siblings",r[t.Filter.Child]="children",r);t.filterToPlural=function(e){return a[e]}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(5),c=l(n(3)),s=i(n(0)),d=n(6),f=n(64),m=n(9),p=n(165),h=n(35);n(1144);t.default=function(e){var t=(0,m.usePageContext)().communityData,n=e.accentColor,r=e.children,a=void 0===r?[]:r,i=e.inPubBody,l=void 0!==i&&i,b=e.isInboundEdge,v=e.pubEdge,y=e.pubEdgeElement,g=void 0===y?null:y,_=e.parentPub,E=void 0===_?null:_,P=e.showIcon,w=e.viewingFromSibling,O=void 0!==w&&w,C=e.pubData,S=(0,p.isViewingEdgeFromTarget)(v,O,b),D=o((0,s.useState)(!1),2),k=D[0],j=D[1],M=(0,s.useCallback)((function(){return j(!0)}),[]),N=(0,s.useCallback)((function(){return j(!1)}),[]),I=k?n||t.accentColorDark:"#ddd",x={borderColor:I};return s.default.createElement("div",{className:(0,c.default)("pub-edge-listing-card-component",l&&"in-pub-body"),style:x,onMouseEnter:M,onMouseLeave:N,onFocus:M,onBlur:N},a&&s.default.createElement("div",{className:"controls"},a),s.default.createElement("div",{className:(0,c.default)("relation",P&&"show-icon")},P&&s.default.createElement(u.Icon,{icon:"key-enter",color:n,iconSize:14,className:"drop-return"}),function(){var e=v.relationType,t=v.pubIsParent,n=!O&&S?!t:t,r=p.relationTypeDefinitions[e];if(r){var a=r.article,i=r.preposition,o=r.name,l=s.default.createElement("span",{className:"relation-name"},o);if(O){var u=E&&s.default.createElement(s.default.Fragment,null,i," ",s.default.createElement("a",{className:"pub-title",href:(0,h.pubShortUrl)(E)},E.title));return s.default.createElement(s.default.Fragment,null,"Another ",l," ",u)}var c=E&&s.default.createElement("span",{className:"pub-title"},E.title);return n?s.default.createElement(s.default.Fragment,null,(0,f.toTitleCase)(a)," ",l," ",i," ",c||"this Pub"):s.default.createElement(s.default.Fragment,null,c||"This Pub"," is ",a," ",l," ",i)}return null}()),g||s.default.createElement(d.PubEdge,{accentColor:I,actsLikeLink:l,pubEdge:v,viewingFromTarget:S,showDescriptionByDefault:C.pubEdgeDescriptionVisible}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getTypicalPubLabels=t.renderLabelPairs=t.getSubmissionTimeLabel=t.getPubReleasedStateLabel=t.getCollectionKindLabel=t.getCollectionPublicStateLabel=t.getScopeSummaryLabels=void 0;var o=i(n(0)),l=n(64),u=n(74),c=n(67),s=n(99),d=n(6);t.getScopeSummaryLabels=function(e,t){void 0===t&&(t=!1);var n=e.discussions,r=e.reviews,a=e.pubs,i=[];return t&&i.push({label:String(a),icon:"pubDoc"}),n>0&&i.push({label:String(n),icon:"chat"}),r>0&&i.push({label:String(r),icon:"social-media"}),i};t.getCollectionPublicStateLabel=function(e){return e.isPublic?{label:"Public",icon:"globe"}:{label:"Private",icon:"lock"}};t.getCollectionKindLabel=function(e){var t=(0,u.getSchemaForKind)(e.kind);return{label:(0,l.capitalize)(t.label.singular),icon:t.bpDisplayIcon}};var f=Date.now(),m=function(e){return f-e.valueOf()>6048e5?"on "+(0,c.formatDate)(e):o.default.createElement(d.TimeAgo,{date:e})};t.getPubReleasedStateLabel=function(e){var t=(0,s.getPubPublishedDate)(e,!1);return t&&e.releases.length>0?{label:o.default.createElement(o.default.Fragment,null,"PublishedÂ ",m(t)),icon:"globe"}:{label:"Unreleased",icon:"lock"}};t.getSubmissionTimeLabel=function(e){var t,n=null===(t=e.submission)||void 0===t?void 0:t.submittedAt;return n?{label:o.default.createElement(o.default.Fragment,null,"SubmittedÂ ",m(new Date(n))),icon:"time"}:null};t.renderLabelPairs=function(e){return o.default.createElement("div",{className:"summary-icons"},e.map((function(e,t){var n=e.icon,r=e.label,a=e.iconClass,i=e.iconSize,l=void 0===i?12:i,u="string"==typeof n?o.default.createElement(d.Icon,{className:a,icon:n,iconSize:l}):n;return o.default.createElement("div",{className:"summary-icon-pair",key:t},u,r)})))};t.getTypicalPubLabels=function(e){return a(a([],r((0,t.getScopeSummaryLabels)(e.scopeSummary)),!1),[(0,t.getPubReleasedStateLabel)(e)],!1)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(9);n(1311);var c=o.default.forwardRef((function(e,t){var n=e.isDark,i=e.children,c=e.className,s=a(e,["isDark","children","className"]),d=(0,u.usePageContext)().communityData.accentColorDark;return o.default.createElement("div",r({},s,{ref:t,className:(0,l.default)("special-row-component",n&&"dark",c),style:n?{background:d,color:"white"}:{}}),o.default.createElement("div",{className:"inner"},i))}));t.default=c},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.usePersistableState=void 0;var i=n(0),o=n(71);t.usePersistableState=function(e,t,n){void 0===n&&(n={});var l=a((0,i.useState)(e),2),u=l[0],c=l[1],s=a((0,i.useState)(!1),2),d=s[0],f=s[1],m=a((0,i.useState)(n),2),p=m[0],h=m[1],b=a((0,i.useState)(null),2),v=b[0],y=b[1],g=r(r({},u),p),_=Object.keys(p).length>0,E=function(e){var n=r(r({},u),e);return f(!0),t(e,n).then((function(){y(null),c(n),h({})})).catch((function(e){return y(e)})).finally((function(){return f(!1)}))};return(0,o.useBeforeUnload)(_),{hasChanges:_,persist:function(){return E(p)},revert:function(){return h({})},state:g,unpersistedState:p,persistedState:u,isPersisting:d,update:function(e,t){void 0===t&&(t=!1);var n=r(r({},p),e);h(n),t&&E(n)},error:v}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=l(n(1338));n(1340);var f=function(e){var t=e.pubData,n=e.showHeader,r=o((0,u.useState)(!1),2),a=r[0],i=r[1],l=(0,u.useRef)();return u.default.createElement("div",{className:"citations-preview-component"},n&&u.default.createElement("h6",{className:"pub-header-themed-secondary"},"Cite as"),u.default.createElement("div",{className:"citation-body",ref:l,dangerouslySetInnerHTML:{__html:t.citationData.pub.default}}),u.default.createElement(c.ButtonGroup,null,u.default.createElement(s.ClickToCopyButton,{className:"copy-button",icon:"duplicate",copyString:function(){return l.current?l.current.textContent:""}},"Copy"),u.default.createElement(c.Button,{className:"more-cite-options-button",icon:"more",minimal:!0,onClick:function(){return i(!0)}},"More Cite Options")),u.default.createElement(d.default,{isOpen:a,citationData:t.citationData,citationStyle:t.citationStyle,onClose:function(){return i(!1)}}))};f.defaultProps={showHeader:!0},t.default=f},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NavBuilderContext=void 0;var a=r(n(0));t.NavBuilderContext=a.default.createContext({})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.updateSubmissionWorkflow=t.createSubmissionWorkflow=void 0;var a=n(18);t.createSubmissionWorkflow=function(e,t){return a.apiFetch.post("/api/submissionWorkflows",r(r({},e),{collectionId:t,enabled:!0}))};t.updateSubmissionWorkflow=function(e,t){return a.apiFetch.put("/api/submissionWorkflows",r(r({},e),{collectionId:t}))}},,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(3)),d=n(6),f=n(278);n(1464);t.default=function(e){var t=e.children,n=e.className,a=e.expandToFold,i=(0,c.useRef)(null),o=l((0,c.useState)(0),2),u=o[0],m=o[1],p=(0,f.useViewport)().viewportHeight;return(0,c.useLayoutEffect)((function(){i.current&&m((p||0)-i.current.getBoundingClientRect().top-window.scrollY)}),[p]),c.default.createElement(d.GridWrapper,{containerClassName:(0,s.default)("spub-header-tab-component","pub",n)},c.default.createElement("div",{style:r({},a&&{minHeight:u}),ref:i},t))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1506);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterAndSortDiscussions=t.discussionMatchesSearchTerm=t.groupDiscussionsByLine=void 0;t.groupDiscussionsByLine=function(e,t){var n,r=e.sort((function(e,t){return e.boundingBox.bottom<t.boundingBox.bottom?-1:e.boundingBox.bottom>t.boundingBox.bottom?1:0})),a={};r.filter((function(e){return e.attrs&&e.attrs.class&&(e.attrs.class.indexOf("discussion-range")>-1||e.attrs.class.indexOf("local-highlight")>-1)})).forEach((function(e){var t=e.boundingBox.bottom;return n===t?(a[n].push(e),null):(n=t,a[t]=[e],null)}));var i=[];return Object.keys(a).sort((function(e,t){return Number(e)<Number(t)?-1:Number(e)>Number(t)?1:0})).forEach((function(e){var n=a[e].sort((function(e,t){return e.boundingBox.left<t.boundingBox.left?-1:e.boundingBox.left>t.boundingBox.left?1:0})).map((function(e){if(e.attrs.class.indexOf("local-highlight")>-1)return{id:e.attrs.class.replace("local-highlight lh-",""),thread:{comments:[]}};var n=e.attrs.class.replace("discussion-range d-","");return t.find((function(e){return e.id===n}))})).filter((function(e){return e&&!e.isClosed})),r=a[e].reduce((function(e,t){return e?t.boundingBox.right>e.boundingBox.right?t:e:t}),void 0),o=r.attrs.class.indexOf("discussion-range d-")>-1?r.attrs.class.replace("discussion-range d-","dm-"):r.attrs.class.replace("local-highlight lh-","lm-");i.push({key:e,mountClassName:o,discussions:n})})),i};t.discussionMatchesSearchTerm=function(e,t){return!!t&&[e.text,e.author.fullName].map((function(e){return e.toLowerCase()})).some((function(e){return e.toLowerCase().includes(t.toLowerCase())}))};t.filterAndSortDiscussions=function(e,n,r,a,i,o){return void 0===i&&(i=null),void 0===o&&(o=null),e.filter((function(e){return n?e.isClosed:!e.isClosed})).filter((function(e){return!i||e.thread.comments.some((function(e){return(0,t.discussionMatchesSearchTerm)(e,i)}))})).filter((function(e){return!o||!o.includes(e.id)})).filter((function(e){return 0===a.length||a.reduce((function(t,n){return!(!e.labels||-1===e.labels.indexOf(n))&&t}),!0)})).sort((function(e,t){if("newestThread"===r&&e.number>t.number)return-1;if("newestThread"===r&&e.number<t.number)return 1;if("oldestThread"===r&&e.number<t.number)return-1;if("oldestThread"===r&&e.number>t.number)return 1;var n=e.thread.comments.reduce((function(e,t){return t.createdAt>e?t.createdAt:e}),"0000-02-01T22:21:19.608Z"),a=t.thread.comments.reduce((function(e,t){return t.createdAt>e?t.createdAt:e}),"0000-02-01T22:21:19.608Z");if("newestReply"===r&&n>a)return-1;if("newestReply"===r&&n<a)return 1;var i=e.thread.comments.reduce((function(e,t){return t.createdAt<e?t.createdAt:e}),"9999-02-01T22:21:19.608Z"),o=t.thread.comments.reduce((function(e,t){return t.createdAt<e?t.createdAt:e}),"9999-02-01T22:21:19.608Z");return"oldestReply"===r&&i<o?-1:"oldestReply"===r&&i>o?1:"mostReplies"===r&&e.thread.comments.length>t.thread.comments.length?-1:"mostReplies"===r&&e.thread.comments.length<t.thread.comments.length?1:"leastReplies"===r&&e.thread.comments.length<t.thread.comments.length?-1:"leastReplies"===r&&e.thread.comments.length>t.thread.comments.length?1:0}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.labelFiles=t.getPotentialLabelsForFile=t.extensionFor=t.exclusiveFileLabels=void 0;var a=n(496);t.exclusiveFileLabels=["document","bibliography"];t.extensionFor=function(e){var t=e.split(".");return t[t.length-1]};var i=function(e){return Object.keys(a.extensionToPandocFormat).includes((0,t.extensionFor)(e.clientPath))};t.getPotentialLabelsForFile=function(e){var n=i(e);return[n&&"document",n&&"supplement",n&&"preamble",a.bibliographyFormats.includes((0,t.extensionFor)(e.clientPath))&&"bibliography"].filter((function(e){return e}))};t.labelFiles=function(e){var n=e.find((function(e){return"bibliography"===e.label}))||e.find((function(e){return"bib"===(0,t.extensionFor)(e.clientPath)&&!e.label})),a=e.find((function(e){return"document"===e.label}))||e.find((function(e){return i(e)&&!e.label}));return e.map((function(e){return e===a?r(r({},e),{label:"document"}):e===n?r(r({},e),{label:"bibliography"}):e}))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDepositTypeTitle=t.isStandaloneComponentDeposit=t.isPeerReviewDeposit=t.isPreprintDeposit=t.isConferenceDeposit=t.isJournalDeposit=t.isBookDeposit=t.getDepositBody=t.setDepositRecordReviewRecommendation=t.getDepositRecordReviewRecommendation=t.setDepositRecordReviewType=t.getDepositRecordReviewType=t.setDepositRecordContentVersion=t.getDepositRecordContentVersion=t.getDoiData=void 0;var r=[["book","content_item"],["conference","conference_paper"],["journal","journal_article"],["posted_content"],["peer_review"],["sa_component","component_list","component"]];t.getDoiData=function(e){for(var t=e.doi_batch.body,n=0;n<r.length;){for(var a=r[n],i=t,o=0;o<a.length;){if(!(i=i[a[o]]))break;if(o===a.length-1)return i.doi_data;o++}n++}return null};t.getDepositRecordContentVersion=function(e){if(!e||!e.depositJson)return null;var n=e.depositJson.deposit,r=(0,t.getDoiData)(n);return r?r.resource["@content_version"]:null};t.setDepositRecordContentVersion=function(e,n){if(e&&e.depositJson){var r=e.depositJson.deposit,a=(0,t.getDoiData)(r);n?a.resource["@content_version"]=n:delete a.resource["@content_version"]}};t.getDepositRecordReviewType=function(e){if(!e||!e.depositJson)return null;var t=e.depositJson.deposit.doi_batch.body;return"peer_review"in t?t.peer_review["@type"]:null},t.setDepositRecordReviewType=function(e,t){if(!e||!e.depositJson)return null;e.depositJson.deposit.doi_batch.body.peer_review["@type"]=t};t.getDepositRecordReviewRecommendation=function(e){if(!e||!e.depositJson)return null;var t=e.depositJson.deposit.doi_batch.body;return"peer_review"in t?t.peer_review["@recommendation"]:null},t.setDepositRecordReviewRecommendation=function(e,t){if(!e||!e.depositJson)return null;e.depositJson.deposit.doi_batch.body.peer_review["@recommendation"]=t};t.getDepositBody=function(e){return e&&e.depositJson?e.depositJson.deposit.doi_batch.body:null};var a=function(e){return function(n){var r=(0,t.getDepositBody)(n);return n&&r&&e in r}};t.isBookDeposit=a("book"),t.isJournalDeposit=a("journal"),t.isConferenceDeposit=a("conference"),t.isPreprintDeposit=a("posted_content"),t.isPeerReviewDeposit=a("peer_review"),t.isStandaloneComponentDeposit=a("sa_component");t.getDepositTypeTitle=function(e){switch(!0){case(0,t.isBookDeposit)(e):return"Book Chapter";case(0,t.isJournalDeposit)(e):return"Journal Article";case(0,t.isConferenceDeposit)(e):return"Conference Proceeding";case(0,t.isPreprintDeposit)(e):return"Preprint";case(0,t.isPeerReviewDeposit)(e):return"Peer Review";case(0,t.isStandaloneComponentDeposit)(e):return"Supplement";default:return""}}},,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=r(n(237));n(622);t.default=function(e){var t=e.className,n=e.truncateAt,r=e.size,l=void 0===r?22:r,u=e.borderColor,c=void 0===u?"#eee":u,s=e.borderWidth,d=void 0===s?2:s,f=function(e,t){return t&&e.length>t?{users:e.slice(0,t),overflow:e.length-t}:{users:e,overflow:null}}(e.users,n),m=f.users,p=f.overflow;return 0===m.length?null:a.default.createElement("div",{className:(0,i.default)("avatars-component",t)},m.map((function(e,t){return a.default.createElement(o.default,{initials:e.initials,avatar:e.avatar,key:e.id,instanceNumber:t,width:l,borderWidth:d,borderColor:c,doesOverlap:!0})})),p&&a.default.createElement("div",{className:"overflow"},"+",p))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(199)),u=n(64);n(658);var c={renderEmptyState:function(){return null},renderSuffix:function(){return null},renderTruncation:function(e){return e+" "+(0,u.naivePluralize)("other",e)},renderUserLabel:function(e){return e.fullName}},s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce((function(e,t){return Array.isArray(t)?a(a([],r(e),!1),r(t),!1):a(a([],r(e),!1),[t],!1)}),[])},d=function(e){var t=e.ampersand,n=void 0!==t&&t,i=e.bylinePrefix,d=void 0===i?"by":i,f=e.contributors,m=e.linkToUsers,p=void 0===m||m,h=e.renderEmptyState,b=void 0===h?c.renderEmptyState:h,v=e.renderSuffix,y=void 0===v?c.renderSuffix:v,g=e.renderTruncation,_=void 0===g?c.renderTruncation:g,E=e.renderUserLabel,P=void 0===E?c.renderUserLabel:E,w=e.truncateAt,O=void 0===w?null:w,C=function(e,t){if("string"==typeof e)return o.default.createElement("span",{key:"author-"+e},e);var n=(0,l.default)(e).user,r=P(n,t);return"slug"in n&&n.slug&&p?o.default.createElement("span",{key:"author-"+n.id},o.default.createElement("a",{href:"/user/"+n.slug,className:"hoverline"},r)):o.default.createElement("span",{key:"author-"+n.id},r)};return o.default.createElement("div",{className:"byline-component"},o.default.createElement("span",{className:"text-wrapper"},f.length>0&&o.default.createElement(o.default.Fragment,null,d&&o.default.createElement("span",null,d," "),function(){if("string"==typeof f)return f;if(null!==O&&f.length>O){var e=f.slice(0,O),t=f.length-e.length;return(0,u.joinOxford)(a(a([],r(e.map(C)),!1),[_(t)],!1),{joiner:s,ampersand:n,empty:[]})}return(0,u.joinOxford)(f.map(C),{joiner:s,ampersand:n,empty:[]})}()),0===f.length&&b(),y&&y()))};d.defaultProps=c,t.default=d},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(623),t),a(n(631),t),a(n(632),t),a(n(633),t),a(n(634),t),a(n(635),t),a(n(636),t),a(n(637),t),a(n(638),t),a(n(639),t),a(n(640),t),a(n(641),t),a(n(642),t),a(n(643),t),a(n(644),t),a(n(645),t),a(n(646),t),a(n(647),t),a(n(648),t),a(n(649),t),a(n(341),t),a(n(650),t),a(n(651),t),a(n(341),t),a(n(652),t),a(n(653),t),a(n(654),t),a(n(655),t),a(n(656),t),a(n(657),t)},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.submissionStatuses=t.initialStatuses=t.submitterStatuses=t.managerStatuses=void 0,t.managerStatuses=["received","accepted","declined"],t.submitterStatuses=["received"],t.initialStatuses=["incomplete"],t.submissionStatuses=a([],r(new Set(a(a(a([],r(t.initialStatuses),!1),r(t.managerStatuses),!1),r(t.submitterStatuses),!1))),!1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPartsOfFullName=void 0;t.getPartsOfFullName=function(e){var t=e.split(" ").slice(0,-1).join(" "),n=e.split(" ").pop(),r=t.charAt(0).toUpperCase()+n.charAt(0).toUpperCase();return{firstName:t,lastName:n,initials:r}}},,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(5),l=n(107),u=r(n(173));n(663);var c={allCollections:i.default.array.isRequired,selectedCollectionIds:i.default.array.isRequired,onItemSelect:i.default.func.isRequired,onRemove:i.default.func.isRequired,placeholder:i.default.string},s=function(e){var t={};return e.allCollections.forEach((function(e){t[e.id]=e})),a.default.createElement(l.MultiSelect,{className:"collection-multi-select-component",items:Object.keys(t),itemPredicate:function(n,r){if((e.selectedCollectionIds||[]).indexOf(r)>-1)return!1;if(!n)return!0;var a=t[r];return(0,u.default)(n.toLowerCase(),a.title.toLowerCase())},itemRenderer:function(e,n){var r=n.handleClick,i=n.modifiers,o=t[e];return a.default.createElement("li",{key:e},a.default.createElement("button",{type:"button",tabIndex:-1,onClick:r,className:i.active?"bp3-menu-item bp3-active":"bp3-menu-item"},o.title))},selectedItems:e.selectedCollectionIds,tagRenderer:function(e){var n=t[e];return n&&n.title},tagInputProps:{onRemove:e.onRemove,placeholder:e.placeholder,collectionProps:{className:"bp3-minimal bp3-intent-primary"},inputProps:{placeholder:e.placeholder}},resetOnSelect:!0,onItemSelect:e.onItemSelect,noResults:a.default.createElement("div",{className:"bp3-menu-item"},"No Matching Collections"),popoverProps:{popoverClassName:"bp3-minimal",position:o.Position.BOTTOM_LEFT,modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}})};s.propTypes=c,s.defaultProps={placeholder:""},t.default=s},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(10)),u=n(5),c=n(664),s=n(9);n(829);var d={value:l.default.string.isRequired,onChange:l.default.func,onChangeComplete:l.default.func,children:l.default.func},f={onChange:void 0,onChangeComplete:void 0,children:void 0},m=["#c0392b","#d35400","#f39c12","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50"],p=function(e){var t=(0,s.usePageContext)().communityData,n=t?a(a([],r(m),!1),[t.accentColorDark,t.accentColorLight,"black","white"],!1):m;return o.default.createElement("div",{className:"color-input-component"},o.default.createElement(u.Popover,{content:o.default.createElement(c.SketchPicker,{color:e.value,onChange:e.onChange,onChangeComplete:e.onChangeComplete,presetColors:n}),interactionKind:u.PopoverInteractionKind.CLICK,position:u.Position.BOTTOM,usePortal:!1},"function"==typeof e.children?e.children(e.value):o.default.createElement("div",{className:"swatch",style:{backgroundColor:e.value}})))};p.propTypes=d,p.defaultProps=f,t.default=p},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5);t.default=function(e){var t=e.cancelLabel,n=void 0===t?"Cancel":t,r=e.children,a=e.confirmLabel,i=e.intent,c=void 0===i?"danger":i,s=e.onConfirm,d=e.text,f=e.title,m=o((0,l.useState)(!1),2),p=m[0],h=m[1];return l.default.createElement(l.default.Fragment,null,r({open:function(){return h(!0)}}),l.default.createElement(u.Dialog,{isOpen:p,title:f},l.default.createElement("div",{className:u.Classes.DIALOG_BODY},d),l.default.createElement("div",{className:u.Classes.DIALOG_FOOTER},l.default.createElement("div",{className:u.Classes.DIALOG_FOOTER_ACTIONS},l.default.createElement(u.Button,{onClick:function(){return h(!1)}},n),l.default.createElement(u.Button,{intent:c,onClick:function(){h(!1),s()}},a)))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=r(n(382)),l=r(n(338));n(834);t.default=function(e){var t=e.attributions,n=e.className,r=e.truncateAt,u=e.hasPopover,c=void 0===u||u;if(0===t.length)return null;var s=a.default.createElement(l.default,{users:t.map((function(e){return e.user})),className:n,truncateAt:r});return c?a.default.createElement(i.Popover,{minimal:!0,interactionKind:"hover",content:a.default.createElement("div",{className:"contributor-avatars-component_list-container"},a.default.createElement(o.default,{attributions:e.attributions})),position:"bottom-left",popoverClassName:"contributor-avatars-component_popover"},s):s}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=r(n(832)),l={attributions:i.default.array.isRequired},u=function(e){var t=e.attributions;return a.default.createElement("div",{className:"contributors-list-component"},t.map((function(e){return a.default.createElement(o.default,{attribution:e,key:e.id})})))};u.propTypes=l,t.default=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3));n(838);var o=function(e){var t=e.children,n=e.className;return a.default.createElement("ul",{className:(0,i.default)("dashboard-row-listing-component",n)},a.default.Children.map(t,(function(e){return a.default.createElement("li",null,e)})))};o.defaultProps={className:""},t.default=o},,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuItemDivider=t.MenuItem=void 0;var c=n(5),s=u(n(3)),d=o(n(0)),f=o(n(384)),m=n(255),p=n(256),h=d.default.forwardRef((function(e,t){var n=e.active,a=void 0!==n&&n,i=e.children,o=void 0===i?null:i,u=e.className,f=void 0===u?"":u,m=e.disabled,p=void 0!==m&&m,h=e.hasSubmenu,b=void 0!==h&&h,v=e.href,y=e.icon,g=void 0===y?null:y,_=e.onClick,E=void 0===_?null:_,P=e.onDismiss,w=void 0===P?null:P,O=e.rightElement,C=void 0===O?null:O,S=e.target,D=void 0===S?"_self":S,k=e.textClassName,j=void 0===k?"":k,M=l(e,["active","children","className","disabled","hasSubmenu","href","icon","onClick","onDismiss","rightElement","target","textClassName"]),N=b?d.default.createElement(c.Icon,{icon:"caret-right"}):C;return d.default.createElement("li",r({},M,{ref:t,onClick:function(e){E&&E(e),w&&w(),v&&window.open(v,D)}}),d.default.createElement("a",{href:v,target:D,className:(0,s.default)(c.Classes.MENU_ITEM,p&&c.Classes.DISABLED,a&&c.Classes.ACTIVE,f)},g&&("string"==typeof g?d.default.createElement(c.Icon,{icon:g}):g),d.default.createElement("div",{className:(0,s.default)(c.Classes.TEXT_OVERFLOW_ELLIPSIS,c.Classes.FILL,j)},o),N&&d.default.createElement("span",{className:c.Classes.MENU_ITEM_LABEL},N)))}));t.MenuItem=d.default.forwardRef((function(e,t){var n=e.children,a=void 0===n?null:n,i=e.text,o=e.dismissOnClick,u=void 0===o||o,c=l(e,["children","text","dismissOnClick"]),s=(0,d.useContext)(p.MenuContext),b=s.dismissMenu,v=s.parentMenu;return a?d.default.createElement(m.Menu,{onDismiss:b,disclosure:function(e){return d.default.createElement(f.MenuItem,r({as:h},e,v,c,{style:{display:"block","-webkit-appearance":"unset"},hasSubmenu:!0}),i)}},a):d.default.createElement(f.MenuItem,r({as:h,ref:t},v,c,{onDismiss:u?b:null}),i)}));t.MenuItemDivider=function(){return d.default.createElement(f.MenuSeparator,null,(function(e){return d.default.createElement("li",r({className:c.Classes.MENU_DIVIDER},e))}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuButton=void 0;var o=i(n(0)),l=n(5),u=i(n(58)),c=n(255);t.MenuButton=function(e){var t,n,i=e.placement,s=e.unstable_fixed,d=e.buttonContent,f=e.children,m=e.buttonProps,p=a(e,["placement","unstable_fixed","buttonContent","children","buttonProps"]),h=r(r({},m),{icon:(n=null===(t=e.buttonProps)||void 0===t?void 0:t.icon,n&&"string"==typeof n?o.default.createElement(u.default,{icon:n}):n)});return o.default.createElement(c.Menu,r({placement:i,unstable_fixed:s,disclosure:function(e){var t=e.ref,n=a(e,["ref"]);return o.default.createElement(l.Button,r({children:d},h,n,{elementRef:t}))}},p),f)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(57),s=n(18),d=n(847),f=function(e){return o(void 0,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,s.apiFetch.post("/api/dev",{subdomain:e})];case 1:return t.sent(),window.location.href="/",[2]}}))}))};t.default=function(){var e=(0,u.useCallback)((function(){var e=prompt("Enter a Community subdomain");f(e)}),[]);return u.default.createElement(u.default.Fragment,null,u.default.createElement(c.MenuItem,{text:"Base PubPub",icon:"home",onClick:function(){return f(null)}}),u.default.createElement(c.MenuItem,{text:"Choose a Community...",icon:"text-highlight",onClick:e}),u.default.createElement(c.MenuItemDivider,null),d.communities.map((function(e){var t=e.title,n=e.subdomain,r=e.icon;return u.default.createElement(c.MenuItem,{key:n,text:t,icon:r,onClick:function(){return f(n)}})})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.editorSchema=t.buildSchema=void 0;var a=n(7),i=n(852);t.buildSchema=function(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n={});var o=r(r({},i.defaultNodes),e),l=r(r({},i.defaultMarks),t);return Object.keys(n).forEach((function(e){var t=o[e];t&&(o[e].defaultOptions=r(r({},t.defaultOptions),n[e]))})),Object.keys(o).forEach((function(e){o[e]||delete o[e]})),Object.keys(l).forEach((function(e){l[e]||delete l[e]})),new a.Schema({nodes:o,marks:l,topNode:"doc"})},t.editorSchema=(0,t.buildSchema)()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCitationInlineLabel=void 0;t.getCitationInlineLabel=function(e){var t=e.attrs,n=t.count,r=t.citation,a=t.customLabel;return a||(r&&r.inline?r.inline:"["+n+"]")}},,,,,function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.structuredCitation=void 0;var a=n(105);t.structuredCitation=function(e){return function(t){var n=t.attrs,i=n[e],o=n.customLabel,l=(0,a.useDocumentState)().noteManager,u=!!l,c=r((0,a.useState)((function(){return u&&l.getRenderedValueSync(i)})),2),s=c[0],d=c[1];return(0,a.useEffect)((function(){u&&l.getRenderedValue(i).then(d)}),[l,i,u,o]),s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isResizeableFormat=void 0;var r=["jpg","jpeg","png"];t.isResizeableFormat=function(e){var t=e.split(".").pop().toLowerCase();return r.includes(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.referencesPluginKey=void 0;var r=n(8),a=n(873),i=n(77);t.referencesPluginKey=new r.PluginKey("references");var o=function(e){return e.toLowerCase().replace(/\s+/g,"")};t.default=function(e,n){var l=n.nodeLabels,u=n.suggestionManager;var c={char:"@",name:"reference-suggestion",keyBindings:{ArrowUp:function(){return u.previous(),!0},ArrowDown:function(){return u.next(),!0},Enter:function(){return u.select(),!0},Esc:function(){return u.close(),!0}},onChange:function(e){var t,n,r;u.load((t=e.view,n=e.queryText.partial,r=(0,i.getReferenceableNodes)(t.state,l),""===n?r:r.filter((function(e){var t=(0,i.buildLabel)(e.node,(0,i.getNodeLabelText)(e.node,l));return null!==t&&o(t).indexOf(o(n))>-1}))),e)},onExit:function(){u.close()},createCommand:function(e){var t=e.match,n=e.view;return function(e){var r=n.state.tr,a=t.range,i=a.from,o=a.end,l=n.state.schema.nodes.reference.create({targetId:e.node.attrs.id});r.replaceWith(i,o,l),n.dispatch(r)}}};return[(0,a.suggest)(c),function(e){return new r.Plugin({key:t.referencesPluginKey,state:{init:function(){return{nodeLabels:e.nodeLabels}},apply:function(e,t){return t}}})}(n)]}},,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFirebaseConnectionMonitorRef=t.createFirebaseChange=t.flattenKeyables=t.storeCheckpoint=t.firebaseTimestamp=void 0;var u=n(158),c=l(n(259));t.firebaseTimestamp={".sv":"timestamp"};t.storeCheckpoint=function(e,n,i){return r(void 0,void 0,void 0,(function(){var r;return a(this,(function(a){switch(a.label){case 0:return r={d:(0,u.compressStateJSON)({doc:n.toJSON()}).d,k:i,t:t.firebaseTimestamp},[4,Promise.all([e.child("checkpoints/"+i).set(r),e.child("checkpoint").set(r),e.child("checkpointMap/"+i).set(t.firebaseTimestamp)])];case 1:return a.sent(),[2]}}))}))};t.flattenKeyables=function(e){return Object.keys(e).sort((function(e,t){return parseInt(e,10)-parseInt(t,10)})).reduce((function(t,n){var r=e[n];return Array.isArray(r)?o(o([],i(t),!1),i(r),!1):o(o([],i(t),!1),[r],!1)}),[])};t.createFirebaseChange=function(e,n){return{id:c.default.v4(),cId:n,s:e.map((function(e){return(0,u.compressStepJSON)(e.toJSON())})),t:t.firebaseTimestamp}};t.getFirebaseConnectionMonitorRef=function(e){return e.root.child(".info/connected")}},,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.editorHasPasteDecorations=void 0;var a=n(8),i=n(47),o=n(934),l=n(936),u=n(262),c=n(938);t.default=function(e,t){var n=t.mediaUploadHandler,s=void 0===n?c.defaultMediaUploadHandler:n;return!e.nodes.image||t.isReadOnly?[]:new a.Plugin({key:u.pastePluginKey,state:{init:function(e,t){return{decorations:i.DecorationSet.create(t.doc,[])}},apply:function(e,t){var n=t.decorations,a=(0,o.getNextDecorationsForTransaction)(e,n);return r(r({},t),{decorations:a})}},props:{handleDOMEvents:{paste:(0,l.createPasteHandler)(s),drop:(0,l.createDropHandler)(s)},decorations:function(e){var t;if(this instanceof a.Plugin){var n=this.getState(e);n&&(t=n.decorations)}return t}},appendTransaction:function(t,n,r){for(var a=0;a<t.length;a++){var i=t[a],l=(0,o.getFinishedUploadFromTransaction)(i,n);if(l){var u=l.src,c=l.position;return r.tr.insert(c,e.nodes.image.create({url:u}))}}return null}})};t.editorHasPasteDecorations=function(e){var t=u.pastePluginKey.getState(e);return!!t&&t.decorations.find().length>0}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.domEventsPluginKey=void 0;var r=n(8);t.domEventsPluginKey=new r.PluginKey("domEvents");var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n={};return e.forEach((function(e){n[e]=function(e,t){var n=e.state.tr;n.setMeta("latestDomEvent",t),e.dispatch(n)}})),n};t.default=function(){return new r.Plugin({key:t.domEventsPluginKey,state:{init:function(){return{latestDomEvent:null}},apply:function(e,t){var n=t.latestDomEvent;return{latestDomEvent:e.getMeta("latestDomEvent")||n}}},props:{handleDOMEvents:a("click","keydown")}})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.immediatelyDispatchOnChange=t.getChangeObject=void 0;var o=n(8),l=n(214),u=n(105),c=n(160),s=n(418),d=new o.PluginKey("onChange"),f=function(e,t,n){var r=e.coordsAtPos(t),a=e.coordsAtPos(n);return{left:Math.min(r.left,a.left),top:Math.min(r.top,a.top),right:Math.max(r.right,a.right),bottom:Math.max(r.bottom,a.bottom)}},m=function(e){return(e.docView.innerDeco.members?e.docView.innerDeco.members:[e.docView.innerDeco]).reduce((function(t,n){var r=n.find().map((function(t){return{from:t.from,to:t.to,boundingBox:f(e,t.from,t.to),attrs:t.type.attrs}}));return i(i([],a(t),!1),a(r),!1)}),[])},p=function(e){var t=e.state,n=t.schema.marks.link,a=t.selection,i=a.from,o=a.$from,l=a.to,u=a.$to,c=a.empty,s=t.doc.resolve(Math.max(i-1,0)),d=t.doc.resolve(Math.max(l-1,0)),m=function(e,t){return e.marksAcross(t)||[]},p=(c?m(o,u).length?m(o,u):m(s,d):m(o,d)).reduce((function(e,t){return"link"===t.type.name?t:e}),void 0);if(p){for(var h=i-1,b=!1;!b;)0===h&&(b=!0),t.doc.rangeHasMark(h,h+1,n)?h-=1:b=!0;for(var v=i,y=!1;!y;)0===v&&(y=!0),t.doc.rangeHasMark(v,v+1,n)?v+=1:y=!0;return{attrs:p.attrs,boundingBox:f(e,h,v),updateAttrs:function(t){var n=p.attrs,a=e.state.tr;a.removeMark(h+1,v,e.state.schema.marks.link),a.addMark(h+1,v,e.state.schema.marks.link.create(r(r({},n),t))),e.dispatch(a)},removeLink:function(){var t=e.state.tr;t.removeMark(h+1,v,e.state.schema.marks.link),e.dispatch(t)}}}},h=function(e,t){if(e)return function(e){var n=t.state.selection.from;if(void 0!==n){var a=t.state.selection.node.attrs,i=t.state.tr.setNodeMarkup(n,null,r(r({},a),e));if(t.state.selection.node.type.isInline){var l=o.NodeSelection.create(i.doc,n);i.setSelection(l)}t.dispatch(i)}}},b=function(e,t){if(e)return function(e,n,a){var i=e.create(r({},n),a),o=t.state.selection.from,l=t.state.selection.to,u=t.state.tr.replaceRangeWith(o,l,i);t.dispatch(u)}};t.getChangeObject=function(e){var t,n,r=!!e.state.selection.node,a=c.collabDocPluginKey.getState(e.state)||{},i=s.domEventsPluginKey.getState(e.state).latestDomEvent;return{view:e,selection:e.state.selection,selectionBoundingBox:f(e,e.state.selection.from,e.state.selection.to),selectionInTable:(0,l.isInTable)(e.state),selectedNode:r?(t=e.state,n=t.selection.node,(0,u.getReactedCopyOfNode)(n,t)||n):void 0,updateNode:h(r,e),changeNode:b(r,e),decorations:m(e),activeLink:p(e),isCollabLoaded:a.isLoaded,latestDomEvent:i}};t.immediatelyDispatchOnChange=function(e){var t;return null===(t=d.getState(e.state))||void 0===t?void 0:t.dispatchChange(e)},t.default=function(e,n){var r=function(e){var r;null===(r=n.onChange)||void 0===r||r.call(n,(0,t.getChangeObject)(e))};return new o.Plugin({key:d,state:{init:function(){return{dispatchChange:r}},apply:function(e,t){return t}},view:function(){return{update:r}}})}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.expect=t.assert=void 0;!function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="AssertionError",t}a(t,e)}(Error);function i(e,t){void 0===t&&(t="")}t.assert=i,t.expect=function(e){return i(),e}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=l(n(3)),s=n(78),d=n(9),f=n(422),m=l(n(990)),p=l(n(425)),h=l(n(992)),b=n(266),v=n(994),y=n(995);n(999);var g={view:{},selectedNode:null,updateNode:function(){}};t.default=function(e){var t=e.editorChangeObject,n=e.isSmall,a=void 0!==n&&n,i=e.showBlockTypes,o=void 0===i?!a:i,l=e.controlsConfiguration,_=void 0===l?{}:l,E=e.isTranslucent,P=void 0!==E&&E,w=e.citationStyle,O=void 0===w?"apa-7":w,C=e.buttons,S=t||g,D=(0,d.usePageContext)().communityData,k=(0,f.useRefMap)(),j=(0,u.useRef)(null),M=(0,s.useToolbarState)({loop:!0}),N=(0,v.usePendingAttrs)(S),I=(0,y.useControlsState)({buttons:C,editorChangeObject:S,controlsConfiguration:r({kind:a?"floating":"anchored",container:j.current,isAbsolutelyPositioned:!1,isFullScreenWidth:!1},_)}),x=I.openedButton,T=I.setOpenedButton,A=I.selectedNodeId,R=I.buttonStates,B=I.resolvedControlsConfiguration;(0,u.useEffect)((function(){if(x){var e=k.getRef(x.key);if(e&&e.current&&"function"==typeof e.current.scrollIntoView){var t=e.current;t.parentNode.scrollLeft=t.offsetLeft-5}}}),[x]);var F=function(e){var t=e.button,n=e.isOpen,i=e.isActive,o=e.isIndicated,l=e.isDisabled,c=e.isDetached,d=e.onClick,f="media"===t.key&&{view:S.view},m=(0,b.getButtonPopoverComponent)(t,l);return u.default.createElement(s.ToolbarItem,r({},M,{outerRef:k.getRef(t.key),as:t.component||p.default,key:t.key,label:t.label,formattingItem:t,disabled:l,isActive:i,isIndicated:o&&!n,isOpen:n,isDetached:c,isSmall:a,popoverContent:m&&u.default.createElement(m,null),accentColor:D.accentColorDark,onClick:d},f))};return u.default.createElement("div",{ref:j,className:(0,c.default)("formatting-bar-component",a&&"small",P&&"translucent")},u.default.createElement(s.Toolbar,r({"aria-label":"Formatting toolbar",className:"toolbar"},M),o&&u.default.createElement(u.default.Fragment,null,u.default.createElement(s.ToolbarItem,r({as:m.default,isSmall:a,editorChangeObject:S},M)),u.default.createElement("div",{className:"separator"})),R.map((function(e,t){return u.default.createElement(u.default.Fragment,{key:t},t>0&&u.default.createElement("div",{className:"separator"}),e.map(F))}))),function(){if(B){var e=B.component;return u.default.createElement(h.default,{controlsConfiguration:B,editorChangeObject:S,accentColor:D.accentColorDark,onClose:function(){return T(null)}},u.default.createElement(e,{key:A,editorChangeObject:S,isSmall:a,citationStyle:O,pendingAttrs:N,onClose:function(){return T(null)}}))}return null}())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRefMap=void 0;var r=n(0);t.useRefMap=function(){var e=(0,r.useRef)({}).current;return{getRef:function(t){var n=e[t];if(n)return n;var a=(0,r.createRef)();return e[t]=a,a},refs:e}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(57),c=n(424),s=o.default.forwardRef((function(e,t){var n=e.editorChangeObject.view,i=e.className,s=void 0===i?"":i,d=e.commands,f=e.disclosure,m=e.markActiveItems,p=void 0===m||m,h=a(e,["editorChangeObject","className","commands","disclosure","markActiveItems"]),b=(0,c.useCommandStates)({commands:d,view:n,state:null==n?void 0:n.state}),v=function(e){var t=e.title,r=e.icon,a=e.key,i=e.commandState;return o.default.createElement(u.MenuItem,{key:a,active:p&&(null==i?void 0:i.isActive),disabled:!(null==i?void 0:i.canRun),text:t,icon:r,onClick:function(){null==i||i.run(),n.focus()}})};return o.default.createElement(u.Menu,r({ref:t},h,{disclosure:function(e){return f(b,e)},menuStyle:{zIndex:20},className:(0,l.default)("command-menu-component",s)}),b.map((function(e,t){return o.default.createElement(o.default.Fragment,{key:t},t>0&&o.default.createElement(u.MenuItemDivider,null),e.map(v))})))}));t.default=s},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.useCommandStates=void 0;var a=n(0),i=n(266),o=function(e,t){var n={};return e.forEach((function(e){Array.isArray(e)&&(n=r(r({},n),o(e,t))),"command"in e&&e.command&&(n[e.key]=e.command(t))})),n};t.useCommandStates=function(e){var t=e.commands,n=e.view,l=e.state,u=(0,a.useMemo)((function(){return n?o(t,n):{}}),[n]);return(0,a.useMemo)((function(){return function(e,t,n){return n?(0,i.deepMap)(e,(function(e){var a=t[e.key];return a?r(r({},e),{commandState:a(n)}):e})):e}(t,u,l)}),[t,u,l])}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(78),c=n(5),s=n(6),d=function(e,t,n){return t&&!n?{color:"white",background:e}:{}},f=function(e,t,n){return t&&n?{background:e}:{}},m=function(e){return{background:e}},p={preventOverflow:{enabled:!1},flip:{enabled:!1}},h=o.default.forwardRef((function(e,t){var n=e.disabled,i=void 0!==n&&n,h=e.formattingItem,b=e.isActive,v=void 0!==b&&b,y=e.isIndicated,g=void 0!==y&&y,_=e.isDetached,E=void 0!==_&&_,P=e.isOpen,w=void 0!==P&&P,O=e.isSmall,C=void 0!==O&&O,S=e.label,D=void 0===S?null:S,k=e.onClick,j=e.accentColor,M=void 0===j?"white":j,N=e.outerRef,I=e.popoverContent,x=a(e,["disabled","formattingItem","isActive","isIndicated","isDetached","isOpen","isSmall","label","onClick","accentColor","outerRef","popoverContent"]),T=o.default.createElement(u.Button,r({ref:t},x,{role:"button",disabled:i,focusable:!0,title:h.title,"aria-label":h.ariaTitle||h.title,"aria-pressed":h.isToggle?v:void 0,className:(0,l.default)("bp3-button","bp3-minimal",!w&&!g&&v&&"bp3-active",C&&"bp3-small",!w&&!g&&i&&"bp3-disabled"),style:f(M,w,E),onClick:function(){return k(h)}}),o.default.createElement(s.Icon,{icon:h.icon,iconSize:C?12:16}),D);return I&&(T=o.default.createElement(c.Popover,{content:I,interactionKind:c.PopoverInteractionKind.HOVER,modifiers:p,openOnTargetFocus:!0,minimal:!0,position:c.Position.BOTTOM},T)),o.default.createElement("span",{ref:N,className:(0,l.default)("formatting-bar-button",w&&"open",E&&"detached",!!D&&"has-label"),style:d(M,w,E)},T,g&&o.default.createElement("div",{className:"indicator",style:m(M)}))}));t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=u(n(1010)),f=n(98);n(1011);var m={height:200,width:200,image:void 0,onCancel:function(){},onUploaded:function(){}},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={scale:1.5,isUploading:!1,blob:void 0},n.editor=void 0,n.onFileFinish=n.onFileFinish.bind(n),n.handleScaleChange=n.handleScaleChange.bind(n),n.handleSaveClick=n.handleSaveClick.bind(n),n}return a(t,e),t.prototype.onFileFinish=function(e,t,n,r){this.setState({isUploading:!1,scale:1.5}),this.props.onUploaded("https://assets.pubpub.org/"+r,this.state.blob)},t.prototype.handleScaleChange=function(e){this.setState({scale:e})},t.prototype.handleSaveClick=function(){var e=this;this.editor.getImage().toBlob((function(t){(0,f.s3Upload)(t,(function(){}),e.onFileFinish,0),e.setState({isUploading:!0,blob:URL.createObjectURL(t)})}),"image/jpeg",.9)},t.prototype.render=function(){var e=this;return"undefined"==typeof window?null:c.default.createElement("div",{className:"image-cropper-component"},c.default.createElement("h5",null,"Crop Image"),c.default.createElement("div",{className:"editor-wrapper"},c.default.createElement(d.default,{ref:function(t){e.editor=t},image:this.props.image,width:this.props.width,height:this.props.height,border:0,scale:this.state.scale})),c.default.createElement(s.Slider,{value:this.state.scale,onChange:this.handleScaleChange,min:1,max:5,stepSize:.1,renderLabel:!1}),c.default.createElement("div",{className:"buttons"},c.default.createElement(s.Button,{text:"Cancel",onClick:this.props.onCancel}),c.default.createElement(s.Button,{text:"Crop and Save",className:"bp3-intent-primary",onClick:this.handleSaveClick,loading:this.state.isUploading})))},t.defaultProps=m,t}(c.Component);t.default=p},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(5);n(1012);var l={isOpen:i.default.bool,onClose:i.default.func.isRequired,children:i.default.node.isRequired,maxWidth:i.default.number},u=function(e){return a.default.createElement(o.Overlay,{className:"bp3-overlay-scroll-container",isOpen:e.isOpen,onClose:e.onClose,transitionName:"pub-overlay",transitionDuration:200},a.default.createElement("style",null,"\n\t\t\t\t\t@media only screen and (min-width: "+e.maxWidth/.9+"px) {\n\t\t\t\t\t\t.overlay-wrapper {\n\t\t\t\t\t\t\tleft: calc(50vw - "+e.maxWidth/2+"px);\n\t\t\t\t\t\t\twidth: "+e.maxWidth+"px; // Effectively it's max width\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t"),a.default.createElement("div",{className:"overlay-wrapper bp3-card bp3-elevation-2"},e.children))};u.propTypes=l,u.defaultProps={maxWidth:940,isOpen:!1},t.default=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(271),l=n(9),u=r(n(429)),c=r(n(430)),s=r(n(272)),d=r(n(431)),f=r(n(273)),m=r(n(434)),p=r(n(1026));n(1028);t.default=function(e){var t=(0,l.usePageContext)(),n=t.locationData,r=t.loginData,h=t.communityData,b=e.blocks,v=e.isNarrow,y=e.layoutPubsByBlock,g=e.id,_=void 0===g?"":g,E=e.collection,P=(0,o.resolveLayoutPubsByBlock)(y,b);return a.default.createElement("div",{id:_,className:(0,i.default)("layout-component",v&&"narrow","ultrawide"===n.query.display&&"ultrawide")},b.map((function(e,t){return"pubs"===e.type?a.default.createElement("div",{className:"layout-pubs-block",key:t},a.default.createElement(u.default,{content:e.content,pubs:P[e.id],collectionId:E&&E.id})):"text"===e.type?a.default.createElement(d.default,{key:t,content:e.content}):"html"===e.type?a.default.createElement(c.default,{key:t,content:e.content}):"banner"===e.type?a.default.createElement(s.default,{key:t,content:e.content,communityData:h,loginData:r,locationData:n}):"collections-pages"===e.type?a.default.createElement("div",{className:"layout-pages-block",key:t},a.default.createElement(f.default,{content:e.content,pages:h.pages,collections:h.collections})):"collection-header"===e.type&&E?a.default.createElement(m.default,{key:t,content:e.content,collection:E}):"submission-banner"===e.type?a.default.createElement(p.default,{key:t,content:e.content}):null})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(6),l=n(216);t.default=function(e){var t=e.pubs,n=e.content,a=e.collectionId,u=n.hideByline,c=n.hideContributors,s=n.hideDates,d=n.hideDescription,f=n.hideEdges,m=n.pubPreviewType,p=n.title,h=["medium","minimal"].includes(m),b=a?{customizePubUrl:function(e){return(0,l.createReadingParamUrl)(e,a)}}:{};return i.default.createElement("div",{className:"block-content"},i.default.createElement("div",{className:"container"},p&&i.default.createElement("div",{className:"row"},i.default.createElement("div",{className:"col-12"},i.default.createElement("h1",null,p))),t.map((function(e,t,n){if(h&&t%2==1)return null;var a=h&&t<n.length-1?n[t+1]:null;return i.default.createElement("div",{key:e.id,className:"row"},i.default.createElement("div",{className:h?"col-6":"col-12"},i.default.createElement(o.PubPreview,r({pubData:e,size:m,hideByline:u,hideDescription:d,hideDates:s,hideEdges:f,hideContributors:c},b))),a&&i.default.createElement("div",{className:h?"col-6":"col-12"},i.default.createElement(o.PubPreview,r({pubData:a,size:m,hideByline:u,hideDescription:d,hideDates:s,hideEdges:f,hideContributors:c},b))))}))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(6),l={content:i.default.object.isRequired},u=function(e){return e.content.html?a.default.createElement("div",{className:"layout-html-component"},a.default.createElement("div",{className:"block-content"},a.default.createElement(o.GridWrapper,null,a.default.createElement("div",{dangerouslySetInnerHTML:{__html:e.content.html}})))):null};u.propTypes=l,t.default=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(41)),o=n(6);t.default=function(e){var t=e.content;return t.text?a.default.createElement("div",{className:"layout-text-component"},a.default.createElement("div",{className:"block-content"},a.default.createElement(o.GridWrapper,null,a.default.createElement(i.default,{initialContent:t.text,isReadOnly:!0})))):null}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(88),o=n(433);n(1020);t.default=function(e){var t=e.pageData,n=(0,i.getResizedUrl)(t.avatar,"inside",600),r=t.avatar?{backgroundImage:'url("'+n+'")'}:{background:(0,o.generatePageBackground)(t.title)};return a.default.createElement("a",{className:"page-preview-component",style:r,href:"/"+t.slug},t.avatar&&a.default.createElement("div",{className:"dim"}),a.default.createElement("span",null,t.title))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateDefaultPageLayout=t.generatePageBackground=void 0;var r=n(161);t.generatePageBackground=function(e){var t=["#b33939","#cd6133","#474787","#227093","#218c74"];return e?t[e.charCodeAt(e.length-1)%5]:t[0]};t.generateDefaultPageLayout=function(){return[{id:(0,r.generateHash)(8),type:"pubs",content:{title:"",pubPreviewType:"large",limit:1,pubIds:[]}},{id:(0,r.generateHash)(8),type:"pubs",content:{title:"",pubPreviewType:"medium",limit:0,pubIds:[]}}]}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(112),o=n(6),l=n(132),u=r(n(1021)),c=n(74),s=n(64),d=n(67),f=n(436),m=r(n(217));n(1025);var p=function(e){var t=e.collection,n=e.content.hiddenMetadataFields,r=void 0===n?[]:n,i=t.metadata,o=t.kind;if(!i||"tag"===o)return null;var l=["doi","url"],u=(0,f.getOrderedCollectionMetadataFields)(t).filter((function(e){return!l.includes[e.name]}));return a.default.createElement(a.default.Fragment,null,u.map((function(e){var t=e.name,n=i[t],o=!r.includes(t)&&n&&(0,f.formattedMetadata)(t,n);return o?a.default.createElement("div",{key:t},o):null})))};t.default=function(e){var t=e.collection,n=e.content,r=n.hideByline,f=n.hideContributors,h=n.hideCollectionKind,b=n.hideDate,v=n.hiddenMetadataFields,y=void 0===v?[]:v,g=e.content,_=(0,l.getAllCollectionContributors)(t),E=_.filter((function(e){return e.isAuthor})),P=(0,c.getSchemaForKind)(t.kind),w=(0,u.default)(t),O=[!h&&a.default.createElement("div",{className:"collection-kind",key:0},a.default.createElement(o.Icon,{icon:P.bpDisplayIcon}),(0,s.capitalize)(P.label.singular)),!b&&a.default.createElement("div",{key:1},"Created ",(0,d.formatDate)(t.createdAt)),w&&!(null==y?void 0:y.includes("doi"))&&a.default.createElement(o.ClickToCopyButton,{className:"click-to-copy",copyString:"https://doi.org/"+w,beforeCopyPrompt:"Copy doi.org link",icon:null,small:!0,key:2},(function(e){return a.default.createElement(i.Button,{as:"a",onClick:e},w)})),a.default.createElement(p,{collection:t,content:g,key:3})].filter((function(e){return e}));return a.default.createElement("div",{className:"layout-collection-header-component"},a.default.createElement(o.GridWrapper,{columnClassName:"inner"},a.default.createElement("h1",null,t.title),E&&!r&&a.default.createElement(m.default,{contributors:E,renderSuffix:function(){return!f&&_.length>0&&a.default.createElement(o.ContributorAvatars,{attributions:_,truncateAt:8})}}),O.length>0&&a.default.createElement("div",{className:"details-row"},O)))}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formattedMetadata=t.getOrderedCollectionMetadataFields=void 0;var r=n(74),a=n(67);t.getOrderedCollectionMetadataFields=function(e){return(0,r.getSchemaForKind)(e.kind).metadata};var i=function(e,t){var n=new Date(e);if((0,a.isValidDate)(n)){var r=(0,a.getLocalDateMatchingUtcCalendarDate)(n);if((0,a.isValidDate)(r))return""+t+(0,a.formatDate)(r)}return null};t.formattedMetadata=function(e,t){return"printIssn"===e?"ISSN: "+t:"electronicIssn"===e?"e-ISSN: "+t:"volume"===e?"Volume "+t:"issue"===e?"Issue "+t:"printPublicationDate"===e?i(t,"Printed "):"publicationDate"===e?i(t,"Published "):"isbn"===e?"ISBN: "+t:"copyrightYear"===e?"Copyright Â© "+t:"edition"===e?t+" ed.":"theme"===e?""+t:"acronym"===e?" "+t:"location"===e?""+t:"date"===e?i(t,""):t}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(80)),o=r(n(3)),l=n(9);n(1027);t.default=function(e){var t=e.title,n=e.content,r=e.className,u=(0,l.usePageContext)().communityData.accentColorDark,c=(0,i.default)(u).alpha(.2).toString();return a.default.createElement("div",{className:(0,o.default)("layout-submission-banner-skeleton-component",r),style:{backgroundColor:c}},a.default.createElement("h2",null,t),a.default.createElement("div",null,n))}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLazyRef=void 0;var r=n(0),a=Symbol(0);t.useLazyRef=function(e){var t=(0,r.useRef)(a);return t.current===a&&(t.current=e()),t}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.PubContextProvider=t.ImmediatePubContext=t.SuspendedPubContext=void 0;var l=i(n(0)),u=n(441),c=n(439),s=n(257),d=n(1049),f=n(1050),m=n(1062),p=n(218),h=n(1063),b=n(277),v={inPub:!1,pubData:{nodeLabels:{},slug:"",releases:[],releaseNumber:0},collabData:{editorChangeObject:{}},historyData:{},firebaseDraftRef:null,updateLocalData:null,updatePubData:null,submissionState:{},noteManager:new u.NoteManager("apa-7","count",{})};t.SuspendedPubContext=l.default.createContext(v),t.ImmediatePubContext=l.default.createContext(v);t.PubContextProvider=function(e){var n,r,a=e.children,i=e.pubData,v=o((0,p.useIdlyUpdatedState)(i),2),y=v[0],g=v[1],_=o((0,f.usePubCollabState)({pubData:y}),2),E=_[0],P=_[1],w=(0,m.usePubHistoryState)({pubData:y,editorView:null!==(r=null===(n=E.editorChangeObject)||void 0===n?void 0:n.view)&&void 0!==r?r:null}),O=o((0,d.usePubSubmissionState)({pubData:y,editorChangeObject:E.editorChangeObject}),2),C=O[0],S=O[1],D=(0,h.usePubBodyState)({pubData:y,collabData:E,historyData:w,submissionState:C}),k=(0,c.useLazyRef)((function(){return new u.NoteManager(y.citationStyle,y.citationInlineStyle,y.initialStructuredCitations)})).current,j=(0,l.useMemo)((function(){return(0,s.getPubHeadings)(y.initialDoc,E.editorChangeObject)}),[y.initialDoc,E.editorChangeObject]),M=(0,l.useCallback)((function(e,t,n){void 0===n&&(n={});var r=n.isImmediate;"pub"===e&&(r?g.immediately(!0)(t):g(t))}),[g]),N={inPub:!0,pubData:y,updatePubData:g,collabData:E,updateCollabData:P,historyData:w,submissionState:C,updateSubmissionState:S,noteManager:k,pubBodyState:D,updateLocalData:M,pubHeadings:j},I=(0,b.usePubSuspendWhileTyping)(N);return l.default.createElement(t.SuspendedPubContext.Provider,{value:I},l.default.createElement(t.ImmediatePubContext.Provider,{value:N},a))}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.NoteManager=void 0;var i=n(1048),o=n(18),l="undefined"!=typeof window,u=function(e,t,n){return l?(0,o.apiFetch)("/api/editor/citation-format",{method:"POST",body:JSON.stringify({structuredValues:e,inlineStyleKind:n,citationStyleKind:t})}):Promise.resolve([])},c=function(e){function t(t,n,r){return e.call(this,u,t,n,r)||this}return a(t,e),t}(i.NoteManagerCore);t.NoteManager=c},,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlsButtonGroup=t.ControlsButton=void 0;var i=a(n(0)),o=n(78);t.ControlsButton=function(e){return i.default.createElement(o.Button,r({className:"controls-button"},e))};t.ControlsButtonGroup=function(e){var t=e.children;return i.default.createElement("div",{className:"controls-button-group"},t)}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlsReferencePopover=t.ControlsReferenceSettingsLink=void 0;var u=i(n(0)),c=l(n(3)),s=n(6),d=n(115),f=n(39),m=n(40);n(1066);t.ControlsReferenceSettingsLink=function(e){var t=(0,f.usePubContext)(),n=t.inPub,r=t.pubData;if(!n)return null;var a=u.default.createElement("a",{href:(0,m.getDashUrl)({pubSlug:r.slug,mode:"settings",section:"block-labels"})},"Pub Settings");return u.default.createElement("span",{className:(0,c.default)("controls-reference-settings-link",e.dark&&"dark")},e.small?u.default.createElement(u.default.Fragment,null,"Enable item labeling in ",a):u.default.createElement(u.default.Fragment,null,"Visit ",a," to turn on labeling and enable references."))};t.ControlsReferencePopover=function(){return(0,f.usePubContext)().inPub?u.default.createElement("p",{className:"controls-reference-popover-component"},u.default.createElement(t.ControlsReferenceSettingsLink,null)):null},t.default=function(e){var t=e.editorChangeObject,n=t.updateNode,r=t.selectedNode,a=t.view,i=(0,d.getCurrentNodeLabels)(a.state),l=(0,u.useMemo)((function(){return i?(0,d.getReferenceableNodes)(a.state,i):[]}),[a.state,i]),c=o((0,u.useState)((function(){return function(e,t){return e&&e.attrs&&e.attrs.targetId?t.find((function(t){return t.node.attrs.id===e.attrs.targetId})):null}(r,l)})),2),f=c[0],m=c[1],p=f&&f.node&&f.node.attrs.id,h=(0,u.useRef)(!1);(0,u.useEffect)((function(){h.current&&(n({targetId:p}),h.current=!1)}),[p,n]);var b=(0,u.useCallback)((function(e){h.current=!0,m(e)}),[m]);return u.default.createElement(s.ReferencesDropdown,{references:l,selectedReference:f,onSelect:b})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getCookieOptions=void 0;t.getCookieOptions=function(){return r(r({expires:365e3},window.location.host.includes("pubpub.org")&&{domain:".pubpub.org"}),window.location.host.includes("duqduq.org")&&{domain:".duqduq.org"})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getLicenseForPub=t.licenses=void 0;var a=n(99),i=n(1105);t.licenses=[{slug:"cc-by",full:"Creative Commons Attribution 4.0 International License",short:"CC-BY",version:"4.0",link:"https://creativecommons.org/licenses/by/4.0/"},{slug:"cc-0",full:"Creative Commons Public Domain Dedication",short:"CC-0",version:"1.0",link:"https://creativecommons.org/publicdomain/zero/1.0/"},{slug:"cc-by-nc",full:"Creative Commons Attribution-NonCommercial 4.0 International License",short:"CC-BY-NC",version:"4.0",link:"https://creativecommons.org/licenses/by-nc/4.0/"},{slug:"cc-by-nd",full:"Creative Commons Attribution-NoDerivatives 4.0 International License",short:"CC-BY-ND",version:"4.0",link:"https://creativecommons.org/licenses/by-nd/4.0/"},{slug:"cc-by-nc-nd",full:"Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License",short:"CC-BY-NC-ND",version:"4.0",link:"https://creativecommons.org/licenses/by-nc-nd/4.0/"},{slug:"cc-by-sa",full:"Creative Commons Attribution-ShareAlike 4.0 International License",short:"CC-BY-SA",version:"4.0",link:"https://creativecommons.org/licenses/by-sa/4.0/"},{slug:"cc-by-nc-sa",full:"Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License",short:"CC-BY-NC-SA",version:"4.0",link:"https://creativecommons.org/licenses/by-nc-sa/4.0/"},{slug:"copyright",full:"Copyright Â© All rights reserved.",short:"Copyright",version:null,link:null,requiresPremium:!0}];t.getLicenseForPub=function(e,n){var o=t.licenses.find((function(t){return t.slug===e.licenseSlug})),l=r(r({},o),{summary:o.slug.toUpperCase()+" "+o.version}),u=(0,a.getPubCopyrightYear)(e),c=(0,i.getPublisherString)(n);return"copyright"===l.slug&&c&&u&&(l.full="Copyright Â© "+u+" "+c+". All rights reserved.",l.summary=""),l}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(87)),s=n(5),d=n(6),f=n(57),m=n(9),p=n(450),h=l(n(1109)),b=l(n(1110));n(1112);var v=function(e){var t,n,r=e.memberData,a=e.isInvitation,i=e.isReadOnly,l=e.isOnlyMemberInScope,v=e.onDelete,y=e.onUpdate,g=(0,m.usePageContext)(),_=g.scopeData,E=g.loginData,P=o((0,u.useState)(null),2),w=P[0],O=P[1],C=_.elements.activeTargetType,S=_.activePermissions.canAdmin,D=l&&"community"===C,k=!S&&"admin"===r.permissions,j=r.user||{fullName:r.email,initials:"@"},M=j.id&&E.id===j.id,N=function(e){return y(r,{permissions:e})},I=function(){return v(r)},x=function(e){var t=p.permissionValues.indexOf(e)<p.permissionValues.indexOf(r.permissions);M&&t?O({dialogType:"demote",onConfirm:function(){return N(e)}}):N(e)},T=function(){M?O({dialogType:"delete",onConfirm:I}):I()};return u.default.createElement("div",{className:"member-row-component"},w&&u.default.createElement(h.default,{key:"self-destructive-"+w.dialogType,isOpen:!0,dialogType:w.dialogType,onConfirm:function(){w&&Promise.resolve(w.onConfirm()).then((function(){return window.location.reload()}))},onCancel:function(){return O(null)}}),u.default.createElement(d.Avatar,{className:a?"invitation":"",initials:j.initials,avatar:j.avatar,width:30}),u.default.createElement("div",{className:"member-info"},u.default.createElement("div",{className:"member-name"},j.fullName),a&&u.default.createElement(s.Tag,{className:"pending-tag",minimal:!0},"Pending"),u.default.createElement("div",{className:"added"},a?"Invited":"Added"," ",(0,c.default)(r.createdAt,"mmm dd, yyyy"))),!(i||k)&&(t=y&&u.default.createElement(f.MenuButton,{"aria-label":"Select member permissions",className:"member-permission-select bp3-elevation-3",placement:"bottom-end",buttonProps:{className:"permission-button",rightIcon:"caret-down",outlined:!0},buttonContent:""+r.permissions},u.default.createElement(b.default,{activeTargetType:C,canAdmin:S,activePermission:r.permissions,onSelect:x})),n=v&&!D&&u.default.createElement(s.Button,{minimal:!0,icon:"cross",onClick:T,disabled:k}),u.default.createElement(u.default.Fragment,null,t,n)),(i||k)&&u.default.createElement(s.Tag,{minimal:!0,large:!0},"Can ",r.permissions))};v.defaultProps={isInvitation:!1,isOnlyMemberInScope:!1,isReadOnly:!1,onUpdate:null,onDelete:null},t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.permissionValues=void 0,t.permissionValues=["view","edit","manage","admin"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generatePubBackground=void 0;var r=n(1127),a=["linear-gradient(135deg, #cb2d3e, #ef973a)","linear-gradient(-45deg, #00bf8f, #001510)","linear-gradient(135deg, #2c3e50, #4ca1af)","linear-gradient(-45deg, #ad5389, #3c1053)","linear-gradient(135deg, #000046, #1cb5e0)"];t.generatePubBackground=function(e){return e?(0,r.getPsuedorandomChoiceForUuid)(e,a):a[0]}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(9),o=n(6);t.default=function(e){var t=e.pubData,n=e.communityData,r=e.updatePubData,l=e.canEdit,u=(0,i.usePendingChanges)().pendingPromise;return a.default.createElement(o.AttributionEditor,{apiRoute:"/api/pubAttributions",identifyingProps:{communityId:n.id,pubId:t.id},attributions:t.attributions,canEdit:l,communityData:n,onUpdateAttributions:function(e){return r({attributions:e})},promiseWrapper:u})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.fuzzyMatchCollection=t.fuzzyMatchPub=void 0;var a=r(n(173)),i=r(n(199)),o=function(e,t){return function(e){return e.attributions.map(i.default).map((function(e){return e.user.fullName}))}(e).some((function(e){return(0,a.default)(t,e.toLowerCase())}))};t.fuzzyMatchPub=function(e,t){var n=(t||"").toLowerCase().trim();return!n||(["title","id","slug"].some((function(t){return function(e,t,n){return(0,a.default)(t,e[n].toLowerCase())}(e,n,t)}))||o(e,n))};t.fuzzyMatchCollection=function(e,t){return!t||(0,a.default)(t.toLowerCase(),e.title.toLowerCase())}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(3));n(281);t.default=function(e){var t=e.bylineElement,n=e.className,a=void 0===n?null:n,l=e.detailsElement,u=e.metadataElements,c=e.outerElementProps,s=void 0===c?{}:c,d=e.titleElement,f=e.topLeftElement,m=void 0===f?null:f;return i.default.createElement("article",r({className:(0,o.default)("pub-edge-layout",a)},s),i.default.createElement("div",{className:"top"},m&&i.default.createElement("div",{className:"top-left"},m),i.default.createElement("div",{className:"top-right"},i.default.createElement("div",{className:"title-container"},d),t&&i.default.createElement("div",{className:"byline-container"},t),i.default.createElement("ul",{className:"metadata"},u.map((function(e,t){return e&&i.default.createElement("li",{key:t},e)})).filter((function(e){return e}))))),l)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));n(1142);t.default=function(e){return a.default.createElement("span",{onClick:e.onToggle,onKeyDown:e.onToggle,tabIndex:"0",className:"pub-edge-description-button",role:"button","aria-controls":e.targetId,"aria-expanded":e.open},e.open?"Hide Description":"Show Description")}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=u(n(3)),d=n(5),f=n(62),m=n(165),p=n(282),h=u(n(283)),b=u(n(1145)),v=u(n(1146));n(1148);var y=function(e,t){var n=e.edge,r=e.isSibling,a=e.isInboundEdge,i=(0,m.getDisplayedPubForPubEdge)(n,{isInboundEdge:a,viewingFromSibling:r});return i?i.id:t};t.default=function(e){var t,n=e.accentColor,r=e.className,a=void 0===r?"":r,i=e.hideIfNoInitialMatches,u=void 0===i||i,m=e.initialMode,g=void 0===m?p.Mode.Carousel:m,_=e.initialFilters,E=void 0===_?[p.Filter.Child]:_,P=e.isolated,w=void 0!==P&&P,O=e.pubData,C=o((0,c.useState)(0),2),S=C[0],D=C[1],k=o((0,c.useState)(g),2),j=k[0],M=k[1],N=o((0,c.useState)(E),2),I=N[0],x=N[1],T=function(e,t){var n=t.inboundEdges,r=t.outboundEdges,a=t.siblingEdges,i=e.includes(p.Filter.Parent),u=e.includes(p.Filter.Child),c=e.includes(p.Filter.Sibling),s=[],d=[],m=[],h=[];return r.forEach((function(e){var t=e.pubIsParent,n={isSibling:!1,isInboundEdge:!1,edge:e};(t?u:i)&&s.push(n),t?m.push(n):d.push(n)})),n.forEach((function(e){var t=e.pubIsParent,n={isSibling:!1,isInboundEdge:!0,edge:e};(t?i:u)&&s.push(n),t?d.push(n):m.push(n)})),a.forEach((function(e){var t=e.pubIsParent,n=e.pub,r=e.targetPub,a={isSibling:!0,isInboundEdge:!1,edge:e,parentPub:t?n:r};h.push(a),c&&s.push(a)})),{filteredPubEdgesInContext:(0,f.unique)(s,y),collatedPubEdgesInContext:(0,f.unique)(l(l(l([],o(d),!1),o(m),!1),o(h),!1),y)}}(I,O),A=T.filteredPubEdgesInContext,R=T.collatedPubEdgesInContext,B=o((0,c.useState)(u&&0===A.length),1)[0],F=A,L=F[S],U=F.length,z=(0,c.useCallback)((function(){return D((function(e){return(e+1)%U}))}),[U]),H=(0,c.useCallback)((function(){return D((function(e){return(e-1+U)%U}))}),[U]),V=(0,c.useCallback)((function(e){x((function(t){var n=t.indexOf(e);return n>-1?l(l([],o(t.slice(0,n)),!1),o(t.slice(n+1)),!1):l(l([],o(t),!1),[e],!1)})),D(0)}),[]),q=(0,c.useCallback)((function(){x((function(e){return e.length===Object.keys(p.Filter).length?[]:p.allFilters})),D(0)}),[]),W=1===A.length,G=R.length>1&&(!w||A.length>1)&&c.default.createElement(c.default.Fragment,null,c.default.createElement(b.default,{index:S,count:U}),c.default.createElement(v.default,{accentColor:n,carouselControlsDisabled:W,single:1===A.length,filters:I,mode:j,onAllFilterToggle:q,onBackClick:H,onFilterToggle:V,onModeChange:M,onNextClick:z,showFilterMenu:!w}));return B?null:c.default.createElement("div",{className:(0,s.default)("pub-edge-listing-component",a)},!w&&c.default.createElement("div",{className:"top"},c.default.createElement("h5",{style:{color:n}},"Connections"),G),(t=j===p.Mode.Carousel?L&&c.default.createElement(h.default,{pubData:O,pubEdge:L.edge,parentPub:L.parentPub,accentColor:n,showIcon:w,viewingFromSibling:L.isSibling,isInboundEdge:L.isInboundEdge,inPubBody:!0},w&&G):A.map((function(e){var t=e.isInboundEdge,r=e.edge,a=e.isSibling,i=e.parentPub;return c.default.createElement(h.default,{pubData:O,key:r.url,pubEdge:r,parentPub:i,accentColor:n,viewingFromSibling:a,isInboundEdge:t,inPubBody:!0})})),w||L&&0!==A.length?t:c.default.createElement(d.NonIdealState,{title:"No Results",icon:"search"})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useMembersState=t.useMembers=void 0;var d=n(0),f=n(9),m=o(n(458));t.useMembers=function(e){var t=e.members,n=e.updateMembers,a=(0,f.usePageContext)().scopeData,i=(0,f.usePendingChanges)().pendingPromise,o=a.elements.activeIds;return{addMember:function(e){return i(m.addMember({scopeIds:o,user:e})).then((function(e){return n(s([e],c(t),!1))}))},updateMember:function(e,a){return n(t.map((function(t){return t.id===e.id?r(r({},t),a):t}))),i(m.updateMember({member:e,update:a,scopeIds:o})).catch((function(){n(t.map((function(t){return t.id===e.id?e:t})))}))},removeMember:function(e){return l(void 0,void 0,void 0,(function(){var r;return u(this,(function(a){return r=s([],c(t),!1),n(t.filter((function(t){return t.id!==e.id}))),[2,i(m.removeMember({member:e,scopeIds:o})).catch((function(){return n(r)}))]}))}))},membersByType:{pub:t.filter((function(e){return e.pubId})),collection:t.filter((function(e){return e.collectionId})),community:t.filter((function(e){return e.communityId})),organization:t.filter((function(e){return e.organizationId}))}}};t.useMembersState=function(e){var n=e.initialMembers,a=c((0,d.useState)(n),2),i=a[0],o=a[1],l=(0,t.useMembers)({members:i,updateMembers:o});return r(r({},l),{members:i})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.removeMember=t.updateMember=t.addMember=void 0;var a=n(18);t.addMember=function(e){var t=e.scopeIds,n=e.user;return(0,a.apiFetch)("/api/members",{method:"POST",body:JSON.stringify(r(r({},t),{targetUserId:n.id,value:{permissions:"view"}}))})};t.updateMember=function(e){var t=e.member,n=e.update,i=e.scopeIds;return(0,a.apiFetch)("/api/members",{method:"PUT",body:JSON.stringify(r(r({},i),{id:t.id,value:n}))})};t.removeMember=function(e){var t=e.member,n=e.scopeIds;return(0,a.apiFetch)("/api/members",{method:"DELETE",body:JSON.stringify(r(r({},n),{id:t.id}))})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineContext=void 0;var a=r(n(0));t.TimelineContext=a.default.createContext({accentColor:void 0})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(3)),c=n(6),s=n(459),d=function(e){var t=e.accentColor,n=e.className,r=e.controls,a=e.hollow,i=e.large,o=e.icon,d=e.title,f=e.subtitle,m=(0,l.useContext)(s.TimelineContext).accentColor,p=t||m;return l.default.createElement("div",{className:(0,u.default)("timeline-item-component",i&&"large",a&&"hollow",n)},l.default.createElement("div",{className:"inner"},l.default.createElement("div",{className:"left"},l.default.createElement("div",{className:"bubble",style:a?{color:p,borderColor:p}:{color:"white",backgroundColor:p}},o&&l.default.createElement(c.Icon,{icon:o,iconSize:i?20:12})),l.default.createElement("div",{className:"descender"})),l.default.createElement("div",{className:"right"},d&&l.default.createElement("div",{className:"title"},d),f&&l.default.createElement("div",{className:"subtitle"},f),r&&l.default.createElement("div",{className:"controls"},r))))};d.defaultProps={accentColor:null,className:"",controls:null,hollow:!1,large:!1,icon:null,title:null,subtitle:null},t.default=d},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.createInitialState=t.updateThread=t.updatePub=void 0;var i=n(462),o=n(62),l=function(e,t){return"function"==typeof t?t(e):t};t.updatePub=function(e,t,n){return r(r({},e),{pubStates:e.pubStates.map((function(e){if(e.pub.id===t.pubId){var a=l(e,n);return a?r(r({},e),a):null}return e})).filter((function(e){return!!e}))})};t.updateThread=function(e,n,a){var i=n.pubId,o=n.threadId;return(0,t.updatePub)(e,{pubId:i},(function(e){return r(r({},e),{threadStates:e.threadStates.map((function(e){if(e.thread.id===o){var t=l(e,a);return t?r(r({},e),t):null}return e})).filter((function(e){return!!e}))})}))};var u=function(e,t){return e.concat().sort((function(e,n){return t(e)<t(n)?1:-1}))},c=function(e){var t=a((0,o.splitArrayOn)(e,(function(e){return e.initiallyUnread})),2),n=t[0],r=t[1];return(0,o.flattenOnce)([n,r].map((function(e){return u(e,(function(e){return e.latestUnreadTimestamp}))})))},s=function(e,t,n,l){var c,s=null!==(c=n.subscriptions.find((function(t){return t.threadId===e.id})))&&void 0!==c?c:null,d=function(e){var t=a((0,o.splitArrayOn)(e,(function(e){return e.isRead})),2),n=t[0],r=t[1];return(0,o.flattenOnce)([r,n].map((function(e){return u(e,(function(e){return e.activityItem.timestamp}))})))}(t),f=function(e,t,n){var a=-1+new Set(e.map((function(e){return e.actorId}))).size;return e.map((function(e){return(0,i.renderActivityItem)(e,r(r({},t),{scope:n,otherActorsCount:a}))}))}(d.map((function(e){return e.activityItem})),n,{communityId:l.communityId,pubId:l.id});return{thread:e,subscription:s,activityItems:f,initiallyUnread:t.some((function(e){return!e.isRead})),latestUnreadTimestamp:d[0].activityItem.timestamp,notifications:d,location:{pubId:l.id,threadId:e.id}}},d=function(e,t,n){var r,i=n.associations,l=n.subscriptions,c={pubId:e.id},d=(0,o.bucketBy)(t,(function(e){return e.activityItem.payload.threadId})),f=null!==(r=l.find((function(t){return t.pubId===e.id})))&&void 0!==r?r:null,m=i.community[e.communityId],p=Object.entries(d).map((function(t){var r=a(t,2),o=r[0],l=r[1];return s(i.thread[o],l,n,e)})),h=function(e){var t=a((0,o.splitArrayOn)(e,(function(e){return e.initiallyUnread})),2),n=t[0],r=t[1];return(0,o.flattenOnce)([n,r].map((function(e){return u(e,(function(e){var t;return null===(t=e.notifications[0])||void 0===t?void 0:t.activityItem.timestamp}))})))}(p);return{location:c,pub:e,community:m,subscription:f,threadStates:h,initiallyUnread:p.some((function(e){return e.initiallyUnread})),latestUnreadTimestamp:h[0].latestUnreadTimestamp}};t.createInitialState=function(e){var t=e.notifications,n=e.associations,r=e.notificationPreferences,i=(0,o.bucketBy)(t,(function(e){return e.activityItem.pubId})),l=Object.entries(i).map((function(t){var r=a(t,2),i=r[0],o=r[1];return d(n.pub[i],o,e)}));return{pubStates:c(l),hasNotifications:l.length>0,notificationPreferences:r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderActivityItem=void 0;var r=n(1224);Object.defineProperty(t,"renderActivityItem",{enumerable:!0,get:function(){return r.renderActivityItem}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collectionTitle=void 0;var r=n(40),a=n(106),i="the Collection";t.collectionTitle=function(e,t){if("collectionId"in t.scope&&t.scope.collectionId===e.collectionId)return{title:"this Collection"};var n=(0,a.getCollectionFromContext)(e.collectionId,t);return n?{prefix:i,title:n.title,href:(0,r.getDashUrl)({collectionSlug:n.slug})}:"collection"in e.payload?{prefix:i,title:e.payload.collection.title}:{prefix:i,title:"an unknown Collection"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.communityTitle=void 0;var r=n(35),a=n(106);t.communityTitle=function(e,t){if(!("pubId"in t.scope)&&!("collectionId"in t.scope)&&t.scope.communityId===e.communityId)return{title:"this Community"};var n=(0,a.getCommunityFromContext)(e.communityId,t);return n?{prefix:"the Community",title:n.title,href:(0,r.communityUrl)(n)}:"community"in e.payload?{prefix:"the Community",title:e.payload.community.title}:{title:"an unknown Community"}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pubTitle=void 0;var a=r(n(0)),i=n(6),o=n(40),l=n(106);t.pubTitle=function(e,t){if("pubId"in t.scope&&e.pubId===t.scope.pubId)return{title:"this Pub"};var n=(0,l.getPubFromContext)(e.pubId,t);return n?{prefix:"the Pub",title:a.default.createElement(i.PubTitle,{pubData:n}),href:(0,o.getDashUrl)({pubSlug:n.slug})}:"pub"in e.payload?{prefix:"the Pub",title:e.payload.pub.title}:{title:"an unknown Pub"}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(9),o=n(6);n(1248);t.default=function(e){var t=e.isMobile,n=(0,i.usePageContext)().scopeData.elements,r="Community",l="office";return n.activeCollection&&(r="Collection",l="collection"),n.activePub&&(r="Pub",l="pubDoc"),a.default.createElement("div",{className:"scope-picker-component"},a.default.createElement(o.MenuButton,{"aria-label":t?"Mobile Dash Menu":"Dashboard Menu",buttonContent:a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"top"},r),!t&&a.default.createElement("div",{className:"bottom"},"Dashboard")),buttonProps:{icon:a.default.createElement(o.Icon,{icon:l}),className:"scope-button",fill:!0,minimal:!0,rightIcon:"caret-down"},placement:t?"top-start":"bottom-start",className:"scope-picker-menu"},a.default.createElement(o.ScopeDropdown,{isDashboard:!0})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=c(n(3)),f=n(5),m=n(1252),p=n(6),h=n(9),b=n(40),v=n(74),y=n(18),g=n(222);n(1253);var _=[{key:"tag",description:"A lightweight collection of thematically related pubs"},{key:"issue",description:"Organize your pubs into an issue of your journal"},{key:"book",description:"Arrange pubs into chapters for a longer texts"},{key:"conference",description:"Host a conference on PubPub"}];t.default=function(e){var t=e.isOpen,n=e.onClose,a=(0,h.usePageContext)().communityData,i=u((0,s.useState)(!1),2),o=i[0],c=i[1],E=u((0,s.useState)(null),2),P=E[0],w=E[1],O=u((0,s.useState)(""),2),C=O[0],S=O[1],D=u((0,s.useState)(""),2),k=D[0],j=D[1],M=(0,m.useRadioState)({state:"tag"}),N=function(){return c(!0),w(null),(0,y.apiFetch)("/api/collections",{method:"POST",body:JSON.stringify({communityId:a.id,title:k,kind:M.state})}).then((function(e){window.location.href=(0,b.getDashUrl)({collectionSlug:e.slug})})).catch((function(e){c(!1);var t="forbidden-slug"===(null==e?void 0:e.type)?e.slugStatus:"available";if("available"!==t){var n=(0,g.getSlugError)(k,t);S(n)}else w(e)}))};return s.default.createElement(f.Overlay,{className:"create-collection-dialog-component",isOpen:t,onClose:n},s.default.createElement(f.Card,{className:"dialog-card",elevation:4},s.default.createElement("h4",null,"Create a new Collection"),s.default.createElement("div",{className:"collection-creation-controls"},s.default.createElement(f.ControlGroup,null,s.default.createElement(f.InputGroup,{large:!0,className:"collection-title-input",placeholder:"Enter collection title...",value:k,onKeyDown:function(e){"Enter"===e.key&&k&&N()},onChange:function(e){j(e.target.value)}}),s.default.createElement(f.Button,{large:!0,onClick:N,disabled:!k,loading:o},"Create")),P&&s.default.createElement(f.Callout,{className:"error-callout",intent:"warning",title:"Error creating Collection."}),C&&s.default.createElement(f.Callout,{className:"error-callout",intent:"danger",title:C}),s.default.createElement(m.RadioGroup,r({},M,{"aria-label":"Choose collection type",className:"kind-buttons"}),_.map((function(e){var t=e.key,n=e.description;return s.default.createElement(m.Radio,r({},M,{key:t,value:t}),(function(e){var a=e.checked,i=l(e,["checked"]);return s.default.createElement("button",r({type:"button",className:(0,d.default)("bp3-button","bp3-outlined","kind-button",a&&"bp3-active")},i),s.default.createElement(p.Icon,{icon:(0,v.getSchemaForKind)(t).bpDisplayIcon}),s.default.createElement("div",{className:"text"},s.default.createElement("div",{className:"title"},t),s.default.createElement("div",null,n)))}))}))))))}},,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),l=i(n(3)),u=i(n(0)),c=n(165),s=n(420),d=n(6),f=n(57),m=i(n(1293));n(1296);var p=function(e,t){return void 0===t&&(t=c.RelationType.Reply),r({relationType:t,pubIsParent:!0},e)},h=function(e){if(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText}return e};t.default=function(e){var t=e.onChange,n=e.onCancel,i=e.onSave,b=e.pubData,v=e.pubEdge,y=e.usedPubIds,g=e.loading,_=e.error,E=e.saveButtonLabel,P=v&&c.relationTypeDefinitions[v.relationType]&&c.relationTypeDefinitions[v.relationType].name,w=function(e){var n=e.targetPub,a=e.externalPublication,i=e.createNewFromUrl;n?t(p({targetPub:n,targetPubId:n.id})):a?t(p({externalPublication:r(r({},a),{description:h(a.description)})})):i&&t(p({externalPublication:{url:i,contributors:[]}}))},O=function(){(0,s.assert)(null!==v),t(r(r({},v),{pubIsParent:!v.pubIsParent}))},C=function(){(0,s.assert)(null!==v),i(v)};return u.default.createElement("div",{className:(0,l.default)("new-edge-editor-component",v&&"has-new-edge")},u.default.createElement("h4",null,"Connection Properties"),v?function(){(0,s.assert)(null!==v);var e=v.externalPublication,i=v.targetPub||e&&e.title;return u.default.createElement("div",{className:"new-edge-controls"},u.default.createElement("div",{className:"controls-row"},u.default.createElement(f.MenuButton,{"aria-label":"Select relationship type",buttonProps:{rightIcon:"chevron-down",children:"Type: "+P}},Object.entries(c.relationTypeDefinitions).map((function(e){var n=a(e,2),i=n[0],o=n[1].name,l=v.relationType===i;return u.default.createElement(f.MenuItem,{text:o,onClick:function(){return function(e){(0,s.assert)(null!==v),t(r(r({},v),{relationType:e}))}(i)},key:i,icon:l?"tick":"blank"})}))),u.default.createElement(o.Button,{icon:"swap-vertical",onClick:O},"Switch direction")),u.default.createElement(d.PubEdgeListingCard,{pubData:b,isInboundEdge:!1,pubEdge:v,pubEdgeElement:e&&u.default.createElement(d.PubEdgeEditor,{externalPublication:e,onUpdateExternalPublication:function(n){return t(r(r({},v),{externalPublication:r(r({},e),n)}))},pubData:b})}),_&&u.default.createElement(o.Callout,{intent:"warning",className:"error-callout"},"There was an error creating this Pub connection."),u.default.createElement("div",{className:"controls-row"},u.default.createElement(o.Button,{className:"cancel-button",onClick:n},"Cancel"),u.default.createElement(o.Button,{intent:"primary",onClick:C,loading:g,disabled:!i},null!=E?E:"Add connection")))}():u.default.createElement(m.default,{usedPubIds:y,onSelectItem:w}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractDoiFromOrgUrl=t.extractDoi=t.isDoi=t.DOI_ORG_PATTERN=t.DOI_PATTERN=void 0,t.DOI_PATTERN=/\b10\.(?:97[89]\.\d{2,8}\/\d{1,7}|\d{4,9}\/\S+)/,t.DOI_ORG_PATTERN=/doi\.org$/;t.isDoi=function(e){return"string"==typeof e&&t.DOI_PATTERN.test(e)};t.extractDoi=function(e){var n=e.match(t.DOI_PATTERN);return n?n[0]:null};t.extractDoiFromOrgUrl=function(e){var n=e.hostname,r=e.pathname;return t.DOI_ORG_PATTERN.test(n)?(0,t.extractDoi)(r):null}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=u(n(3)),d=n(5),f=n(6),m=n(40),p=n(9),h=n(473),b=n(284),v=u(n(474));n(1308);var y=c.default.forwardRef((function(e,t){var n=e.className,r=e.collection,a=e.isOpen,i=e.onToggleOpen,u=e.isLoading,y=r.title,g=r.slug,_=(0,p.usePageContext)().communityData,E=(0,c.useCallback)((function(e){i&&(i(),e.stopPropagation())}),[i]),P=(0,b.renderLabelPairs)(l(l([],o((0,b.getScopeSummaryLabels)(r.scopeSummary,!0)),!1),[(0,b.getCollectionPublicStateLabel)(r),(0,b.getCollectionKindLabel)(r)],!1)),w=c.default.createElement(d.Button,{"aria-label":a?"collapse Collection":"expand Collection",onClick:E,minimal:!0,icon:c.default.createElement(f.Icon,{iconSize:h.iconSize,icon:a?"collapse-all":"expand-all",color:_.accentColorDark}),loading:u});return c.default.createElement(v.default,{onClick:i,className:(0,s.default)("collection-overview-row-component",n),title:y,leftIcon:"collection",href:(0,m.getDashUrl)({collectionSlug:g}),details:P,withHoverEffect:!a,rightElement:w,ref:t})}));t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iconSize=void 0,t.iconSize=16},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(3)),c=n(6),s=n(473);n(1307);var d=l.default.forwardRef((function(e,t){var n=e.className,r=e.leftIcon,a=e.details,i=e.title,o=e.byline,d=e.rightElement,f=void 0===d?null:d,m=e.withBorder,p=void 0===m||m,h=e.withHoverEffect,b=void 0!==h&&h,v=e.darkenRightIcons,y=void 0!==v&&v,g=e.onClick,_=e.href,E=(0,l.useRef)(null),P=(0,l.useCallback)((function(e){e.target===E.current&&e.preventDefault()}),[]),w=(0,l.useCallback)((function(e){e.stopPropagation()}),[]),O="string"==typeof r?l.default.createElement(c.Icon,{icon:r,className:"left-icon",iconSize:s.iconSize}):r;return l.default.createElement("div",{onClick:g,ref:t,onMouseDown:P,className:(0,u.default)("overview-row-skeleton-component",b&&"with-hover-effect",p&&"with-border",n)},O,l.default.createElement("div",{className:"center-container",ref:E},l.default.createElement("a",{href:_,className:"title",onClick:w},i),o&&l.default.createElement("div",{className:"byline"},o),a),l.default.createElement("div",{className:(0,u.default)("right-element",y&&"darker")},f))}));t.default=d},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3));n(1310);t.default=function(e){var t=e.children,n=e.style,r=e.className;return a.default.createElement("ul",{style:n,className:(0,i.default)("overview-rows-component",r)},a.default.Children.map(t,(function(e,t){return e?a.default.createElement("li",{key:t},e):null})))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(5),c=n(6),s=n(35),d=n(40),f=n(9),m=i(n(474)),p=n(284);t.default=function(e){var t=e.pub,n=e.className,i=e.inCollection,h=e.leftIconElement,b=void 0===h?null:h,v=e.labels,y=void 0===v?null:v,g=e.rightElement,_=(0,f.usePageContext)().communityData,E=g||o.default.createElement(u.AnchorButton,{minimal:!0,icon:"circle-arrow-right",href:(0,s.pubUrl)(_,t),target:"_blank"}),P=a(a([],r(y||[]),!1),r((0,p.getTypicalPubLabels)(t)),!1);return o.default.createElement(m.default,{className:(0,l.default)("pub-overview-row-component",n),title:o.default.createElement(c.PubTitle,{pubData:t}),href:(0,d.getDashUrl)({pubSlug:t.slug,collectionSlug:null==i?void 0:i.slug}),byline:o.default.createElement(c.PubByline,{pubData:t,linkToUsers:!1,truncateAt:8}),details:(0,p.renderLabelPairs)(P),leftIcon:b||"pubDoc",rightElement:E,darkenRightIcons:!!i})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(112),o=n(5),l=n(6),u=r(n(285));n(1312);t.default=function(e){var t=e.isLoading,n=e.isDark,r=e.onClick;return a.default.createElement(i.Button,{as:u.default,onClick:r,isDark:n,className:"load-more-pubs-row-component",disabled:t},!t&&a.default.createElement(l.Icon,{icon:"chevron-down",iconSize:18}),t&&a.default.createElement(o.Spinner,{size:14}),a.default.createElement("span",{className:"label"},t?"Loading Pubs...":"Load more Pubs"))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useCollectionState=t.useCollectionPubs=void 0;var s=n(0),d=n(164),f=n(9),m=c(n(199)),p=n(286),h=o(n(279)),b=n(1332);t.useCollectionPubs=function(e){var t=e.collection,n=e.pubs,a=e.initialCollectionPubs,i=t.id,o=(0,f.usePageContext)().communityData.id,c=(0,f.usePendingChanges)().pendingPromise,m=l((0,s.useState)((function(){return(0,d.sortByRank)(a)})),2),p=m[0],v=m[1],y=l((0,s.useState)(t.scopeSummary),2),g=y[0],_=y[1],E=function(e){v(p.map((function(t){return t.id===e.id?e:t})))};return{addCollectionPub:function(e){c(h.addCollectionPub({collectionId:i,communityId:o,pubId:e.id}).then((function(t){_((function(t){return r(r({},(0,b.addScopeSummaries)(t,e.scopeSummary)),{pubs:t.pubs+1})})),v((function(e){return(0,d.sortByRank)(u(u([],l(e),!1),[t],!1))}))})))},collectionPubs:p,removeCollectionPub:function(e){var t=n.find((function(t){return t.id===e.pubId}));t&&_((function(e){return r(r({},(0,b.subtractScopeSummaries)(e,t.scopeSummary)),{pubs:e.pubs-1})})),c(h.removeCollectionPub({communityId:o,id:e.id})),v(p.filter((function(t){return t.id!==e.id})))},reorderCollectionPubs:function(e,t){var n=u([],l(p),!1),a=l(n.splice(e,1),1)[0],i=(0,d.findRankInRankedList)(n,t),s=r(r({},a),{rank:i});n.splice(t,0,s),c(h.updateCollectionPub({communityId:o,id:s.id,update:{rank:i}})),v(n)},setCollectionPubContextHint:function(e,t){c(h.updateCollectionPub({communityId:o,id:e.id,update:{contextHint:t}})),E(r(r({},e),{contextHint:t}))},setCollectionPubIsPrimary:function(e){var t=e.pubId,a=n.find((function(e){return e.id===t}));if(a&&a.collectionPubs){var i=(0,d.findRankInRankedList)(a.collectionPubs,0,"pubRank");c(h.updateCollectionPub({communityId:o,id:e.id,update:{pubRank:i}})),E(r(r({},e),{pubRank:i}))}},scopeSummary:g}};t.useCollectionState=function(e){var t=(0,f.usePageContext)(),n=t.updateCollection,a=t.communityData,i=(0,f.usePendingChanges)().pendingPromise,o=(0,p.usePersistableState)(e,(function(t){return i(h.updateCollection({communityId:a.id,collectionId:e.id,updatedCollection:t})).then((function(){return n(t)}))})),l=o.state,u=o.error,c=o.update,d=o.hasChanges,b=o.persist,v=(0,s.useMemo)((function(){return function(e,t){var n,a,i=null===(n=t.pages)||void 0===n?void 0:n.find((function(t){return t.id===e.pageId})),o=null===(a=e.attributions)||void 0===a?void 0:a.map(m.default);return r(r({},e),{page:i,attributions:o})}(l,a)}),[l,a]);return{slugStatus:"forbidden-slug"===(null==u?void 0:u.type)?u.slugStatus:"available",collection:v,hasChanges:d,persistCollection:b,updateCollection:function(e){return c(e,!0)},deleteCollection:function(){return i(h.deleteCollection({communityId:a.id,collectionId:v.id}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderJournalCitationForCitations=t.renderJournalCitation=t.citationInlineStyles=t.citationStyles=void 0,t.citationStyles=[{key:"acm-siggraph",name:"ACM SIGGRAPH",path:"./citeStyles/acm-siggraph.csl"},{key:"american-anthro",name:"American Anthropological Association",path:"./citeStyles/american-anthropological-association.csl"},{key:"apa",name:"APA 6th Edition",path:"./citeStyles/apa-6th-edition.csl"},{key:"apa-7",name:"APA 7th Edition",path:"./citeStyles/apa-7th-edition.csl"},{key:"arcadia-science",name:"Arcadia Science",path:"./citeStyles/arcadia-science.csl"},{key:"cell",name:"Cell",path:"./citeStyles/cell.csl"},{key:"chicago",name:"Chicago",path:"./citeStyles/chicago-author-date.csl"},{key:"harvard",name:"Harvard",path:"./citeStyles/harvard-cite-them-right.csl"},{key:"elife",name:"ELife",path:"./citeStyles/elife.csl"},{key:"frontiers",name:"Frontiers",path:"./citeStyles/frontiers.csl"},{key:"mla",name:"MLA",path:"./citeStyles/modern-language-association.csl"},{key:"ama",name:"AMA",path:"./citeStyles/american-medical-association.csl"},{key:"vancouver",name:"Vancouver",path:"./citeStyles/vancouver.csl"}],t.citationInlineStyles=[{key:"count",title:"Count",example:"[1]"},{key:"authorYear",title:"Author-Year",example:"(Goodall, 1995)"},{key:"author",title:"Author",example:"(Goodall)"},{key:"label",title:"Label",example:"(bibtexKey)"}];t.renderJournalCitation=function(e,t,n){return"issue"===e&&t||n};t.renderJournalCitationForCitations=function(e,n,r){return{"container-title":(0,t.renderJournalCitation)(e,n,r)}}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(107),f=u(n(173)),m=u(n(58));n(1358);var p=function(e){function t(t){var n=e.call(this,t)||this;return n.getFilteredItems=n.getFilteredItems.bind(n),n.state={filteredItems:n.getFilteredItems(t,""),query:""},n.filterItems=n.filterItems.bind(n),n.handleSelect=n.handleSelect.bind(n),n}return a(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({filteredItems:this.getFilteredItems(e,"")})},t.prototype.getFilteredItems=function(e,t){var n=e.usedItems.map((function(e){return e.id}));return e.items.filter((function(e){var r=(0,f.default)(t.toLowerCase(),e.title.toLowerCase()),a=(0,f.default)(t.toLowerCase(),e.slug.toLowerCase()),i=n.indexOf(e.id)>-1;return e.slug&&!i&&(r||a)})).sort((function(e,t){return e.title<t.title?-1:e.title>t.title?1:0}))},t.prototype.filterItems=function(e){var t=this.getFilteredItems(this.props,e);this.setState({query:e,filteredItems:t})},t.prototype.handleSelect=function(e){this.props.onSelect(e),this.filterItems("")},t.prototype.render=function(){return c.default.createElement("div",{className:"page-autocomplete-component"},c.default.createElement(d.Suggest,{className:"input",items:this.state.filteredItems,inputProps:{placeholder:this.props.placeholder,rightElement:c.default.createElement(m.default,{icon:"caret-down"}),small:!0},query:this.state.query,onQueryChange:this.filterItems,inputValueRenderer:function(){},itemRenderer:function(e,t){var n=t.handleClick,r=t.modifiers;return c.default.createElement("li",{key:e.id},c.default.createElement("span",{role:"button",tabIndex:-1,onClick:n,className:r.active?"bp3-menu-item bp3-active":"bp3-menu-item"},c.default.createElement("span",{className:"title"},e.title)))},onItemSelect:this.handleSelect,resetOnSelect:!0,noResults:c.default.createElement(s.MenuItem,{disabled:!0,text:"No results"}),popoverProps:{minimal:!0,position:s.Position.BOTTOM_LEFT,modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1},flip:{enabled:!1}}}}))},t}(c.Component);t.default=p},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=u(n(3)),d=n(5),f=n(6),m=n(74),p=n(163),h=u(n(480)),b=n(288);t.default=function(e){var t=e.dropdownId,n=e.NavBuilderList,r=e.index,a=e.item,i=e.newLink,u=e.isStatic,v=void 0!==u&&u,y=(0,c.useContext)(b.NavBuilderContext),g=y.updateItem,_=y.pages,E=y.collections,P=function(e,t){return c.default.createElement(c.default.Fragment,null,t&&c.default.createElement(f.Icon,{icon:t}),e)},w=function(e){return c.default.createElement(d.InputGroup,{small:!0,placeholder:"Title",onChange:function(e){g(t,r,{title:e.target.value})},value:e})};return c.default.createElement("div",{className:(0,s.default)({"nav-builder-row-component":!0,static:v})},c.default.createElement("div",{className:"top"},function(){if("type"in a){if("collection"===a.type){var e=E.find((function(e){return e.id===a.id}));if(e){var n=(0,m.getSchemaForKind)(e.kind);return P(e.title,n&&n.bpDisplayIcon)}}else if("page"===a.type){var u=_.find((function(e){return e.id===a.id}));if(u)return P(u.title,"page-layout")}return null}return"href"in a?c.default.createElement(c.default.Fragment,null,c.default.createElement(f.Icon,{icon:"link"}),w(a.title),c.default.createElement(d.InputGroup,{small:!0,className:"href-input",placeholder:"https://www.example.com",onChange:function(e){g(t,r,{href:e.target.value})},value:a.href})):(0,p.isCommunityNavigationMenu)(a)?c.default.createElement(c.default.Fragment,null,w(a.title),c.default.createElement(h.default,{items:_,placeholder:"Add Page",usedItems:_.filter((function(e){return a.children.some((function(t){return t===e.id||t.id===e.id}))})),onSelect:function(e){var n={type:"page",id:e.id};g(t,r,{children:l([n],o(a.children),!1)})}}),c.default.createElement(h.default,{items:E,placeholder:"Add Collection",usedItems:E.filter((function(e){return a.children.some((function(t){return t.id===e.id}))})),onSelect:function(e){var n={type:"collection",id:e.id};g(t,r,{children:l([n],o(a.children),!1)})}}),c.default.createElement(d.Button,{small:!0,text:"Add Link",onClick:function(){g(t,r,{children:l([i],o(a.children),!1)})}})):null}()),(0,p.isCommunityNavigationMenu)(a)?c.default.createElement("div",{className:"children"},c.default.createElement(n,{id:a.id,items:a.children,pages:_,newLink:i})):null)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1384);t.default=function(e){var t=e.initialContent,n=e.onContent,r=e.placeholder;return a.default.createElement("div",{className:"workflow-text-editor-component"},a.default.createElement(i.MinimalEditor,{initialContent:t,onEdit:function(e){return n(e.toJSON())},getButtons:function(e){return e.workflowButtonSet},placeholder:r,useFormattingBar:!0,constrainHeight:!0}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=void 0;var i=n(0),o=n(71),l=n(137),u=n(6),c=n(1394);t.useLocalStorage=function(e){var t=e.communityId,n=e.featureName,s=e.path,d=e.initial,f=e.debounce,m=void 0===f?0:f,p=e.warnBeforeUnload,h=void 0!==p&&p;if(!(0,i.useContext)(u.ClientOnlyContext).isClientOnly)throw new Error("");var b=(0,i.useMemo)((function(){return s.reduce((function(e,t){return e.getChild(t)}),(0,c.getCommunityLocalStorage)(t,n))}),a([t,n],r(s),!1)),v=r((0,i.useState)((function(){return b.getItem()})),1)[0],y=r((0,i.useState)((function(){return null!=v?v:d()})),2),g=y[0],_=y[1],E=r((0,l.useDebounce)(g,m),1)[0],P=g===E;return(0,i.useEffect)((function(){b.setItem(E)}),[b,E]),(0,o.useBeforeUnload)(!P&&h),{value:g,setValue:_,initialValue:v,flushed:P}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(5),f=n(274),m=n(9),p=n(159),h=n(35),b=n(485),v=c(n(482)),y=c(n(1396)),g=c(n(1398)),_=n(486);n(1401);var E={title:b.isNonEmptyString,introText:b.isNonEmptyDocJson,instructionsText:b.isNonEmptyDocJson,receivedEmailText:b.isAlwaysValid,acceptedText:b.isAlwaysValid,declinedText:b.isAlwaysValid,targetEmailAddresses:b.isValidEmailList,enabled:b.isAlwaysValid,requireAbstract:b.isAlwaysValid,requireDescription:b.isAlwaysValid},P=s.default.createElement(s.default.Fragment,null,"You can leave it blank if you don't have anything you want to add.");t.default=function(e){var t=e.collection,n=e.onUpdateWorkflow,a=e.onValidateWorkflow,i=e.workflow,o=e.finalStepButton,c=void 0===o?null:o,w=(0,m.usePageContext)().communityData,O=w.email,C=l((0,s.useState)("instructions-requirements"),2),S=C[0],D=C[1],k=l((0,s.useState)((function(){return(0,b.validate)(i,E)})),2),j=k[0],M=j.validatedFields,N=j.isValidated,I=k[1],x=(0,p.withValue)((0,h.collectionUrl)(w,t),(function(e){return s.default.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},e)})),T=function(e){var t=r(r({},i),e),a=(0,b.validate)(t,E);I(a),n(e)},A={community:w,from:"submissions@mg.pubpub.org",to:"submitter.name@place.org",cc:i.targetEmailAddresses};(0,s.useEffect)((function(){a(N)}),[a,N]);var R;return s.default.createElement("div",{className:"submission-workflow-editor-component"},s.default.createElement(g.default,{selectedStep:S,onSelectStep:D,stepCompletions:{"instructions-requirements":M.title&&M.instructionsText,"response-emails":M.targetEmailAddresses,"layout-banner":M.introText}}),s.default.createElement("div",{className:"step-content"},"instructions-requirements"===S&&(R=(new Date).getFullYear().toString(),s.default.createElement(s.default.Fragment,null,s.default.createElement(d.Label,null,s.default.createElement("h2",null,"Workflow title"),s.default.createElement("p",null,"For example, ",s.default.createElement("i",null,"Summer ",R," Special Issue: Call for Submissions"),". Submitters will see this, not the Collection title."),s.default.createElement(d.InputGroup,{large:!0,onChange:function(e){return T({title:e.target.value})},value:i.title,placeholder:"Call for Submissions"})),s.default.createElement("h2",null,"Detailed submission instructions"),s.default.createElement("p",null,"...for content, formatting, etc. Submitters will be able to refer to these at any time."),s.default.createElement(v.default,{placeholder:"Detailed submission instructions",initialContent:i.instructionsText,onContent:function(e){return T({instructionsText:e})}}),s.default.createElement("h2",null,"Submission requirements"),s.default.createElement(d.FormGroup,{helperText:s.default.createElement(s.default.Fragment,null,"We'll merge the abstract into the Pub when it is submitted.")},s.default.createElement(d.Checkbox,{label:"Require an abstract",checked:i.requireAbstract,onChange:function(){return T({requireAbstract:!i.requireAbstract})}})),s.default.createElement(d.FormGroup,{helperText:s.default.createElement(s.default.Fragment,null,"A short editorial subtitle shown in the Pub header and in links to the Pub. You may want this for relatively self-serve workflows.")},s.default.createElement(d.Checkbox,{label:"Require a description",checked:i.requireDescription,onChange:function(){return T({requireDescription:!i.requireDescription})}})))),"response-emails"===S&&s.default.createElement("div",{className:"email-step"},s.default.createElement("h2",null,"Email correspondence addresses"),s.default.createElement("p",null,"Once a submission is completed, PubPub will email the submitter with an automated response and CC these addresses (that you control):"),s.default.createElement("div",{className:"target-email-input"},s.default.createElement(d.TagInput,{values:i.targetEmailAddresses,intent:i.targetEmailAddresses&&!M.targetEmailAddresses?"danger":void 0,placeholder:"Submissions email address(es)",onChange:function(e){return T({targetEmailAddresses:e})},addOnBlur:!0}),O&&s.default.createElement(d.Button,{disabled:i.targetEmailAddresses.indexOf(O)>=0,onClick:function(){return T({targetEmailAddresses:u(u([],l(i.targetEmailAddresses),!1),[O],!1)})}},"Use ",O)),s.default.createElement("h2",null,"Automated submission response"),s.default.createElement("p",null,"You can customize the automated response here, perhaps with a note of thanks and an expected response time. ",P),s.default.createElement(y.default,r({},A,{kind:"received",collectionTitle:t.title,body:s.default.createElement(v.default,{placeholder:"Custom email text",initialContent:i.receivedEmailText,onContent:function(e){return T({receivedEmailText:e})}})})),s.default.createElement("h2",null,"Acceptance email template"),s.default.createElement("p",null,"This is just a template that you'll be able to modify before sending each acceptance email. ",P),s.default.createElement(y.default,r({},A,{kind:"accepted",collectionTitle:t.title,body:s.default.createElement(v.default,{placeholder:"Custom email text",initialContent:i.acceptedText,onContent:function(e){return T({acceptedText:e})}})})),s.default.createElement("h2",null,"Rejection email template"),s.default.createElement("p",null,"This is just a template that you'll be able to modify before sending each rejection email. ",P),s.default.createElement(y.default,r({},A,{kind:"declined",collectionTitle:t.title,body:s.default.createElement(v.default,{placeholder:"Custom email text",initialContent:i.declinedText,onContent:function(e){return T({declinedText:e})}})}))),"layout-banner"===S&&s.default.createElement("div",{className:"banner-step"},s.default.createElement("h2",null,"Layout banner text"),s.default.createElement("p",null,"Visitors to ",x," will see a banner inviting them to submit to this Collection. You can add a brief description of your call for submissions here."),s.default.createElement(f.LayoutSubmissionBannerSkeleton,{className:"banner-skeleton",title:i.title,content:s.default.createElement(s.default.Fragment,null,s.default.createElement(v.default,{placeholder:"Banner content",initialContent:i.introText,onContent:function(e){return T({introText:e})}}),s.default.createElement(d.Button,{className:"fake-submit-button"},"Create a submission"))}))),function(){var e=_.submissionWorkflowConfigSteps.indexOf(S),t=_.submissionWorkflowConfigSteps[e+1];if(t){var n=_.submissionWorkflowConfigStepLabels[t];return s.default.createElement(d.Button,{minimal:!0,outlined:!0,rightIcon:"arrow-right",intent:"primary",onClick:function(){return D(t)},className:"next-step-button"},"Next: ",s.default.createElement("b",null,n))}return c}())}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.validate=t.isValidEmailList=t.isTruthyAnd=t.isAlwaysValid=t.isNonEmptyDocJson=t.isNonEmptyString=void 0;var i=n(41),o=n(1395);t.isNonEmptyString=function(e){return e.length>0};t.isNonEmptyDocJson=function(e){return!(0,i.isEmptyDoc)(e)};t.isAlwaysValid=function(){return!0};t.isTruthyAnd=function(e,t){return void 0===t&&(t=!1),function(n){return n?e(n):t}};t.isValidEmailList=function(e){return!!e.length&&e.every((function(e){return(0,o.isValidEmail)(e)}))};t.validate=function(e,t){var n=Object.entries(e).reduce((function(e,n){var i,o=a(n,2),l=o[0],u=o[1],c=t[l];return c?r(r({},e),((i={})[l]=c(u),i)):e}),{});return{validatedFields:n,isValidated:!Object.values(n).some((function(e){return!e}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submissionWorkflowConfigStepLabels=t.submissionWorkflowConfigSteps=void 0,t.submissionWorkflowConfigSteps=["instructions-requirements","response-emails","layout-banner"],t.submissionWorkflowConfigStepLabels={"instructions-requirements":"Instructions & Requirements","response-emails":"Email correspondence","layout-banner":"Layout banner"}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(6);t.default=function(e){return i.default.createElement(o.DashboardFrame,r({},e,{className:"dashboard-submission-workflow-container",title:"Submission Workflow",icon:"manually-entered-data"}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1425);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(78),c=n(6);n(1434);var s=o.default.forwardRef((function(e,t){var n=e.children,i=e.className,s=void 0===i?"":i,d=e.href,f=void 0===d?null:d,m=e.icon,p=void 0===m?null:m,h=e.onClick,b=void 0===h?null:h,v=e.rightIcon,y=void 0===v?null:v,g=a(e,["children","className","href","icon","onClick","rightIcon"]);return o.default.createElement(u.Button,r({},g,{onClick:b,href:f,className:(0,l.default)("collections-bar-button-component",s),ref:t,tabIndex:"0"}),p&&o.default.createElement(c.Icon,{icon:p,iconSize:14,className:(0,l.default)(!!n&&"spaced-icon-left")}),n,y&&o.default.createElement(c.Icon,{icon:y,iconSize:14,className:"spaced-icon-right"}))}));t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pingTask=void 0;var r=n(18);t.pingTask=function(e,t,n){return void 0===n&&(n=t),new Promise((function(a,i){var o=function(){(function(e){return(0,r.apiFetch)("/api/workerTasks?workerTaskId="+e)})(e).then((function(e){e.isProcessing?setTimeout(o,t):e.error?i(new Error(e.error)):a(e.output)})).catch((function(e){return i(e)}))};setTimeout(o,n)}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(57),l=n(9),u=n(39);n(1449);t.default=function(e){var t=e.children,n=e.limitHeight,r=e.onSelect,c=void 0===r?null:r,s=e.placement,d=void 0===s?"bottom-end":s,f=(0,l.usePageContext)().scopeData,m=(0,u.usePubContext)({immediate:!0}).pubHeadings,p=f.activePermissions,h=p.canEdit,b=p.canEditDraft;return 0===m.length?null:a.default.createElement(o.Menu,{"aria-label":"Table of contents",className:(0,i.default)("pub-toc-component",n&&"limit-height"),disclosure:t,placement:d},m.map((function(e){return a.default.createElement(o.MenuItem,{key:e.index,href:"#"+e.href,className:"level-"+e.level,onClick:function(t){if(c&&c(),h||b){t.preventDefault(),document.getElementById(e.href).scrollIntoView();var n=document.body.scrollTop||document.documentElement.scrollTop;document.body.scrollTop=document.documentElement.scrollTop=n-75}},text:e.title})})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(6),c=i(n(491)),s=n(39);n(1451);t.default=function(){var e=(0,s.usePubContext)().pubData;return o.default.createElement("div",{className:"pub-header-sticky-component"},o.default.createElement("div",{className:"sticky-title"},e.title),o.default.createElement("div",{className:"sticky-buttons"},o.default.createElement(c.default,{limitHeight:!0},(function(e){var t=e.ref,n=a(e,["ref"]);return o.default.createElement(o.default.Fragment,null,o.default.createElement(l.Button,r({minimal:!0},n,{elementRef:t,className:"contents-button"}),"Contents"),o.default.createElement("span",{className:"dot"},"Â·"))})),o.default.createElement(l.Button,{minimal:!0,onClick:function(){return window.scrollTo({left:0,top:0,behavior:"auto"})},icon:o.default.createElement(u.Icon,{icon:"double-chevron-up"})})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(5),d=n(6);n(1467);t.default=function(e){var t=e.asLabel,n=void 0!==t&&t,r=e.children,a=e.fullWidth,i=void 0!==a&&a,l=e.instructions,f=e.title,m=o((0,u.useState)(!1),2),p=m[0],h=m[1],b=(0,u.useCallback)((function(){return h(!0)}),[]),v=u.default.createElement(u.default.Fragment,null,u.default.createElement("h2",{className:"title"},f,p&&function(e){if("valid"in e){var t=e.valid,n=e.invalidNotice;if(!t)return u.default.createElement(s.Tooltip,{content:u.default.createElement("span",null,n)},u.default.createElement(d.Icon,{intent:"warning",icon:"warning-sign",className:"invalid-icon",iconSize:13}))}return null}(e)),l&&u.default.createElement("p",{className:"instructions"},l),r);return u.default.createElement(n?"label":"div",{className:(0,c.default)("spub-header-field-component",i&&"full-width"),onBlur:b},v)}},,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var d=o(n(0)),f=n(5),m=o(n(41)),p=n(6),h=n(116),b=n(9),v=n(18),y=n(39),g=function(e,t){return t?"Start a discussion here (or highlight some text above to begin one inline)":e?"Add your discussion...":"Add a reply..."},_=function(e){var t=e.discussionData,n=e.isPubBottomInput,a=(0,y.usePubContext)(),i=a.pubData,o=a.historyData,_=a.collabData,E=a.updateLocalData,P=(0,b.usePageContext)(),w=P.loginData,O=P.locationData,C=P.communityData,S=_.editorChangeObject.view,D=c((0,d.useState)(),2),k=D[0],j=D[1],M=c((0,d.useState)(!1),2),N=M[0],I=M[1],x=c((0,d.useState)(!1),2),T=x[0],A=x[1],R=c((0,d.useState)(Date.now()),2),B=R[0],F=R[1],L=!t.number,U=null==k?void 0:k.view;(0,d.useEffect)((function(){!n&&(L||T)&&U&&U.focus()}),[L,U,T,n]);var z=w.id,H="?redirect="+O.path+(O.queryString.length>1?O.queryString:"");return d.default.createElement("div",{className:"thread-comment-component input"},d.default.createElement("div",{className:"avatar-wrapper"},d.default.createElement(p.Avatar,{width:18,initials:w.initials,avatar:w.avatar})),!z&&d.default.createElement(d.default.Fragment,null,d.default.createElement(f.AnchorButton,{className:"discussion-primary-button",text:"Login to discuss",href:"/login"+H,small:!0}),L&&!n&&d.default.createElement(f.Button,{className:"discussion-cancel-button",text:"Cancel",small:!0,onClick:function(){(0,m.removeLocalHighlight)(S,t.id)}})),z&&!L&&!T&&d.default.createElement("input",{type:"text",className:"simple-input",placeholder:"Add a reply...",onFocus:function(){A(!0)}}),z&&(L||T)&&d.default.createElement("div",{className:"content-wrapper"},d.default.createElement("div",{className:"discussion-body-wrapper editable"},d.default.createElement(h.FormattingBar,{editorChangeObject:k,buttons:h.buttons.discussionButtonSet,isSmall:!0}),d.default.createElement(m.default,{key:B,placeholder:g(L,n),onChange:function(e){j(e)}})),d.default.createElement(f.Button,{className:"discussion-primary-button",intent:f.Intent.PRIMARY,text:L?"Post Discussion":"Post Reply",loading:N,disabled:!(0,m.getText)(null==k?void 0:k.view)&&!(0,m.getTopLevelImages)(null==k?void 0:k.view).length,onClick:L?function(){return l(void 0,void 0,void 0,(function(){var e,r;return u(this,(function(a){switch(a.label){case 0:return I(!0),e=(0,m.getLocalHighlightText)(S,t.id),[4,(0,v.apiFetch)("/api/discussions",{method:"POST",body:JSON.stringify({accessHash:O.query.access,discussionId:t.id,pubId:i.id,historyKey:o.currentKey,communityId:C.id,content:(0,m.getJSON)(null==k?void 0:k.view),text:(0,m.getText)(null==k?void 0:k.view)||"",initAnchorData:e,visibilityAccess:i.isRelease?"public":"members"})})];case 1:return r=a.sent(),E("pub",{discussions:s(s([],c(i.discussions),!1),[r],!1)}),n?(I(!1),F(Date.now())):(0,m.convertLocalHighlightToDiscussion)(S,r.id),[2]}}))}))}:function(){return l(void 0,void 0,void 0,(function(){var e;return u(this,(function(a){switch(a.label){case 0:return I(!0),[4,(0,v.apiFetch)("/api/threadComment",{method:"POST",body:JSON.stringify({accessHash:O.query.access,parentId:t.id,threadId:t.thread.id,pubId:i.id,communityId:C.id,content:(0,m.getJSON)(null==k?void 0:k.view),text:(0,m.getText)(null==k?void 0:k.view)||""})})];case 1:return e=a.sent(),E("pub",{discussions:i.discussions.map((function(t){return t.thread.id===e.threadId?r(r({},t),{thread:r(r({},t.thread),{comments:s(s([],c(t.thread.comments),!1),[e],!1)})}):t}))}),n&&(I(!1),F(Date.now())),[2]}}))}))},small:!0}),L&&!n&&d.default.createElement(f.Button,{className:"discussion-cancel-button",text:"Cancel",small:!0,onClick:function(){(0,m.removeLocalHighlight)(S,t.id)}})))};_.defaultProps={isPubBottomInput:!1},t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bibliographyFormats=t.extensionToPandocFormat=void 0,t.extensionToPandocFormat={docx:"docx+citations",epub:"epub",html:"html",md:"markdown+tex_math_dollars",odt:"odt",txt:"markdown_strict",xml:"jats",tex:"latex"},t.bibliographyFormats=["bib","bibtex","copac","json","yaml","enl","xml","wos","medline","mods","nbib","ris"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLowestAncestorWithId=t.getHighestAncestorWithId=void 0;t.getHighestAncestorWithId=function(e,t){void 0===t&&(t=document.body);for(var n=e,r=null;n&&n!==t;)n.hasAttribute("id")&&(r=n),n=n.parentElement;return n!==t?null:r};t.getLowestAncestorWithId=function(e){for(var t=e;t&&!t.hasAttribute("id");)t=t.parentElement;return t}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(78),l=a(n(3)),u=a(n(80)),c=n(6),s=n(9),d=n(1243),f=a(n(1246)),m=a(n(1250)),p=a(n(1255)),h=a(n(1258)),b=n(1577);n(1578),n(1579);var v=function(e){var t=e.chunkName,n=e.initialData,a=e.viewData,d=(0,b.usePageState)(n,a),v=d.communityData,y=d.locationData,g=(0,h.default)(a,y,t),_=g.ActiveComponent,E=g.hideNav,P=g.hideFooter,w=g.isDashboard;"undefined"!=typeof window&&(window.__pubpub_pageContextProps__=d);var O,C,S=!E&&!v.hideNav&&!w,D=!P&&!w;return i.default.createElement(s.PageContext.Provider,{value:d},i.default.createElement(o.Provider,null,(O=v.accentColorDark,C=(0,u.default)(O).fade(.95).rgb().string(),i.default.createElement("style",{type:"text/css"},":root { \n\t\t\t\t--community-accent-dark: "+O+";\n\t\t\t\t--community-accent-dark-faded: "+C+";\n\t\t\t}")),i.default.createElement("div",{id:"app",className:(0,l.default)({dashboard:w})},i.default.createElement(c.AccentStyle,{communityData:v,isNavHidden:!S}),(y.isDuqDuq||y.isQubQub)&&i.default.createElement("div",{className:"duqduq-warning"},"Development Environment"),i.default.createElement(c.SkipLink,{targetId:"main-content"},"Skip to main content"),i.default.createElement(c.LegalBanner,null),i.default.createElement(c.Header,null),S&&i.default.createElement(c.NavBar,null),w&&i.default.createElement(c.MobileAware,{mobile:function(e){var t=e.className;return i.default.createElement(p.default,{isMobile:!0,className:t})},desktop:function(e){var t=e.className;return i.default.createElement(i.default.Fragment,null,i.default.createElement(f.default,{className:t}),i.default.createElement(m.default,{className:t}))}}),i.default.createElement("div",{id:"main-content",tabIndex:"-1"},i.default.createElement(_,r({},a))),D&&i.default.createElement(c.Footer,null))))};t.default=v,(0,d.hydrateWrapper)(v)},,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=r(n(80)),l={communityData:i.default.object.isRequired,isNavHidden:i.default.bool.isRequired},u=function(e){var t=e.communityData,n=e.isNavHidden,r=t.accentColorLight,i=t.accentColorDark,l=t.headerColorType,u=t.useHeaderTextAccent,c=function(e){return{base:e,text:(0,o.default)(e).isLight()?"#000000":"#FFFFFF",hover:(0,o.default)(e).fade(.2).rgb().string(),action:(0,o.default)(e).fade(.4).rgb().string(),minimal:(0,o.default)(e).fade(.9).rgb().string(),minimalAction:(0,o.default)(e).fade(.8).rgb().string()}},s=c(i),d=s.base,f=s.text,m=s.hover,p=s.action,h=s.minimal,b=s.minimalAction,v=c("light"===l?r:i),y="light"===l?i:r,g=".accent-color."+(n?"header-component":"nav-bar-component")+" { border-bottom: 2px solid "+y+"; }",_=".accent-color."+(n?"header-component":"nav-bar-component")+" { border-bottom: 1px solid #DDD; }",E="linear-gradient(90deg, "+(0,o.default)(v.base).rgb().fade(1).string()+" 0%,  "+(0,o.default)(v.base).rgb().fade(1).string()+" 85%,  "+v.base+" 100%);";return a.default.createElement("style",{dangerouslySetInnerHTML:{__html:"\n\t\t\t.accent-background { background-color: "+d+"; }\n\t\t\t.accent-color { color: "+f+"; }\n\t\t\t.accent-background.header-component, .accent-background.nav-bar-component, .accent-background.footer-component, .accent-background.nav-item-background, .accent-background.image-wrapper{ background-color: "+v.base+"; }\n\t\t\t.accent-color.header-component, .accent-color.nav-bar-component, .accent-color.footer-component, .accent-color.nav-item { color: "+(u?y:v.text)+"; }\n\t\t\t.bp3-button.bp3-intent-primary:not(.bp3-outlined) { background-color: "+p+"; color: "+f+"; }\n\t\t\t.bp3-button.bp3-intent-primary:not(.bp3-outlined):hover:not(.bp3-disabled) { background-color: "+m+"; color: "+f+"; }\n\t\t\t.bp3-button.bp3-intent-primary:not(.bp3-outlined):active:not(.bp3-disabled), .bp3-button.bp3-intent-primary.bp3-active:not(.bp3-disabled) { background-color: "+d+"; color: "+f+"; }\n\n\t\t\t.bp3-button.bp3-intent-primary.bp3-outlined { border-color: "+d+"; color: "+d+"; }\n\t\t\t.bp3-button.bp3-intent-primary.bp3-outlined:hover:not(.bp3-disabled) { background-color: "+h+"; color: "+d+"; }\n\t\t\t.bp3-button.bp3-intent-primary.bp3-outlined:active:not(.bp3-disabled), .bp3-button.bp3-intent-primary.bp3-active:not(.bp3-disabled) { background-color: "+b+"; color: "+d+"; }\n\n\t\t\t.bp3-button.bp3-intent-primary:not(.bp3-outlined).bp3-minimal { background-color: "+p+"; color: "+f+"; }\n\n\n\t\t\t.bp3-tag.bp3-intent-primary { background: "+d+"; color: "+f+"; }\n\t\t\t.bp3-tag.bp3-minimal.bp3-intent-primary { background-color: "+h+'; color: inherit; }\n\t\t\t.accent-color .bp3-button:not([class*="bp3-intent-"]), .accent-color .bp3-button[class*="bp3-icon-"]::before { color: inherit; }\n\t\t\t.accent-color a, .accent-color a:hover { color: inherit; }\n\t\t\t.bp3-tab[aria-selected="true"], .bp3-tab:not([aria-selected="true"]):hover { box-shadow: inset 0 -3px 0 '+h+'; }\n\t\t\t.bp3-tab[aria-selected="true"] { box-shadow: inset 0 -3px 0 '+d+"; }\n\t\t\t.thread:hover:after { background-color: "+d+"; }\n\t\t\t.bp3-slider-progress.bp3-intent-primary, .bp3-dark .bp3-slider-progress.bp3-intent-primary { background: "+d+"; }\n\t\t\t.bp3-slider-handle .bp3-slider-label { background: "+d+"; color: "+f+"; }\n\t\t\t.highlight-dot-wrapper .highlight-dot { background-color: "+d+"; }\n\n\t\t\t.changelog-callout { background: "+h+" !important; }\n\t\t\t.changelog-callout .release-label { color: "+d+"; border: 1px dashed "+d+"; }\n\n\t\t\tspan.citation:hover { color: "+d+"; }\n\n\t\t\t.overflow-gradient { background: "+E+" }\n\n\t\t\t"+(u?g:"")+"\n\t\t\t"+(!u&&v.base&&"#ffffff"===v.base.toLowerCase()?_:"")+"\n\t\t"}})};u.propTypes=l,t.default=u},,,function(e,t,n){"use strict";var r,a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0;var f=l(n(0)),m=n(5),p=d(n(566)),h=n(6),b=n(326),v=n(18),y=d(n(567));n(569);var g=function(){},_={disabled:!1,onDeposit:g,onError:g,onPreview:g},E={Initial:"initial",Previewing:"previewing",Previewed:"previewed",Depositing:"depositing",Deposited:"deposited"},P="fetch_preview",w="fetch_preview_success",O="update_content_version",C="update_review_type",S="update_review_recommendation",D="fetch_deposit",k="fetch_deposit_success",j="error",M=((r={})[E.Initial]="Preview Deposit",r[E.Previewing]="Generating Preview",r[E.Previewed]="Submit Deposit",r[E.Depositing]="Depositing",r[E.Deposited]="DOI Deposited",r),N=function(e,t){return e===E.Initial&&t?"Update & Preview Deposit":e===E.Previewed&&t?"Re-Submit Deposit":M[e]};function I(e,t){switch(t.type){case P:return e.status!==E.Initial&&e.status!==E.Error&&e.status!==E.Previewed?e:a(a({},e),{status:E.Previewing,error:null});case w:return e.status!==E.Previewing?e:a(a({},e),{status:E.Previewed,crossrefDepositRecord:t.payload,error:null});case O:if(e.status!==E.Previewed)return e;var n=a({},e.crossrefDepositRecord);return(0,b.setDepositRecordContentVersion)(n,t.payload),a(a({},e),{crossrefDepositRecord:n});case C:if(e.status!==E.Previewed)return e;n=a({},e.crossrefDepositRecord);return(0,b.setDepositRecordReviewType)(n,t.payload),a(a({},e),{crossrefDepositRecord:n});case S:if(e.status!==E.Previewed)return e;n=a({},e.crossrefDepositRecord);return(0,b.setDepositRecordReviewRecommendation)(n,t.payload),a(a({},e),{crossrefDepositRecord:n});case D:return e.status!==E.Previewed?e:a(a({},e),{status:E.Depositing,error:null});case k:return e.status!==E.Depositing?e:a(a({},e),{status:E.Deposited,crossrefDepositRecord:t.payload,error:null});case j:return a(a({},e),{status:E.Initial,error:t.payload});default:return e}}t.reducer=I;var x={status:E.Initial,preview:null,crossrefDepositRecord:null,error:null},T=[{title:"(None)",key:"none"},{title:"Preprint",key:"preprint"},{title:"Advance Manuscript",key:"am"},{title:"Version of Record",key:"vor"}],A=[{title:"(None)",key:"none"},{title:"Referee Report",key:"referee-report"},{title:"Editor Report",key:"editor-report"},{title:"Author Comment",key:"author-comment"},{title:"Community Comment",key:"community-comment"},{title:"Aggregate",key:"aggregate"},{title:"Recommendation",key:"recommendation"}],R=[{title:"(None)",key:"none"},{title:"Major Revision",key:"major-revision"},{title:"Minor Revision",key:"minor-revision"},{title:"Reject",key:"reject"},{title:"Reject with Resubmit",key:"reject-with-resubmit"},{title:"Accept",key:"accept"},{title:"Accept with Reservation",key:"accept-with-reservation"}],B=function(e){return(0,p.default)(e,(function(e){return null!=e}))};function F(e){var t=this,n=e.communityData,r=e.disabled,i=e.pubData,o=e.onPreview,l=e.onDeposit,d=e.onError,p=e.target,g=s((0,f.useReducer)(I,a(a({},x),{crossrefDepositRecord:i.crossrefDepositRecord})),2),_=g[0],M=g[1],F=_.status,L=_.crossrefDepositRecord,U=_.error,z=(0,b.getDepositRecordReviewType)(L),H=(0,b.getDepositRecordReviewRecommendation)(L),V=(0,b.getDepositRecordContentVersion)(L);!V&&(0,b.isPreprintDeposit)(L)&&(V="preprint");var q,W=V||"none",G=T.find((function(e){return e.key===W})),K=z||"none",J=A.find((function(e){return e.key===K})),Y=H||"none",$=R.find((function(e){return e.key===Y})),Q=(0,f.useMemo)((function(){return{target:p,pubId:i.id,communityId:n.id,contentVersion:V,reviewType:z,reviewRecommendation:H}}),[p,i,n,V,z,H]),Z=(0,f.useCallback)((function(e){return u(t,void 0,void 0,(function(){var t,n,r;return c(this,(function(i){switch(i.label){case 0:M({type:P}),i.label=1;case 1:return i.trys.push([1,3,,4]),t=new URLSearchParams(B(a(a({},Q),e))),[4,(0,v.apiFetch)("/api/doiPreview?"+t.toString())];case 2:return n=i.sent(),o(n),M({type:w,payload:n}),[3,4];case 3:return(r=i.sent())instanceof Error&&(M({type:j,payload:r.message}),d(r)),[3,4];case 4:return[2]}}))}))}),[Q,o,d]);F===E.Initial?q=function(){return Z()}:F===E.Previewed&&(q=function(){return u(t,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:M({type:D}),r.label=1;case 1:return r.trys.push([1,3,,4]),e=JSON.stringify(B(Q)),[4,(0,v.apiFetch)("/api/doi",{method:"POST",body:e})];case 2:return t=r.sent(),M({type:k,payload:{depositJson:t}}),l(t.dois[p]),[3,4];case 3:return(n=r.sent())instanceof Error&&(M({type:j,payload:n.message}),d(n)),[3,4];case 4:return[2]}}))}))});var X=(0,f.useRef)(i.doi);return(0,f.useEffect)((function(){X.current!==i.doi&&F===E.Previewed&&Z(),X.current=i.doi}),[i.doi,F,Z]),f.default.createElement("div",{className:"assign-doi-component"},(F===E.Previewed||F===E.Previewing)&&f.default.createElement(f.default.Fragment,null,f.default.createElement(m.Callout,{intent:"primary",title:"Review Deposit"},"This work is being deposited as a"," ",f.default.createElement("strong",null,(0,b.getDepositTypeTitle)(L)||"..."),' based on its Connections, Primary Collection, or selected Content Version. Review the information below, then click the "Submit Deposit" button to submit the deposit to Crossref.'),!(0,b.isStandaloneComponentDeposit)(L)&&f.default.createElement(h.InputField,{label:"Content Version"},f.default.createElement(h.MenuButton,{buttonContent:G.title,buttonProps:{rightIcon:"caret-down"},"aria-label":"content-version"},T.map((function(e){return f.default.createElement(h.MenuItem,{key:e.key,active:e===G,onClick:function(){return function(e){var t=e.key,n="none"===t?null:t;M({type:O,payload:n}),Z({contentVersion:n})}(e)},text:e.title})})))),(0,b.isPeerReviewDeposit)(L)&&f.default.createElement("div",{className:"dropdowns"},f.default.createElement(h.InputField,{label:"Review Type"},f.default.createElement(h.MenuButton,{buttonContent:J.title,buttonProps:{rightIcon:"caret-down"},"aria-label":"review-type"},A.map((function(e){return f.default.createElement(h.MenuItem,{key:e.key,active:e===J,onClick:function(){return function(e){var t=e.key,n="none"===t?null:t;M({type:C,payload:n}),Z({reviewType:n})}(e)},text:f.default.createElement("span",null,e.title)})})))),f.default.createElement(h.InputField,{label:"Review Recommendation"},f.default.createElement(h.MenuButton,{buttonContent:$.title,buttonProps:{rightIcon:"caret-down"},"aria-label":"review-type"},R.map((function(e){return f.default.createElement(h.MenuItem,{key:e.key,active:e===$,onClick:function(){return function(e){var t=e.key,n="none"===t?null:t;M({type:S,payload:n}),Z({reviewRecommendation:n})}(e)},text:f.default.createElement("span",null,e.title)})})))))),F===E.Previewed&&f.default.createElement(y.default,{crossrefDepositRecord:L}),f.default.createElement(h.InputField,{error:U&&"There was an error depositing the work."},f.default.createElement(m.Button,{disabled:r||!q,text:N(F,i.crossrefDepositRecord),loading:F===E.Previewing||F===E.Depositing,onClick:q,icon:F===E.Deposited&&"tick"})))}F.defaultProps=_,t.default=F},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(67),s=n(326);n(568);var d=function(e){if(!e)return null;var t=e["rel:related_item"];return 0===t.length?null:l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Relationships"),l.default.createElement("dl",null,t.map((function(e){var t=e["rel:inter_work_relation"],n=e["rel:intra_work_relation"],r=t||n,a=r["#text"],i=r["@relationship-type"];return l.default.createElement(l.default.Fragment,{key:a},l.default.createElement("dt",null,"Relationship Type"),l.default.createElement("dd",null,i),l.default.createElement("dt",null,"Identifier"),l.default.createElement("dd",null,a))}))))},f=function(e){return l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,"Title"),l.default.createElement("dd",null,e.title))},m=function(e){return l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,"Publisher"),l.default.createElement("dd",null,e.publisher_name))},p=function(e,t){void 0===t&&(t="Publication Date");var n=e.day,r=e.month,a=e.year;return l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,t),l.default.createElement("dd",null,(0,c.formatDate)(a+"-"+r+"-"+n,{inUtcTime:!0})))},h=function(e){return e?l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,"Contributors"),l.default.createElement("dd",null,e.person_name.map((function(e){return l.default.createElement("ul",{key:e.surname},e.given_name," ",e.surname," (",e["@contributor_role"],")")})))):null},b=function(e){var t=e.journal,n=t.journal_article,r=n.titles,a=n.publication_date,i=n.contributors,o=n["rel:program"],u=t.journal_metadata,c=u.full_title,s=u.doi_data.doi,m=t.journal_issue;return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Journal Article"),l.default.createElement("dl",null,f(r),p(a),h(i)),l.default.createElement("h6",null,"Journal Metadata"),l.default.createElement("dl",null,l.default.createElement("dt",null,"Title"),l.default.createElement("dd",null,c),l.default.createElement("dt",null,"DOI"),l.default.createElement("dd",null,s)),m&&function(e){var t=e.titles,n=e.publication_date,r=e.contributors;return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Journal Issue"),l.default.createElement("dl",null,f(t),p(n),h(r)))}(m),d(o))};function v(e){var t=o((0,l.useState)("preview"),2),n=t[0],r=t[1],a=e.crossrefDepositRecord,i=(0,s.getDepositBody)(a),v=a.doi,y=a.depositJson.dois,g=y.community,_=y.pub,E=a.depositXml,P=(0,s.getDepositRecordContentVersion)(a);return l.default.createElement(u.Tabs,{onChange:r,selectedTabId:n,className:"assign-doi-preview-component"},l.default.createElement(u.Tab,{id:"preview",title:"Preview",panel:l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"DOIs"),l.default.createElement("dl",null,l.default.createElement("dt",null,"Community"),l.default.createElement("dd",null,g),l.default.createElement("dt",null,"Pub"),l.default.createElement("dd",null,v||_),P&&"none"!==P&&l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,"Content Version"),l.default.createElement("dd",null,P))),(0,s.isJournalDeposit)(a)&&b(i),(0,s.isBookDeposit)(a)&&function(e){var t=e.book,n=t.book_metadata,r=n.titles,a=n.edition_number,i=n.publisher,o=n.publication_date,u=n.contributors,c=t.content_item,s=c.titles,b=c.contributors,v=c.publication_date,y=c["rel:program"];return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Book Metadata"),l.default.createElement("dl",null,f(r),l.default.createElement("dt",null,"Edition Number"),l.default.createElement("dd",null,a),m(i),h(u),p(o)),l.default.createElement("h6",null,"Content"),l.default.createElement("dl",null,f(s),h(b),p(v)),d(y))}(i),(0,s.isConferenceDeposit)(a)&&function(e){var t=e.conference,n=t.contributors,r=t.conference_paper,a=r.titles,i=r.contributors,o=r["rel:program"],u=t.event_metadata,s=u.conference_name,b=u.conference_date["#text"],v=t.proceedings_metadata,y=v.proceedings_title,g=v.publication_date,_=v.publisher;return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Conference Paper"),l.default.createElement("dl",null,f(a),h(i)),l.default.createElement("h6",null,"Event Metadata"),l.default.createElement("dl",null,l.default.createElement("dt",null,"Conference Name"),l.default.createElement("dd",null,s),l.default.createElement("dt",null,"Conference Date"),l.default.createElement("dd",null,(0,c.formatDate)(new Date(b)))),l.default.createElement("h6",null,"Proceedings Metadata"),l.default.createElement("dl",null,l.default.createElement("dt",null,"Proceedings Title"),l.default.createElement("dd",null,y),p(g),m(_)),l.default.createElement("h6",null,"Contributors"),l.default.createElement("dl",null,h(n)),d(o))}(i),(0,s.isPreprintDeposit)(a)&&function(e){var t=e.posted_content,n=t.contributors,r=t.titles,a=t["rel:program"],i=t.posted_date;return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Preprint"),l.default.createElement("dl",null,f(r),h(n),p(i,"Posted Date")),d(a))}(i),(0,s.isPeerReviewDeposit)(a)&&function(e){var t=e.peer_review,n=t["@type"],r=t["@recommendation"],a=t.contributors,i=t.titles,o=t["rel:program"],u=t.review_date;return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Peer Review"),l.default.createElement("dl",null,f(i),h(a),p(u,"Review Date"),n&&l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,"Review Type"),l.default.createElement("dd",null,n)),r&&l.default.createElement(l.default.Fragment,null,l.default.createElement("dt",null,"Review Recommendation"),l.default.createElement("dd",null,r))),d(o))}(i),(0,s.isStandaloneComponentDeposit)(a)&&function(e){var t=e.sa_component,n=t["@parent_doi"],r=t.component_list.component,a=r.contributors,i=r.titles,o=r.publication_date;return l.default.createElement(l.default.Fragment,null,l.default.createElement("h6",null,"Standalone Component"),l.default.createElement("dl",null,l.default.createElement("dt",null,"Parent DOI"),l.default.createElement("dd",null,n),l.default.createElement("dt",null,"Parent Relation"),l.default.createElement("dd",null,"isPartOf"),f(i),h(a),p(o)))}(i))}),l.default.createElement(u.Tab,{id:"xml",title:"XML",panel:l.default.createElement("pre",null,E)}))}v.defaultProps={},t.default=v},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=u(n(0)),m=n(118),p=n(5),h=n(18),b=n(6),v=d(n(606)),y=d(n(236));n(612);var g={listOnBylineText:"List on byline",onPersistStateChange:function(){},promiseWrapper:function(e){return e},hasEmptyState:!0},_=function(e){function t(t){var n=e.call(this,t)||this;return n.handleDragEnd=n.handleDragEnd.bind(n),n.handleAttributionAdd=n.handleAttributionAdd.bind(n),n.handleAttributionUpdate=n.handleAttributionUpdate.bind(n),n.handleAttributionDelete=n.handleAttributionDelete.bind(n),n}return a(t,e),t.prototype.persistAttribution=function(e,t){var n=this.props,r=n.apiRoute,a=n.identifyingProps;return(0,n.promiseWrapper)((0,h.apiFetch)(r,{method:t,body:JSON.stringify(i(i({},e),a))}))},t.prototype.handleAttributionAdd=function(e){var t=this,n=this.props,r=n.attributions,a=n.onUpdateAttributions,i=n.onPersistStateChange,o=.5+(r.length?Math.max.apply(Math,s([],c(r.map((function(e){return e.order}))),!1)):0)/2;i(1),this.persistAttribution({userId:e.id,name:e.name,order:o,isAuthor:!0},"POST").then((function(e){var n=t.props.attributions;a(s(s([],c(n),!1),[e],!1)),i(-1)}))},t.prototype.handleAttributionUpdate=function(e){var t=this.props,n=t.attributions,r=t.onUpdateAttributions,a=t.onPersistStateChange;r(n.map((function(t){return t.id!==e.id?t:i(i({},t),e)}))),a(1),this.persistAttribution(e,"PUT").then((function(){return a(-1)}))},t.prototype.handleAttributionDelete=function(e){var t=this.props,n=t.attributions,r=t.onUpdateAttributions,a=t.onPersistStateChange;r(n.filter((function(t){return t.id!==e}))),a(1),this.persistAttribution({id:e},"DELETE").then((function(){return a(-1)}))},t.prototype.handleDragEnd=function(e){var t=this.props,n=t.attributions,r=t.identifyingProps,a=t.onUpdateAttributions;if(e.destination){var o=e.source.index,l=n[o].id,u=e.destination.index,c=n[u].order,s=o>u?-1:1,d=.5;if(o===u)d=n[o].order;else if(0===u)d=c/2;else if(u===n.length-1)d=(1+c)/2;else{var f=n[u+s].order;d=(c+f)/2}this.handleAttributionUpdate(i(i({},r),{id:l,order:d})),a(n.map((function(e){return e.id!==l?e:i(i({},e),{order:d})})).sort((function(e,t){return e.order-t.order})))}},t.prototype.render=function(){var e=this,t=this.props,n=t.attributions,r=t.canEdit,a=t.listOnBylineText,i=t.hasEmptyState,o=n.concat().sort((function(e,t){return e.order-t.order}));return f.default.createElement("div",{className:"attribution-editor-component"},r&&f.default.createElement(f.default.Fragment,null,f.default.createElement(b.UserAutocomplete,{onSelect:this.handleAttributionAdd,allowCustomUser:!0,placeholder:"Add new person...",usedUserIds:n.map((function(e){return e.user&&e.user.id})).filter((function(e){return e}))}),f.default.createElement(m.DragDropContext,{onDragEnd:this.handleDragEnd},f.default.createElement(y.default,{droppableType:"ATTRIBUTION",droppableId:"attributionEditor",items:o,itemId:function(e){return e.id},withDragHandles:!0,renderItem:function(t,n,r){return f.default.createElement(v.default,{attribution:t,canEdit:!0,isDragging:r,dragHandleProps:n,onAttributionDelete:e.handleAttributionDelete,onAttributionUpdate:e.handleAttributionUpdate,listOnBylineText:a})},renderEmptyState:function(){return i&&f.default.createElement(p.NonIdealState,{icon:"person",title:"No contributors yet!",description:"Start typing a person's name above to add a contributor."})}}))),!r&&o.map((function(e){return f.default.createElement(v.default,{key:e.id,attribution:e,canEdit:!1,onAttributionDelete:function(){},onAttributionUpdate:function(){},listOnBylineText:a})})))},t.defaultProps=g,t}(f.Component);t.default=_},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(3)),l=n(5),u=n(6),c=a(n(607)),s=a(n(609)),d=function(e){var t=e.attribution,n=e.canEdit,a=e.dragHandleProps,d=void 0===a?null:a,f=e.isDragging,m=void 0!==f&&f,p=e.onAttributionUpdate,h=e.onAttributionDelete,b=t.user,v=t.id,y=t.isAuthor,g=t.roles||[],_=!t.user||t.user.isShadowUser||t.user.id===t.id;return i.default.createElement("div",{className:(0,o.default)("attribution-row",m&&"is-dragging")},n&&i.default.createElement(l.Button,{small:!0,minimal:!0,className:"delete-button",onClick:function(){return h(v)},icon:"small-cross"}),d&&i.default.createElement("div",r({},d,{className:"drag-handle"}),i.default.createElement(l.Icon,{icon:"drag-handle-vertical"})),i.default.createElement("div",{className:"avatar-wrapper"},_&&n?i.default.createElement(s.default,{width:50,attribution:t,onUpdateAvatar:function(e){return p({id:v,avatar:e})}}):i.default.createElement(u.Avatar,{width:50,initials:b.initials,avatar:b.avatar})),i.default.createElement("div",{className:"content"},i.default.createElement("div",{className:"top-content"},i.default.createElement("div",{className:"name"},b.slug?i.default.createElement("a",{href:"/user/"+b.slug,className:"hoverline"},b.fullName):i.default.createElement("span",null,b.fullName))),i.default.createElement("div",{className:"bottom-content"},!n&&y&&i.default.createElement("span",{style:{marginRight:"1em"}},"Listed on byline"),!n&&g.map((function(e){return i.default.createElement(l.Tag,{key:e,minimal:!0,intent:"primary"},e)})),n&&i.default.createElement(c.default,r({},e,{roles:g,isShadowAttribution:_})))))};d.defaultProps={dragHandleProps:null,isDragging:!1},t.default=d},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(107),c=n(608);t.default=function(e){var t=e.attribution,n=e.isShadowAttribution,i=e.listOnBylineText,s=e.onAttributionUpdate,d=e.roles,f=t.affiliation,m=t.id,p=t.isAuthor,h=t.orcid;return o.default.createElement("div",{className:"detail-controls"},o.default.createElement(l.Checkbox,{checked:p,onChange:function(e){return s({id:m,isAuthor:e.target.checked})}},i),o.default.createElement(u.MultiSelect,{className:"roles",items:d,itemListPredicate:c.getFilteredRoles,itemRenderer:function(e,t){var n=t.handleClick,r=t.modifiers;return o.default.createElement(l.MenuItem,{key:e,onClick:n,active:r.active,text:e})},selectedItems:d,tagRenderer:function(e){return o.default.createElement("span",null,e)},tagInputProps:{onRemove:function(e,t){var n=d.filter((function(e,n){return n!==t}));s({id:m,roles:n})},placeholder:"Add roles...",tagProps:{className:"bp3-minimal bp3-intent-primary"},inputProps:{placeholder:"Add roles..."}},resetOnSelect:!0,onItemSelect:function(e){var t=a(a([],r(d),!1),[e],!1);s({id:m,roles:t})},noResults:o.default.createElement(l.MenuItem,{disabled:!0},"No Matching Roles"),popoverProps:{popoverClassName:"bp3-minimal",position:l.Position.BOTTOM_LEFT,modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1},flip:{enabled:!1}}}}),o.default.createElement("div",{className:"right-details"},o.default.createElement(l.InputGroup,{placeholder:"Affiliation",defaultValue:f,onKeyDown:function(e){"Enter"===e.key&&e.currentTarget.blur()},onBlur:function(e){return s({id:m,affiliation:e.target.value.trim()})}}),n&&o.default.createElement(l.InputGroup,{rightElement:h&&o.default.createElement(l.Tag,{minimal:!0},"ORCID"),placeholder:"ORCID",defaultValue:h,onKeyDown:function(e){"Enter"===e.key&&e.currentTarget.blur()},onBlur:function(e){return s({id:m,orcid:e.target.value.trim()})}})))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFilteredRoles=void 0;var o=i(n(173)),l=["Conceptualization","Methodology","Software","Validation","Formal Analysis","Investigation","Resources","Data Curation","Writing â€“ Original Draft Preparation","Writing â€“ Review & Editing","Visualization","Supervision","Project Administration","Peer Review","Funding Acquisition","Illustrator","Editor","Series Editor","Translator","Chair"];t.getFilteredRoles=function(e,t){var n=l.reduce((function(t,n){return n.toLowerCase()!==e.toLowerCase()&&t}),!0);return a(a([],r(e&&n?[e]:[]),!1),r(l),!1).filter((function(n){var r=(0,o.default)(e.toLowerCase(),n.toLowerCase());return!(t.indexOf(n)>-1)&&r})).sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(5),d=n(112),f=n(6);n(610);t.default=function(e){var t=e.attribution,n=t.avatar,r=t.user,a=e.onUpdateAvatar,i=e.width,l=o((0,u.useState)(!1),2),m=l[0],p=l[1];return u.default.createElement("div",{className:"editable-avatar-component"},u.default.createElement(f.ImageUpload,{onImageSelect:function(){p(!0)},onNewImage:function(e){p(!1),a(e)}},(function(e){var t=e.selectImage,a=e.clearImage;return u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Button,{"aria-label":"Upload avatar image",as:"div",className:"avatar-button",style:{borderRadius:i/2},onClick:t},u.default.createElement(f.Avatar,{width:i,initials:r.initials,avatar:n}),u.default.createElement("div",{className:(0,c.default)("hover-overlay",!n&&"no-image",m&&"is-loading")},m&&u.default.createElement(s.Spinner,{size:i/2}),!m&&u.default.createElement(f.Icon,{icon:"add",iconSize:i/2.25}))),n&&u.default.createElement(s.Button,{"aria-label":"Remove avatar image",small:!0,className:"remove-button",icon:u.default.createElement(f.Icon,{icon:"trash",iconSize:12}),intent:"danger",onClick:a}))})))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(80));n(621);t.default=function(e){var t=e.bannerText,n=e.accentColor,r=e.right,a=(0,l.useMemo)((function(){return(0,u.default)(n).alpha(.1)}),[n]);return l.default.createElement("div",{style:{background:a},className:"banner"},l.default.createElement("div",{className:"banner-text"},t),l.default.createElement("div",null,r))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.activityAssociationTypes=void 0,a(n(624),t),a(n(625),t),a(n(626),t),a(n(627),t),a(n(628),t),a(n(629),t);var i=n(630);Object.defineProperty(t,"activityAssociationTypes",{enumerable:!0,get:function(){return i.activityAssociationTypes}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.activityAssociationTypes=void 0,t.activityAssociationTypes=["collectionPub","collection","community","discussion","externalPublication","page","pubEdge","pub","review","submission","release","threadComment","thread","user"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPubAttribution=t.isCollectionAttribution=t.isAttributionWithUser=void 0;t.isAttributionWithUser=function(e){return"user"in e&&!!e.user};t.isCollectionAttribution=function(e){return"collectionId"in e};t.isPubAttribution=function(e){return"pubId"in e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(71);t.default=function(e){var t=e.afterCopyPrompt,n=void 0===t?"Copied!":t,r=e.beforeCopyPrompt,a=void 0===r?null:r,i=e.children,s=void 0===i?null:i,d=e.className,f=void 0===d?"":d,m=e.copyString,p=e.disabled,h=void 0!==p&&p,b=e.icon,v=void 0===b?"link":b,y=e.minimal,g=void 0===y||y,_=e.tooltipPosition,E=void 0===_?u.Position.TOP:_,P=e.usePortal,w=void 0===P||P,O=e.small,C=void 0!==O&&O,S=e.outlined,D=void 0!==S&&S,k=o((0,l.useState)(!1),2),j=k[0],M=k[1],N=o((0,c.useCopyToClipboard)(),2),I=N[0],x=N[1],T=function(){x("function"==typeof m?m():m),M(!0)};return l.default.createElement(u.Tooltip,{usePortal:w,content:(j?I.error?"There was an error copying.":n:a)||void 0,onClosed:function(){return M(!1)},className:f,children:"function"==typeof s?s(T):l.default.createElement(u.Button,{minimal:g,small:C,icon:v,onClick:T,disabled:h,outlined:D},s),position:E})}},,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientOnlyContext=void 0;var a=r(n(0));t.ClientOnlyContext=a.default.createContext({isClientOnly:!1});t.default=function(e){var n=e.children,r=e.fallback,i=void 0===r?null:r;return"undefined"!=typeof window?a.default.createElement(t.ClientOnlyContext.Provider,{value:{isClientOnly:!0}},n):a.default.createElement(a.default.Fragment,null,i)}},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(88);n(831);var l={title:i.default.string,description:i.default.string,subdomain:i.default.string,domain:i.default.string,heroLogo:i.default.string,heroBackgroundImage:i.default.string,accentColor:i.default.string,accentTextColor:i.default.string},u=function(e){var t=(0,o.getResizedUrl)(e.heroLogo,"inside",600),n=(0,o.getResizedUrl)(e.heroBackgroundImage,"outside",800),r={color:e.accentTextColor},i={backgroundColor:e.accentColor,color:e.accentTextColor,backgroundImage:e.heroBackgroundImage?'url("'+n+'")':""},l=e.domain?"https://"+e.domain:"https://"+e.subdomain+".pubpub.org";return a.default.createElement("a",{className:"community-preview-component",href:l,style:i},a.default.createElement("div",{className:"logo-wrapper"},e.heroLogo&&a.default.createElement("img",{className:"logo",src:t,alt:e.title}),!e.heroLogo&&a.default.createElement("h3",{style:r},e.title)),a.default.createElement("div",{className:"description"},e.description))};u.defaultProps={title:void 0,description:void 0,subdomain:void 0,domain:void 0,heroLogo:void 0,heroBackgroundImage:void 0,accentColor:"#000",accentTextColor:"#FFF"},u.propTypes=l,t.default=u},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(6);n(833);var l={attribution:i.default.object.isRequired},u=function(e){var t=e.attribution,n=t.user,r=n.slug?a.default.createElement("a",{href:"/user/"+n.slug},a.default.createElement(o.Avatar,{initials:n.initials,avatar:n.avatar,width:30})):a.default.createElement(o.Avatar,{initials:n.initials,avatar:n.avatar,width:30}),i=n.slug?a.default.createElement("a",{href:"/user/"+n.slug,className:"hoverline"},n.fullName):a.default.createElement("span",null,n.fullName),l=t.affiliation||n.title,u=(t.roles||[]).reduce((function(e,t){return e?e+", "+t:t}),"");return a.default.createElement("div",{className:"contributors-list_contributor-component"},a.default.createElement("div",{className:"avatar-wrapper"},r),a.default.createElement("div",{className:"details-wrapper"},a.default.createElement("div",{className:"name"},i),n.orcid&&a.default.createElement("div",{className:"pub-header-themed-secondary orcid"},a.default.createElement(o.Icon,{icon:"orcid"}),a.default.createElement("a",{href:"https://orcid.org/"+n.orcid,target:"_blank",rel:"noopener noreferrer"},n.orcid)),l&&a.default.createElement("div",{className:"affiliation pub-header-themed-secondary"},l),!!u&&a.default.createElement("div",{className:"roles pub-header-themed-secondary"},"Roles: ",u)))};u.propTypes=l,t.default=u},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(6),l=n(9);n(836);t.default=function(e){var t=e.className,n=e.children,r=e.controls,u=void 0===r?null:r,c=e.details,s=void 0===c?null:c,d=e.icon,f=e.title,m=e.banner,p=(0,l.usePageContext)().scopeData.elements.activeTargetType;return a.default.createElement("div",{className:(0,i.default)("dashboard-frame-component",t)},m,a.default.createElement("div",{className:"dashboard-content-header"},a.default.createElement("div",{className:"dashboard-header-left"},a.default.createElement("div",{className:"title"},d&&a.default.createElement(a.default.Fragment,null,a.default.createElement(o.Icon,{icon:d,iconSize:24}),"Â "),a.default.createElement("span",{className:"target-type"},p),"Â ",f),s&&a.default.createElement("div",{className:"details"},s)),a.default.createElement("div",{className:"dashboard-header-right"},a.default.createElement("div",{className:"controls"},u))),n)}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(78),d=n(6),f=l(n(383));n(839);var m=function(e){var t=e.children,n=e.className,r=e.handle,a=e.href,i=e.icon,l=e.onClick,m=e.rightSideElements,p=e.selected,h=e.subtitle,b=e.title,v=o((0,u.useState)(!1),2),y=v[0],g=v[1],_=u.default.Children.count(t)>0;return u.default.createElement("div",{className:(0,c.default)("dashboard-row-component",n,p&&"selected")},u.default.createElement("div",{className:"inner"},u.default.createElement(s.Button,{"aria-label":y?"Hide collection children":"Show collection children",className:(0,c.default)({arrow:!0,active:_,opened:y}),role:"button",tabIndex:_?0:-1,onClick:function(e){_&&(e.preventDefault(),g(!y))}},_&&u.default.createElement(d.Icon,{icon:"caret-right"})),u.default.createElement("div",{className:"left"},u.default.createElement("div",{className:"icon-and-title-container"},r,u.default.createElement("div",{className:"icon"},u.default.createElement(d.Icon,{icon:i,iconSize:14})),u.default.createElement("a",{className:"title-and-subtitle",href:a,onClick:l,draggable:"false"},u.default.createElement("div",{className:"title"},b),u.default.createElement("div",{className:"subtitle"},h)))),u.default.createElement("div",{className:"right"},m)),y&&u.default.createElement(f.default,{className:"child-rows"},t))};m.defaultProps={children:null,className:"",handle:null,href:null,onClick:null,rightSideElements:null,selected:!1,subtitle:null},t.default=m},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(5),f=c(n(87)),m=function(e){return!Number.isNaN(e.valueOf())},p=function(e){if(e){var t=new Date(e);if(m(t))return(0,f.default)(t,"UTC:yyyy-mm-dd");throw new Error}return e};t.default=function(e){var t=e.date,n=e.onSelectDate,a=l(e,["date","onSelectDate"]),i=(0,s.useRef)(),o=u((0,s.useState)(!1),2),c=o[0],f=o[1];(0,s.useEffect)((function(){return f(!0)}),[]),(0,s.useEffect)((function(){var e=i.current;if(e)try{var n=p(t);e.value=n}catch(e){}}),[t]);var h=(0,s.useCallback)((function(e){try{var t=function(e){var t=e.target.value;if(t){var n=u(t.split("-"),3),r=n[0],a=n[1],i=n[2];if(r&&4===r.length&&!r.startsWith("0")&&a&&i){var o=new Date(t);if(m(o))return o}throw new Error}return null}(e);n(t)}catch(e){}}),[n]);return s.default.createElement(d.InputGroup,r({placeholder:"YYYY-MM-DD"},a,function(e,t){if(!t)try{return{value:p(e)}}catch(e){return{}}return{}}(t,c),{type:"date",inputRef:i,onInput:h}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DevCommunitySwitcherMenuItems=t.DevCommunitySwitcherMenu=void 0;var a=n(842);Object.defineProperty(t,"DevCommunitySwitcherMenu",{enumerable:!0,get:function(){return r(a).default}});var i=n(387);Object.defineProperty(t,"DevCommunitySwitcherMenuItems",{enumerable:!0,get:function(){return r(i).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(57),l=a(n(387));t.default=function(e){return i.default.createElement(o.Menu,r({},e,{"aria-label":"Switch Community"}),i.default.createElement(l.default,null))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));t.default={superscript:{path:a.default.createElement("path",{d:"M12.013 18.335v2.237h-3.321l-2.129-3.375-0.321-0.563c-0.080-0.094-0.121-0.188-0.147-0.281h-0.040c-0.027 0.094-0.080 0.188-0.121 0.281-0.080 0.161-0.201 0.375-0.335 0.589l-2.076 3.348h-3.455v-2.237h1.714l2.638-3.897-2.478-3.643h-1.835v-2.25h3.696l1.862 3.054c0.121 0.188 0.214 0.388 0.308 0.562 0.080 0.094 0.121 0.188 0.147 0.281h0.040c0.027-0.094 0.080-0.188 0.147-0.281l0.335-0.563 1.875-3.054h3.442v2.25h-1.674l-2.464 3.576 2.732 3.964h1.46zM20.545 9.241v2.759h-6.884l-0.040-0.362c-0.027-0.188-0.054-0.442-0.054-0.616 0-3.656 4.688-3.964 4.688-5.906 0-0.696-0.629-1.165-1.339-1.165-0.509 0-0.964 0.241-1.299 0.522-0.174 0.147-0.335 0.335-0.482 0.509l-1.406-1.232c0.241-0.335 0.509-0.616 0.844-0.884 0.563-0.442 1.379-0.871 2.518-0.871 1.942 0 3.295 1.138 3.295 2.92 0 3.214-4.446 3.482-4.634 5.397h3.107v-1.071h1.688z"}),squareViewboxDimension:24},subscript:{path:a.default.createElement("path",{d:"M12.013 18.335v2.237h-3.321l-2.129-3.375-0.321-0.563c-0.080-0.094-0.121-0.188-0.147-0.281h-0.040c-0.027 0.094-0.080 0.188-0.121 0.281-0.080 0.161-0.201 0.375-0.335 0.589l-2.076 3.348h-3.455v-2.237h1.714l2.638-3.897-2.478-3.643h-1.835v-2.25h3.696l1.862 3.054c0.121 0.188 0.214 0.388 0.308 0.562 0.080 0.094 0.121 0.188 0.147 0.281h0.040c0.027-0.094 0.080-0.188 0.147-0.281l0.335-0.563 1.875-3.054h3.442v2.25h-1.674l-2.464 3.576 2.732 3.964h1.46zM20.571 21.241v2.759h-6.884l-0.054-0.362c-0.013-0.201-0.040-0.442-0.040-0.616 0-3.656 4.688-3.964 4.688-5.906 0-0.696-0.629-1.165-1.339-1.165-0.522 0-0.964 0.241-1.299 0.522-0.174 0.147-0.335 0.335-0.482 0.509l-1.406-1.232c0.241-0.335 0.509-0.616 0.844-0.884 0.563-0.455 1.379-0.871 2.518-0.871 1.942 0 3.295 1.138 3.295 2.92 0 3.201-4.446 3.469-4.634 5.397h3.107v-1.071h1.688z"}),squareViewboxDimension:24},"list-ol":{path:a.default.createElement("path",{d:"M5.103 21.696c0 1.473-1.152 2.304-2.545 2.304-0.844 0-1.701-0.281-2.304-0.884l0.763-1.179c0.362 0.335 0.911 0.603 1.42 0.603 0.469 0 0.964-0.228 0.964-0.763 0-0.75-0.857-0.79-1.406-0.75l-0.348-0.75c0.482-0.616 0.924-1.299 1.5-1.821v-0.013c-0.429 0-0.871 0.027-1.299 0.027v0.71h-1.42v-2.036h4.46v1.179l-1.272 1.54c0.897 0.214 1.487 0.911 1.487 1.835zM5.129 13.299v2.129h-4.848c-0.040-0.241-0.080-0.482-0.080-0.723 0-2.478 3.027-2.853 3.027-3.978 0-0.455-0.281-0.696-0.723-0.696-0.469 0-0.857 0.402-1.085 0.777l-1.138-0.79c0.442-0.924 1.353-1.446 2.371-1.446 1.246 0 2.317 0.737 2.317 2.063 0 1.982-2.906 2.424-2.946 3.469h1.701v-0.804h1.406zM24 17.571v2.571c0 0.228-0.201 0.429-0.429 0.429h-16.286c-0.241 0-0.429-0.201-0.429-0.429v-2.571c0-0.241 0.188-0.429 0.429-0.429h16.286c0.228 0 0.429 0.188 0.429 0.429zM5.143 5.531v1.326h-4.487v-1.326h1.433c0-1.085 0.013-2.17 0.013-3.254v-0.161h-0.027c-0.147 0.295-0.415 0.496-0.67 0.723l-0.951-1.018 1.821-1.701h1.42v5.411h1.446zM24 10.714v2.571c0 0.228-0.201 0.429-0.429 0.429h-16.286c-0.241 0-0.429-0.201-0.429-0.429v-2.571c0-0.241 0.188-0.429 0.429-0.429h16.286c0.228 0 0.429 0.188 0.429 0.429zM24 3.857v2.571c0 0.228-0.201 0.429-0.429 0.429h-16.286c-0.241 0-0.429-0.201-0.429-0.429v-2.571c0-0.228 0.188-0.429 0.429-0.429h16.286c0.228 0 0.429 0.201 0.429 0.429z"}),squareViewboxDimension:24},"list-ul":{path:a.default.createElement("path",{d:"M5.143 18.857c0 1.42-1.152 2.571-2.571 2.571s-2.571-1.152-2.571-2.571 1.152-2.571 2.571-2.571 2.571 1.152 2.571 2.571zM5.143 12c0 1.42-1.152 2.571-2.571 2.571s-2.571-1.152-2.571-2.571 1.152-2.571 2.571-2.571 2.571 1.152 2.571 2.571zM24 17.571v2.571c0 0.228-0.201 0.429-0.429 0.429h-16.286c-0.228 0-0.429-0.201-0.429-0.429v-2.571c0-0.228 0.201-0.429 0.429-0.429h16.286c0.228 0 0.429 0.201 0.429 0.429zM5.143 5.143c0 1.42-1.152 2.571-2.571 2.571s-2.571-1.152-2.571-2.571 1.152-2.571 2.571-2.571 2.571 1.152 2.571 2.571zM24 10.714v2.571c0 0.228-0.201 0.429-0.429 0.429h-16.286c-0.228 0-0.429-0.201-0.429-0.429v-2.571c0-0.228 0.201-0.429 0.429-0.429h16.286c0.228 0 0.429 0.201 0.429 0.429zM24 3.857v2.571c0 0.228-0.201 0.429-0.429 0.429h-16.286c-0.228 0-0.429-0.201-0.429-0.429v-2.571c0-0.228 0.201-0.429 0.429-0.429h16.286c0.228 0 0.429 0.201 0.429 0.429z"}),squareViewboxDimension:24},admin:{path:a.default.createElement("path",{d:"M21.042 3.711c-3.165 0-6.217-1.206-8.515-3.391-0.302-0.264-0.753-0.264-1.017 0-2.298 2.185-5.35 3.391-8.515 3.391-0.414 0-0.753 0.339-0.753 0.753v11.755c0 0.435 2.24 5.755 8.289 7.422 0.078 0.023 1.426 0.414 1.507 0.414 0.099 0 1.413-0.387 1.507-0.414 5.644-1.555 8.289-6.676 8.289-7.422v-11.755c-0.038-0.414-0.377-0.753-0.791-0.753zM13.13 22.21l-1.13 0.301-1.13-0.301c-2.034-0.565-3.843-1.695-5.199-3.203 0.98-2.6 3.504-4.371 6.33-4.371s5.35 1.771 6.33 4.371c-1.356 1.507-3.165 2.637-5.199 3.203zM20.289 16.069c-0.377 0.829-0.867 1.582-1.394 2.298-0.942-2.072-2.75-3.655-4.936-4.22 1.319-0.716 2.185-2.072 2.185-3.655 0-2.298-1.846-4.144-4.144-4.144s-4.144 1.846-4.144 4.144c0 1.582 0.904 2.939 2.185 3.655-2.185 0.603-3.994 2.148-4.936 4.22-0.528-0.678-1.017-1.469-1.394-2.298v-10.889c3.052-0.151 5.953-1.319 8.289-3.316 2.336 1.997 5.237 3.165 8.289 3.316v10.889zM12 13.884c-1.884 0-3.391-1.507-3.391-3.391s1.507-3.391 3.391-3.391 3.391 1.507 3.391 3.391-1.507 3.391-3.391 3.391z"}),squareViewboxDimension:24},doc:{path:a.default.createElement("g",null,a.default.createElement("path",{key:"doc1",d:"M18 24h-14.667c-1.841 0-3.333-1.492-3.333-3.333v0-17.333c0-1.841 1.492-3.333 3.333-3.333v0h14.667c1.841 0 3.333 1.492 3.333 3.333v0 17.333c0 1.841-1.492 3.333-3.333 3.333v0zM3.333 2.667c-0.368 0-0.667 0.298-0.667 0.667v0 17.333c0 0.368 0.298 0.667 0.667 0.667v0h14.667c0.368 0 0.667-0.298 0.667-0.667v0-17.333c0-0.368-0.298-0.667-0.667-0.667v0z"}),a.default.createElement("path",{key:"doc2",d:"M10.667 8h-4c-0.736 0-1.333-0.597-1.333-1.333s0.597-1.333 1.333-1.333v0h4c0.736 0 1.333 0.597 1.333 1.333s-0.597 1.333-1.333 1.333v0z"}),a.default.createElement("path",{key:"doc3",d:"M14.667 13.333h-8c-0.736 0-1.333-0.597-1.333-1.333s0.597-1.333 1.333-1.333v0h8c0.736 0 1.333 0.597 1.333 1.333s-0.597 1.333-1.333 1.333v0z"}),a.default.createElement("path",{key:"doc4",d:"M13.333 18.667h-6.667c-0.736 0-1.333-0.597-1.333-1.333s0.597-1.333 1.333-1.333v0h6.667c0.736 0 1.333 0.597 1.333 1.333s-0.597 1.333-1.333 1.333v0z"})),squareViewboxDimension:24},toc:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M17.077 19.582h-11.538v3.033h11.538v-3.033zM24 7.451h-18.462v3.033h18.462v-3.033zM5.538 16.55h18.462v-3.033h-18.462v3.033zM5.538 1.385v3.033h18.462v-3.033h-18.462z"}),a.default.createElement("path",{d:"M2.769 2.769c0 0.765-0.62 1.385-1.385 1.385s-1.385-0.62-1.385-1.385c0-0.765 0.62-1.385 1.385-1.385s1.385 0.62 1.385 1.385z"})),squareViewboxDimension:24},doi:{path:a.default.createElement("path",{d:"M6.18 10.611c-0.404 0-0.777 0.294-1.037 0.598-0.21 0.247-0.315 0.628-0.315 0.945s0.119 0.67 0.329 0.917c0.255 0.305 0.53 0.514 0.938 0.514 0.367 0 0.802-0.154 1.054-0.405 0.255-0.251 0.468-0.673 0.468-1.039 0-0.362-0.099-0.796-0.355-1.047-0.255-0.255-0.719-0.482-1.082-0.482zM13.427 10.711c-0.42 0-0.762 0.165-1.025 0.495-0.214 0.265-0.321 0.567-0.321 0.906 0 0.343 0.107 0.647 0.321 0.912 0.264 0.33 0.605 0.495 1.025 0.495 0.375 0 0.692-0.135 0.951-0.404 0.26-0.274 0.389-0.608 0.389-1.003 0-0.391-0.132-0.721-0.395-0.99-0.259-0.274-0.574-0.411-0.945-0.411zM12.006 1.71c-5.683 0-10.291 4.607-10.291 10.291s4.607 10.291 10.291 10.291 10.291-4.607 10.291-10.291c0-5.683-4.607-10.291-10.291-10.291zM9.565 15.146h-1.906v-0.776c-0.194 0.243-0.649 0.491-0.847 0.602-0.346 0.193-0.816 0.32-1.256 0.32-0.712 0-1.346-0.225-1.902-0.715-0.663-0.585-0.974-1.479-0.974-2.442 0-0.98 0.34-1.762 1.019-2.347 0.539-0.465 1.199-0.838 1.899-0.838 0.408 0 0.91 0.037 1.269 0.209 0.206 0.099 0.574 0.331 0.793 0.558v-4.087h1.906v9.517zM16.089 14.269c-0.634 0.73-1.521 1.095-2.662 1.095-1.145 0-2.034-0.365-2.668-1.095-0.523-0.6-0.784-1.336-0.784-2.209 0-0.786 0.264-1.484 0.791-2.092 0.638-0.734 1.546-1.101 2.724-1.101 1.083 0 1.948 0.367 2.594 1.101 0.527 0.6 0.791 1.314 0.791 2.144 0 0.838-0.261 1.557-0.784 2.157zM17.697 6.002c0.222-0.222 0.492-0.334 0.809-0.334s0.587 0.111 0.809 0.334c0.222 0.218 0.334 0.486 0.334 0.803 0 0.321-0.111 0.593-0.334 0.815-0.218 0.218-0.488 0.327-0.809 0.327-0.317 0-0.587-0.111-0.809-0.334-0.218-0.222-0.327-0.492-0.327-0.809s0.109-0.585 0.327-0.803zM19.519 15.141h-2.026v-6.051h2.026v6.051z"}),squareViewboxDimension:24},edit2:{path:a.default.createElement("path",{d:"M23.246 3.925l-3.175-3.175c-0.461-0.459-1.096-0.742-1.798-0.742s-1.337 0.284-1.798 0.742l-13.824 13.824c-0.294 0.295-0.517 0.661-0.639 1.071l-0.005 0.018-1.947 6.729c-0.032 0.106-0.050 0.227-0.050 0.353 0 0.697 0.565 1.262 1.262 1.262 0.126 0 0.248-0.018 0.362-0.053l-0.009 0.002 6.729-1.947c0.428-0.127 0.794-0.349 1.089-0.643l-0 0 13.803-13.841c0.46-0.461 0.744-1.097 0.744-1.8s-0.284-1.339-0.744-1.8l0 0zM4.009 17.812l2.179 2.179-3.066 0.892zM8.484 18.729l-3.213-3.213 13.038-12.979 3.175 3.205z"}),squareViewboxDimension:24},facebook:{path:a.default.createElement("path",{d:"M22.676 0H1.324C.593 0 0 .593 0 1.324v21.352C0 23.408.593 24 1.324 24h11.494v-9.294H9.689v-3.621h3.129V8.41c0-3.099 1.894-4.785 4.659-4.785 1.325 0 2.464.097 2.796.141v3.24h-1.921c-1.5 0-1.792.721-1.792 1.771v2.311h3.584l-.465 3.63H16.56V24h6.115c.733 0 1.325-.592 1.325-1.324V1.324C24 .593 23.408 0 22.676 0"}),squareViewboxDimension:24},github:{path:a.default.createElement("path",{d:"M12 0.296c-6.627 0-12 5.372-12 12 0 5.302 3.438 9.8 8.206 11.387 0.6 0.111 0.82-0.26 0.82-0.577 0-0.286-0.011-1.231-0.016-2.234-3.339 0.726-4.043-1.416-4.043-1.416-0.546-1.387-1.332-1.756-1.332-1.756-1.089-0.745 0.082-0.729 0.082-0.729 1.205 0.085 1.839 1.237 1.839 1.237 1.070 1.834 2.807 1.304 3.492 0.997 0.108-0.775 0.418-1.305 0.762-1.605-2.666-0.303-5.467-1.332-5.467-5.93 0-1.31 0.469-2.381 1.237-3.221-0.125-0.302-0.536-1.523 0.116-3.176 0 0 1.008-0.322 3.301 1.23 0.957-0.266 1.984-0.399 3.004-0.404 1.020 0.005 2.047 0.138 3.006 0.404 2.291-1.553 3.297-1.23 3.297-1.23 0.653 1.653 0.243 2.873 0.118 3.176 0.769 0.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921 0.43 0.372 0.814 1.103 0.814 2.222 0 1.606-0.014 2.898-0.014 3.293 0 0.319 0.216 0.694 0.824 0.576 4.765-1.588 8.199-6.085 8.199-11.385 0-6.628-5.373-12-12-12z"}),squareViewboxDimension:24},"google-plus":{path:a.default.createElement("g",null,a.default.createElement("path",{key:"gp1",d:"M7.636 10.72v2.62h4.331c-0.173 1.125-1.308 3.295-4.331 3.295-2.606 0-4.734-2.161-4.734-4.823s2.128-4.823 4.734-4.823c1.486 0 2.475 0.633 3.042 1.177l2.072-1.997c-1.331-1.242-3.056-1.997-5.114-1.997-4.223 0.005-7.636 3.417-7.636 7.641s3.412 7.636 7.636 7.636c4.406 0 7.331-3.098 7.331-7.462 0-0.502-0.056-0.886-0.122-1.266h-7.209z"}),a.default.createElement("path",{key:"gp2",d:"M24 10.5h-2.25v-2.25h-2.25v2.25h-2.25v2.25h2.25v2.25h2.25v-2.25h2.25z"})),squareViewboxDimension:24},"google-scholar":{path:a.default.createElement("path",{d:"M19.042 3.997v-1.46l1.059-0.827h-11.464l-6.923 6.018h4.591c-0.008 0.114-0.012 0.217-0.012 0.334 0 1.117 0.387 2.041 1.162 2.78 0.775 0.739 1.729 1.107 2.858 1.107 0.264 0 0.523-0.020 0.774-0.055-0.156 0.348-0.234 0.671-0.234 0.972 0 0.529 0.241 1.095 0.722 1.696-2.103 0.143-3.648 0.522-4.633 1.134-0.564 0.348-1.018 0.788-1.361 1.315-0.343 0.531-0.513 1.1-0.513 1.713 0 0.517 0.111 0.983 0.333 1.397s0.513 0.754 0.874 1.017c0.36 0.266 0.776 0.488 1.244 0.668 0.468 0.179 0.933 0.306 1.397 0.379 0.462 0.072 0.922 0.107 1.378 0.107 0.722 0 1.445-0.093 2.173-0.278 0.727-0.187 1.409-0.463 2.046-0.83 0.636-0.365 1.153-0.862 1.55-1.486 0.396-0.626 0.595-1.329 0.595-2.108 0-0.59-0.121-1.128-0.362-1.615-0.24-0.486-0.533-0.887-0.882-1.198s-0.697-0.598-1.046-0.856c-0.348-0.26-0.643-0.523-0.883-0.794s-0.361-0.539-0.361-0.803c0-0.264 0.093-0.518 0.28-0.765 0.185-0.247 0.411-0.485 0.676-0.713s0.529-0.481 0.793-0.758c0.264-0.276 0.49-0.634 0.676-1.072s0.279-0.935 0.279-1.488c0-0.721-0.137-1.311-0.405-1.786-0.032-0.055-0.065-0.097-0.101-0.162l3.050-2.502v0.918c-0.396 0.050-0.355 0.287-0.355 0.57v6.896c0 0.319 0.261 0.581 0.581 0.581h0.214c0.319 0 0.581-0.261 0.581-0.581v-6.896c0-0.283 0.042-0.519-0.352-0.57zM13.288 15.921c0.061 0.040 0.199 0.149 0.414 0.324 0.217 0.174 0.364 0.305 0.443 0.397 0.077 0.089 0.192 0.223 0.342 0.405s0.253 0.338 0.306 0.468c0.054 0.133 0.108 0.293 0.163 0.479 0.053 0.185 0.080 0.374 0.080 0.566 0 0.914-0.352 1.591-1.054 2.029-0.703 0.438-1.542 0.658-2.516 0.658-0.492 0-0.976-0.059-1.45-0.171s-0.928-0.286-1.361-0.515c-0.433-0.228-0.781-0.547-1.045-0.954-0.265-0.41-0.397-0.88-0.397-1.407 0-0.553 0.15-1.034 0.451-1.442 0.3-0.409 0.693-0.718 1.181-0.928 0.486-0.211 0.978-0.361 1.477-0.45 0.499-0.091 1.007-0.137 1.524-0.137 0.24 0 0.425 0.013 0.558 0.037 0.024 0.012 0.162 0.111 0.415 0.298 0.252 0.186 0.409 0.3 0.469 0.342zM13.108 10.53c-0.397 0.475-0.951 0.712-1.659 0.712-0.636 0-1.195-0.255-1.676-0.767-0.482-0.51-0.827-1.090-1.037-1.738s-0.317-1.285-0.317-1.911c0-0.734 0.193-1.359 0.578-1.875 0.385-0.517 0.938-0.776 1.658-0.776 0.636 0 1.199 0.27 1.685 0.812 0.487 0.541 0.837 1.148 1.046 1.821s0.315 1.315 0.315 1.929c0 0.721-0.198 1.319-0.594 1.793z"}),squareViewboxDimension:24},linkedin:{path:a.default.createElement("path",{d:"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"}),squareViewboxDimension:24},lock2:{path:a.default.createElement("g",null,a.default.createElement("path",{key:"lock1",d:"M5.378 23.74h13.245c0.993 0 1.806-0.813 1.806-1.806v-10.235c0-0.993-0.813-1.806-1.806-1.806h-0.301v-1.896c0-3.522-2.83-6.382-6.321-6.382s-6.321 2.86-6.321 6.382v1.896h-0.301c-0.993 0-1.806 0.813-1.806 1.806v10.235c0 0.993 0.813 1.806 1.806 1.806zM7.485 7.996c0-2.529 2.017-4.575 4.515-4.575s4.515 2.047 4.515 4.575v1.896h-9.031v-1.896zM5.378 11.699h13.245v10.235h-13.245v-10.235z"}),a.default.createElement("path",{key:"lock2",d:"M11.097 15.913h1.806v3.612h-1.806v-3.612z"})),squareViewboxDimension:24},orcid:{path:a.default.createElement("path",{d:"M15.351 9.45c-0.296-0.138-0.575-0.231-0.84-0.274-0.264-0.045-0.688-0.067-1.274-0.067h-1.523v6.338h1.562c0.609 0 1.082-0.042 1.42-0.125s0.619-0.188 0.845-0.316c0.226-0.128 0.432-0.285 0.62-0.473 0.601-0.611 0.902-1.381 0.902-2.312 0-0.915-0.309-1.662-0.927-2.24-0.228-0.214-0.491-0.392-0.784-0.531zM12.006 1.71c-5.684 0-10.291 4.608-10.291 10.291s4.607 10.291 10.291 10.291 10.291-4.608 10.291-10.291-4.607-10.291-10.291-10.291zM8.589 16.545h-1.219v-8.522h1.219v8.522zM7.979 7.133c-0.462 0-0.839-0.374-0.839-0.839 0-0.461 0.376-0.838 0.839-0.838s0.84 0.376 0.84 0.838c-0.001 0.466-0.376 0.839-0.84 0.839zM17.995 13.922c-0.22 0.521-0.533 0.978-0.94 1.373-0.414 0.408-0.896 0.713-1.446 0.921-0.322 0.125-0.616 0.21-0.884 0.254-0.269 0.042-0.781 0.063-1.538 0.063h-2.695v-8.509h2.873c1.16 0 2.076 0.172 2.752 0.521s1.211 0.86 1.61 1.534c0.399 0.675 0.599 1.412 0.599 2.207 0.001 0.571-0.111 1.117-0.329 1.636z"}),squareViewboxDimension:24},reddit:{path:a.default.createElement("path",{d:"M6 15c0-0.828 0.672-1.5 1.5-1.5s1.5 0.672 1.5 1.5c0 0.828-0.672 1.5-1.5 1.5s-1.5-0.672-1.5-1.5zM15 15c0-0.828 0.672-1.5 1.5-1.5s1.5 0.672 1.5 1.5c0 0.828-0.672 1.5-1.5 1.5s-1.5-0.672-1.5-1.5zM15.073 18.206c0.386-0.304 0.946-0.238 1.251 0.148s0.238 0.946-0.148 1.251c-1.076 0.847-2.715 1.395-4.175 1.395s-3.1-0.548-4.175-1.395c-0.386-0.304-0.453-0.864-0.148-1.251s0.864-0.453 1.251-0.148c0.619 0.488 1.845 1.013 3.073 1.013s2.454-0.525 3.073-1.013zM24 12c0-1.657-1.343-3-3-3-1.128 0-2.109 0.623-2.622 1.543-1.542-0.844-3.421-1.389-5.467-1.514l1.79-4.020 3.426 0.989c0.308 0.875 1.142 1.503 2.122 1.503 1.243 0 2.25-1.007 2.25-2.25s-1.007-2.25-2.25-2.25c-0.857 0-1.602 0.479-1.982 1.184l-3.818-1.102c-0.427-0.123-0.88 0.087-1.061 0.493l-2.432 5.462c-1.995 0.141-3.826 0.68-5.335 1.506-0.512-0.92-1.495-1.542-2.622-1.542-1.657 0-3 1.343-3 3 0 1.226 0.736 2.279 1.79 2.745-0.189 0.563-0.29 1.151-0.29 1.755 0 4.142 4.701 7.5 10.5 7.5s10.5-3.358 10.5-7.5c0-0.605-0.101-1.192-0.29-1.755 1.054-0.465 1.79-1.519 1.79-2.745zM20.25 4.406c0.466 0 0.844 0.378 0.844 0.844s-0.378 0.844-0.844 0.844-0.844-0.378-0.844-0.844 0.378-0.844 0.844-0.844zM1.5 12c0-0.827 0.673-1.5 1.5-1.5 0.598 0 1.115 0.352 1.356 0.859-0.784 0.595-1.434 1.28-1.914 2.033-0.551-0.222-0.942-0.762-0.942-1.392zM12 22.219c-4.815 0-8.719-2.56-8.719-5.719s3.904-5.719 8.719-5.719c4.815 0 8.719 2.56 8.719 5.719s-3.904 5.719-8.719 5.719zM21.558 13.392c-0.48-0.753-1.13-1.438-1.914-2.033 0.241-0.507 0.758-0.859 1.356-0.859 0.827 0 1.5 0.673 1.5 1.5 0 0.63-0.39 1.17-0.942 1.392z"}),squareViewboxDimension:24},team:{path:a.default.createElement("path",{d:"M8.533 1.6c-2.347 0-4.267 1.92-4.267 4.267s1.92 4.267 4.267 4.267c2.347 0 4.267-1.92 4.267-4.267s-1.92-4.267-4.267-4.267zM17.6 2.133c-1.905 0-3.467 1.562-3.467 3.467s1.562 3.467 3.467 3.467c1.905 0 3.467-1.562 3.467-3.467s-1.562-3.467-3.467-3.467zM8.533 3.2c1.482 0 2.667 1.184 2.667 2.667s-1.184 2.667-2.667 2.667c-1.482 0-2.667-1.184-2.667-2.667s1.184-2.667 2.667-2.667zM17.6 3.733c1.040 0 1.867 0.826 1.867 1.867s-0.826 1.867-1.867 1.867c-1.040 0-1.867-0.826-1.867-1.867s0.826-1.867 1.867-1.867zM17.6 9.6c-2.252 0-4.262 0.608-5.442 1.825-1.103-0.319-2.328-0.492-3.625-0.492-2.269 0-4.324 0.53-5.875 1.442s-2.658 2.275-2.658 3.892v5.333c0 0.419 0.381 0.8 0.8 0.8h15.467c0.419-0 0.8-0.381 0.8-0.8v-3.2c1.985 0 3.538 0 6.133 0 0.419-0 0.8-0.381 0.8-0.8v-4c0-1.281-0.873-2.333-2.042-2.992s-2.69-1.008-4.358-1.008zM17.6 11.2c1.434 0 2.711 0.326 3.567 0.808s1.233 1.035 1.233 1.592v3.2h-5.333c0.106-2.306-1.107-3.513-2.658-4.425-0.163-0.096-0.335-0.188-0.508-0.275 0.859-0.514 2.182-0.9 3.7-0.9zM8.533 12.533c2.015 0 3.822 0.485 5.067 1.217s1.867 1.638 1.867 2.517v4.533h-13.867v-4.533c0-0.879 0.622-1.785 1.867-2.517s3.051-1.217 5.067-1.217z"}),squareViewboxDimension:24},twitter:{path:a.default.createElement("path",{d:"M24 5.306c-0.881 0.394-1.833 0.656-2.827 0.773 1.017-0.609 1.795-1.575 2.166-2.723-0.952 0.563-2.006 0.975-3.127 1.195-0.9-0.956-2.18-1.552-3.595-1.552-2.719 0-4.922 2.203-4.922 4.922 0 0.384 0.042 0.759 0.127 1.12-4.092-0.206-7.72-2.166-10.148-5.147-0.422 0.727-0.666 1.575-0.666 2.475 0 1.706 0.867 3.216 2.189 4.097-0.806-0.023-1.566-0.248-2.231-0.614 0 0.019 0 0.042 0 0.061 0 2.386 1.697 4.378 3.952 4.828-0.412 0.112-0.848 0.173-1.298 0.173-0.319 0-0.623-0.033-0.928-0.089 0.628 1.955 2.447 3.38 4.598 3.422-1.688 1.322-3.806 2.109-6.117 2.109-0.398 0-0.788-0.023-1.177-0.070 2.184 1.402 4.772 2.212 7.552 2.212 9.056 0 14.011-7.505 14.011-14.011 0-0.216-0.005-0.427-0.014-0.637 0.961-0.689 1.795-1.556 2.456-2.545z"}),squareViewboxDimension:24},prezi:{path:a.default.createElement("g",null,a.default.createElement("path",{className:"rings",d:"M6.303 11.87c-0.041 3.122 2.621 5.726 5.735 5.726s5.664-2.604 5.664-5.726c0-3.122-2.549-5.65-5.664-5.65-4.124 0-5.705 3.372-5.735 5.65zM12.038 6.833c2.776 0 4.954 2.255 4.954 5.038s-2.178 4.991-4.954 4.991c-2.776 0-5.025-2.209-5.025-4.991s2.249-5.038 5.025-5.038z"}),a.default.createElement("path",{className:"rings",d:"M4.906 11.87c0 4.037 3.376 7.053 7.131 7.053s7.036-3.103 7.036-7.053c0-3.949-3.309-7.087-7.036-7.087s-7.131 2.878-7.131 7.087zM12.037 5.423c3.219 0 6.359 2.767 6.359 6.447 0 3.705-2.848 6.376-6.359 6.376-3.671 0-6.394-2.819-6.394-6.376 0-3.692 2.882-6.447 6.394-6.447z"}),a.default.createElement("path",{className:"rings",d:"M3.525 11.874c0 4.871 3.984 8.459 8.514 8.459s8.464-3.695 8.464-8.459c0-4.764-3.94-8.497-8.464-8.497s-8.514 3.464-8.514 8.497zM12.040 4.078c4.099 0 7.748 3.356 7.748 7.795 0 4.469-3.609 7.782-7.846 7.782-4.21 0-7.755-3.491-7.755-7.782 0-4.454 3.616-7.795 7.852-7.795z"}),a.default.createElement("path",{className:"bars",d:"M11.596 7.767h0.897v8.185h-0.897z"}),a.default.createElement("path",{className:"bars",d:"M9.724 8.41c0.36-0.286 0.897-0.426 0.897-0.426v7.728c-0.509-0.121-0.891-0.416-0.891-0.416z"}),a.default.createElement("path",{className:"bars",d:"M14.377 8.392c-0.36-0.286-0.897-0.426-0.897-0.426v7.728c0.509-0.121 0.891-0.416 0.891-0.416z"}),a.default.createElement("path",{className:"bars",d:"M8.736 9.346v4.979c0 0-0.826-0.808-0.826-2.477s0.826-2.503 0.826-2.503z"}),a.default.createElement("path",{className:"bars",d:"M15.297 9.311v4.979c0 0 0.826-0.808 0.826-2.477s-0.826-2.503-0.826-2.503z"}),a.default.createElement("path",{className:"bars",d:"M16.241 3.476l1.186-2.273-1.102-0.531-0.943 2.403z"}),a.default.createElement("path",{className:"bars",d:"M14.393 2.776l0.685-2.471-1.189-0.289-0.421 2.547z"}),a.default.createElement("path",{className:"bars",d:"M12.479 2.479l0.165-2.559-1.223-0.040 0.109 2.579z"}),a.default.createElement("path",{className:"bars",d:"M10.499 2.587l-0.375-2.536-1.204 0.217 0.647 2.499z"}),a.default.createElement("path",{className:"bars",d:"M8.589 3.106l-0.896-2.402-1.132 0.464 1.155 2.308z"}),a.default.createElement("path",{className:"bars",d:"M6.833 4.012l-1.378-2.162-1.010 0.69 1.611 2.016z"}),a.default.createElement("path",{className:"bars",d:"M5.332 5.235l-1.791-1.834-0.847 0.882 1.99 1.644z"}),a.default.createElement("path",{className:"bars",d:"M4.087 6.78l-2.136-1.418-0.644 1.040 2.29 1.191z"}),a.default.createElement("path",{className:"bars",d:"M3.21 8.511l-2.381-0.95-0.417 1.15 2.486 0.696z"}),a.default.createElement("path",{className:"bars",d:"M2.7 10.419l-2.527-0.432-0.168 1.212 2.576 0.162z"}),a.default.createElement("path",{className:"bars",d:"M2.597 12.353l-2.562 0.094 0.084 1.22 2.555-0.369z"}),a.default.createElement("path",{className:"bars",d:"M2.905 14.313l-2.486 0.629 0.338 1.176 2.421-0.896z"}),a.default.createElement("path",{className:"bars",d:"M3.614 16.16l-2.299 1.134 0.576 1.079 2.18-1.382z"}),a.default.createElement("path",{className:"bars",d:"M4.692 17.816l-2.012 1.589 0.789 0.935 1.843-1.807z"}),a.default.createElement("path",{className:"bars",d:"M6.060 19.186l-1.644 1.967 0.963 0.754 1.435-2.146z"}),a.default.createElement("path",{className:"bars",d:"M7.723 20.268l-1.196 2.268 1.1 0.536 0.953-2.399z"}),a.default.createElement("path",{className:"bars",d:"M9.585 20.981l-0.691 2.469 1.188 0.292 0.427-2.546z"}),a.default.createElement("path",{className:"bars",d:"M11.537 21.284l-0.161 2.559 1.223 0.038-0.114-2.579z"}),a.default.createElement("path",{className:"bars",d:"M13.471 21.18l0.366 2.538 1.205-0.213-0.639-2.501z"}),a.default.createElement("path",{className:"bars",d:"M15.386 20.666l0.89 2.405 1.133-0.461-1.149-2.311z"}),a.default.createElement("path",{className:"bars",d:"M17.148 19.764l1.373 2.165 1.012-0.688-1.607-2.020z"}),a.default.createElement("path",{className:"bars",d:"M18.679 18.516l1.795 1.831 0.846-0.884-1.993-1.64z"}),a.default.createElement("path",{className:"bars",d:"M19.896 17.009l2.131 1.425 0.647-1.038-2.286-1.198z"}),a.default.createElement("path",{className:"bars",d:"M20.795 15.24l2.383 0.947 0.415-1.151-2.487-0.692z"}),a.default.createElement("path",{className:"bars",d:"M21.304 13.317l2.528 0.425 0.164-1.212-2.577-0.154z"}),a.default.createElement("path",{className:"bars",d:"M21.398 11.335l2.561-0.114-0.094-1.22-2.552 0.389z"}),a.default.createElement("path",{className:"bars",d:"M21.077 9.383l2.481-0.647-0.346-1.173-2.414 0.914z"}),a.default.createElement("path",{className:"bars",d:"M20.355 7.544l2.291-1.15-0.584-1.075-2.17 1.398z"}),a.default.createElement("path",{className:"bars",d:"M19.291 5.926l2.007-1.595-0.791-0.933-1.838 1.812z"}),a.default.createElement("path",{className:"bars",d:"M17.881 4.53l1.629-1.98-0.969-0.746-1.418 2.157z"})),squareViewboxDimension:24},youtube:{path:a.default.createElement("path",{d:"M23.495 6.205a3.007 3.007 0 0 0-2.088-2.088c-1.87-.501-9.396-.501-9.396-.501s-7.507-.01-9.396.501A3.007 3.007 0 0 0 .527 6.205a31.247 31.247 0 0 0-.522 5.805 31.247 31.247 0 0 0 .522 5.783 3.007 3.007 0 0 0 2.088 2.088c1.868.502 9.396.502 9.396.502s7.506 0 9.396-.502a3.007 3.007 0 0 0 2.088-2.088 31.247 31.247 0 0 0 .5-5.783 31.247 31.247 0 0 0-.5-5.805zM9.609 15.601V8.408l6.264 3.602z"}),squareViewboxDimension:24},vimeo:{path:a.default.createElement("path",{d:"M23.977 6.416c-.105 2.338-1.739 5.543-4.894 9.609-3.268 4.247-6.026 6.37-8.29 6.37-1.409 0-2.578-1.294-3.553-3.881L5.322 11.4C4.603 8.816 3.834 7.522 3.01 7.522c-.179 0-.806.378-1.881 1.132L0 7.197c1.185-1.044 2.351-2.084 3.501-3.128C5.08 2.701 6.266 1.984 7.055 1.91c1.867-.18 3.016 1.1 3.447 3.838.465 2.953.789 4.789.971 5.507.539 2.45 1.131 3.674 1.776 3.674.502 0 1.256-.796 2.265-2.385 1.004-1.589 1.54-2.797 1.612-3.628.144-1.371-.395-2.061-1.614-2.061-.574 0-1.167.121-1.777.391 1.186-3.868 3.434-5.757 6.762-5.637 2.473.06 3.628 1.664 3.493 4.797l-.013.01z"}),squareViewboxDimension:24},soundcloud:{path:a.default.createElement("path",{d:"M1.175 12.225c-.051 0-.094.046-.101.1l-.233 2.154.233 2.105c.007.058.05.098.101.098.05 0 .09-.04.099-.098l.255-2.105-.27-2.154c0-.057-.045-.1-.09-.1m-.899.828c-.06 0-.091.037-.104.094L0 14.479l.165 1.308c0 .055.045.094.09.094s.089-.045.104-.104l.21-1.319-.21-1.334c0-.061-.044-.09-.09-.09m1.83-1.229c-.061 0-.12.045-.12.104l-.21 2.563.225 2.458c0 .06.045.12.119.12.061 0 .105-.061.121-.12l.254-2.474-.254-2.548c-.016-.06-.061-.12-.121-.12m.945-.089c-.075 0-.135.06-.15.135l-.193 2.64.21 2.544c.016.077.075.138.149.138.075 0 .135-.061.15-.15l.24-2.532-.24-2.623c0-.075-.06-.135-.135-.135l-.031-.017zm1.155.36c-.005-.09-.075-.149-.159-.149-.09 0-.158.06-.164.149l-.217 2.43.2 2.563c0 .09.075.157.159.157.074 0 .148-.068.148-.158l.227-2.563-.227-2.444.033.015zm.809-1.709c-.101 0-.18.09-.18.181l-.21 3.957.187 2.563c0 .09.08.164.18.164.094 0 .174-.09.18-.18l.209-2.563-.209-3.972c-.008-.104-.088-.18-.18-.18m.959-.914c-.105 0-.195.09-.203.194l-.18 4.872.165 2.548c0 .12.09.209.195.209.104 0 .194-.089.21-.209l.193-2.548-.192-4.856c-.016-.12-.105-.21-.21-.21m.989-.449c-.121 0-.211.089-.225.209l-.165 5.275.165 2.52c.014.119.104.225.225.225.119 0 .225-.105.225-.225l.195-2.52-.196-5.275c0-.12-.105-.225-.225-.225m1.245.045c0-.135-.105-.24-.24-.24-.119 0-.24.105-.24.24l-.149 5.441.149 2.503c.016.135.121.24.256.24s.24-.105.24-.24l.164-2.503-.164-5.456-.016.015zm.749-.134c-.135 0-.255.119-.255.254l-.15 5.322.15 2.473c0 .15.12.255.255.255s.255-.12.255-.27l.15-2.474-.165-5.307c0-.148-.12-.27-.271-.27m1.005.166c-.164 0-.284.135-.284.285l-.103 5.143.135 2.474c0 .149.119.277.284.277.149 0 .271-.12.284-.285l.121-2.443-.135-5.112c-.012-.164-.135-.285-.285-.285m1.184-.945c-.045-.029-.105-.044-.165-.044s-.119.015-.165.044c-.09.054-.149.15-.149.255v.061l-.104 6.048.115 2.449v.008c.008.06.03.135.074.18.058.061.142.104.234.104.08 0 .158-.044.209-.09.058-.06.091-.135.091-.225l.015-.24.117-2.203-.135-6.086c0-.104-.061-.193-.135-.239l-.002-.022zm1.006-.547c-.045-.045-.09-.061-.15-.061-.074 0-.149.016-.209.061-.075.061-.119.15-.119.24v.029l-.137 6.609.076 1.215.061 1.185c0 .164.148.314.328.314.181 0 .33-.15.33-.329l.15-2.414-.15-6.637c0-.12-.074-.221-.165-.277m8.934 3.777c-.405 0-.795.086-1.139.232-.24-2.654-2.46-4.736-5.188-4.736-.659 0-1.305.135-1.889.359-.225.09-.27.18-.285.359v9.368c.016.18.15.33.33.345h8.185C22.681 17.218 24 15.914 24 14.28s-1.319-2.952-2.938-2.952"}),squareViewboxDimension:24},spotify:{path:a.default.createElement("path",{d:"M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"}),squareViewboxDimension:24},slideshare:{path:a.default.createElement("g",null,a.default.createElement("path",{className:"a",strokeLinejoin:"miter",strokeLinecap:"butt",strokeMiterlimit:"10",strokeWidth:"1",d:"M2.4 12.6v-9.6c0-1.020 0.84-1.8 1.8-1.8h15.6c1.020 0 1.8 0.78 1.8 1.8v9.6"}),a.default.createElement("path",{className:"b",d:"M12.6 9.6c0-1.68 1.32-3 3-3s3 1.32 3 3-1.32 3-3 3-3-1.32-3-3zM23.88 10.56c0.060-0.12 0.12-0.18 0.12-0.36 0-0.36-0.24-0.6-0.6-0.6-0.12 0-0.24 0.060-0.36 0.12v0c0 0 0 0 0 0s-0.060 0.060-0.060 0.060c-0.54 0.54-3.66 3.42-6.78 3.42h-2.22c-0.78 0-1.38 0.66-1.38 1.38v6.66c0 1.2 0.96 2.16 2.16 2.16h0.78c2.34 0 4.32-1.92 4.32-4.32 0 0 0.060-2.16-0.84-3.6 1.86-0.78 4.56-3.72 4.86-4.92z"}),a.default.createElement("path",{className:"c",d:"M12.6 16.020v2.46c1.14-0.36 3.72-1.5 3.6-4.080-1.5 1.44-2.82 1.68-3.6 1.62z"}),a.default.createElement("path",{className:"d",d:"M8.4 6.6c1.68 0 3 1.32 3 3s-1.32 3-3 3-3-1.32-3-3 1.32-3 3-3zM16.2 14.4c0-0.36-0.24-0.6-0.6-0.6-0.24 0-0.48 0.18-0.54 0.36v0c-0.66 1.2-1.98 1.92-4.080-0.66v0.060c-0.24-0.24-0.6-0.36-0.96-0.36h-2.22c-3.12 0-6.24-2.88-6.78-3.42 0 0-0.060-0.060-0.060-0.060s0 0 0 0v0c-0.12-0.060-0.24-0.12-0.36-0.12-0.36 0-0.6 0.24-0.6 0.6 0 0.12 0.060 0.24 0.12 0.36 0.3 1.2 3 4.2 4.92 4.92-0.9 1.5-0.84 3.6-0.84 3.6 0 2.34 1.92 4.32 4.32 4.32h0.78c1.2 0 2.16-0.96 2.16-2.16v-4.56c1.2 0.54 3.84 0.78 4.68-1.98 0-0.060 0.060-0.18 0.060-0.3z"})),squareViewboxDimension:24},codepen:{path:a.default.createElement("path",{d:"M24 8.182l-.018-.087-.017-.05c-.01-.024-.018-.05-.03-.075-.003-.018-.015-.034-.02-.05l-.035-.067-.03-.05-.044-.06-.046-.045-.06-.045-.046-.03-.06-.044-.044-.04-.015-.02L12.58.19c-.347-.232-.796-.232-1.142 0L.453 7.502l-.015.015-.044.035-.06.05-.038.04-.05.056-.037.045-.05.06c-.02.017-.03.03-.03.046l-.05.06-.02.06c-.02.01-.02.04-.03.07l-.01.05C0 8.12 0 8.15 0 8.18v7.497c0 .044.003.09.01.135l.01.046c.005.03.01.06.02.086l.015.05c.01.027.016.053.027.075l.022.05c0 .01.015.04.03.06l.03.04c.015.01.03.04.045.06l.03.04.04.04c.01.013.01.03.03.03l.06.042.04.03.01.014 10.97 7.33c.164.12.375.163.57.163s.39-.06.57-.18l10.99-7.28.014-.01.046-.037.06-.043.048-.036.052-.058.033-.045.04-.06.03-.05.03-.07.016-.052.03-.077.015-.045.03-.08v-7.5c0-.05 0-.095-.016-.14l-.014-.045.044.003zm-11.99 6.28l-3.65-2.44 3.65-2.442 3.65 2.44-3.65 2.44zm-1.034-6.674l-4.473 2.99L2.89 8.362l8.086-5.39V7.79zm-6.33 4.233l-2.582 1.73V10.3l2.582 1.726zm1.857 1.25l4.473 2.99v4.82L2.89 15.69l3.618-2.417v-.004zm6.537 2.99l4.474-2.98 3.613 2.42-8.087 5.39v-4.82zm6.33-4.23l2.583-1.72v3.456l-2.583-1.73zm-1.855-1.24L13.042 7.8V2.97l8.085 5.39-3.612 2.415v.003z"}),squareViewboxDimension:24},unsplash:{path:a.default.createElement("path",{d:"M15.6,13.575 C15.6,15.6 13.95,17.175 12,17.175 C10.05,17.175 8.4,15.6 8.4,13.575 C8.4,11.55 10.05,9.975 12,9.975 C14.025,10.05 15.6,11.625 15.6,13.575 Z M24,8.025 L24,19.2 C24,20.925 22.575,22.425 20.775,22.425 L3.225,22.425 C1.425,22.425 0,21 0,19.2 L0,7.95 C0,6.225 1.425,4.725 3.225,4.725 L6,4.725 L6.6,3 C6.9,2.175 7.875,1.5 8.775,1.5 L15.225,1.5 C16.125,1.5 17.1,2.175 17.4,3 L18,4.8 L20.775,4.8 C22.575,4.8 24,6.225 24,8.025 Z M17.55,13.65 C17.55,10.575 15.075,8.025 11.925,8.025 C8.85,8.025 6.3,10.575 6.3,13.65 C6.3,16.725 8.775,19.275 11.925,19.275 C15.075,19.2 17.55,16.725 17.55,13.65 Z"}),squareViewboxDimension:24},googlemaps:{path:a.default.createElement("g",null,a.default.createElement("path",{className:"a",d:"M1.832 2.978h17.357c1.012 0 1.832 0.82 1.832 1.832v17.357c0 1.012-0.82 1.832-1.832 1.832h-17.357c-1.012 0-1.832-0.82-1.832-1.832v-17.357c0-1.012 0.82-1.832 1.832-1.832z"}),a.default.createElement("path",{className:"b",d:"M10.65 13.297l-10.14 10.14c0.333 0.347 0.801 0.563 1.322 0.563h17.357c0.592 0 1.116-0.28 1.45-0.713z"}),a.default.createElement("path",{className:"c",d:"M17.738 0.036c-3.241 0-5.868 2.508-5.868 5.602 0.002 0.966 0.232 1.915 0.732 2.754v0c0.151 0.246 0.291 0.492 0.416 0.737 0.117 0.175 0.228 0.352 0.332 0.527 0.12 0.167 0.236 0.335 0.346 0.503 0.458 0.619 0.875 1.225 1.272 1.808 0.277 0.446 0.589 0.923 0.862 1.396 0.827 1.432 1.402 2.83 1.609 4.867 0 0.001 0 0.003 0 0.004 0.063 0.144 0.18 0.233 0.307 0.233 0.141-0 0.269-0.11 0.325-0.279 0.211-2.014 0.783-3.403 1.604-4.825 0.274-0.472 0.585-0.95 0.862-1.396 0.398-0.582 0.814-1.189 1.272-1.808 0.11-0.169 0.226-0.337 0.346-0.503 0.105-0.176 0.216-0.352 0.332-0.527 0.125-0.245 0.266-0.491 0.416-0.737v0c0.499-0.84 0.7-1.789 0.701-2.754 0-3.094-2.627-5.602-5.868-5.602z"}),a.default.createElement("path",{className:"d",d:"M19.777 5.637c0 1.075-0.913 1.946-2.039 1.946s-2.039-0.871-2.039-1.946c0-1.075 0.913-1.946 2.039-1.946s2.039 0.871 2.039 1.946z"}),a.default.createElement("path",{className:"e",d:"M4.992 5.036c-1.634 0-2.958 1.348-2.958 3.010s1.324 3.010 2.958 3.010c1.064 0 1.681-0.335 2.216-0.88s0.73-1.369 0.73-2.2c0-0.127-0.008-0.253-0.022-0.378h-2.888v1.064h1.696c-0.069 0.265-0.186 0.507-0.37 0.694-0.33 0.335-0.709 0.542-1.365 0.542-1.006 0-1.822-0.83-1.822-1.854s0.816-1.854 1.822-1.854c0.489 0 0.916 0.142 1.254 0.452l0.833-0.833c-0-0-0.001-0.001-0.001-0.001-0.556-0.533-1.266-0.775-2.083-0.775zM6.541 7.016c0 0.001 0.001 0.002 0.001 0.002v-0.001z"}),a.default.createElement("path",{className:"f",d:"M13.695 10.159l-2.791 2.791 9.961 9.961c0.1-0.227 0.157-0.478 0.157-0.743v-10.901c-0.164 0.236-0.327 0.472-0.483 0.701-0.277 0.446-0.589 0.923-0.862 1.396-0.821 1.422-1.393 2.812-1.604 4.825-0.057 0.169-0.184 0.279-0.325 0.279-0.127-0-0.244-0.089-0.307-0.233-0-0.001-0-0.003-0-0.004-0.207-2.037-0.782-3.435-1.609-4.867-0.274-0.472-0.585-0.95-0.862-1.396-0.398-0.582-0.814-1.189-1.272-1.808-0-0-0.001-0.001-0.001-0.001z"}),a.default.createElement("path",{className:"g",d:"M12.926 8.958l-12.926 12.926v0.284c0 1.015 0.817 1.832 1.833 1.832h0.355l12.476-12.476c-0.307-0.446-0.623-0.9-0.967-1.364-0.11-0.169-0.226-0.337-0.346-0.503-0.105-0.176-0.216-0.352-0.332-0.527-0.029-0.057-0.062-0.114-0.092-0.171z"}),a.default.createElement("path",{className:"h",d:"M12.581 13.361l-2.152 2.152 8.487 8.487h0.273c1.015 0 1.832-0.817 1.832-1.832v-0.366z"})),squareViewboxDimension:24},giphy:{path:a.default.createElement("g",null,a.default.createElement("path",{className:"a",d:"M1.967 2.71h2.447l0 19.101h-2.447l-0-19.101z"}),a.default.createElement("path",{className:"b",d:"M19.102 7.605l2.45-0-0 14.204-2.45 0 0-14.204z"}),a.default.createElement("path",{className:"c",d:"M1.966 21.806l19.586-0 0 2.45-19.586 0-0-2.45z"}),a.default.createElement("path",{className:"d",d:"M1.966 0.261h12.241l0 2.45h-12.241l-0-2.45z"}),a.default.createElement("path",{className:"e",d:"M14.208 7.603l7.347-0 0.001-2.448-2.451-0.001 0.001-2.448-2.448-0.001 0.001-2.448-2.451-0.001z"}),a.default.createElement("path",{className:"f",d:"M19.105 7.604l2.45-0 0 2.45-2.45 0-0-2.45z"})),squareViewboxDimension:24},download2:{path:a.default.createElement("path",{d:"M28.963 11.37h-7.407v-11.111h-11.111v11.111h-7.407l12.963 12.963 12.963-12.963zM3.037 28.037v3.704h25.926v-3.704h-25.926z"}),squareViewboxDimension:32},share2:{path:a.default.createElement("path",{d:"M25.524 22.54c-1.206 0-2.286 0.476-3.111 1.222l-11.317-6.587c0.079-0.365 0.143-0.73 0.143-1.111s-0.063-0.746-0.143-1.111l11.19-6.524c0.857 0.794 1.984 1.286 3.238 1.286 2.635 0 4.762-2.127 4.762-4.762s-2.127-4.762-4.762-4.762c-2.635 0-4.762 2.127-4.762 4.762 0 0.381 0.064 0.746 0.143 1.111l-11.191 6.524c-0.857-0.794-1.984-1.286-3.238-1.286-2.635 0-4.762 2.127-4.762 4.762s2.127 4.762 4.762 4.762c1.254 0 2.381-0.492 3.238-1.286l11.302 6.603c-0.079 0.333-0.127 0.683-0.127 1.032 0 2.556 2.079 4.635 4.635 4.635s4.635-2.079 4.635-4.635c0-2.556-2.079-4.635-4.635-4.635z"}),squareViewboxDimension:32},metrics:{path:a.default.createElement("path",{d:"M0 9.6h6.857v22.4h-6.857v-22.4zM12.8 0h6.4v32h-6.4v-32zM25.6 18.286h6.4v13.714h-6.4v-13.714z"}),squareViewboxDimension:32},cite:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M5.56 22.286v-2.548h-2.039v-15.476h2.039v-2.548h-5.56v20.573h5.56zM24 22.286v-20.573h-5.583v2.548h2.039v15.476h-2.039v2.548h5.583z"}),a.default.createElement("path",{d:"M13.918 5.993l-0.421 3.1h-2.409l0.438-3.1h-1.348l-0.421 3.1h-1.702v1.23h1.516l-0.404 2.982h-1.668v1.23h1.483l-0.438 3.083h1.331l0.438-3.083h2.393l-0.438 3.083h1.348l0.421-3.083h1.719v-1.23h-1.533l0.404-2.982h1.685v-1.23h-1.483l0.421-3.1h-1.331zM10.902 10.324h2.393l-0.388 2.982h-2.409l0.404-2.982z"})),squareViewboxDimension:24},tag2:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M23.539 11.265l-10.77-10.812c-0.288-0.29-0.681-0.453-1.090-0.453h-10.129c-0.849 0-1.538 0.689-1.538 1.54v10.128c0 0.409 0.163 0.8 0.451 1.089l10.792 10.793c0.3 0.3 0.694 0.45 1.087 0.45s0.787-0.15 1.087-0.45l10.107-10.108c0.6-0.6 0.601-1.575 0.002-2.177zM19.858 12.88l-6.986 6.986c-0.293 0.293-0.767 0.293-1.059 0l-8.803-8.804v-7.313c0-0.414 0.335-0.75 0.748-0.75h7.316l8.785 8.82c0.293 0.293 0.291 0.767-0.001 1.060z"}),a.default.createElement("path",{d:"M10.502 8.25c0 1.243-1.007 2.25-2.248 2.25s-2.248-1.008-2.248-2.25c0-1.243 1.006-2.25 2.248-2.25s2.248 1.008 2.248 2.25z"})),squareViewboxDimension:24},return:{path:a.default.createElement("g",null,a.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9 1C8.725 1 8.5 1.225 8.5 1.5V4C8.5 5.105 7.605 6 6.5 6H2.205L3.35 4.855C3.445 4.765 3.5 4.64 3.5 4.5C3.5 4.225 3.275 4 3 4C2.86 4 2.735 4.055 2.645 4.145L0.645 6.145C0.555 6.235 0.5 6.36 0.5 6.5C0.5 6.64 0.555 6.765 0.645 6.855L2.645 8.855C2.735 8.945 2.86 9 3 9C3.275 9 3.5 8.775 3.5 8.5C3.5 8.36 3.445 8.235 3.355 8.145L2.205 7H6.5C8.155 7 9.5 5.655 9.5 4V1.5C9.5 1.225 9.275 1 9 1Z"})),squareViewboxDimension:10},collection:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M5.5138 0.0952148H1.71475C0.821989 0.0952148 0.0957031 0.821501 0.0957031 1.71426V5.51312C0.0957031 6.40588 0.821989 7.13217 1.71475 7.13217H5.5138C6.40656 7.13217 7.13285 6.40588 7.13285 5.51312V1.71426C7.13285 0.821501 6.40656 0.0952148 5.5138 0.0952148ZM5.56142 4.51312C5.56142 5.09083 5.09151 5.56074 4.5138 5.56074L2.71475 5.56074C2.13704 5.56074 1.66713 5.09083 1.66713 4.51312V2.71426C1.66713 2.13655 2.13704 1.66664 2.71475 1.66664H4.5138C5.09151 1.66664 5.56142 2.13655 5.56142 2.71426V4.51312Z"}),a.default.createElement("path",{d:"M14.4181 0H10.619C9.72629 0 9 0.726286 9 1.61905V5.4179C9 6.31067 9.72629 7.03695 10.619 7.03695H14.4181C15.3109 7.03695 16.0371 6.31067 16.0371 5.4179V1.61905C16.0371 0.726286 15.3109 0 14.4181 0ZM14.4657 4.4179C14.4657 4.99562 13.9958 5.46552 13.4181 5.46552L11.619 5.46552C11.0413 5.46552 10.5714 4.99562 10.5714 4.4179V2.61905C10.5714 2.04133 11.0413 1.57143 11.619 1.57143H13.4181C13.9958 1.57143 14.4657 2.04133 14.4657 2.61905V4.4179Z"}),a.default.createElement("path",{d:"M14.4181 9H10.619C9.72629 9 9 9.72629 9 10.619V14.4179C9 15.3107 9.72629 16.037 10.619 16.037H14.4181C15.3109 16.037 16.0371 15.3107 16.0371 14.4179V10.619C16.0371 9.72629 15.3109 9 14.4181 9ZM14.4657 13.4179C14.4657 13.9956 13.9958 14.4655 13.4181 14.4655L11.619 14.4655C11.0413 14.4655 10.5714 13.9956 10.5714 13.4179V11.619C10.5714 11.0413 11.0413 10.5714 11.619 10.5714H13.4181C13.9958 10.5714 14.4657 11.0413 14.4657 11.619V13.4179Z"}),a.default.createElement("path",{d:"M5.4181 9H1.61905C0.726286 9 0 9.72629 0 10.619V14.4179C0 15.3107 0.726286 16.037 1.61905 16.037H5.4181C6.31086 16.037 7.03714 15.3107 7.03714 14.4179V10.619C7.03714 9.72629 6.31086 9 5.4181 9ZM5.46571 13.4179C5.46571 13.9956 4.99581 14.4655 4.4181 14.4655L2.61905 14.4655C2.04133 14.4655 1.57143 13.9956 1.57143 13.4179V11.619C1.57143 11.0413 2.04133 10.5714 2.61905 10.5714H4.4181C4.99581 10.5714 5.46571 11.0413 5.46571 11.619V13.4179Z"})),squareViewboxDimension:16},pubDoc:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M0 1.90137C0 0.850737 0.846947 0 1.89189 0H16.1072C17.1559 0 17.9991 0.851684 17.9991 1.90137V16.0977C17.9991 17.1483 17.1521 17.9991 16.1072 17.9991H1.89189C0.843158 17.9991 0 17.1474 0 16.0977V1.90137ZM1.94737 15.11C1.94737 15.6311 2.37842 16.0526 2.89474 16.0526H15.1053C15.6282 16.0526 16.0526 15.6216 16.0526 15.11V2.89095C16.0526 2.36989 15.6216 1.94832 15.1053 1.94832H2.89474C2.37179 1.94832 1.94737 2.37937 1.94737 2.89095V15.11ZM3.78947 4.73684V6.68421H14.2105V4.73684H3.78947ZM3.78947 8.52632V10.4737H12.3158V8.52632H3.78947Z"})),squareViewboxDimension:18},pubDocNew:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M2.32,2.89H8.68v1.2H2.32Zm0,3.51H7.53V5.21H2.32ZM11,1.16A1.16,1.16,0,0,0,9.84,0H1.16A1.16,1.16,0,0,0,0,1.16V9.84A1.16,1.16,0,0,0,1.16,11H6.63V9.81H1.77a.58.58,0,0,1-.58-.58V1.77a.58.58,0,0,1,.58-.58H9.23a.58.58,0,0,1,.58.58v4.9H11V10a1.42,1.42,0,0,0,0-.2ZM9.83,11V7.59H8.64V11Zm1.11-2.3H7.53V9.89h3.41Z"})),squareViewboxDimension:11},chat2:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M22 15V5C22 4.172 21.663 3.42 21.121 2.879C20.579 2.338 19.828 2 19 2H5C4.172 2 3.42 2.337 2.879 2.879C2.338 3.421 2 4.172 2 5V21C2 21.256 2.098 21.512 2.293 21.707C2.684 22.098 3.317 22.098 3.707 21.707L7.414 18H19C19.828 18 20.58 17.663 21.121 17.121C21.662 16.579 22 15.828 22 15ZM19 14C19 14.276 18.889 14.525 18.707 14.707C18.525 14.889 18.276 15 18 15H12H7C6.724 15 6.474 15.112 6.293 15.293L5 16.586V6C5 5.724 5.111 5.475 5.293 5.293C5.475 5.111 5.724 5 6 5H18C18.276 5 18.525 5.111 18.707 5.293C18.889 5.475 19 5.724 19 6V14Z"})),squareViewboxDimension:24},home2:{path:a.default.createElement("g",null,a.default.createElement("path",{d:"M0.386 7.21099C0.15 7.39499 0 7.67999 0 7.99999V19C0 19.828 0.337 20.58 0.879 21.121C1.421 21.662 2.172 22 3 22H17C17.828 22 18.58 21.663 19.121 21.121C19.662 20.579 20 19.828 20 19V7.99999C19.999 7.69999 19.866 7.40699 19.614 7.21099L10.614 0.210993C10.256 -0.0640067 9.753 -0.0740067 9.386 0.210993L0.386 7.21099ZM4 19C3.724 19 3.475 18.889 3.293 18.707C3.111 18.525 3 18.276 3 18V8.48899L10 3.26699L17 8.48899V18C17 18.276 16.889 18.525 16.707 18.707C16.525 18.889 16.276 19 16 19C8.08011 19 10.0667 19 4 19Z"})),squareViewboxDimension:24},at:{path:a.default.createElement("text",{fontSize:"22px",style:{fontSize:22,fontFamily:"'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Open Sans', 'Helvetica Neue', sans-serif"},transform:"translate(0, 16)"},"@"),squareViewboxDimension:20},overview:{path:a.default.createElement("path",{d:"M12.88 6.62H2.96v1.42h9.91V6.62zm0-2.83H2.96v1.42h9.91V3.79zm0-2.83H2.96v1.41h9.91V.96zM1.54.96H.12v1.41h1.42V.96zm0 7.08V6.62H.12v1.42h1.42zm0-4.25H.12v1.42h1.42V3.79z"}),viewbox:"0 -2 9 13"},rtl:{path:a.default.createElement("path",{d:"M15.5,0H6C3.2,0,1,2.2,1,5s2.2,5,5,5v6.5c0,.8,.7,1.5,1.5,1.5s1.5-.7,1.5-1.5V3h2v13.5c0,.8,.7,1.5,1.5,1.5s1.5-.7,1.5-1.5V3h1.5c.8,0,1.5-.7,1.5-1.5s-.7-1.5-1.5-1.5ZM0,15.4c0,.12,.07,.23,.18,.3h0l3,2h0c.09,.05,.2,.09,.32,.09,.28,0,.5-.18,.5-.4v-4c0-.22-.22-.4-.5-.4-.12,0-.23,.04-.32,.1h0L.18,15.09h0C.08,15.17,0,15.28,0,15.4Z"}),viewbox:"0 0 17 18"}}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MenuSelect=void 0;var i=a(n(0)),o=n(385),l=n(386);t.MenuSelect=function(e){var t=e["aria-label"],n=e.icon,a=e.value,u=e.items,c=e.onSelectValue,s=e.buttonProps,d=e.showTickIcon,f=void 0===d||d,m=e.prefix,p=void 0===m?null:m,h=e.disabled,b=void 0!==h&&h,v=e.rightIcon,y=void 0===v?"caret-down":v,g=e.defaultLabel,_=void 0===g?"Select...":g,E=null!==a?u.find((function(e){return e.value===a})):null;return i.default.createElement(l.MenuButton,{disabled:b,"aria-label":t,buttonContent:i.default.createElement(i.default.Fragment,null,p,(null==E?void 0:E.label)||_),buttonProps:r({icon:n,rightIcon:y,outlined:!0},s)},u.map((function(e){return i.default.createElement(o.MenuItem,{key:e.value,icon:f&&(e===E?"tick":"blank"),active:e===E,onClick:function(){return c(e.value)},text:e.label})})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),u=n(256);t.default=function(e){var t=e.children,n=e.config,a=(0,l.useContext)(u.MenuConfigContext);return l.default.createElement(u.MenuConfigContext.Provider,{value:r(r({},a),n)},t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.communities=void 0;t.communities=[]},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0));t.default=function(e){var t=e.children,n=e.renderLauncherElement,r=e.renderChildrenWhenClosed,a=void 0===r||r,i=o((0,l.useState)(!1),2),u=i[0],c=i[1],s=o((0,l.useState)(Date.now()),2),d=s[0],f=s[1];return l.default.createElement(l.default.Fragment,null,n({openDialog:function(){c(!0),f(Date.now())}}),(u||a)&&t({key:d,isOpen:u,onClose:function(){return c(!1)}}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(0)),d=c(n(87)),f=n(5),m=n(6),p=n(257),h=n(18);n(977);t.default=function(e){var t=e.communityId,n=e.pubData,r=e.onSetDownloads,a=e.text,i=void 0===a?"Upload your file":a,c=e.isLarge,b=void 0!==c&&c,v=e.isSmall,y=void 0!==v&&v,g=e.isMinimal,_=void 0!==g&&g,E=u((0,s.useState)(!1),2),P=E[0],w=E[1],O=(0,p.getFormattedDownload)(n.downloads),C=O||{},S=C.url,D=void 0===S?"":S,k=C.date,j=D.split(".").pop().toLowerCase(),M=function(e){return o(void 0,void 0,void 0,(function(){var a,i;return l(this,(function(o){switch(o.label){case 0:a=e?[{type:"formatted",url:e,createdAt:new Date}]:[],o.label=1;case 1:return o.trys.push([1,3,,4]),w(!0),[4,(0,h.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify({downloads:a,pubId:n.id,communityId:t})})];case 2:return o.sent(),r(a),w(!1),[3,4];case 3:return i=o.sent(),console.error("Error Saving Pub Downloads: ",i),[3,4];case 4:return[2]}}))}))};return s.default.createElement("div",{className:"download-chooser-component"},s.default.createElement("div",{className:"buttons"},s.default.createElement(m.FileUploadButton,{icon:"upload",onUploadFinish:M,text:i,isLarge:b,isSmall:y,isMinimal:_}),O&&s.default.createElement(s.default.Fragment,null,s.default.createElement(f.Button,{icon:"download",text:"Download "+j.toUpperCase(),onClick:function(){return window.open(D)},small:y}),s.default.createElement(f.Button,{text:"Remove file",icon:"trash",onClick:function(){return M(null)},loading:P,small:y}))),k&&s.default.createElement("div",{className:"subtext"},"Uploaded ",(0,d.default)(k,"mmm dd, yyyy")))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(3)),c=n(9),s=n(77),d=n(939),f=n(942),m=n(943),p=o(n(974));n(976);var h=(0,s.getEmptyDoc)();t.default=function(e){var t=e.nodeLabels,n=void 0===t?{}:t,r=e.noteManager,a=e.collaborativeOptions,i=e.customMarks,o=void 0===i?{}:i,s=e.customNodes,b=void 0===s?{}:s,v=e.customPlugins,y=void 0===v?{}:v,g=e.debounceEditsMs,_=void 0===g?0:g,E=e.discussionsOptions,P=e.enableSuggestions,w=void 0!==P&&P,O=e.initialContent,C=e.isReadOnly,S=void 0!==C&&C,D=e.nodeOptions,k=void 0===D?{}:D,j=e.onChange,M=e.onError,N=e.onEdit,I=e.onKeyPress,x=e.onScrollToSelection,T=e.placeholder,A=(0,l.useRef)(null),R=(0,d.useSuggestions)(w),B=R.suggesting,F=R.suggestionManager,L=(0,c.usePageContext)().noteManager,U=r||L,z=O||h,H=(0,f.useInitialValues)({nodeLabels:n,nodeOptions:k,noteManager:U,customNodes:b,customMarks:o,initialContent:z,isReadOnly:S}),V=H.initialDocNode,q=H.schema,W=H.staticContent;return(0,m.useEditorView)({customPlugins:y,pluginsOptions:{noteManager:U,discussionsOptions:E||null,collaborativeOptions:a||null,initialDoc:V,isReadOnly:S,nodeLabels:n,onChange:j,onError:M,placeholder:T,suggestionManager:F},debounceEditsMs:_,initialDocNode:V,schema:q,isReadOnly:S,onKeyPress:I,onScrollToSelection:x,onError:M,onEdit:N,mountRef:A}),l.default.createElement(l.default.Fragment,null,l.default.createElement("div",{ref:A,className:(0,u.default)("editor","ProseMirror",S&&"read-only")},W),B&&l.default.createElement("div",{style:F.getPosition()},l.default.createElement(p.default,{nodeLabels:n,references:B.items,activeReference:F.getSelectedValue(),onReferenceSelect:function(e){return F.select(e)}})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.applyStepsToDoc=t.getStepsInChangeRange=void 0;var i=n(27),o=n(158);t.getStepsInChangeRange=function(e,t,n,l){return r(void 0,void 0,void 0,(function(){var r,u;return a(this,(function(a){switch(a.label){case 0:return[4,e.child("changes").orderByKey().startAt(n.toString()).endAt(l.toString()).once("value")];case 1:return r=a.sent(),(u=r.val())?[2,Object.keys(u).sort((function(e,t){return parseInt(e,10)-parseInt(t,10)})).map((function(e){return u[e]})).map((function(e){return e.s.map((function(e){return i.Step.fromJSON(t,(0,o.uncompressStepJSON)(e))}))}))]:[2,[]]}}))}))};t.applyStepsToDoc=function(e,t){return e.reduce((function(e,t){var n=t.apply(e),r=n.doc,a=n.failed;if(a)throw new Error(a);return r}),t)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultMarks=t.defaultNodes=void 0;var i=n(853),o=a(n(854)),l=a(n(866)),u=a(n(867)),c=a(n(869)),s=a(n(870)),d=a(n(871)),f=a(n(872)),m=a(n(891)),p=a(n(892)),h=a(n(893)),b=a(n(894)),v=a(n(895));t.defaultNodes=r(r(r(r(r(r(r(r(r(r(r(r(r({},i.baseNodes),o.default),l.default),u.default),c.default),s.default),d.default),f.default),m.default),p.default),h.default),b.default),v.default),t.defaultMarks=r({},i.baseMarks)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.baseMarks=t.baseNodes=void 0,t.baseNodes={doc:{content:"block+",attrs:{meta:{default:{}}}},paragraph:{selectable:!1,content:"inline*",group:"block",attrs:{id:{default:null},class:{default:null},textAlign:{default:null},rtl:{default:null}},parseDOM:[{tag:"p",getAttrs:function(e){return{id:e.getAttribute("id"),class:e.getAttribute("class"),textAlign:e.getAttribute("data-text-align"),rtl:e.getAttribute("data-rtl")}}}],toDOM:function(e){var t=!e.content||Array.isArray(e.content)&&!e.content.length?["br"]:0;return["p",r(r(r({class:e.attrs.class},e.attrs.id&&{id:e.attrs.id}),e.attrs.textAlign&&{"data-text-align":e.attrs.textAlign}),e.attrs.rtl&&{"data-rtl":e.attrs.rtl.toString()}),t]}},blockquote:{content:"block+",group:"block",attrs:{id:{default:null}},selectable:!1,parseDOM:[{tag:"blockquote",getAttrs:function(e){return{id:e.getAttribute("id")}}}],toDOM:function(e){return["blockquote",r({},e.attrs.id&&{id:e.attrs.id}),0]}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],selectable:!0,toDOM:function(){return["div",["hr"]]}},heading:{attrs:{level:{default:1},fixedId:{default:""},id:{default:""},textAlign:{default:null},rtl:{default:null}},content:"inline*",group:"block",defining:!0,selectable:!1,parseDOM:[1,2,3,4,5,6].map((function(e){return{tag:"h"+e,getAttrs:function(t){return{id:t.getAttribute("id"),textAlign:t.getAttribute("data-text-align"),rtl:t.getAttribute("data-rtl"),level:e}}}})),toDOM:function(e){return["h"+e.attrs.level,r(r({id:e.attrs.fixedId||e.attrs.id},e.attrs.textAlign&&{"data-text-align":e.attrs.textAlign}),e.attrs.rtl&&{"data-rtl":e.attrs.rtl.toString()}),0]}},ordered_list:{content:"list_item+",group:"block",attrs:{id:{default:null},order:{default:1},rtl:{default:null}},selectable:!1,parseDOM:[{tag:"ol",getAttrs:function(e){return{id:e.getAttribute("id"),order:e.hasAttribute("start")?+e.getAttribute("start"):1,rtl:e.getAttribute("data-rtl")}}}],toDOM:function(e){return["ol",r(r(r(r({},e.attrs.id&&{id:e.attrs.id}),e.attrs.textAlign&&{"data-text-align":e.attrs.textAlign}),e.attrs.rtl&&{"data-rtl":e.attrs.rtl.toString()}),{start:1===e.attrs.order?null:e.attrs.order}),0]}},bullet_list:{content:"list_item+",group:"block",attrs:{id:{default:null},rtl:{default:null}},selectable:!1,parseDOM:[{tag:"ul",getAttrs:function(e){return{id:e.getAttribute("id"),rtl:e.getAttribute("data-rtl")}}}],toDOM:function(e){return["ul",r(r(r({},e.attrs.id&&{id:e.attrs.id}),e.attrs.textAlign&&{"data-text-align":e.attrs.textAlign}),e.attrs.rtl&&{"data-rtl":e.attrs.rtl.toString()}),0]}},list_item:{content:"paragraph block*",defining:!0,selectable:!1,parseDOM:[{tag:"li"}],toDOM:function(){return["li",0]}},code_block:{content:"text*",group:"block",attrs:{id:{default:null}},code:!0,selectable:!1,parseDOM:[{tag:"pre",getAttrs:function(e){return{id:e.getAttribute("id")}},preserveWhitespace:"full"}],toDOM:function(e){return["pre",r({},e.attrs.id&&{id:e.attrs.id}),["code",0]]}},text:{inline:!0,group:"inline",toDOM:function(e){return e.text}},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}}},t.baseMarks={em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:function(e){return"italic"===e&&null}}],toDOM:function(){return["em"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(e){return"normal"!==e.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(e){return/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}}],toDOM:function(){return["strong"]}},link:{inclusive:!1,attrs:{href:{default:""},title:{default:null},target:{default:null}},parseDOM:[{tag:"a[href]",getAttrs:function(e){return"reference"!==e.getAttribute("data-node-type")&&{href:e.getAttribute("href"),title:e.getAttribute("title"),target:e.getAttribute("target")}}}],toDOM:function(e){var t=e.attrs;return t.target&&"string"!=typeof t.target&&(t.target=null),["a",t]}},sub:{parseDOM:[{tag:"sub"}],toDOM:function(){return["sub"]}},sup:{parseDOM:[{tag:"sup"}],toDOM:function(){return["sup"]}},strike:{parseDOM:[{tag:"s"},{tag:"strike"},{tag:"del"}],toDOM:function(){return["s"]}},code:{parseDOM:[{tag:"code"}],toDOM:function(){return["code"]}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(389),i=n(114),o=n(394);t.default={citation:{atom:!0,reactive:!0,attrs:{id:{default:null},href:{default:null},value:{default:""},unstructuredValue:{default:""},customLabel:{default:""}},reactiveAttrs:{count:(0,i.counter)({nodeFingerprintFn:function(e){return[e.attrs.value,e.attrs.unstructuredValue]}}),citation:(0,o.structuredCitation)("value")},parseDOM:[{tag:"span",getAttrs:function(e){return"citation"===e.getAttribute("data-node-type")&&{id:e.getAttribute("id"),value:e.getAttribute("data-value")||"",unstructuredValue:e.getAttribute("data-unstructured-value")||"",customLabel:e.getAttribute("data-custom-label")||""}}}],toDOM:function(e){var t=e.attrs,n=t.href,i=t.id,o=t.value,l=t.unstructuredValue,u=t.customLabel;return[n?"a":"span",r(r(r({},n&&{href:n}),i&&{id:i}),{"data-node-type":"citation","data-value":o,"data-unstructured-value":l,"data-custom-label":u,class:"citation"}),(0,a.getCitationInlineLabel)(e)]},inline:!0,group:"inline"}}},,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(129),l=n(114);t.default={equation:{atom:!0,attrs:{id:{default:null},value:{default:""},html:{default:""},renderForPandoc:{default:!1}},parseDOM:[{tag:"span",getAttrs:function(e){return"math-inline"===e.getAttribute("data-node-type")&&{value:e.getAttribute("data-value")||"",html:e.firstChild.innerHTML||""}}}],toDOM:function(e,t){var n=(void 0===t?{isReact:!1}:t).isReact;return["span",{"data-node-type":"math-inline","data-value":e.attrs.value},(0,o.renderHtmlChildren)(n,e.attrs.html)]},inline:!0,group:"inline",draggable:!1},block_equation:{atom:!0,reactive:!0,attrs:{id:{default:null},value:{default:""},html:{default:""},renderForPandoc:{default:!1},hideLabel:{default:!1}},reactiveAttrs:{count:(0,l.counter)({useNodeLabels:!0})},parseDOM:[{tag:"div",getAttrs:function(e){var t;if("math-block"!==e.getAttribute("data-node-type"))return!1;var n=(null===(t=e.querySelector("span.katex"))||void 0===t?void 0:t.outerHTML)||e.firstChild.innerHTML;return{id:e.getAttribute("id")||null,value:e.getAttribute("data-value")||"",html:n||""}}}],toDOM:function(e,t){var n=(void 0===t?{}:t).isReact;return e.attrs.renderForPandoc?i.default.createElement("script",{type:"math/tex-display",dangerouslySetInnerHTML:{__html:e.attrs.value}}):["div",r(r({},e.attrs.id&&{id:e.attrs.id}),{"data-node-type":"math-block","data-value":e.attrs.value}),["span"],(0,o.renderHtmlChildren)(n,e.attrs.html),["span",{class:"equation-label",spellcheck:"false"},e.attrs.count?"("+e.attrs.count+")":""]]},inline:!1,group:"block"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(868),i=n(114),o=function(e){var t;return r({class:"math-node"},(null===(t=e.attrs)||void 0===t?void 0:t.id)&&{id:e.attrs.id})},l=function(e,t,n){var i=e.attrs,l=e.textContent,u=null==i?void 0:i.count,c=u?l+" \\tag{"+u+"}":l,s=(0,a.renderToKatexString)(c,{displayMode:n,throwOnError:!1,globalGroup:!0});return[t,r(r({},o(e)),{dangerouslySetInnerHTML:{__html:s}})]};t.default={math_inline:r(r({},{content:"text*",inline:!0,atom:!0,parseDOM:[{tag:"math-inline"}]}),{group:"inline",toDOM:function(e,t){return(void 0===t?{isReact:!1}:t).isReact?l(e,"math-inline",!1):["math-inline",{class:"math-node"},0]}}),math_display:r(r({},{content:"text*",atom:!0,code:!0,parseDOM:[{tag:"math-display"}]}),{reactive:!0,group:"block",attrs:{id:{default:null},hideLabel:{default:!1}},reactiveAttrs:{count:(0,i.counter)({useNodeLabels:!0})},toDOM:function(e,t){return(void 0===t?{isReact:!1}:t).isReact?l(e,"div",!0):["math-display",o(e),0]}})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderToKatexString=void 0;var a=r(n(301));t.renderToKatexString=function(e,t){try{return a.default.renderToString(e,t)}catch(e){return'<div class="parse-error">(math error)</div>'}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(129);t.default={file:{atom:!0,attrs:{id:{default:null},url:{default:null},fileName:{default:null},fileSize:{default:null},caption:{default:""}},parseDOM:[{tag:"figure",getAttrs:function(e){return"file"===e.getAttribute("data-node-type")&&{id:e.getAttribute("id")||null,url:e.getAttribute("data-url")||null,fileName:e.getAttribute("data-file-name")||null,fileSize:e.getAttribute("data-file-size")||null,caption:e.getAttribute("data-caption")||""}}}],toDOM:function(e,t){var n=(void 0===t?{}:t).isReact,i=e.attrs,o=function(e){var t=e.fileName,n=e.url;return n&&n.includes(".")?n.split(".").pop():t&&t.includes(".")?t.split(".").pop():""}(i);return["figure",r(r({},e.attrs.id&&{id:e.attrs.id}),{"data-node-type":"file","data-url":e.attrs.url,"data-file-name":e.attrs.fileName,"data-file-size":e.attrs.fileSize,"data-caption":e.attrs.caption,class:"file"}),["div",{class:"bp3-card bp3-elevation-2 details"},["div",{"data-type":o.substring(0,4),class:"file-icon file-icon-default"}],["div",{class:"file-name"},["a",{href:i.url,target:"_blank",rel:"noopener noreferrer",download:i.fileName},["span",{},i.fileName]]],["div",{class:"file-size"},i.fileSize?i.fileSize.toString():""],["a",{href:i.url,target:"_blank",rel:"noopener noreferrer",download:i.fileName,class:"bp3-button bp3-icon-download"}]],["figcaption",{},(0,a.renderHtmlChildren)(n,e.attrs.caption,"div")]]},inline:!1,group:"block"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(114),i=n(394);t.default={footnote:{atom:!0,reactive:!0,attrs:{id:{default:null},href:{default:null},value:{default:""},structuredValue:{default:""}},reactiveAttrs:{count:(0,a.counter)(),citation:(0,i.structuredCitation)("structuredValue")},parseDOM:[{tag:"span",getAttrs:function(e){return"footnote"===e.getAttribute("data-node-type")&&{value:e.getAttribute("data-value")||"",structuredValue:e.getAttribute("data-structured-value")||""}}}],toDOM:function(e){var t=e.attrs,n=t.href,a=t.id,i=t.count,o=t.value,l=t.structuredValue;return[n?"a":"span",r(r(r({},n&&{href:n}),a&&{id:a}),{"data-node-type":"footnote","data-value":o,"date-structured-value":l,class:"footnote"}),String(i)]},inline:!0,group:"inline"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(129);t.default={iframe:{atom:!0,attrs:{id:{default:null},url:{default:""},size:{default:75},height:{default:419},align:{default:"center"},caption:{default:""}},parseDOM:[{tag:"figure",getAttrs:function(e){return"iframe"===e.getAttribute("data-node-type")&&{id:e.getAttribute("id")||null,url:e.firstChild.getAttribute("src")||null,size:Number(e.getAttribute("data-size"))||75,height:Number(e.firstChild.getAttribute("height"))||419,align:e.getAttribute("data-align")||"center",caption:e.firstChild.getAttribute("alt")||""}}}],toDOM:function(e,t){var n=(void 0===t?{isReact:!1}:t).isReact,i=e.attrs.id+"-figure-caption";return["figure",r(r({},e.attrs.id&&{id:e.attrs.id}),{"data-node-type":"iframe","data-size":e.attrs.size,"data-align":e.attrs.align}),["iframe",{alt:e.attrs.caption,src:e.attrs.url,height:e.attrs.height,"aria-describedby":i}],["figcaption",{id:i},(0,a.renderHtmlChildren)(n,e.attrs.caption,"div")]]},inline:!1,group:"block"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=n(159),o=n(88),l=n(395),u=n(115),c=n(129),s=n(114),d=n(213),f=function(e,t,n){return e&&t?{"aria-describedby":n}:t?{"aria-labelledby":n}:{}};t.default={image:{atom:!0,reactive:!0,attrs:{id:{default:null},url:{default:null},size:{default:50},align:{default:"center"},caption:{default:""},altText:{default:""},hideLabel:{default:!1},fullResolution:{default:!1},href:{default:null}},reactiveAttrs:{count:(0,s.counter)({useNodeLabels:!0}),label:(0,d.label)()},parseDOM:[{tag:"figure",getAttrs:function(e){return"image"===e.getAttribute("data-node-type")&&{id:e.getAttribute("id")||null,url:e.getAttribute("data-url")||null,caption:e.getAttribute("data-caption")||"",size:Number(e.getAttribute("data-size"))||50,align:e.getAttribute("data-align")||"center",altText:e.getAttribute("data-alt-text")||"",href:e.getAttribute("data-href")||null}}}],toDOM:function(e,t){var n=(void 0===t?{isReact:!1}:t).isReact,s=e.attrs,d=s.url,m=s.align,p=s.id,h=s.altText,b=s.caption,v=s.fullResolution,y=s.size,g=s.href,_="breakout"===m?1920:800,E=(0,l.isResizeableFormat)(d)&&!v,P=E?(0,o.getResizedUrl)(d,"inside",_):d,w=E?(0,o.getSrcSet)(d,"inside",_):"",O=p+"-figure-caption",C=["img",r({srcSet:w,src:P,alt:h||""},f(h,b,O))];return["figure",r(r({},p&&{id:p}),{"data-node-type":"image","data-size":y,"data-align":m,"data-url":d,"data-caption":b,"data-href":g,"data-alt-text":h}),g?["a",{href:g,target:"_blank"},C]:C,["figcaption",{id:O},(0,a.pruneFalsyValues)(["div",{},(0,i.withValue)((0,u.buildLabel)(e),(function(e){return["strong",{spellcheck:"false"},e]})),(0,c.renderHtmlChildren)(n,b,"div")])]]},inline:!1,group:"block"}}},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(214),i=n(7),o=n(62),l=n(159),u=n(114),c=n(213),s=n(115),d=(0,a.tableNodes)({tableGroup:"block",cellContent:"block+",cellAttributes:{background:{default:null,getFromDOM:function(e){return e.style.backgroundColor||null},setDOMAttr:function(e){}}}}),f=d.table;f.onInsert=function(e){for(var t=e.state,n=t.tr,r=t.schema,a=r.nodes.table,o=r.nodes.table_row,l=r.nodes.table_cell.createAndFill({}),u=[],c=0;c<3;c+=1)u.push(l);var s=o.create(null,i.Fragment.from(u)),d=[];for(c=0;c<3;c+=1)d.push(s);var f=a.create(null,i.Fragment.from(d));e.dispatch(n.replaceSelectionWith(f).scrollIntoView())};var m=f.toDOM;f.attrs=r(r({},f.attrs),{id:{default:null},hideLabel:{default:!1}}),f.reactive=!0,f.reactiveAttrs={count:(0,u.counter)({useNodeLabels:!0}),label:(0,c.label)()},f.parseDOM[0].getAttrs=function(e){return{id:e.getAttribute("id")||null}},f.toDOM=function(e){var t=m(e);return(0,o.pruneFalsyValues)([t[0],{id:e.attrs.id},(0,l.withValue)((0,s.buildLabel)(e),(function(e){return["caption",e]})),t[1]])},t.default=d},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=n(159),o=n(129),l=n(114),u=n(213),c=n(115);t.default={video:{atom:!0,reactive:!0,attrs:{id:{default:null},url:{default:null},size:{default:50},align:{default:"center"},caption:{default:""},hideLabel:{default:!1}},reactiveAttrs:{count:(0,l.counter)({useNodeLabels:!0}),label:(0,u.label)()},parseDOM:[{tag:"figure",getAttrs:function(e){return"video"===e.getAttribute("data-node-type")&&{id:e.getAttribute("id")||null,url:e.firstChild.getAttribute("src")||null,size:Number(e.getAttribute("data-size"))||50,align:e.getAttribute("data-align")||"center",caption:e.firstChild.getAttribute("alt")||""}}}],toDOM:function(e,t){var n=(void 0===t?{isReact:!1}:t).isReact,l=e.attrs.id+"-figure-caption";return["figure",r(r({},e.attrs.id&&{id:e.attrs.id}),{"data-node-type":"video","data-size":e.attrs.size,"data-align":e.attrs.align}),["video",{controls:"true",preload:"metadata",src:e.attrs.url,alt:e.attrs.caption,"aria-describedby":l}],["figcaption",{id:l},(0,a.pruneFalsyValues)(["div",{},(0,i.withValue)((0,c.buildLabel)(e),(function(e){return["strong",{spellcheck:"false"},e]})),(0,o.renderHtmlChildren)(n,e.attrs.caption,"div")])]]},inline:!1,group:"block"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(62),i=n(159),o=n(115),l=n(129),u=n(114),c=n(213);t.default={audio:{atom:!0,reactive:!0,attrs:{id:{default:null},url:{default:null},size:{default:50},align:{default:"center"},caption:{default:""},hideLabel:{default:!1}},reactiveAttrs:{count:(0,u.counter)({useNodeLabels:!0}),label:(0,c.label)()},parseDOM:[{tag:"figure",getAttrs:function(e){return"audio"===e.getAttribute("data-node-type")&&{id:e.getAttribute("id")||null,url:e.firstChild.getAttribute("src")||null,size:Number(e.getAttribute("data-size"))||50,align:e.getAttribute("data-align")||"center",caption:e.firstChild.getAttribute("alt")||""}}}],toDOM:function(e,t){var n=(void 0===t?{isReact:!1}:t).isReact,u=e.attrs.id+"-figure-caption";return["figure",r(r({},e.attrs.id&&{id:e.attrs.id}),{"data-node-type":"audio","data-size":e.attrs.size,"data-align":e.attrs.align}),["audio",{controls:"true",preload:"metadata",src:e.attrs.url,alt:e.attrs.caption,"aria-describedby":u}],["figcaption",{id:u},(0,a.pruneFalsyValues)(["div",{},(0,i.withValue)((0,o.buildLabel)(e),(function(e){return["strong",{spellcheck:"false"},e]})),(0,l.renderHtmlChildren)(n,e.attrs.caption,"div")])]]},inline:!1,group:"block"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(3)),o=n(105),l=n(115);t.default={reference:{atom:!0,isLeaf:!0,inline:!0,reactive:!0,selectable:!0,group:"inline",attrs:{id:{default:null},targetId:{default:null}},reactiveAttrs:{label:function(e){var t=e.attrs.targetId,n=(0,o.useDocumentState)().nodeLabels;return t?(0,o.useDeferredNode)(t,(function(e){if(!e)return null;var t=(0,l.getReferenceableNodeType)(e),r=n[t];return r&&r.enabled?(0,l.buildLabel)(e,null==r?void 0:r.text):null})):null}},parseDOM:[{tag:"a",getAttrs:function(e){if("reference"!==e.getAttribute("data-node-type"))return!1;var t=e.getAttribute("data-target-id");return{id:e.getAttribute("id"),targetId:t,href:"#"+t}}}],toDOM:function(e){var t=e.attrs,n=t.id,a=t.targetId,o=t.label;return["a",r(r({},n&&{id:n}),{href:"#"+a,class:(0,i.default)("reference",!o&&"missing"),"data-node-type":"reference","data-target-id":a}),o||"(ref?)"]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={group:"block",toDOM:function(){return["span"]}};t.default={highlightQuote:r,citationList:r,footnoteList:r,discussion:r}},,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getFirebaseDoc=t.getLatestKeyAndTimestamp=t.getFirstKeyAndTimestamp=void 0;var u=n(7),c=n(27),s=n(158),d=n(210),f=n(405),m=function(e,t,n){return void 0===n&&(n=null),a(void 0,void 0,void 0,(function(){var r,a,o,l,u,c,f,m;return i(this,(function(i){switch(i.label){case 0:return t?(r=Object.keys(t).map((function(e){return parseInt(e,10)})),(a=r.filter((function(e){return"number"!=typeof n||e<=n})).reduce((function(e,t){return Math.max(e,t)}),-1))>=0?[4,e.child("checkpoints/"+a).once("value")]:[3,2]):[3,2];case 1:if(o=i.sent(),l=o.val())return[2,{doc:(0,s.uncompressStateJSON)(l).doc,key:a,timestamp:l.t}];i.label=2;case 2:return[4,e.child("checkpoint").once("value")];case 3:return u=i.sent(),(c=u.val())&&(f=c.k,m=parseInt(f,10),"number"!=typeof n||m<=n)?[2,{doc:(0,s.uncompressStateJSON)(c).doc,key:m}]:[2,{doc:(0,d.getEmptyDoc)(),key:-1}]}}))}))},p=function(e,t){return function(n){return a(void 0,void 0,void 0,(function(){var a,l,u,c,s,d,f,m,p,h,b;return i(this,(function(i){switch(i.label){case 0:return a=e(n.child("changes").orderByKey()).once("value"),l=e(n.child("merges").orderByKey()).once("value"),[4,Promise.all([a,l])];case 1:return u=o.apply(void 0,[i.sent(),2]),c=u[0],s=u[1],d=r(r({},c.val()),s.val()),f=Object.keys(d).map((function(e){return parseInt(e,10)})),m=t(f),p=d[m],h=Array.isArray(p)?p[p.length-1]:p,b=h&&h.t,[2,{key:m,timestamp:b}]}}))}))}};t.getFirstKeyAndTimestamp=p((function(e){return e.limitToFirst(1)}),(function(e){return e.length?e.reduce((function(e,t){return Math.min(e,t)}),1/0):-1})),t.getLatestKeyAndTimestamp=p((function(e){return e.limitToLast(1)}),(function(e){return e.length?e.reduce((function(e,t){return Math.max(e,t)}),-1/0):-1}));t.getFirebaseDoc=function(e,t,n){return void 0===n&&(n=null),a(void 0,void 0,void 0,(function(){var a,d,p,h,b,v,y,g,_,E,P,w,O,C,S,D,k;return i(this,(function(i){switch(i.label){case 0:return[4,e.child("checkpointMap").once("value")];case 1:return a=i.sent(),d=a.val(),[4,m(e,d,n)];case 2:return p=i.sent(),h=p.doc,b=p.key,v=p.timestamp,y=e.child("changes").orderByKey().startAt(String(b+1)).endAt(String(n)).once("value"),g=e.child("merges").orderByKey().startAt(String(b+1)).endAt(String(n)).once("value"),[4,Promise.all([y,g])];case 3:return _=o.apply(void 0,[i.sent(),2]),E=_[0],P=_[1],w=r(r({},E.val()),P.val()),O=(0,f.flattenKeyables)(w),C=O.map((function(e){return e.s.map(s.uncompressStepJSON)})).reduce((function(e,t){return l(l([],o(e),!1),o(t),!1)}),[]),S=Object.keys(w),D=S.length?S.map((function(e){return parseInt(e,10)})).reduce((function(e,t){return Math.max(e,t)})):b,k=O.length>0?O[O.length-1].t:v,[2,{doc:C.reduce((function(e,n){var r=c.Step.fromJSON(t,n).apply(e),a=r.failed,i=r.doc;return a&&console.error("Failed with: "+a),i}),u.Node.fromJSON(t,h)),docIsFromCheckpoint:0===C.length,key:D,timestamp:k,checkpointMap:d}]}}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateHash=void 0;t.generateHash=function(e){for(var t=e||32,n="abcdefghijklmnopqrstuvwxyz0123456789",r="",a=0;a<t;a+=1)r+=n.charAt(Math.floor(Math.random()*n.length));return r}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.insertNodeIntoEditor=t.updateNodeAttrsById=void 0;t.updateNodeAttrsById=function(e,t,n){var a=e.state,i=a.doc,o=a.tr,l=null,u=null;i.descendants((function(e,n){if(e.attrs.id===t&&(u=n,l=e),null!==l)return!1})),l&&null!==u&&(o.setNodeMarkup(u,void 0,r(r({},l.attrs),n)),e.dispatch(o))};t.insertNodeIntoEditor=function(e,t,n){var r=e.state,a=r.schema,i=r.tr,o=a.nodes[t];if(o.spec.onInsert)o.spec.onInsert(e,n);else{var l=o.create(n),u=i.replaceSelectionWith(l);e.dispatch(u)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getNotesByKindFromDoc=void 0;var a=r(n(901));t.getNotesByKindFromDoc=function(e){var t=[],n=[];return e.nodesBetween(0,e.nodeSize-2,(function(e){var r=function(e){var t=e.attrs,n=t.unstructuredValue;return t.value+"-"+(n?(0,a.default)(n):"")}(e);if("footnote"===e.type.name){var i=e.attrs,o=i.value,l=i.structuredValue;t.push({id:e.attrs.id,unstructuredValue:o,structuredValue:l,fingerprint:r})}if("citation"===e.type.name){var u=e.attrs,c=u.unstructuredValue;o=u.value;n.push({id:e.attrs.id,structuredValue:o,unstructuredValue:c,fingerprint:r})}return!0})),{footnotes:t,citations:n}}},,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderStatic=t.getReactedDocFromJson=void 0;var l=o(n(0)),u=o(n(903)),c=o(n(922)),s=n(7),d=n(105),f=function(e){try{var t={},n="* { "+e+" } ";return u.default.parse(n).stylesheet.rules[0].declarations.forEach((function(e){var n=e.property,r=e.value,a=(0,c.default)(n);t[a]=r})),t}catch(e){return{}}},m={rowspan:"rowSpan",colspan:"colSpan",class:"className",spellcheck:"spellCheck",style:function(e){return{style:"string"==typeof e?f(e):e}}},p=function(e){var t=e&&"object"==typeof e&&!Array.isArray(e);return{attrs:t?function(e){var t={};return Object.entries(e).forEach((function(e){var n=a(e,2),i=n[0],o=n[1];if(i in m){var l=m[i];"function"==typeof l?t=r(r({},t),l(o)):t[l]=o}else t[i]=o})),t}(e):{},hasAttrs:t}},h=function(e,t){if(!Array.isArray(e))return e;var n=a(e),o=n[0],u=n[1],c=n.slice(2),s=p(u),d=s.attrs,f=s.hasAttrs?c:i([u],a(c),!1);return l.default.createElement.apply(l.default,i([o,r(r({},d),{key:t})],a(f.map((function(e,n){return h(e,t+"-"+n)}))),!1))},b=function(e){return 0===e},v=function(e,t,n){if(Array.isArray(e)){var r=e.findIndex(b);return r>=0?i(i(i([],a(e.slice(0,r)),!1),a(t),!1),a(e.slice(r+1)),!1):n?i(i([],a(e),!1),a(t),!1):e.map((function(e){return v(e,t)}))}return e},y=function(e,t,n){var a=e.type,i=e.marks,o=e.content,l=e.attrs,u=void 0===l?{}:l,c=t.nodes[a].spec,d=Array.isArray(o)?o.map((function(e){return y(e,t,n)})):[],f=s.Node.fromJSON(t,e);f.attrs=function(e,t){if(t.attrs){var n={};return Object.keys(e).forEach((function(r){(t.attrs[r]||t.reactiveAttrs&&t.reactiveAttrs[r])&&(n[r]=e[r])})),n}return null}(u,c);var m=v(c.toDOM(f,r(r({},n),{isReact:!0})),d);return i?function(e,t,n){return t.reduce((function(e,t){var r=n.marks[t.type].spec;return v(r.toDOM(t),[e],!0)}),e)}(m,i,t):m};t.getReactedDocFromJson=function(e,t,n,r){var a=s.Node.fromJSON(t,e);return(0,d.getReactedDoc)(a,{documentState:{noteManager:n,nodeLabels:r}}).toJSON()};t.renderStatic=function(e){var n=e.schema,r=e.doc,a=e.reactedDoc,i=void 0===a?null:a,o=e.noteManager,l=e.nodeLabels,u=void 0===l?{}:l,c=e.context,s=void 0===c?{}:c;return(i||(0,t.getReactedDocFromJson)(r,n,o,u)).content.map((function(e,t){var r=y(e,n,s);return h(r,t)}))}},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findParentNode=t.findParentNodeClosestToPos=t.mouseEventSelectsNode=t.marksAtSelection=t.moveToEndOfSelection=t.moveToStartOfSelection=t.moveSelectionToEnd=t.moveSelectionToStart=void 0;var r=n(8);t.moveSelectionToStart=function(e){var t=e.state.tr;t.setSelection(r.Selection.atStart(e.state.doc)),e.dispatch(t)};t.moveSelectionToEnd=function(e){var t=e.state.tr;t.setSelection(r.Selection.atEnd(e.state.doc)),e.dispatch(t)};t.moveToStartOfSelection=function(e){var t=e.state.tr;e.dispatch(t.setSelection(new r.TextSelection(e.state.selection.$from)))};t.moveToEndOfSelection=function(e){var t=e.state.tr;e.dispatch(t.setSelection(new r.TextSelection(e.state.selection.$to)))};t.marksAtSelection=function(e){return e.state.selection.$from.marks().map((function(e){return e.type.name}))};t.mouseEventSelectsNode=function(e,t){var n=t.clientX,a=t.clientY;try{var i=e.posAtCoords({left:n,top:a});if(i){var o=i.inside,l=e.state.doc.nodeAt(o);if(l&&r.NodeSelection.isSelectable(l))return!0}}catch(e){if(e instanceof RangeError)return!1;throw e}return!1};t.findParentNodeClosestToPos=function(e,t){for(var n=e.depth;n>0;n--){var r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}return null};t.findParentNode=function(e){return function(n){var r=n.$from;return(0,t.findParentNodeClosestToPos)(r,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viewIsEmpty=t.focus=t.reanchorDiscussion=t.getLocalHighlightText=t.convertLocalHighlightToDiscussion=t.removeLocalHighlight=t.setLocalHighlight=t.formatDiscussionData=t.importDocJson=t.getCollabJSONs=t.getText=t.getTopLevelImages=t.getTextFromDoc=t.getJSON=t.dispatchEmptyTransaction=void 0;var r=n(8),a=n(7),i=n(261),o=n(416),l=n(210);t.dispatchEmptyTransaction=function(e){if(e.docView){var t=e.state.tr;e.dispatch(t)}};t.getJSON=function(e){return e?e.state.doc.toJSON():null};t.getTextFromDoc=function(e,t){return void 0===t&&(t="\n"),e.textBetween(0,e.nodeSize-2,t)};t.getTopLevelImages=function(e){var n=(0,t.getJSON)(e);return n?n.content.filter((function(e){return"image"===e.type})):[]};t.getText=function(e,n){return void 0===n&&(n="\n"),e?(0,t.getTextFromDoc)(e.state.doc,n):null};t.getCollabJSONs=function(e,t){var n=e.state.plugins.reduce((function(e,t){return"collaborative$"===t.key?t:e}),void 0);return n?n.getJSONs(t):null};t.importDocJson=function(e,t){var n=a.Node.fromJSON(e.state.schema,t),i=e.state.tr;return i.setSelection(r.Selection.atStart(e.state.doc)),i.replaceSelection(new a.Slice(n.content,0,0)),e.dispatch(i),n};t.formatDiscussionData=function(e,t,n){var r=(e.state.collaborative$||{}).mostRecentRemoteKey;return{currentKey:r,initAnchor:t,initHead:n,initKey:r,selection:{a:t,h:n,type:"text"}}};t.setLocalHighlight=function(e,t,n,r){var a=e.state.tr;a.setMeta("localHighlights",!0),a.setMeta("newLocalHighlightData",[{from:t,to:n,id:r}]),e.dispatch(a)};t.removeLocalHighlight=function(e,t){var n=e.state.tr;n.setMeta("localHighlights",!0),n.setMeta("localHighlightIdToRemove",t),e.dispatch(n)};t.convertLocalHighlightToDiscussion=function(e,n){var r=e.state.localHighlights$.activeDecorationSet.find().filter((function(e){return e.type.attrs&&e.type.attrs.class})).find((function(e){return e.type.attrs.class.replace("local-highlight lh-","")===n}));r&&((0,i.addDiscussionToView)(e,n,{anchor:r.from,head:r.to,type:"text"}),(0,t.removeLocalHighlight)(e,n))};t.getLocalHighlightText=function(e,t){var n=e.state.localHighlights$.activeDecorationSet.find().filter((function(e){return e.type.attrs&&e.type.attrs.class})).reduce((function(e,n){return n.type.attrs.class.replace("local-highlight lh-","")===t?n:e}),void 0);if(!n)return null;var r=n.from,a=n.to;return{from:r,to:a,exact:e.state.doc.textBetween(r,a),prefix:e.state.doc.textBetween(Math.max(0,r-100),Math.max(0,r)),suffix:e.state.doc.textBetween(Math.min(e.state.doc.nodeSize-2,a),Math.min(e.state.doc.nodeSize-2,a+100))}};t.reanchorDiscussion=function(e,t,n){var r=(e.state.collaborative$||{}).mostRecentRemoteKey,a=e.state.selection,i=a.anchor,o=a.head,l=e.state.tr;l.setMeta("removeDiscussion",{id:n}),e.dispatch(l),t.child("discussions").child(n).update({currentKey:r,selection:{a:i,h:o,t:"text"}})};t.focus=function(e){e.focus()};t.viewIsEmpty=function(e){return(0,l.isEmptyDocNode)(e.doc)&&!(0,o.editorHasPasteDecorations)(e)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getAnchoredDiscussionIds=t.addDiscussionToView=t.discussionsPluginKey=void 0;var a=n(8),i=n(47),o=n(926),l=n(927),u=n(928),c=n(932),s=n(933);t.discussionsPluginKey=new a.PluginKey("discussions");var d=function(e,n){var d=e.discussionAnchors,f=e.draftRef,m=e.initialHistoryKey,p=null==f?void 0:f.child("discussions"),h=p&&(0,s.connectToFirebaseDiscussions)(p),b=f&&(0,c.createFastForwarder)(f),v=(0,o.getDiscussionsFromAnchors)(d),y=null,g=(0,u.createDiscussionsState)({initialDiscussions:v,initialHistoryKey:m,initialDoc:n,remoteDiscussions:h||null,fastForwardDiscussions:b||null,onUpdateDiscussions:function(e){if(y){var n=y.state.tr;n.setMeta(t.discussionsPluginKey,{updateResult:e}),y.dispatch(n)}}}),_=g.addDiscussion,E=g.handleTransaction;return new a.Plugin({key:t.discussionsPluginKey,state:{init:function(){var e=(0,l.getDecorationsForDiscussions)(v);return{decorations:i.DecorationSet.create(n,e),addDiscussion:_}},apply:function(e,n,a){var i=function(e,n){var r=e.getMeta(t.discussionsPluginKey);return r&&r.updateResult?r.updateResult:E(e,n)}(e,a);return i?r(r({},n),{decorations:(0,l.getDecorationsForUpdateResult)(n.decorations,i)}):n}},view:function(e){return y=e,{destroy:function(){null==h||h.disconnect()}}},props:{decorations:function(e){var t;if(this instanceof a.Plugin){var n=this.getState(e);n&&(t=n.decorations)}return t}}})};t.addDiscussionToView=function(e,n,r){var a=t.discussionsPluginKey.getState(e.state);return a?a.addDiscussion(n,r):null};t.getAnchoredDiscussionIds=function(e){var n=t.discussionsPluginKey.getState(e.state);if(n){var r=n.decorations,a=[];return r.find().forEach((function(e){var t=e.spec.widgetForDiscussionId;t&&a.push(t)})),a}return[]},t.default=function(e,t){var n=t.discussionsOptions,r=t.initialDoc;return n?d(n,r):[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDiscussionsFromAnchors=void 0;var r=n(180);t.getDiscussionsFromAnchors=function(e){var t={};return e.forEach((function(e){var n=e.selection,a=e.discussionId,i=e.historyKey;n&&!(0,r.isEmptySelection)(n)&&(t[a]={initKey:i,currentKey:i,initAnchor:n.anchor,initHead:n.head,selection:n})})),t}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getDecorationsForDiscussions=t.getDecorationsForUpdateResult=void 0;var i=n(47),o=n(62),l=n(180),u=function(e,t,n){return i.Decoration.inline(t,n,{class:"discussion-range d-"+e},{key:"discussion-inline-"+e})},c=function(e,t){var n=document.createElement("span");return n.className="discussion-mount dm-"+e,i.Decoration.widget(t,n,{stopEvent:function(){return!0},key:"discussion-widget-"+e,widgetForDiscussionId:e,side:-1})},s=function(e,t){var n=t.selection;if(n){var r=(0,l.getRangeFromSelection)(n),a=r.from,i=r.to;return[u(e,a,i),c(e,i)]}return[]};t.getDecorationsForUpdateResult=function(e,t){var n=[],i=t.doc,u=t.mapping,d=e.find().filter((function(e){return function(e,t){return t.removedDiscussionIds.has(e.spec.discussionId)}(e,t)})),f=e.remove(d).map(u,i,{onRemove:function(e){var t=e.widgetForDiscussionId;t&&n.push(t)}}),m=a(a([],r(function(e){return(0,o.flattenOnce)(a([],r(e.addedDiscussionIds),!1).map((function(t){var n=e.discussions[t];return s(t,n)})))}(t)),!1),r(function(e,t){var n=t.discussions;return e.map((function(e){var t=n[e];if(t){var r=t.selection;if(r&&!(0,l.isEmptySelection)(r)){var a=(0,l.getRangeFromSelection)(r).to;return c(e,a)}}return null})).filter((function(e){return!!e}))}(n,t)),!1);return f.add(i,m)};t.getDecorationsForDiscussions=function(e){var t=Object.entries(e).map((function(e){var t=r(e,2),n=t[0],a=t[1];return s(n,a)}));return(0,o.flattenOnce)(t)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.createDiscussionsState=void 0;var i=n(27),o=n(929),l=n(180);t.createDiscussionsState=function(e){var t=e.initialDiscussions,n=e.initialHistoryKey,u=e.initialDoc,c=e.fastForwardDiscussions,s=e.onUpdateDiscussions,d=e.remoteDiscussions,f=(0,o.createHistoryState)(u,n),m=t,p=function(e,t){var n=function(e,t,n){var r={},i={},o=new Set,l=new Set;return Object.entries(t).forEach((function(t){var u=a(t,2),c=u[0],s=u[1];if(s){if(s.currentKey===n){var d=e[c],f=!d||d.currentKey<s.currentKey,m=!d||d.currentKey<=s.currentKey;f&&(r[c]=s),m&&(i[c]=s),d||l.add(c)}}else o.add(c)})),{addedDiscussionIds:l,removedDiscussionIds:o,sendableDiscussions:r,updatableDiscussions:i}}(m,e,t),i=n.sendableDiscussions,o=n.updatableDiscussions,u=n.removedDiscussionIds,c=n.addedDiscussionIds;return m=(0,l.removeDiscussionsById)(r(r({},m),o),u),null==d||d.sendDiscussions(i),{discussions:m,addedDiscussionIds:c,removedDiscussionIds:u}},h=function(e){if(0!==Object.keys(e).length){var t=f.getState(),n=t.currentDoc,r=t.currentHistoryKey,a=p(e,r),o=a.addedDiscussionIds,l=a.removedDiscussionIds;s({discussions:m,addedDiscussionIds:o,removedDiscussionIds:l,mapping:new i.Mapping,doc:n})}};return null==d||d.receiveDiscussions((function(e){var t=function(e){return Object.values(e).reduce((function(e,t){return t?Math.max(e,t.currentKey):e}),-1)}(e);f.onReachesKey(t,(function(){var t=f.getState(),n=t.currentDoc,r=t.currentHistoryKey;h(e),null==c||c(e,n,r).then(h)}))})),{addDiscussion:function(e,t){var n,r=f.getState().currentHistoryKey;h(((n={})[e]={initKey:r,currentKey:r,selection:t,initHead:t.head,initAnchor:t.anchor},n))},handleTransaction:function(e,t){var n=f.updateState(e,t),a=n.currentDoc,i=n.currentHistoryKey,o=n.previousHistoryKey;if(e.steps.length>0||i>o){var u=function(e,t,n,a){if(n===a&&0===t.length)return{};var i={};return Object.keys(e).forEach((function(o){var u=e[o];if(u.currentKey===n){var c=(0,l.mapDiscussionThroughSteps)(u,t);i[o]=r(r({},c),{currentKey:a})}})),i}(m,e.steps,o,i);return r(r({},p(u,i)),{mapping:e.mapping,doc:a})}return null}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHistoryState=void 0;var a=n(160);t.createHistoryState=function(e,t){var n=t,i=e,o=[],l=function(){return{currentHistoryKey:n,currentDoc:i}};return{onReachesKey:function(e,t){n>=e?t():o.push({key:e,callback:t})},updateState:function(e,t){var u,c=n,s=i,d=a.collabDocPluginKey.getState(t),f=null!==(u=null==d?void 0:d.mostRecentRemoteKey)&&void 0!==u?u:-1,m=e.doc;if(f>=n&&(n=f,i=m),n>c){var p=function(e,t){var n=[],r=[];return e.forEach((function(e){t>=e.key?n.push(e):r.push(e)})),{ready:n,notReady:r}}(o,n),h=p.ready,b=p.notReady;o=b,h.forEach((function(e){return e.callback()}))}return r(r({},l()),{previousHistoryKey:c,previousDoc:s})},getState:l}}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(415),l=n(27),u=n(158),c=n(77),s=function(){};t.default=function(e,t,n,d){var f,m=t.collaborativeOptions,p=t.isReadOnly,h=t.onError,b=void 0===h?s:h,v=m.firebaseRef,y=m.onStatusChange,g=void 0===y?s:y,_=m.onUpdateLatestKey,E=void 0===_?s:_,P=m.initialDocKey,w=!1,O=!1,C=null,S=[],D=function(e){var t=(0,o.sendableSteps)(e);return p||w||!t?null:(w=!0,v.child("changes").child(String(P+1)).transaction((function(e){if(g("saving"),!e)return(0,c.createFirebaseChange)(t.steps,d)}),void 0,!1).then((function(t){var n=t.committed,r=t.snapshot;if(w=!1,n){g("saved");r.key&&r.key%100==0&&(0,c.storeCheckpoint)(v,e.doc,r.key)}j()})).catch((function(e){console.error("Error in firebase transaction:",e),b(e)})))},k=function(t){var n=t.s.map((function(t){return l.Step.fromJSON(e,(0,u.uncompressStepJSON)(t))}));return{steps:n,clientIds:new Array(n.length).fill(t.cId)}},j=function(){return w||(S.forEach((function(e){try{var t=k(e.val()),n=t.steps,r=t.clientIds,a=(0,o.receiveTransaction)(f.state,n,r);P=Number(e.key),f.dispatch(a),E(P)}catch(e){console.error("Error in recieveCollabChanges:",e),b(e)}})),S=[],(0,o.sendableSteps)(f.state)&&D(f.state)),null},M=function(){return(0,c.getFirebaseConnectionMonitorRef)(v).on("value",(function(e){e.val()?O&&g("connected"):g("disconnected")})),v.child("changes").orderByKey().startAt(String(P+1)).once("value").then((function(e){var t=e.val()||{},n=[],i=[],l=Object.keys(t);Object.keys(t).forEach((function(e){var o=k(t[e]),l=o.steps,u=o.clientIds;n.push.apply(n,a([],r(l),!1)),i.push.apply(i,a([],r(u),!1))})),P=l.length?l.map((function(e){return Number(e)})).reduce((function(e,t){return Math.max(e,t)}),0):P;var u=(0,o.receiveTransaction)(f.state,n,i);f.dispatch(u),E(P);var c=f.state.tr;return c.setMeta("finishedLoading",!0),f.dispatch(c),g("connected"),O=!0,(C=v.child("changes").orderByKey().startAt(String(P+1))).on("child_added",(function(e){!function(e){S.push(e),j()}(e)}))})).catch((function(e){console.error("In loadDocument Error with ",e,e.message)}))};return new i.Plugin({key:n,state:{init:function(){return{isLoaded:!1,localClientId:d,localClientData:m.clientData,sendCollabChanges:D}},apply:function(e,t){return{isLoaded:e.getMeta("finishedLoading")||t.isLoaded,mostRecentRemoteKey:P,localClientId:d,localClientData:m.clientData,sendCollabChanges:D}}},view:function(e){return f=e,M(),{destroy:function(){null==C||C.off("child_added"),(0,c.getFirebaseConnectionMonitorRef)(v).off("value"),S=[]}}}})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.cursorsPluginKey=void 0;var a=n(8),i=n(47),o=n(158);t.cursorsPluginKey=new a.PluginKey("cursors");t.default=function(e,n,l){return new a.Plugin({key:t.cursorsPluginKey,state:{init:function(e,t){return{cursorDecorations:i.DecorationSet.create(t.doc,[])}},apply:function(e,t,u,c){if(n.isReadOnly)return t;var s=l.getState(c),d=s.localClientId,f=s.localClientData;t.cursorDecorations.find().forEach((function(e){e.spec.lastActive+3e5<(new Date).getTime()&&n.collaborativeOptions.firebaseRef.child("cursors").child(e.spec.key.replace("cursor-inline-","").replace("cursor-widget-","")).remove()}));var m=t.cursorDecorations.find().filter((function(t){var n=(e.getMeta("setCursor")||{}).id,r=(e.getMeta("removeCursor")||{}).id,a=t.spec.key.replace("cursor-inline-","").replace("cursor-widget-","");return r===a||n===a})),p=e.getMeta("setCursor"),h=p?function(e,t){var n,r=l.getState(t).localClientId;if(e.id===r)return[];try{n=a.Selection.fromJSON(t.doc,(0,o.uncompressSelectionJSON)(e.selection))}catch(e){return[]}var u="c-"+e.id,c=document.createElement("span");c.className="collab-cursor "+u;var s=document.createElement("span");s.className="inner-bar",c.appendChild(s);var d=document.createElement("style");c.appendChild(d);var f="",m=document.createElement("span");m.className="inner-circle-small "+u,s.appendChild(m);var p=document.createElement("span");p.className="hover-wrapper",s.appendChild(p);var h=document.createElement("span");if(h.className="inner-circle-big",p.appendChild(h),e.initials){var b=document.createElement("span");b.className="initials "+u,f+=".initials."+u+'::after { content: "'+e.initials+'"; } ',p.appendChild(b)}if(e.image){var v=document.createElement("span");v.className="image "+u,f+=".image."+u+"::after { background-image: url('"+e.image+"'); } ",p.appendChild(v)}if(e.name){var y=document.createElement("span");y.className="name "+u,f+=".name."+u+'::after { content: "'+e.name+'"; } ',e.cursorColor&&(y.style.backgroundColor=e.cursorColor),p.appendChild(y)}e.cursorColor&&(s.style.backgroundColor=e.cursorColor,m.style.backgroundColor=e.cursorColor,h.style.backgroundColor=e.cursorColor,f+=".name."+u+"::after { background-color: "+e.cursorColor+" !important; } "),d.innerHTML=f;var g=n.from,_=n.to,E=n.head,P=[];return P.push(i.Decoration.widget(E,c,{key:"cursor-widget-"+e.id,lastActive:e.lastActive})),g!==_&&P.push(i.Decoration.inline(g,_,{class:"cursor-range "+u,style:"background-color: "+(e.backgroundColor||"rgba(0, 25, 150, 0.2)")+";"},{key:"cursor-inline-"+e.id,lastActive:e.lastActive})),P}(p,c):[],b=t.cursorDecorations.remove(m).map(e.mapping,e.doc).add(c.doc,h),v=u.selection,y=void 0===v?{}:v,g=c.selection||{},_=!(y.a||y.anchor),E=e.getMeta("pointer"),P=g instanceof a.AllSelection==!1,w=!e.docChanged&&(g.anchor!==y.anchor||g.head!==y.head);if(P&&(_||E||w)){var O=y.anchor===g.anchor,C=y.head===g.head;if(!y.anchor||!O||!C){var S=r(r({},f),{selection:g});S.lastActive=6e4*Math.round((new Date).getTime()/6e4);var D=r(r({},S),{selection:_?{a:1,h:1,t:"text"}:(0,o.compressSelectionJSON)(g.toJSON())});n.collaborativeOptions.firebaseRef.child("cursors").child(d).set(D)}}return{cursorDecorations:b}}},view:function(e){if(!n.isReadOnly){var t=l.getState(e.state).localClientId,a=function(e,t){return{transactionCallback:function(n){return function(a){var i=a.key,o=a.val();if(o&&i!==e){var l=t.state.tr;l.setMeta(n,r(r({},o),{id:a.key})),t.dispatch(l)}}}}}(t,e),i=n.collaborativeOptions.firebaseRef.child("cursors");i.child(t).onDisconnect().remove(),i.on("child_added",a.transactionCallback("setCursor")),i.on("child_changed",a.transactionCallback("setCursor")),i.on("child_removed",a.transactionCallback("removeCursor"))}return{destroy:function(){var t=l.getState(e.state).localClientId,r=n.collaborativeOptions.firebaseRef.child("cursors");r.child(t).remove(),r.off("child_added"),r.off("child_changed"),r.off("child_removed")}}},props:{decorations:function(e){var n=t.cursorsPluginKey.getState(e).cursorDecorations.find();return i.DecorationSet.create(e.doc,n)}}})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.createFastForwarder=void 0;var l=n(62),u=n(77),c=n(180);t.createFastForwarder=function(e){return function(t,n,s){return a(void 0,void 0,void 0,(function(){var a,d,f,m,p,h;return i(this,(function(i){switch(i.label){case 0:return a=n.type.schema,d=Object.values(t),0===(f=d.filter((function(e){return e&&e.currentKey<s}))).length?[2,{}]:(m=f.reduce((function(e,t){return(null==t?void 0:t.selection)?Math.min(e,t.currentKey):e}),1/0),[4,(0,u.getStepsInChangeRange)(e,a,m+1,s)]);case 1:return p=i.sent(),h={},Object.entries(t).forEach((function(e){var t=o(e,2),n=t[0],a=t[1];a&&f.includes(a)&&(h[n]=function(e,t,n,a){var i=e.currentKey-n,o=(0,l.flattenOnce)(t.slice(i)),u=(0,c.mapDiscussionThroughSteps)(e,o);return r(r({},u),{currentKey:a})}(a,p,m,s))})),[2,h]}}))}))}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.connectToFirebaseDiscussions=void 0;var i=n(158),o=function(e){var t=e.selection,n=t&&(0,i.uncompressSelectionJSON)(t);return r(r({},e),{selection:null!=n?n:null})};t.connectToFirebaseDiscussions=function(e){var t=null,n=null,l=function(e){var n,r=e.val();r&&(null==t||t(((n={})[e.key]=o(r),n)))},u=function(e){var n;null==t||t(((n={})[e.key]=null,n))};return e.once("value").then((function(r){var i=r.val();if(i){var c={};Object.entries(i).forEach((function(e){var t=a(e,2),n=t[0],r=t[1];c[n]=o(r)})),null==t||t(c)}e.on("child_added",l),e.on("child_removed",u),n=function(){e.off("child_added",l),e.off("child_removed",u)}})),{sendDiscussions:function(t){Object.entries(t).forEach((function(t){var n=a(t,2),o=n[0],l=n[1];e.child(o).transaction((function(e){if(!e||l.currentKey>e.currentKey)return n=(t=l).selection,a=n&&(0,i.compressSelectionJSON)(n),r(r({},t),{selection:null!=a?a:null});var t,n,a}))}))},receiveDiscussions:function(e){t=e},disconnect:function(){return null==n?void 0:n()}}}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.getFinishedUploadFromTransaction=t.getNextDecorationsForTransaction=t.createPlaceholderDecoration=void 0;var a=n(47),i=n(262),o=n(935);t.createPlaceholderDecoration=function(e,t,n){return a.Decoration.widget(t,(function(){return(0,o.createPlaceholderWidgetElement)(n)}),{id:e,key:e+"-"+n})};var l=function(e,t){var n=r(t.find(void 0,void 0,(function(t){return t.id===e})),1)[0];return n||null};t.getNextDecorationsForTransaction=function(e,n){var r=e.getMeta(i.pastePluginKey),a=n.map(e.mapping,e.doc);if(r){if("uploadFinish"===r.type||"uploadFailure"===r.type){var o=r.id,u=a.find(0,e.doc.nodeSize,(function(e){return e.id===o}));return a.remove(u)}if("uploadStart"===r.type){var c=r.id,s=r.position;return a.add(e.doc,[(0,t.createPlaceholderDecoration)(c,s,0)])}if("uploadProgress"===r.type){c=r.id;var d=r.progress,f=l(c,n);if(f){s=f.to;var m=(0,t.createPlaceholderDecoration)(c,s,d);return a.remove([f]).add(e.doc,[m])}}}return a};t.getFinishedUploadFromTransaction=function(e,t){var n=e.getMeta(i.pastePluginKey);if(n&&"uploadFinish"===n.type){var r=n.src,a=n.id,o=i.pastePluginKey.getState(t).decorations,u=l(a,o);if(u)return{src:r,position:u.to}}return null}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createPlaceholderWidgetElement=void 0;var a=r(n(0)),i=r(n(31)),o=n(5);t.createPlaceholderWidgetElement=function(e){var t=document.createElement("div");return t.classList.add("paste-placeholder-decoration"),i.default.render(a.default.createElement(a.default.Fragment,null,a.default.createElement(o.Spinner,{value:1===e?void 0:e})),t),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDropHandler=t.createPasteHandler=void 0;var r=n(262),a=n(937),i=function(e,t,n){var a=e.id,i=e.start;!function(e,t,n){var a=e.state.tr,i={type:"uploadStart",id:t,position:n};a.setMeta(r.pastePluginKey,i),e.dispatch(a)}(n,a,t),i({onFailure:function(){return function(e,t){var n=e.state.tr,a={type:"uploadFailure",id:t};n.setMeta(r.pastePluginKey,a),e.dispatch(n)}(n,a)},onFinish:function(e){return function(e,t,n){var a=e.state.tr,i={type:"uploadFinish",id:t,src:n};a.setMeta(r.pastePluginKey,i),e.dispatch(a)}(n,a,e)},onProgress:function(e){return function(e,t,n){var a=e.state.tr,i={type:"uploadProgress",id:t,progress:n};a.setMeta(r.pastePluginKey,i),e.dispatch(a)}(n,a,e)}})};t.createPasteHandler=function(e){return function(t,n){var r;if(!n.clipboardData)return!1;if(function(e){var t,n=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text/html");return n&&n.includes('xmlns:o="urn:schemas-microsoft-com:office:office')}(n))return!1;var a=t.state.selection,o=null===(r=n.clipboardData)||void 0===r?void 0:r.items,l=function(e,t){if(t)for(var n=Array.from(t),r=0;r<n.length;r++){var a=n[r].getAsFile();if(a){var i=e(a);if(i)return i}}return null}(e,o||null);return!!l&&(i(l,a.to,t),n.preventDefault(),!0)}};t.createDropHandler=function(e){return function(t,n){var r,o,l;if(!n.dataTransfer||!n.clientY||!n.clientX)return!1;var u=null===(r=n.dataTransfer)||void 0===r?void 0:r.getData("text/html"),c=null===(l=null===(o=n.dataTransfer)||void 0===o?void 0:o.files)||void 0===l?void 0:l[0],s=function(e){if(e){var t=document.createElement("div");t.innerHTML=e;var n=t.children[0];if(n&&n instanceof HTMLImageElement&&!n.dataset.pmSlice)return n.src}return null}(u||null),d=t.posAtCoords({top:n.clientY,left:n.clientX});if(d){var f=c||s&&(0,a.dataUriToFile)(s),m=f&&e(f);if(m)return i(m,d.pos,t),n.preventDefault(),n.stopPropagation(),!0}return!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataUriToFile=void 0;t.dataUriToFile=function(e){var t,n;if(e.startsWith("data:"))return null;for(var r=e.split(","),a=null===(n=null===(t=r[0])||void 0===t?void 0:t.match(/:(.*?);/))||void 0===n?void 0:n[1],i=atob(r[1]),o=i.length,l=new Uint8Array(o);o--;)l[o]=i.charCodeAt(o);return new File([l],Date.now().toString(),{type:a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultMediaUploadHandler=void 0;var r=n(98),a=n(88);t.defaultMediaUploadHandler=function(e){var t=Date.now().toString();return e.type.startsWith("image/")?{id:t,start:function(t){var n=t.onProgress,i=t.onFinish;(0,r.s3Upload)(e,(function(e){var t=e.loaded,r=e.total;return n(t/r)}),(function(e,t,n,r){var o="https://assets.pubpub.org/"+r,l=new Image;l.onload=function(){return i(o)},l.src=(0,a.getResizedUrl)(o,"inside",800)}))}}:null}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useSuggestions=void 0;var i=n(0),o=a(n(940));t.useSuggestions=function(e){var t=(0,i.useMemo)((function(){return new o.default}),[]),n=r((0,i.useState)(null),2),a=n[0],l=n[1],u=(0,i.useCallback)((function(){return l(t.isSuggesting()?t.state:null)}),[t]);return(0,i.useEffect)((function(){return e?(t.transitioned.subscribe(u),function(){return t.transitioned.unsubscribe(u)}):function(){}}),[t,u,e]),{suggesting:a,suggestionManager:t}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionManagerStatus=void 0;var a,i=n(941);!function(e){e[e.Closed=0]="Closed",e[e.Suggesting=1]="Suggesting"}(a=t.SuggestionManagerStatus||(t.SuggestionManagerStatus={}));var o=function(){function e(){this._state={status:a.Closed},this.transitioned=new i.Signal}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.load=function(e,t){this._state={status:a.Suggesting,index:this.isSuggesting()?this.state.index:0,items:e,params:t},this.transitioned.dispatch(this._state.status)},e.prototype.next=function(){if(this.isSuggesting()){var e=this.state;this._state=r(r({},e),{index:e.index+1})}},e.prototype.previous=function(){if(this.isSuggesting()){var e=this.state;this._state=r(r({},e),{index:e.index-1})}},e.prototype.select=function(e){if(this.isSuggesting()){var t=this.state,n=t.items;(0,t.params.command)(void 0!==e&&n.includes(e)?e:this.getSelectedValue()),this.close()}},e.prototype.close=function(){this._state={status:a.Closed},this.transitioned.dispatch(this._state.status)},e.prototype.isSuggesting=function(){return this.state.status===a.Suggesting},e.prototype.getSelectedValue=function(){if(this.isSuggesting()){var e=this.state,t=e.items,n=e.index;return t[(r=n,a=t.length,(r%a+a)%a)]}var r,a;return null},e.prototype.getPosition=function(){if(!this.isSuggesting())return{position:"absolute",top:0,left:0};var e=this.state.params,t=e.view.coordsAtPos(e.range.from+1),n=e.view.dom.offsetParent.getBoundingClientRect();return{position:"absolute",top:t.bottom-n.top,left:t.left-n.left}},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Signal=void 0;var r=function(){function e(){this.subscribers=new Set}return e.prototype.subscribe=function(e){return this.subscribers.add(e),this.unsubscribe.bind(this,e)},e.prototype.unsubscribe=function(e){this.subscribers.delete(e)},e.prototype.dispatch=function(e){this.subscribers.forEach((function(t){return t(e)}))},e}();t.Signal=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useInitialValues=void 0;var r=n(0),a=n(105),i=n(77);t.useInitialValues=function(e){var t=(0,r.useRef)(null);return null===t.current&&(t.current=function(e){var t=e.nodeLabels,n=e.noteManager,r=e.customMarks,o=e.customNodes,l=e.initialContent,u=e.isReadOnly,c=e.nodeOptions,s=(0,i.buildSchema)(o,r,c),d=s.nodeFromJSON(l);return{schema:s,initialDocNode:u?(0,a.addTemporaryIdsToDoc)(d):d,staticContent:(0,i.renderStatic)({schema:s,doc:l,nodeLabels:t,noteManager:n})}}(e)),t.current}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useEditorView=void 0;var i=n(0),o=n(137),l=n(8),u=n(47),c=n(95),s=a(n(944)),d=n(951),f=n(160),m=n(419),p=function(){},h=(0,c.keydownHandler)({"Mod-s":function(){return!0}}),b=function(e){var t=e.isReadOnly;return function(e){var n=f.collabDocPluginKey.getState(e);return!(n&&!n.isLoaded)&&!t}},v=function(e,t){var n=t.onError,r=t.onEdit;return function(t){try{var a=e.state,i=f.collabDocPluginKey.getState(a),o=e.state.applyTransaction(t),l=o.state,u=o.transactions;e.updateState(l),r&&t.docChanged&&r(t.doc,t,l,a),i&&u.some((function(e){return e.docChanged}))&&i.sendCollabChanges(l)}catch(e){e instanceof Error&&(console.error("Error applying transaction:",e),null==n||n(e))}}};t.useEditorView=function(e){var t=e.debounceEditsMs,n=e.onEdit,a=e.onError,c=e.onKeyPress,f=e.onScrollToSelection,y=e.isReadOnly,g=(0,i.useRef)(null),_=r((0,o.useDebouncedCallback)(n||p,t),1)[0];(0,i.useEffect)((function(){null===g.current&&(g.current=function(e){var t=e.initialDocNode,n=e.schema,r=e.customPlugins,a=e.pluginsOptions,i=e.onKeyPress,o=e.onScrollToSelection,c=e.mountRef,f=l.EditorState.create({doc:t,schema:n,plugins:(0,d.getPlugins)(n,r,a)}),p=new u.EditorView({mount:c.current},{state:f,nodeViews:s.default,editable:b(e),handleKeyDown:h,handleKeyPress:i,handleScrollToSelection:o});return p.setProps({dispatchTransaction:v(p,e)}),(0,m.immediatelyDispatchOnChange)(p),p}(e))}),[]),(0,i.useEffect)((function(){var e;null===(e=g.current)||void 0===e||e.setProps({dispatchTransaction:v(g.current,{onError:a,onEdit:_})})}),[a,_]),(0,i.useEffect)((function(){var e;null===(e=g.current)||void 0===e||e.setProps({handleKeyPress:c,handleScrollToSelection:f})}),[c,f]),(0,i.useEffect)((function(){var e;null===(e=g.current)||void 0===e||e.setProps({editable:b({isReadOnly:y})})}),[y]),(0,i.useEffect)((function(){return function(){var e;null===(e=g.current)||void 0===e||e.destroy()}}),[])}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(945)),i=r(n(950));t.default={citation:function(e,t){return new a.default(e,t,"unstructuredValue")},footnote:function(e,t){return new a.default(e,t,"value")},reference:function(e,t){return new i.default(e,t)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),i=n(499),o=r(n(417)),l=n(948);n(949);var u=function(e){return e.split("\n").join("")},c=function(){function e(e,t,n){this.tooltip=null,this.popper=null;var r=a.DOMSerializer.renderSpec(document,e.type.spec.toDOM(e)),i=r.dom,o=r.contentDOM;this.dom=i,this.viewContainer=t.dom,this.contentDOM=o,this.node=e,this.notePopoverId=e.attrs.id+"-note-popover",this.unstructuredAttrKey=n,this.setupTooltip=this.setupTooltip.bind(this),this.teardownTooltip=this.teardownTooltip.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.dom.setAttribute("tabindex","0"),this.dom.setAttribute("role","link"),this.dom.setAttribute("aria-describedby",this.notePopoverId),this.dom.addEventListener("mouseenter",this.setupTooltip),this.dom.addEventListener("mousemove",this.handleMouseMove),this.dom.addEventListener("focus",this.setupTooltip),this.dom.addEventListener("blur",this.teardownTooltip)}return e.prototype.setupTooltip=function(){this.teardownTooltip();var e=this.node.attrs,t=e.citation,n=e[this.unstructuredAttrKey],r=document.createElement("div"),a=(0,o.default)(t.html),l=(0,o.default)(n);r.setAttribute("id",this.notePopoverId),r.setAttribute("role","tooltip"),r.classList.add("note-popover-component","bp3-elevation-2"),r.innerHTML="\n            "+(t?u(a):"")+"\n            "+(n?u(l):"")+"\n        ",document.body.appendChild(r),document.addEventListener("mousemove",this.handleMouseMove),this.tooltip=r,this.popper=(0,i.createPopper)(this.dom,r,{placement:"top-start",modifiers:[{name:"preventOverflow",options:{boundary:this.viewContainer}},{name:"flip"}]})},e.prototype.handleMouseMove=function(e){if(this.tooltip&&this.dom&&document.activeElement!==this.dom){var t=this.tooltip.getBoundingClientRect(),n=this.dom.getBoundingClientRect(),r=(0,l.rectUnion)(t,n);(0,l.rectContainsPoint)(r,{x:e.clientX,y:e.clientY})||this.teardownTooltip()}},e.prototype.teardownTooltip=function(){var e,t;null===(e=this.tooltip)||void 0===e||e.remove(),null===(t=this.popper)||void 0===t||t.destroy()},e.prototype.destroy=function(){this.teardownTooltip(),this.dom.removeEventListener("mouseenter",this.setupTooltip),document.removeEventListener("mousemove",this.handleMouseMove),this.dom.removeEventListener("focus",this.setupTooltip),this.dom.removeEventListener("blur",this.teardownTooltip)},e}();t.default=c},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rectContainsPoint=t.rectUnion=void 0;t.rectUnion=function(e,t){return{right:Math.max(e.right,t.right),left:Math.min(e.left,t.left),x:Math.min(e.x,t.x),bottom:Math.max(e.bottom,t.bottom),top:Math.min(e.top,t.top),y:Math.min(e.y,t.y)}};t.rectContainsPoint=function(e,t){var n=e.left,r=e.right,a=e.top,i=e.bottom,o=t.x,l=t.y;return o>=n&&o<=r&&l>=a&&l<=i}},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=e.attrs,r=n.targetId,a=n.label;this.view=t,this.dom=document.createElement("a"),this.dom.textContent=a||"(ref?)",this.dom.classList.add("reference"),this.dom.setAttribute("data-node-type","reference"),this.dom.setAttribute("data-target-id",r),this.view.editable||this.dom.setAttribute("href","#"+r),this.onClick=this.onClick.bind(this),this.dom.addEventListener("click",this.onClick)}return e.prototype.onClick=function(e){this.view.editable&&e.preventDefault()},e.prototype.stopEvent=function(){return this.view.editable},e.prototype.destroy=function(){this.dom.removeEventListener("click",this.onClick)},e}();t.default=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPlugins=t.standardPlugins=void 0;var u=n(500),c=n(952),s=l(n(160)),d=l(n(261)),f=l(n(418)),m=l(n(953)),p=l(n(954)),h=l(n(955)),b=l(n(956)),v=l(n(957)),y=l(n(966)),g=l(n(967)),_=l(n(419)),E=l(n(970)),P=l(n(971)),w=l(n(972)),O=l(n(973)),C=l(n(396));t.standardPlugins={inputRules:b.default,headerIds:h.default,translatedMathNodes:p.default,placeholder:E.default,localHighlights:y.default,references:C.default,domEvents:f.default,onChange:_.default,gapCursor:function(){return(0,c.gapCursor)()},history:function(){return(0,u.history)()},keymap:v.default,table:O.default,collaborative:s.default,discussions:d.default,ids:m.default,reactive:w.default,paste:P.default,mathPlugin:g.default};t.getPlugins=function(e,n,l){return(u=r(r({},t.standardPlugins),n),c=u.onChange,s=a(u,["onChange"]),Object.values(r(r({},s),{onChange:c})).filter((function(e){return!!e}))).map((function(t){var n=t(e,l);return Array.isArray(n)?n:[n]})).reduce((function(e,t){return o(o([],i(e),!1),i(t),!1)}),[]);var u,c,s}},,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(77),l=function(e){return r(r({},e.attrs),{id:"n"+(0,o.generateHash)(10)})},u=function(e,t){void 0===t&&(t=[]);var n=e.tr,r=!1,i=new Set,o={};return e.doc.descendants((function(e,u){var c=e.type.spec.attrs&&e.type.spec.attrs.id;if("heading"!==e.type.name)if(e.attrs.id){var s=i.has(e.attrs.id);if(function(e,t){return t.some((function(t){var n=a(t.steps,1)[0];if(n&&function(e){return"from"in e&&"slice"in e}(n)&&t.getMeta("paste")){var r=n.from,i=n.from+n.slice.content.size;return e>=r&&e<i}return!1}))}(u,t))s?(r=!0,n.setNodeMarkup(u,e.type,l(e))):o[e.attrs.id]={offset:u,type:e.type,attrs:l(e)};else if(s)r=!0,n.setNodeMarkup(u,e.type,l(e));else if(i.add(e.attrs.id),o[e.attrs.id]){var d=o[e.attrs.id];r=!0,n.setNodeMarkup(d.offset,d.type,d.attrs)}}else c&&(r=!0,n.setNodeMarkup(u,e.type,l(e)))})),r?n:null};t.default=function(e,t){return t.isReadOnly?[]:new i.Plugin({view:function(e){var t=u(e.state);return t&&e.dispatch(t),{}},appendTransaction:function(e,t,n){return u(n,e)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),a=new r.PluginKey("equations-to-math"),i=function(e){if(a.getState(e).hasRun)return null;var t=e.tr,n=[],r=!1,i=e.schema.nodes.math_inline,o=e.schema.nodes.math_display;return e.doc.descendants((function(t,a){var l="equation"===t.type.name?i:"block_equation"===t.type.name?o:null;if(l){var u=l.create(null,e.schema.text(t.attrs.value));n.push({pos:a,replacementNode:u}),r=!0}})),r?(t.setMeta(a,!0),n.reverse().forEach((function(e){var n=e.pos,r=e.replacementNode;return t.replaceWith(n,n+1,r)})),t):null};t.default=function(e,t){return t.isReadOnly?[]:new r.Plugin({key:a,view:function(e){var t=i(e.state);return t&&e.dispatch(t),{}},appendTransaction:function(e,t,n){return i(n)},state:{init:function(){return{hasRun:!1}},apply:function(e,t){var n=t.hasRun;return{hasRun:e.getMeta(a)||n}}}})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(8);t.default=function(e,t){return t.isReadOnly?[]:new a.Plugin({appendTransaction:function(e,t,n){var a=n.tr,i=!1;return n.doc.forEach((function(e,t){if("heading"===e.type.name){var n=e.textContent.replace(/[^a-zA-Z0-9-\s]/gi,"").replace(/^\d+\W+/gi,"").replace(/\s+/gi," ").trim().toLowerCase().replace(/\s/gi,"-");e.attrs.fixedId||e.attrs.id===n||(i=!0,a.setNodeMarkup(t,e.type,r(r({},e.attrs),{id:n})))}})),i?a:null}})}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),o=n(110),l=n(263);t.default=function(e){var t,n,u=o.smartQuotes.concat(o.ellipsis,o.emDash);return e.nodes.blockquote&&u.push((t=e.nodes.blockquote,(0,o.wrappingInputRule)(/^\s*>\s$/,t))),e.nodes.ordered_list&&u.push(function(e){return(0,o.wrappingInputRule)(/^(\d+)\.\s$/,e,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order===+e[1]}))}(e.nodes.ordered_list)),e.nodes.bullet_list&&u.push(function(e){return(0,o.wrappingInputRule)(/^\s*([-+*])\s$/,e)}(e.nodes.bullet_list)),e.nodes.code_block&&u.push(function(e){return(0,o.textblockTypeInputRule)(/^```$/,e)}(e.nodes.code_block)),e.nodes.heading&&u.push(function(e,t){return(0,o.textblockTypeInputRule)(new RegExp("^(#{1,"+t+"})\\s$"),e,(function(e){return{level:e[1].length}}))}(e.nodes.heading,6)),e.nodes.math_inline&&u.push(function(e,t,n){return void 0===n&&(n=[]),new o.InputRule(/\$([^$]+?)\$\040$/,(function(o,l,u,c){var s=r(l,2),d=(s[0],s[1]),f=o.doc.resolve(u+1),m=o.doc.resolve(c-1);if(a(a([],r(f.marks()),!1),r(m.marks()),!1).some((function(e){return n.includes(e.type)})))return null;for(var p=0;p<f.depth+1;p++){var h=f.node(p);if(t.includes(h.type))return null}var b=i.Fragment.fromArray([e.create(null,e.schema.text(d)),e.schema.text(" ")]);return o.tr.replaceWith(u,c,b)}))}(e.nodes.math_inline,[e.nodes.math_inline,e.nodes.math_display,e.nodes.code_block],[e.marks.code])),e.nodes.math_display&&u.push(function(e){return(0,l.makeBlockMathInputRule)(l.REGEX_BLOCK_MATH_DOLLARS,e)}(e.nodes.math_display)),e.marks.code&&u.push((n=e.marks.code,new o.InputRule(/`([^`]+)`\040/,(function(e,t,a,o){var l=r(t,2),u=(l[0],l[1]),c=i.Fragment.fromArray([e.schema.text(u,[e.schema.mark(n)]),e.schema.text(" ")]);return e.tr.replaceWith(a,o,c)})))),(0,o.inputRules)({rules:u})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(79),i=n(187),o=n(500),l=n(110),u=n(95),c=n(263),s=n(181),d="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);t.default=function(e){var t={},n=function(e,n){t[e]=n};if(n("Mod-z",o.undo),n("Shift-Mod-z",o.redo),n("Backspace",l.undoInputRule),d||n("Mod-y",o.redo),n("Alt-ArrowUp",a.joinUp),n("Alt-ArrowDown",a.joinDown),n("Mod-BracketLeft",a.lift),n("Escape",a.selectParentNode),e.marks.strong&&n("Mod-b",(0,a.toggleMark)(e.marks.strong)),e.marks.em&&n("Mod-i",(0,a.toggleMark)(e.marks.em)),e.marks.sup&&n("Mod-.",(0,a.toggleMark)(e.marks.sup)),e.marks.sub&&n("Mod-,",(0,a.toggleMark)(e.marks.sub)),e.marks.strike&&n("Mod-Shift-x",(0,a.toggleMark)(e.marks.strike)),e.marks.code&&n("Mod-<",(0,a.toggleMark)(e.marks.code)),e.marks.link&&n("Mod-k",(0,a.toggleMark)(e.marks.link)),e.nodes.bullet_list&&n("Shift-Ctrl-8",(0,i.wrapInList)(e.nodes.bullet_list)),e.nodes.ordered_list&&n("Shift-Ctrl-9",(0,i.wrapInList)(e.nodes.ordered_list)),e.nodes.blockquote&&n("Ctrl->",(0,a.wrapIn)(e.nodes.blockquote)),e.nodes.hard_break){var f=(0,a.chainCommands)(a.exitCode,(function(t,n){return n(t.tr.replaceSelectionWith(e.nodes.hard_break.create()).scrollIntoView()),!0}));n("Mod-Enter",f),n("Shift-Enter",f),d&&n("Ctrl-Enter",f)}if(e.nodes.list_item&&(n("Enter",(0,i.splitListItem)(e.nodes.list_item)),n("Mod-[",(0,i.liftListItem)(e.nodes.list_item)),n("Mod-]",(0,i.sinkListItem)(e.nodes.list_item)),n("Tab",(0,i.sinkListItem)(e.nodes.list_item)),n("Shift-Tab",(0,i.liftListItem)(e.nodes.list_item))),e.nodes.paragraph&&n("Shift-Ctrl-0",(0,a.setBlockType)(e.nodes.paragraph)),e.nodes.code_block&&n("Shift-Ctrl-\\",(0,a.setBlockType)(e.nodes.code_block)),e.nodes.heading)for(var m=1;m<=6;m+=1)n("Shift-Ctrl-"+m,(0,a.setBlockType)(e.nodes.heading,{level:m})),n("Alt-Ctrl-"+m,(0,a.setBlockType)(e.nodes.heading,{level:m}));e.nodes.horizontal_rule&&n("Mod-_",(function(t,n){return n(t.tr.replaceSelectionWith(e.nodes.horizontal_rule.create()).scrollIntoView()),!0})),e.nodes.math_inline&&n("Backspace",(0,a.chainCommands)(a.deleteSelection,c.mathBackspaceCmd,a.joinBackward,a.selectNodeBackward));var p=(0,a.chainCommands)(a.newlineInCode,a.createParagraphNear,a.liftEmptyBlock,(0,s.splitBlockPreservingAttrs)(["textAlign","rtl"]));return[(0,u.keymap)(t),(0,u.keymap)(r(r({},a.baseKeymap),{Enter:p}))]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.heading6Toggle=t.heading5Toggle=t.heading4Toggle=t.heading3Toggle=t.heading2Toggle=t.heading1Toggle=t.blockquoteToggle=t.orderedListToggle=t.bulletListToggle=t.codeBlockToggle=t.paragraphToggle=t.createListTypeToggle=t.createHeadingBlockTypeToggle=void 0;var r=n(79),a=n(187),i=n(162),o=function(e,t,n){return e.type===t&&(!n||Object.keys(n).every((function(t){return n[t]===e.attrs[t]})))},l=function(e){var t=e.state,n=e.type,r=e.withAttrs;if(!n)return!1;var a=t.selection.$from,i=t.selection.node;if(i&&o(i,n,r))return!0;for(var l=a.depth;l>0;){var u=a.node(l);if(o(u,n,r))return!0;l-=1}return!1},u=function(e){var t=e.state,n=e.type,a=e.withAttrs,i=e.dispatch,o=t.schema,u=l(e)?o.nodes.paragraph:n;return(0,r.setBlockType)(u,a)(t,i)},c=function(e){var t=e.state,n=e.type,i=e.dispatch;return l(e)?(0,r.lift)(t,i):(0,a.wrapInList)(n)(t,i)},s=function(e){var t=e.typeName,n=e.withAttrs,r=e.commandFn,a=void 0===r?u:r;return(0,i.createTypeToggle)({withAttrs:n,commandFn:a,isActiveFn:l,getTypeFromSchema:function(e){return e.nodes[t]}})};t.createHeadingBlockTypeToggle=function(e){return s({typeName:"heading",withAttrs:{level:e}})};t.createListTypeToggle=function(e){return s({typeName:e,commandFn:c})},t.paragraphToggle=s({typeName:"paragraph"}),t.codeBlockToggle=s({typeName:"code_block"}),t.bulletListToggle=(0,t.createListTypeToggle)("bullet_list"),t.orderedListToggle=(0,t.createListTypeToggle)("ordered_list"),t.blockquoteToggle=s({typeName:"blockquote",commandFn:function(e){var t=e.state,n=e.type,a=e.dispatch;return l(e)?(0,r.lift)(t,a):(0,r.wrapIn)(n)(t,a)}}),t.heading1Toggle=(0,t.createHeadingBlockTypeToggle)(1),t.heading2Toggle=(0,t.createHeadingBlockTypeToggle)(2),t.heading3Toggle=(0,t.createHeadingBlockTypeToggle)(3),t.heading4Toggle=(0,t.createHeadingBlockTypeToggle)(4),t.heading5Toggle=(0,t.createHeadingBlockTypeToggle)(5),t.heading6Toggle=(0,t.createHeadingBlockTypeToggle)(6)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkToggle=t.strikethroughToggle=t.superscriptToggle=t.subscriptToggle=t.codeToggle=t.emToggle=t.strongToggle=t.createMarkToggle=void 0;var r=n(79),a=n(162),i=function(e){var t=e.type,n=e.state,r=n.selection,a=r.from,i=r.$from,o=r.to;return r.empty?!!t.isInSet(n.storedMarks||i.marks()):n.doc.rangeHasMark(a,o,t)},o=function(e){var t=e.state,n=e.dispatch,a=e.type;return(0,r.toggleMark)(a)(t,n)};t.createMarkToggle=function(e){return(0,a.createTypeToggle)({getTypeFromSchema:function(t){return t.marks[e]},commandFn:o,isActiveFn:i})},t.strongToggle=(0,t.createMarkToggle)("strong"),t.emToggle=(0,t.createMarkToggle)("em"),t.codeToggle=(0,t.createMarkToggle)("code"),t.subscriptToggle=(0,t.createMarkToggle)("sub"),t.superscriptToggle=(0,t.createMarkToggle)("sup"),t.strikethroughToggle=(0,t.createMarkToggle)("strike"),t.linkToggle=(0,t.createMarkToggle)("link")},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.rtlToggle=void 0;var a,i=n(162);t.rtlToggle=(a=!0,(0,i.createCommandSpec)((function(e,t){var n,i=function(e){var t=e.selection,n=e.doc,r=[];return t.ranges.forEach((function(e){var t=e.$from,a=e.$to;n.nodesBetween(t.pos,a.pos,(function(e,t){(function(e){var t=e.type.spec;return t.attrs&&"rtl"in t.attrs})(e)&&r.push({pos:t,node:e})}))})),r}(t),o=!(!(n=i.map((function(e){return e.node.attrs.rtl}))).length||!n.every((function(e){return!0===e})))||null,l=null===o||null,u=i.length>0;return{isActive:o===a,canRun:u,run:function(){return function(e,t,n,a){var i=t.tr;e.forEach((function(e){var t,n=e.pos,o=e.node;return i.setNodeMarkup(n,void 0,r(r({},o.attrs),((t={}).rtl=a,t)))})),n(i)}(i,t,e,l)}}})))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.tableToggleLabel=t.tableToggleHeaderCell=t.tableToggleHeaderColumn=t.tableToggleHeaderRow=t.tableDeleteColumn=t.tableAddColumnAfter=t.tableAddColumnBefore=t.tableDeleteRow=t.tableAddRowAfter=t.tableAddRowBefore=t.tableSplitCell=t.tableMergeCells=t.tableDelete=void 0;var a=n(214),i=n(212),o=n(77),l=n(162),u=function(e){return(0,l.createCommandSpec)((function(t,n){return{canRun:(0,a.isInTable)(n)&&e(n),run:function(){return e(n,t)},isActive:!1}}))};t.tableDelete=u(a.deleteTable),t.tableMergeCells=u(a.mergeCells),t.tableSplitCell=u(a.splitCell),t.tableAddRowBefore=u(a.addRowBefore),t.tableAddRowAfter=u(a.addRowAfter),t.tableDeleteRow=u(a.deleteRow),t.tableAddColumnBefore=u(a.addColumnBefore),t.tableAddColumnAfter=u(a.addColumnAfter),t.tableDeleteColumn=u(a.deleteColumn),t.tableToggleHeaderRow=u(a.toggleHeaderRow),t.tableToggleHeaderColumn=u(a.toggleHeaderColumn),t.tableToggleHeaderCell=u(a.toggleHeaderCell),t.tableToggleLabel=u((function(e,t){var n;if(!(null===(n=(0,o.getCurrentNodeLabels)(e)[i.ReferenceableNodeType.Table])||void 0===n?void 0:n.enabled))return!1;var a=(0,o.findParentNodeClosestToPos)(e.selection.$from,(function(e){return"table"===e.type.name}));if(a){var l=e.tr.setNodeMarkup(a.pos,a.node.type,r(r({},a.node.attrs),{hideLabel:!a.node.attrs.hideLabel}));return t&&t(l),!0}return!1}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mathToggleLabel=t.mathToggleKind=void 0;var r=n(162),a=function(e,t){var n=e.selection.node;if(!(n&&("math_inline"===n.type.name||"math_display"===n.type.name)))return!1;var r="math_display"===n.type.name;if(t){var a=e.schema.nodes,i=a.math_display,o=a.math_inline,l=r?o:i;t(e.tr.replaceSelectionWith(l.create({},n.content),!0))}return!0},i=function(e,t){var n=e.selection,r=n.node,a=n.$anchor;if(!(r&&"math_display"===r.type.name))return!1;t&&t(e.tr.setNodeMarkup(a.pos,r.type,{hideLabel:!r.attrs.hideLabel}));return!0};t.mathToggleKind=(0,r.createCommandSpec)((function(e,t){return{run:function(){return a(t,e)},canRun:a(t),isActive:!1}})),t.mathToggleLabel=(0,r.createCommandSpec)((function(e,t){return{run:function(){return i(t,e)},canRun:i(t),isActive:!1}}))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.alignTextRight=t.alignTextCenter=t.alignTextLeft=void 0;var o=n(162),l=new Set(["doc","table_cell","table_header","blockquote"]),u=null,c=function(e){if((null==u?void 0:u.state)===e)return u.result;var t=e.selection,n=e.doc,r=[];t.ranges.forEach((function(e){var t=e.$from,a=e.$to;n.nodesBetween(t.pos,a.pos,(function(e,t,n){var a;n&&(a=n.type.name,l.has(a))&&function(e){var t=e.type.spec;return t.attrs&&"textAlign"in t.attrs}(e)&&r.push({pos:t,node:e})}))}));var o,c,s,d={alignableNodes:r,sharedAlignmentType:(o=r,c=o.map((function(e){var t,n=e.node;return null===(t=n.attrs.textAlign)?"left":t})),s=new Set(c),1===s.size?i([],a(s),!1)[0]:null)};return u={state:e,result:d},d},s=function(e){return(0,o.createCommandSpec)((function(t,n){var a=c(n),i=a.sharedAlignmentType,o=a.alignableNodes;return{isActive:i===e,canRun:o.length>0,run:function(){return function(e,t,n,a){var i,o=n.tr,l="left"===(i=t)?null:i;e.forEach((function(e){var t,n=e.pos,a=e.node;return o.setNodeMarkup(n,void 0,r(r({},a.attrs),((t={}).textAlign=l,t)))})),a(o)}(o,e,n,t)}}}))};t.alignTextLeft=s("left"),t.alignTextCenter=s("center"),t.alignTextRight=s("right")},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.splitBlockPreservingAttrs=void 0;var i=n(79),o=a(n(965));t.splitBlockPreservingAttrs=function(e){return function(t,n){var a=t.selection.$from;return(0,i.splitBlock)(t,(function(t){if(n){var i=t.selection.$from.before(),l=t.doc.nodeAt(i),u=a.node();t.setNodeMarkup(i,void 0,r(r({},null==l?void 0:l.attrs),(0,o.default)(u.attrs,e))),n(t)}}))}}},,function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(47),l=new i.PluginKey("localHighlights");t.default=function(){return new i.Plugin({key:l,state:{init:function(e,t){return{activeDecorationSet:o.DecorationSet.create(t.doc,[])}},apply:function(e,t,n,i){var l=t.activeDecorationSet,u=l.find().filter((function(t){return t.spec.key==="lm-"+e.getMeta("localHighlightIdToRemove")})),c=l.remove(u).map(e.mapping,e.doc),s=e.getMeta("newLocalHighlightData")||[],d=s.map((function(e){var t="permanent"===e.id?"permanent":"local-highlight lh-"+e.id,n="permanent"===e.id?"permanent":"lm-"+e.id;return o.Decoration.inline(Number(e.from),Number(e.to),{class:t},{key:n})})),f=s.filter((function(e){return"permanent"!==e.id})).map((function(e){var t=document.createElement("span");return t.className="local-mount lm-"+e.id,o.Decoration.widget(Number(e.to),t,{stopEvent:function(){return!0},key:"lm-"+e.id})}));return{activeDecorationSet:c.add(i.doc,a(a([],r(d),!1),r(f),!1))}}},props:{decorations:function(e){return l.getState(e).activeDecorationSet}}})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(968);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),a=n(263),i=n(969);t.default=function(){var e=a.mathPlugin.props.nodeViews.math_display;return[new r.Plugin({props:{nodeViews:{math_display:(0,i.mathViewOverrideWithCount)(e)}}}),a.mathPlugin]}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.mathViewOverrideWithCount=void 0;var i=n(7),o=function(e,t){var n=e.content,r="\\tag{"+t+"}",a=e.type.schema.text(r),o=i.Fragment.from(n).append(i.Fragment.from(a));return e.copy(o)};t.mathViewOverrideWithCount=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=e.apply(void 0,a([],r(t),!1)),l=i.renderMath,u=l.bind(i);return Object.assign(i,{renderMath:function(){var e=this._node,t=e.attrs,n=t.count,r=t.id,a=n?o(e,n):e;this._node=a,u(),this._node=e,this.dom.setAttribute("id",r)}}),i.renderMath(),i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),a=n(47),i=n(160),o=n(77);t.default=function(e,t){return new r.Plugin({props:{decorations:function(e){if((0,o.viewIsEmpty)(e)&&t.placeholder){var n=[];return e.doc.descendants((function(r,o){var l,u=i.collabDocPluginKey.getState(e)||{},c=(null===(l=t.collaborativeOptions)||void 0===l?void 0:l.clientData)&&!u.isLoaded?"Loading...":t.placeholder;r.type.isBlock&&0===r.childCount&&n.push(a.Decoration.node(o,o+r.nodeSize,{class:"prosemirror-placeholder","data-content":c}))})),a.DecorationSet.create(e.doc,n)}return null}}})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(416);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(105);t.default=function(e,t){return(0,r.createReactivePlugin)({schema:e,documentState:{nodeLabels:t.nodeLabels,noteManager:t.noteManager}})}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var l=n(95),u=n(7),c=n(8),s=n(214),d=n(77);var f=function(e){function t(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var a=e.apply(this,o([t],i(n),!1))||this;return a.sync(t),a}return a(t,e),t.prototype.update=function(t,n){var r=e.prototype.update.call(this,t,n);return this.sync(t),r},t.prototype.syncCaption=function(e){var t=this.dom,n=(0,d.buildLabel)(e);if(n){var r=t.querySelector("table");if(r){var a=r.querySelector("caption");a&&a.parentNode===r&&a.remove();var i=document.createElement("caption");i.innerHTML=n,r.append(i)}}},t.prototype.syncId=function(e){this.dom.setAttribute("id",e.attrs.id)},t.prototype.sync=function(e){this.syncId(e),this.syncCaption(e)},t}(s.TableView);t.default=function(e,t){return e.nodes.table?t.isReadOnly?[(0,s.columnResizing)({handleWidth:-1,View:f})]:(document.execCommand("enableObjectResizing",!1,!1),document.execCommand("enableInlineTableEditing",!1,!1),[(0,s.columnResizing)({View:f}),(0,s.tableEditing)(),(0,l.keymap)({Tab:(0,s.goToNextCell)(1),"Shift-Tab":(0,s.goToNextCell)(-1)}),new c.Plugin({props:{clipboardSerializer:(n=u.DOMSerializer.fromSchema(e),Object.assign(Object.create(n),{serializeFragment:function(e,t){var r=n.serializeFragment(e,t);return r.querySelectorAll("table > caption").forEach((function(e){return e.parentElement.removeChild(e)})),r}}))}})]):[];var n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(77);n(975);t.default=function(e){var t=e.nodeLabels,n=e.references,r=e.activeReference,a=e.onReferenceSelect,i=(0,o.useMemo)((function(){return n.map((function(e){return o.default.createElement(l.MenuItem,{key:e.node.attrs.id,onClick:function(){return a(e)},icon:e.icon,text:(0,u.buildLabel)(e.node,(0,u.getNodeLabelText)(e.node,t)),active:e===r})}))}),[n,r]);return o.default.createElement(l.Menu,{className:"reference-finder-component bp3-elevation-1"},i.length>0?i:o.default.createElement(l.MenuItem,{text:"No items to reference",disabled:!0}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DragHandle=t.DragDropOrdering=t.DragDropListing=void 0;var a=n(236);Object.defineProperty(t,"DragDropListing",{enumerable:!0,get:function(){return r(a).default}});var i=n(979);Object.defineProperty(t,"DragDropOrdering",{enumerable:!0,get:function(){return r(i).default}});var o=n(980);Object.defineProperty(t,"DragHandle",{enumerable:!0,get:function(){return r(o).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=l(n(0)),c=n(118),s=l(n(236));t.default=function(e){var t=e.onReorderItems,n=e.getReorderedItem,l=a(e,["onReorderItems","getReorderedItem"]);return u.default.createElement(c.DragDropContext,{onDragEnd:function(r){var a=r.source,l=r.destination;if(l){var u=a.index,c=l.index,s=o([],i(e.items),!1),d=i(s.splice(u,1),1)[0],f=n?n(d,s):d;s.splice(c,0,f),t(s)}}},u.default.createElement(s.default,r({},l,{droppableId:"drag-drop-ordering"})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(58)),u=o.default.forwardRef((function(e,t){var n=e.dragHandleProps,i=a(e,["dragHandleProps"]);return o.default.createElement("div",r({},i,n,{ref:t}),o.default.createElement(l.default,{icon:"drag-handle-vertical"}))}));t.default=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(5),l=r(n(58));n(982);var u={label:i.default.oneOfType([i.default.string,i.default.node]),icon:i.default.string,intent:i.default.string,isRightAligned:i.default.bool,isMinimal:i.default.bool,isDisabled:i.default.bool,isSmall:i.default.bool,isLarge:i.default.bool,isOpen:i.default.bool,className:i.default.string,usePortal:i.default.bool,children:i.default.node},c=function(e){return a.default.createElement(o.Popover,{content:e.children,interactionKind:o.PopoverInteractionKind.CLICK,position:e.isRightAligned?o.Position.BOTTOM_RIGHT:o.Position.BOTTOM_LEFT,minimal:!0,transitionDuration:-1,inheritDarkTheme:!1,isOpen:e.isOpen,usePortal:e.usePortal},e.icon&&!e.label?a.default.createElement(o.Button,{disabled:e.isDisabled,className:"dropdown-button "+e.className,large:e.isLarge,small:e.isSmall,minimal:e.isMinimal,intent:e.intent,icon:a.default.createElement(l.default,{icon:e.icon})}):a.default.createElement(o.Button,{disabled:e.isDisabled,className:"dropdown-button "+e.className,large:e.isLarge,small:e.isSmall,minimal:e.isMinimal,intent:e.intent,rightIcon:a.default.createElement(l.default,{icon:"caret-down"}),text:a.default.createElement("span",null,e.icon&&a.default.createElement(l.default,{icon:e.icon}),e.label.trim?e.label.trim():e.label)}))};c.defaultProps={label:void 0,icon:void 0,intent:void 0,isMinimal:!1,isDisabled:!1,isRightAligned:!1,isSmall:!1,isLarge:!1,className:"",usePortal:!0,isOpen:void 0,children:void 0},c.propTypes=u,t.default=c},function(e,t,n){},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var u=l(n(0)),c=n(5),s=n(6),d=n(98);n(984);var f={isLarge:!1,isSmall:!1,isMinimal:!1,className:"",accept:void 0},m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isUploading:!1},n.randKey=Math.round(99999*Math.random()).toString(),n.handleUploadFinish=n.handleUploadFinish.bind(n),n.handleFileSelect=n.handleFileSelect.bind(n),n}return a(t,e),t.prototype.handleUploadFinish=function(e,t,n,r){this.props.onUploadFinish("https://assets.pubpub.org/"+r),this.setState({isUploading:!1})},t.prototype.handleFileSelect=function(e){e.target.files.length&&((0,d.s3Upload)(e.target.files[0],(function(){}),this.handleUploadFinish,0),this.setState({isUploading:!0}))},t.prototype.render=function(){var e=this.props,t=e.text,n=e.icon,r=e.isLarge,a=e.isSmall,i=e.isMinimal,o=e.className,l=e.accept;return u.default.createElement("div",{className:"file-upload-button-component "+o},u.default.createElement(c.Button,{className:"upload-button",text:u.default.createElement(u.default.Fragment,null,u.default.createElement("label",{htmlFor:this.randKey,className:"file-select"},t,u.default.createElement("input",{id:this.randKey,name:"file-input",type:"file",accept:l,onChange:this.handleFileSelect,className:"file-input"}))),icon:n?u.default.createElement(s.Icon,{icon:n}):null,large:r,small:a,minimal:i,loading:this.state.isUploading}))},t.defaultProps=f,t}(u.Component);t.default=m},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=l(n(58)),f=n(18),m=n(9),p=n(163);n(989);var h=[{id:"1",title:"Create your community",href:"/community/create"},{id:"2",title:"Login",href:"/login"},{id:"3",title:"Signup",href:"/signup"},{id:"4",title:"Legal",href:"/legal"}],b=[{id:"si-1",icon:"twitter",title:"Twitter",value:"pubpub",url:"https://twitter.com/pubpub"},{id:"si-2",icon:"github",title:"Github",value:"pubpub",url:"https://github.com/pubpub"},{id:"si-3",icon:"envelope",title:"Contact by email",value:"hello@pubpub.org",url:"mailto:hello@pubpub.org?subject=Contact"}],v=function(e){var t=o((0,u.useState)(""),2),n=t[0],r=t[1],a=o((0,u.useState)(!1),2),i=a[0],l=a[1],v=o((0,u.useState)(!1),2),y=v[0],g=v[1],_=o((0,u.useState)(!1),2),E=_[0],P=_[1],w=(0,m.usePageContext)(e.previewContext),O=w.locationData,C=w.communityData,S=C.pages,D=void 0===S?[]:S,k=C.collections,j=void 0===k?[]:k,M=O.isBasePubPub,N=M?h:C.footerLinks||p.defaultFooterLinks,I=(0,p.getNavItemsForCommunityNavigation)({navigation:N,pages:D,collections:j}),x="light"===C.headerColorType?"/static/logoBlack.svg":"/static/logoWhite.svg",T=M?"base-pubpub":"accent-background accent-color",A=M?b:(0,p.createSocialNavItems)(C);return u.default.createElement("div",{className:"footer-component "+T},u.default.createElement(s.GridWrapper,null,u.default.createElement("div",{className:"left"},M&&u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"title"},u.default.createElement("a",{href:"https://pubpub.org"},u.default.createElement("img",{className:"logo",src:x,alt:"PubPub logo"})),u.default.createElement("ul",{className:"social-list"},u.default.createElement("li",null,u.default.createElement("a",{href:"https://twitter.com/pubpub"},u.default.createElement(d.default,{icon:"twitter"}))),u.default.createElement("li",null,u.default.createElement("a",{href:"mailto:hello@pubpub.org?subject=Contact"},u.default.createElement(d.default,{icon:"envelope"}))),u.default.createElement("li",null,u.default.createElement("a",{href:"https://github.com/pubpub"},u.default.createElement(d.default,{icon:"github"}))))),u.default.createElement("ul",{className:"separated"},u.default.createElement("li",null,u.default.createElement("a",{href:"https://pubpub.org/about"},"About")),u.default.createElement("li",null,u.default.createElement("a",{href:"https://pubpub.org/explore"},"Explore")),u.default.createElement("li",null,u.default.createElement("a",{href:"https://pubpub.org/pricing"},"Pricing")),u.default.createElement("li",null,u.default.createElement("a",{href:"https://help.pubpub.org"},"Help")),u.default.createElement("li",null,u.default.createElement("a",{href:"https://github.com/pubpub/pubpub/discussions"},"Forum"))),u.default.createElement("form",{onSubmit:function(e){return e.preventDefault(),l(!0),E?(0,f.apiFetch)("/api/subscribe",{method:"POST",body:JSON.stringify({email:n})}).then((function(){l(!1),r(""),g(!0)})).catch((function(e){console.error(e),l(!1)})):(l(!1),!1)}},u.default.createElement("strong",null,"Feature & Community Newsletter"),u.default.createElement(c.InputGroup,{type:"email",placeholder:"Your Email",value:n,onChange:function(e){r(e.target.value)},label:"Feature & community newsletter",rightElement:u.default.createElement(c.Button,{type:"submit",icon:y?"tick":"arrow-right",minimal:!0,loading:i}),disabled:y}),u.default.createElement("div",{className:"confirm"},u.default.createElement(c.Checkbox,{checked:E,disabled:y,required:"required",onChange:function(e){P(e.target.checked)},label:u.default.createElement("span",null,u.default.createElement(c.Popover,{interactionKind:c.PopoverInteractionKind.HOVER,popoverClassName:"bp3-popover-content-sizing",position:c.Position.RIGHT},u.default.createElement("p",null,u.default.createElement("em",null,"I agree to receive this newsletter.")),u.default.createElement("div",null,u.default.createElement("p",null,"We use a third party provider, Mailchimp, to deliver our newsletters. We never share your data with anyone, and you can unsubscribe using the link at the bottom of every email. Learn more by visiting yourÂ ",u.default.createElement("a",{href:"/legal/privacy"},"privacy settings"),"."))))})))),!M&&C.footerImage&&u.default.createElement("a",{href:C.footerLogoLink||"/"},u.default.createElement("img",{src:C.footerImage,className:"footer-image",alt:C.footerTitle||C.title}))),u.default.createElement("div",{className:"right"},u.default.createElement("div",{className:"footer-title"},u.default.createElement("a",{href:"/"},C.footerTitle||C.title)),u.default.createElement("ul",{className:"separated"},I.map((function(e){return"href"in e?u.default.createElement("li",{key:"footer-item-"+e.id},u.default.createElement("a",{className:"link",href:e.href},e.title)):null}))),!!A.length&&u.default.createElement("ul",{className:"social-list"},A.map((function(e){return u.default.createElement("a",{href:e.url,key:"social-item-"+e.id},u.default.createElement("li",null,u.default.createElement(d.default,{icon:e.icon})))}))))),u.default.createElement("div",{className:"built-on"},u.default.createElement("a",{href:M?"https://www.knowledgefutures.org":"https://www.pubpub.org"},!M&&u.default.createElement(u.default.Fragment,null,"Published with",u.default.createElement("img",{className:"logo",src:x,alt:"PubPub logo"})),M&&u.default.createElement(u.default.Fragment,null,"A project of the",u.default.createElement("img",{className:"logo",src:"/static/kfgMini.svg",alt:"KFG logo"})))))};v.defaultProps={previewContext:void 0},t.default=v},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getNavItemsForCommunityNavigation=t.createSocialNavItems=t.defaultFooterLinks=t.isNavbarMenu=t.isCommunityNavigationMenu=void 0;t.isCommunityNavigationMenu=function(e){return"object"==typeof e&&"children"in e};t.isNavbarMenu=function(e){return"children"in e},t.defaultFooterLinks=[{id:"rss",title:"RSS",href:"/rss.xml"},{id:"legal",title:"Legal",href:"/legal"}];t.createSocialNavItems=function(e){return[{id:"si-0",icon:"globe",title:"Website",value:e.website,url:e.website},{id:"si-1",icon:"twitter",title:"Twitter",value:e.twitter,url:"https://twitter.com/"+e.twitter},{id:"si-2",icon:"facebook",title:"Facebook",value:e.facebook,url:"https://facebook.com/"+e.facebook},{id:"si-3",icon:"envelope",title:"Contact",value:e.email,url:"mailto:"+e.email}].filter((function(e){return!!e.value}))};var a=function(e,t){var n=t.pages,a=t.collections;if("type"in e){var i=e.type,o=e.id,l="collection"===i?a.find((function(e){return e.id===o})):n.find((function(e){return e.id===o}));if(l)return function(e){return r({title:e.title,href:"/"+e.slug,id:e.id},!e.isPublic&&{isPrivate:!0})}(l)}else if("href"in e){var u=e.title,c=e.href,s=e.id,d=!c.startsWith("/");return r({title:u,href:c,id:s},d&&{isExternal:!0})}return null};t.getNavItemsForCommunityNavigation=function(e){var n=e.navigation,r=e.collections,i=e.pages;return n.map((function(e){return function(e,n){if((0,t.isCommunityNavigationMenu)(e)){var r=e.title,i=e.children;return{title:r,id:e.id,children:i.map((function(e){return a(e,n)})).filter((function(e){return!!e}))}}return a(e,n)}(e,{collections:r,pages:i})})).filter((function(e){return!!e}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.getDashboardMenuState=void 0;var a=n(40),i=n(264),o=n(265),l=n(420),u=n(988),c=function(e){var t=e.path,n=e.isDashboard,a=e.params,i=a.subMode,o=a.reviewNumber;return n?o?{mode:"reviews",subMode:o}:{mode:function(e){var t=r(e.split("/")),n=t[0],a=t[1],i=t.slice(2);(0,l.assert)(""===n&&"dash"===a);var o=i.shift();return"collection"===o||"pub"===o?(i.shift(),i.shift()):o}(t),subMode:i||null}:null};t.getDashboardMenuState=function(e){var t=e.locationData,n=e.scopeData;if(t.isBasePubPub)return{menuItems:[],activeMode:null};var r=n.elements.activeTargetType,l=u.menuItemsByScopeType[r],s=c(t);return{menuItems:l.filter((function(t){return function(e,t){var n=t.scopeData.activePermissions.activePermission,r=e.requiredPermission,a=e.shown;return!(r&&!(0,i.checkMemberPermission)(n,r))&&!(a&&!a(t))}(t,e)})).map((function(t){return function(e,t,n){var r=e.title,i=e.icon,l=e.count,u=e.dashboardMode,c=t.scopeData.elements.activeCollection,s=t.locationData.params.pubSlug;return{title:r,href:(0,a.getDashUrl)({mode:u,pubSlug:s,collectionSlug:null==c?void 0:c.slug}),icon:o.pubPubIcons[i],count:l?l(t):null,active:(null==n?void 0:n.mode)===u}}(t,e,s)})),activeMode:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menuItemsByScopeType=void 0;var r={title:"Overview",icon:"overview",dashboardMode:"overview"},a={title:"Activity",icon:"activity",dashboardMode:"activity"},i={title:"Reviews",icon:"review",dashboardMode:"reviews",count:function(e){return e.scopeData.activeCounts.reviews}},o={title:"Impact",icon:"impact",dashboardMode:"impact"},l={title:"Members",icon:"member",dashboardMode:"members",requiredPermission:"manage"},u={title:"Settings",icon:"settings",dashboardMode:"settings",requiredPermission:"manage"};t.menuItemsByScopeType={organization:[],community:[r,a,{title:"Pages",icon:"page",dashboardMode:"pages",requiredPermission:"manage"},i,o,l,u],collection:[r,a,{title:"Layout",icon:"layout",dashboardMode:"layout",requiredPermission:"manage"},i,{title:"Submissions",icon:"submission",dashboardMode:"submissions",requiredPermission:"manage",count:function(e){return e.scopeData.activeCounts.submissions},shown:function(e){return!!e.featureFlags.submissions}},o,l,u],pub:[r,a,i,{title:"Connections",icon:"connection",dashboardMode:"connections"},o,l,u]}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=l(n(0)),c=n(5),s=n(181),d=l(n(423));n(991);var f={key:"paragraph",title:u.default.createElement("p",null,"Paragraph"),label:"Paragraph",command:s.paragraphToggle},m=[f,{key:"header1",title:u.default.createElement("h1",{className:"h1"},"Header 1"),label:"Header 1",command:s.heading1Toggle},{key:"header2",title:u.default.createElement("h2",{className:"h2"},"Header 2"),label:"Header 2",command:s.heading2Toggle},{key:"header3",title:u.default.createElement("h3",{className:"h3"},"Header 3"),label:"Header 3",command:s.heading3Toggle},{key:"header4",title:u.default.createElement("h4",{className:"h4"},"Header 4"),label:"Header 4",command:s.heading4Toggle},{key:"header5",title:u.default.createElement("h5",{className:"h5"},"Header 5"),label:"Header 5",command:s.heading5Toggle},{key:"header6",title:u.default.createElement("h6",{className:"h6"},"Header 6"),label:"Header 6",command:s.heading6Toggle},{key:"code_block",title:u.default.createElement("pre",null,u.default.createElement("code",null,"Code")),label:"Code",command:s.codeBlockToggle}],p=u.default.forwardRef((function(e,t){var n=e.editorChangeObject,l=e.isSmall,s=a(e,["editorChangeObject","isSmall"]);return u.default.createElement(d.default,r({className:"block-type-selector-menu pub-body-styles","aria-label":"Choose text formatting",ref:t,commands:[m],disclosure:function(e,t){var n=t.ref,s=a(t,["ref"]),d=e.reduce((function(e,t){return o(o([],i(e),!1),i(t),!1)}),[]),p=d.find((function(e){var t;return null===(t=e.commandState)||void 0===t?void 0:t.isActive})),h=d.filter((function(e){var t;return null===(t=e.commandState)||void 0===t?void 0:t.canRun})),b=m.find((function(e){return e.command===(null==p?void 0:p.command)}))||f;return u.default.createElement(c.Button,r({minimal:!0,className:"block-type-selector-component",rightIcon:"caret-down",elementRef:n},s,{disabled:h.length<2,small:l}),b.label)},editorChangeObject:n},s))}));t.default=p},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(31)),d=u(n(3)),f=n(5),m=n(993),p=n(41);t.default=function(e){var t=e.accentColor,n=e.children,a=e.editorChangeObject,i=e.onClose,o=e.controlsConfiguration,u=o.isFullScreenWidth,h=o.kind,b=o.style,v=o.container,y=o.showCloseButton,g=o.title,_=o.captureFocusOnMount,E=l((0,c.useState)(_),2),P=E[0],w=E[1],O=(0,m.useFocusTrap)({isActive:P,ignoreMouseEvents:!0,restoreFocusTarget:a.view.dom,onEscapeKeyPressed:function(e){e.stopPropagation(),i()},onMouseDownOutside:function(e){(0,p.mouseEventSelectsNode)(a.view,e)||i()}});(0,c.useEffect)((function(){var e={capture:!0},t=function(e){"Tab"!==e.key||P||(e.preventDefault(),w(!0))};return document.addEventListener("keydown",t,e),function(){return document.removeEventListener("keydown",t,e)}}),[P]);var C=c.default.createElement("div",{"aria-label":"Editing "+g+" options",className:(0,d.default)("formatting-bar-controls-container-component","floating"===h&&"floating bp3-elevation-2",u&&"full-screen-width"),style:r({background:t},b),ref:O.ref},c.default.createElement("div",{className:"inner"},n),y&&c.default.createElement("div",{className:"close-button-container"},c.default.createElement(f.Button,{minimal:!0,small:!0,icon:"cross","aria-label":"Close options",onClick:i})));return"floating"===h?s.default.createPortal(C,v):C}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useFocusTrap=void 0;var a=n(0),i={capture:!0},o=function(e){var t=[];for(t.push(e);e.parentElement;)t.unshift(e.parentElement),e=e.parentElement;return t.filter((function(e){return e instanceof Element})).some((function(e){var t;return null===(t=e.classList)||void 0===t?void 0:t.contains("__reakit-portal")}))},l=function(){var e=window.scrollX,t=window.scrollY;return{restore:function(){"function"==typeof window.scrollTo&&window.scrollTo(e,t)}}},u=function(e,t){return!e||!e.contains(t)&&!o(t)};t.useFocusTrap=function(e){var t=void 0===e?{}:e,n=t.onMouseDownOutside,c=void 0===n?null:n,s=t.onEscapeKeyPressed,d=void 0===s?null:s,f=t.onClickOutside,m=void 0===f?null:f,p=t.isActive,h=void 0!==p&&p,b=t.ignoreMouseEvents,v=void 0!==b&&b,y=t.restoreFocusTarget,g=void 0===y?null:y,_=r((0,a.useState)(null),2),E=_[0],P=_[1],w=(0,a.useRef)(!1),O=(0,a.useRef)(null),C=(0,a.useRef)(null),S=(0,a.useRef)(!1),D=(0,a.useRef)(0),k=(0,a.useCallback)((function(e){if(e instanceof HTMLElement){w.current=!0;try{e.focus()}catch(e){}return w.current=!1,document.activeElement===e}return!1}),[]),j=(0,a.useCallback)((function(e){for(var t=e.childNodes,n=t.length-1;n>=0;n-=1){var r=t[n];if(k(r)||j(r))return!0}return!1}),[k]),M=(0,a.useCallback)((function(e){for(var t=e.childNodes,n=0;n<t.length;n+=1){var r=t[n];if(k(r)||M(r))return!0}return!1}),[k]),N=(0,a.useCallback)((function(e){var t=e.target,n=Date.now()-D.current<1e3;if(!(w.current||!h||!(t instanceof Node)||!E||n&&v))if(E&&E.contains(t))O.current=t,C.current=l();else{if(o(t))return;C.current&&C.current.restore(),M(E),document.activeElement===O.current&&j(E),O.current=document.activeElement}}),[M,j,h,E,v]),I=(0,a.useCallback)((function(e){var t=e.target;D.current=Date.now(),u(E,t)&&(S.current=!0,c&&c(e))}),[c,E]),x=(0,a.useCallback)((function(e){var t=e.target;u(E,t)&&m&&S.current&&m(e)}),[m,E]),T=(0,a.useCallback)((function(e){"Escape"===e.key&&d&&(e.stopPropagation(),d(e))}),[d]);return(0,a.useEffect)((function(){return window.addEventListener("focus",N,!0),function(){return window.removeEventListener("focus",N,!0)}}),[N]),(0,a.useEffect)((function(){return window.addEventListener("mousedown",I,i),function(){return window.removeEventListener("mousedown",I,i)}}),[I]),(0,a.useEffect)((function(){return window.addEventListener("click",x,i),function(){return window.removeEventListener("click",x,i)}}),[x]),(0,a.useEffect)((function(){return E?(E.addEventListener("keydown",T),function(){return E.removeEventListener("keydown",T)}):function(){}}),[T,E]),(0,a.useEffect)((function(){if(E&&h&&!E.contains(document.activeElement)){var e=E.tabIndex;return E.tabIndex=-1,k(E),function(){E.tabIndex=e}}return function(){}}),[h,E,k]),(0,a.useEffect)((function(){var e=document.activeElement;return function(){var t=l();k(g||e),t.restore()}}),[g,k]),{ref:P}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.usePendingAttrs=void 0;var i=n(0),o=n(71),l=n(41);t.usePendingAttrs=function(e){var t=e.selectedNode,n=e.updateNode,u=e.view,c=(null==t?void 0:t.attrs.id)||null,s=(0,o.usePrevious)(c),d=a((0,i.useState)({}),2),f=d[0],m=d[1],p=(0,i.useCallback)((function(e){m((function(t){var n=r({},t);return delete n[e],n}))}),[]),h=(0,i.useCallback)((function(e){c&&m((function(t){var n,a=t[c];return r(r({},t),((n={})[c]=r(r({},a),e),n))}))}),[c]),b=(0,i.useCallback)((function(){if(c&&n){var e=f[c];e&&(null==n||n(e),p(c))}}),[c,n,f,p]);if((0,i.useEffect)((function(){if(s&&s!==c){var e=f[s];e&&((0,l.updateNodeAttrsById)(u,s,e),p(s))}}),[c,s,f,p,u]),t&&c){var v=f[c],y=!!v&&Object.keys(v).length>0;return{attrs:r(r({},t.attrs),v),hasPendingChanges:y,updateAttrs:h,commitChanges:b}}return null}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useControlsState=void 0;var i=n(0),o=n(41),l=n(996),u=n(266),c=n(998),s=n(424),d=function(e,t){return(0,u.deepMap)(e,(function(e){return function(e,t){var n=t.openedButton,r=t.setOpenedButton,a=t.indicatedButtons,i=t.controlsDetached,l=t.editorChangeObject.view,u=function(e,t){var n=e.commandState;return!("function"!=typeof e.isDisabled||!e.isDisabled(t.editorChangeObject))||!(!n||n.canRun)}(e,t),c=(null==n?void 0:n.key)===e.key,s=a.some((function(t){return t.key===e.key})),d=function(e){var t=e.commandState;return!!t&&t.isActive}(e);return{button:e,isDisabled:u,isOpen:c,isIndicated:s,isActive:d,isDetached:c&&i,isHidden:!1,onClick:function(){if(s)r(n===e?null:e);else if("insertNodeType"in e)(0,o.insertNodeIntoEditor)(l,e.insertNodeType),l.focus();else{var t=e.commandState;null==t||t.run(),l.focus()}}}}(e,t)}))};t.useControlsState=function(e){var t,n,o,u,f=e.buttons,m=e.editorChangeObject,p=e.controlsConfiguration,h=(0,i.useMemo)((function(){return f.reduce((function(e,t){return a(a([],r(e),!1),r(t),!1)}),[])}),[f]),b=r((0,i.useState)(null),2),v=b[0],y=b[1],g=(0,c.useInteractionCount)(m.latestDomEvent),_=null===(t=m.view)||void 0===t?void 0:t.dom,E=(0,s.useCommandStates)({view:m.view,state:null===(n=m.view)||void 0===n?void 0:n.state,commands:f}),P=null===(u=null===(o=m.selectedNode)||void 0===o?void 0:o.attrs)||void 0===u?void 0:u.id,w=P+"-"+g,O=h.filter((function(e){var t;return null===(t=e.controls)||void 0===t?void 0:t.indicate(m)})),C=O.map((function(e){return e.key})).join("-"),S=(0,l.resolveControlsConfiguration)(p,m,v),D=d(E,{indicatedButtons:O,openedButton:v,setOpenedButton:y,editorChangeObject:m,controlsDetached:"floating"===(null==S?void 0:S.kind)});return(0,i.useEffect)((function(){var e=O.find((function(e){return e.controls&&e.controls.trigger(m)}));y(e||null)}),[w,C]),(0,i.useEffect)((function(){var e={capture:!0},t=function(e){var t;if("Enter"===e.key&&(null==_?void 0:_.contains(document.activeElement))&&1===O.length&&!v){var n=r(O,1)[0];(null===(t=null==n?void 0:n.controls)||void 0===t?void 0:t.enterKeyTriggers)&&(e.stopImmediatePropagation(),e.preventDefault(),y(n))}};return document.addEventListener("keydown",t,e),function(){return document.removeEventListener("keydown",t,e)}}),[O,v,y,_]),{openedButton:v,setOpenedButton:y,selectedNodeId:P,buttonStates:D,resolvedControlsConfiguration:S}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(268),t),a(n(997),t)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveControlsConfiguration=void 0;var a=n(268);t.resolveControlsConfiguration=function(e,t,n){if("none"!==e.kind&&(null==n?void 0:n.controls)){var i=n.controls.indicate(t),o=n.controls.show(t);if(i&&o){var l=n.title,u=n.ariaTitle,c=n.controls,s=c.component,d=c.captureFocusOnMount,f=c.showCloseButton;if(s)return r(r(r({},e),function(e,t,n){var r=e.kind,i=t.floatingPosition;return i?{kind:"floating",style:i(n,e)}:"floating"===r?{kind:"floating",style:(0,a.positionNearSelection)(n,e)}:{kind:r,style:{}}}(e,n.controls,t)),{component:s,showCloseButton:!!f,captureFocusOnMount:!!d,title:u||l})}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useInteractionCount=void 0;var r=n(0);t.useInteractionCount=function(e){var t=(0,r.useRef)(-1),n=(0,r.useRef)(null);e&&(n.current&&n.current.type===e.type&&n.current.timeStamp===e.timeStamp||(t.current+=1),n.current=e);return t.current}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1001);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6),o=n(9),l=n(130),u=n(265),c=r(n(1002)),s=r(n(1003)),d=r(n(1005)),f=r(n(269));n(1006);t.default=function(e){var t=e.isBasePubPub,n=void 0!==t&&t,r=e.loggedIn,m=(0,o.usePageContext)(),p=m.locationData,h=m.loginData,b=m.communityData.hideCreatePubButton,v=m.scopeData.activePermissions.canManage,y=function(){return a.default.createElement(f.default,{href:"/search",desktop:{text:"Search"},mobile:{icon:"search"}})};return a.default.createElement("div",{className:"global-controls-component"},(0,l.isDevelopment)()&&a.default.createElement(i.DevCommunitySwitcherMenu,{disclosure:a.default.createElement(f.default,{mobileOrDesktop:{icon:u.pubPubIcons.community,rightIcon:"caret-down"}})}),function(){if(!n){var e=r&&(!b||v);return a.default.createElement(a.default.Fragment,null,e&&a.default.createElement(d.default,null),y(),a.default.createElement(i.Menu,{"aria-label":"Dashboard menu",placement:"bottom-end",menuStyle:{zIndex:20},disclosure:a.default.createElement(f.default,{mobile:{icon:"settings"},desktop:{text:"Dashboard",rightIcon:"caret-down"}})},a.default.createElement(i.ScopeDropdown,null)),r?a.default.createElement(i.UserNotificationsPopover,null,(function(e){var t=e.hasUnreadNotifications;return a.default.createElement(f.default,{mobileOrDesktop:{icon:t?"inbox-update":"inbox"}})})):null)}return null}(),n?a.default.createElement(a.default.Fragment,null,a.default.createElement(f.default,{href:"/explore",mobileOrDesktop:{text:"Explore"}}),a.default.createElement(f.default,{href:"/pricing",mobileOrDesktop:{text:"Pricing"}}),a.default.createElement(f.default,{href:"/about",mobileOrDesktop:{text:"About"}}),y()):null,r?a.default.createElement(c.default,{loginData:h}):a.default.createElement(s.default,{locationData:p}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(6),c=n(18),s=function(){(0,c.apiFetch)("/api/logout").then((function(){window.location.href="/"}))},d=function(e,t,n,a){var i=e.initials,c=e.avatar,s=n.ref,d=n.className;return o.default.createElement(l.Button,r({minimal:!0,large:!t,className:d,elementRef:s},a),o.default.createElement(u.Avatar,{initials:i,avatar:c,width:t?20:30}))};t.default=function(e){var t=e.loginData;return o.default.createElement(u.Menu,{"aria-label":"User menu",placement:"bottom-end",menuStyle:{zIndex:20},disclosure:function(e){return function(e,t){var n=t.ref,r=a(t,["ref"]);return o.default.createElement(u.MobileAware,{ref:n,mobile:function(t){return d(e,!0,t,r)},desktop:function(t){return d(e,!1,t,r)}})}(t,e)}},o.default.createElement(u.MenuItem,{href:"/user/"+t.slug,text:o.default.createElement(o.default.Fragment,null,t.fullName,o.default.createElement("span",{className:"subtext",style:{marginLeft:4}},"View Profile"))}),o.default.createElement(u.MenuItem,{href:"/legal/settings",text:"Privacy settings"}),o.default.createElement(u.MenuItem,{onClick:s,text:"Logout"}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(269));t.default=function(e){var t=e.locationData,n=t.path,r=t.queryString,o="/login"+("?redirect="+n+(r.length>1?r:""));return a.default.createElement(i.default,{href:o,desktop:{text:"Login or Signup"},mobile:{text:"Login"}})}},,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(9),s=n(18),d=l(n(269));t.default=function(){var e=o((0,u.useState)(!1),2),t=e[0],n=e[1],r=(0,c.usePageContext)().communityData;return u.default.createElement(d.default,{loading:t,onClick:function(){return n(!0),s.apiFetch.post("/api/pubs",{communityId:r.id}).then((function(e){window.location.href="/pub/"+e.slug})).catch((function(e){console.error(e),n(!1)}))},desktop:{text:"Create Pub"},mobile:{icon:"pubDocNew"}})}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));t.default=function(e){var t=e.containerClassName,n=void 0===t?"":t,r=e.columnClassName,i=void 0===r?"":r,o=e.children,l=void 0===o?null:o;return a.default.createElement("div",{className:"container "+n},a.default.createElement("div",{className:"row"},a.default.createElement("div",{className:"col-12 "+i},l)))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(5),l=n(6),u=n(9),c=n(88);n(1009);var s=function(e){var t=(0,u.usePageContext)(e.previewContext),n=t.locationData,r=t.communityData,s=t.loginData,d="/"!==n.path||r.hideHero,f=!d&&r.hideHeaderLogo,m=function(e){var t="",a="/"===n.path,i=n.isBasePubPub,o=r.heroBackgroundColor&&r.accentColorDark!==r.heroBackgroundColor,l=r.heroTextColor&&r.accentTextColor!==r.heroTextColor;return(i||o)&&a||(t+=" accent-background"),(i||l)&&(i||a)||(t+=" accent-color"),e||"#FFFFFF"===(r.heroTextColor||r.accentTextColor)&&(t+=" bp3-dark"),t}(d),p=function(e){var t="main";return e||!r.hideHero&&r.useHeaderGradient&&r.heroBackgroundImage&&(t+=" gradient bp3-dark"),t}(d),h=function(e){var t="hero";return e||"center"===r.heroAlign&&(t+=" centered"),t}(d),b=function(e){var t={};if(n.isBasePubPub&&(t.boxShadow="/"===n.path?"":"0 0 0 1px rgba(16, 22, 26, 0.1), 0 0 0 rgba(16, 22, 26, 0), 0 1px 1px rgba(16, 22, 26, 0.2)",t.backgroundColor="/"===n.path?"":"#f7f7f9"),e)return t;if(r.heroBackgroundImage){var a=(0,c.getResizedUrl)(r.heroBackgroundImage,"outside",1500,600);t.backgroundImage='url("'+a+'")'}return(r.heroBackgroundColor||r.accentColorDark)&&(t.backgroundColor=r.heroBackgroundColor),t}(d),v=!!s.slug,y=n.isBasePubPub,g=(0,c.getResizedUrl)(r.headerLogo,"inside",void 0,50),_=(0,c.getResizedUrl)(r.heroLogo,"inside",void 0,200),E=(0,c.getResizedUrl)(r.heroImage,"inside",600),P=r.heroPrimaryButton||{},w=r.heroSecondaryButton||{},O=!!e.previewContext;return a.default.createElement("header",{className:(0,i.default)(["header-component",m,O?"preview":""]),style:b},a.default.createElement("div",{className:p},a.default.createElement(l.GridWrapper,{columnClassName:"main-content"},a.default.createElement("div",{className:"logo-wrapper"},!f&&a.default.createElement("a",{href:"/","aria-label":r.title},r.headerLogo&&a.default.createElement(a.default.Fragment,null,a.default.createElement("img",{alt:"",style:y?{padding:"1px 0px"}:{},src:g})),!r.headerLogo&&a.default.createElement("span",null,r.title))),a.default.createElement(l.GlobalControls,{isBasePubPub:n.isBasePubPub,loggedIn:v}))),!d&&a.default.createElement("div",{className:h},a.default.createElement(l.GridWrapper,{columnClassName:"hero-content"},a.default.createElement("div",{className:"hero-copy"},r.heroLogo&&a.default.createElement("div",{className:"hero-logo"},a.default.createElement("img",{alt:r.title,src:_})),r.heroTitle&&a.default.createElement("div",{className:"hero-title"},r.heroTitle),r.heroText&&a.default.createElement("div",{className:"hero-text"},r.heroText),a.default.createElement("div",{className:"hero-button"},P.title&&a.default.createElement(o.AnchorButton,{intent:o.Intent.PRIMARY,large:!0,text:P.title,href:P.url}),w.title&&a.default.createElement(o.AnchorButton,{large:!0,minimal:!0,text:w.title,href:w.url}))),r.heroImage&&a.default.createElement("div",{className:"hero-image"},a.default.createElement("img",{alt:"Community banner",src:E})))))};s.defaultProps={previewContext:void 0},t.default=s},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxPubsPerBlock=void 0,t.maxPubsPerBlock=100},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveLayoutPubsByBlock=void 0;var i=n(62);t.resolveLayoutPubsByBlock=function(e,t){var n=e.pubIdsByBlockId,o=e.pubsById,l=t.filter((function(e){return"pubs"===e.type})),u=(0,i.indexByProperty)(l,"id"),c={};return Object.entries(n).forEach((function(e){var t=r(e,2),n=t[0],l=t[1],s=u[n];if(s){var d=s.content,f=d.limit,m=d.pubIds,p=void 0===m?[]:m,h=l.map((function(e){return o[e]})).filter((function(e){return!!e})),b=r((0,i.splitArrayOn)(h,(function(e){return p.includes(e.id)})),2),v=b[0],y=b[1],g=a(a([],r(v.sort((function(e,t){return p.indexOf(e.id)-p.indexOf(t.id)}))),!1),r(y),!1);c[n]=g.slice(0,f||1/0)}})),c}},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.doi?e.doi:e.metadata&&e.metadata.doi}},,,,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=n(9),u=r(n(437));t.default=function(e){var t=e.content,n=t.body,r=t.title,c=t.submissionWorkflowId,s=(0,l.usePageContext)().loginData.id;return a.default.createElement("div",{className:"layout-text-component"},a.default.createElement("div",{className:"block-content"},a.default.createElement(o.GridWrapper,null,a.default.createElement(u.default,{title:r,content:a.default.createElement(a.default.Fragment,null,a.default.createElement(o.Editor,{initialContent:n,isReadOnly:!0}),a.default.createElement(i.AnchorButton,{href:"/submit/"+c},s?"Create a submission":"Log in to submit"))}))))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=o(n(438)),s=n(6),d=n(1030),f=n(1031),m=o(n(1032)),p=o(n(1034)),h=o(n(1042)),b=o(n(1043)),v=o(n(1090)),y=o(n(1091)),g=o(n(1093));n(1097);var _=["pubs","text","html","banner","collections-pages","collection-header"];t.default=function(e){var t=e.initialLayout,n=e.initialLayoutPubsByBlock,r=e.collection,a=e.communityData,i=e.onChange,o=(0,d.useLayout)(t,i),E=o.layout,P=o.changeLayout,w=o.changeLayoutPartial,O=o.insertBlock,C=o.removeBlock,S=o.moveBlockUp,D=o.moveBlockDown,k=(0,f.useLayoutPubs)(n,E,r&&r.id),j=k.pubsByBlockId,M=k.loadingPubs;(0,l.useEffect)((function(){var e=(0,c.default)(".block-header",{stickyBitStickyOffset:129});return function(){return e.cleanup()}}),[]);var N=!!r&&1===E.filter((function(e){return"pubs"===e.type})).length;return l.default.createElement("div",{className:"layout-editor-component"},l.default.createElement(m.default,{insertIndex:0,onInsert:O,communityData:a,showCollectionHeaderBlock:!!r,pubSort:r?"collection-rank":"creation-date"}),E.map((function(e,t){return _.indexOf(e.type)>-1?l.default.createElement("div",{key:e.id},function(e,t){var n,r=N&&"pubs"===e.type;return l.default.createElement("div",{className:"block-title"},l.default.createElement("div",{className:"text"},"collection-header"===(n=e.type)?"Collection Header":"collections-pages"===n?"Collections & Pages":"html"===n?"HTML":n," Block"),l.default.createElement("div",{className:"bp3-button-group bp3-minimal bp3-small"},l.default.createElement(u.Button,{text:"Move Up",icon:"caret-up",disabled:0===t,onClick:function(){return S(t)}}),l.default.createElement(u.Button,{text:"Move Down",icon:"caret-down",disabled:t===E.length-1,onClick:function(){return D(t)}}),!r&&l.default.createElement(s.Popover,{placement:"bottom-end","aria-label":"Remove this block",gutter:1,content:l.default.createElement(u.Card,null,l.default.createElement("p",null,"Are you sure you want to remove this block?"),l.default.createElement(u.Button,{intent:"danger",text:"Remove",onClick:function(){return C(t)}}))},l.default.createElement(u.Button,null,"Remove Block")),r&&l.default.createElement(u.Tooltip,{content:"This layout requires at least one Pubs block."},l.default.createElement(u.Button,{text:"Remove",disabled:!0}))))}(e,t),l.default.createElement("div",{key:"block-"+e.id,className:"component-wrapper"},"pubs"===e.type&&l.default.createElement(p.default,{key:"item-"+e.id,onChange:w,layoutIndex:t,block:e,pubsInBlock:j[e.id]||[],communityData:a,loading:M,scopedCollectionId:null==r?void 0:r.id}),"text"===e.type&&l.default.createElement(b.default,{key:"item-"+e.id,onChange:w,layoutIndex:t,content:e.content}),"html"===e.type&&l.default.createElement(v.default,{key:"item-"+e.id,onChange:P,layoutIndex:t,content:e.content}),"banner"===e.type&&l.default.createElement(y.default,{key:"item-"+e.id,onChange:P,layoutIndex:t,content:e.content,communityData:a}),"collections-pages"===e.type&&l.default.createElement(h.default,{key:"item-"+e.id,onChange:P,layoutIndex:t,content:e.content,pages:a.pages,collections:a.collections}),!!r&&"collection-header"===e.type&&l.default.createElement(g.default,{key:"item-"+e.id,layoutIndex:t,onChange:w,collection:r,block:e})),l.default.createElement(m.default,{key:"insert-"+e.id,insertIndex:t+1,onInsert:O,communityData:a,showCollectionHeaderBlock:!!r,pubSort:r?"collection-rank":"creation-date"})):null})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useLayout=void 0;var o=n(0),l=n(161);t.useLayout=function(e,t){var n=a((0,o.useState)(e),2),u=n[0],c=n[1],s=function(e){var n=e(i([],a(u),!1));t(n),c(n)};return{layout:u,changeLayout:function(e,t){s((function(n){return n[e].content=t,n}))},changeLayoutPartial:function(e,t){s((function(n){var o=n[e],l=r(r({},o),{content:r(r({},o.content),t)});return i(i(i([],a(n.slice(0,e)),!1),[l],!1),a(n.slice(e+1)),!1)}))},insertBlock:function(e,t,n){s((function(r){return r.splice(e,0,{id:(0,l.generateHash)(8),type:t,content:n}),r}))},removeBlock:function(e){s((function(t){return t.splice(e,1),t}))},moveBlockUp:function(e){s((function(t){var n=t[e-1];return t[e-1]=t[e],t[e]=n,t}))},moveBlockDown:function(e){s((function(t){var n=t[e+1];return t[e+1]=t[e],t[e]=n,t}))}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useLayoutPubs=void 0;var i=n(0),o=n(71),l=n(62),u=n(271),c=n(18),s=function(e){return e.filter((function(e){return"pubs"===e.type}))};t.useLayoutPubs=function(e,t,n){var d=(0,o.usePrevious)(t),f=a((0,i.useState)(e.pubsById),2),m=f[0],p=f[1],h=a((0,i.useState)(0),2),b=h[0],v=h[1],y=(0,i.useRef)(0),g=a((0,i.useState)(e.pubIdsByBlockId),2),_=g[0],E=g[1];return(0,i.useEffect)((function(){if(d&&t&&d!==t){var e=s(d),a=s(t);if(function(e,t){if(!(0,l.arraysAreEqual)(e,t,(function(e,t){return e.id===t.id})))return!0;for(var n=0;n<t.length;n++){var r=e[n],a=t[n];if(i=r.content,o=a.content,i.limit!==o.limit||i.sort!==o.sort||!(0,l.arraysHaveSameElements)(i.collectionIds||[],o.collectionIds||[])||!(0,l.arraysHaveSameElements)(i.pubIds||[],o.pubIds||[]))return!0}var i,o;return!1}(e,a)){var i=Object.keys(m),o=Date.now();v((function(e){return e+1})),function(e,t,n){return c.apiFetch.post("/api/layout",{blocks:e,alreadyFetchedPubIds:t,collectionId:n})}(a,i,n).then((function(e){o>y.current&&(y.current=o,p((function(t){return r(r({},t),e.pubsById)})),E(e.pubIdsByBlockId),v((function(e){return e-1})))}))}}}),[d,t,m,n]),{pubsByBlockId:(0,u.resolveLayoutPubsByBlock)({pubIdsByBlockId:_,pubsById:m},t),allPubs:Object.values(m),loadingPubs:0!==b}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=n(6);n(1033);var u={type:"collection-header",title:"Default",content:{}},c=[{title:"Default",type:"html",content:{html:""}}],s=[{title:"Default",type:"text",content:{text:void 0,align:"left"}}],d=function(e){return[{title:"Default",type:"pubs",content:{title:"",pubPreviewType:"medium",limit:0,pubIds:[],collectionIds:[],sort:e}},{title:"Table of Contents",type:"pubs",content:{title:"",pubPreviewType:"small",limit:0,pubIds:[],collectionIds:[],hideByline:!0,hideDates:!0,hideContributors:!0}}]},f=[{title:"Default",type:"banner",content:{text:"Hello",align:"center",backgroundColor:"#3275d8",backgroundImage:"",backgroundSize:"full",showButton:!1,buttonText:"",defaultCollectionIds:[],buttonUrl:"",buttonType:"none"}},{title:"Submission Button Banner",type:"banner",content:{text:"Create a pub to begin your submission.",align:"center",backgroundColor:"#3275d8",backgroundImage:"",backgroundSize:"full",showButton:!0,buttonText:"",defaultCollectionIds:[],buttonUrl:"",buttonType:"create-pub"}}];t.default=function(e){var t,n=e.insertIndex,a=e.onInsert,m=e.pubSort,p=e.showCollectionHeaderBlock,h=[(t=e.communityData,{type:"collections-pages",title:"Default",content:{title:"",items:t.pages.slice(0,3)}})],b=function(e){return i.default.createElement(o.MenuItem,{key:"insert-"+e.type+"-"+e.title,onClick:function(){a(n,e.type,r({},e.content))},text:e.title,shouldDismissPopover:!0})};return i.default.createElement("div",{className:"layout-editor-insert-component"},i.default.createElement(o.Popover,{content:i.default.createElement(o.Menu,null,p&&i.default.createElement(i.default.Fragment,null,i.default.createElement("li",{className:"bp3-menu-header"},i.default.createElement("h6",null,"Collection Header Block")),b(u)),i.default.createElement("li",{className:"bp3-menu-header"},i.default.createElement("h6",null,"Pubs Block",i.default.createElement(l.Icon,{icon:"widget-header"}))),d(m).map((function(e){return b(e)})),i.default.createElement("li",{className:"bp3-menu-header"},i.default.createElement("h6",null,"Banner Block",i.default.createElement(l.Icon,{icon:"vertical-distribution"}))),f.map((function(e){return b(e)})),i.default.createElement("li",{className:"bp3-menu-header"},i.default.createElement("h6",null,"Text Block",i.default.createElement(l.Icon,{icon:"new-text-box"}))),s.map((function(e){return b(e)})),i.default.createElement("li",{className:"bp3-menu-header"},i.default.createElement("h6",null,"HTML Block",i.default.createElement(l.Icon,{icon:"code"}))),c.map((function(e){return b(e)})),i.default.createElement("li",{className:"bp3-menu-header"},i.default.createElement("h6",null,"Collections & Pages Block",i.default.createElement(l.Icon,{icon:"application"}))),h.map((function(e){return b(e)}))),interactionKind:o.PopoverInteractionKind.CLICK,position:o.Position.BOTTOM,popoverClassName:"bp3-minimal",transitionDuration:-1,inheritDarkTheme:!1,usePortal:!1},i.default.createElement("button",{type:"button",className:"bp3-button bp3-icon-add"},"Add Block")),i.default.createElement("div",{className:"center-line"}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1035);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=u(n(3)),d=n(5),f=n(6),m=n(274),p=u(n(1036)),h=u(n(1037)),b=u(n(1038)),v=[{value:"large",label:"Large"},{value:"medium",label:"Medium"},{value:"small",label:"Small"},{value:"minimal",label:"Minimal"}],y=[{value:"publish-date-reversed",label:"First published"},{value:"publish-date",label:"Recently published"},{value:"creation-date-reversed",label:"First created"},{value:"creation-date",label:"Recently created"},{value:"collection-rank",label:"Collection order"}];t.default=function(e){var t,n=e.onChange,r=e.layoutIndex,a=e.block,i=e.pubsInBlock,u=e.communityData,g=e.loading,_=e.scopedCollectionId,E=a.content,P=E.limit,w=E.pubIds,O=void 0===w?[]:w,C=E.collectionIds,S=void 0===C?[]:C,D=E.pubPreviewType,k=E.sort,j=(0,c.useCallback)((function(e){return n(r,e)}),[n,r]),M=(0,c.useCallback)((function(e){return j({pubPreviewType:e})}),[j]),N=(0,c.useCallback)((function(e){return j({limit:e,pubIds:O.slice(0,e||1/0)})}),[j,O]),I=(0,c.useCallback)((function(e){return j({sort:e})}),[j]),x=(0,c.useCallback)((function(e){return j({collectionIds:e})}),[j]),T=(0,c.useCallback)((function(e){return j({pubIds:e,limit:"number"==typeof P&&P>0?Math.max(P,e.length):P})}),[j,P]),A=(0,c.useCallback)((function(e){return j({title:e})}),[j]);return c.default.createElement("div",{className:(0,s.default)("layout-editor-pubs-component",g&&"loading")},c.default.createElement("div",{className:"block-header rows"},c.default.createElement("div",{className:"controls-row"},c.default.createElement(f.InputField,{label:"Title",value:a.content.title,onChange:function(e){return A(e.target.value)}}),(t=u.collections,c.default.createElement(f.InputField,{label:"Filter by Collection"},c.default.createElement(f.CollectionMultiSelect,{allCollections:t,selectedCollectionIds:S,onItemSelect:function(e){return x(l(l([],o(S),!1),[e],!1))},onRemove:function(e,t){var n=l([],o(S),!1);n.splice(t,1),x(n)},placeholder:"Add collections..."})))),c.default.createElement("div",{className:"controls-row"},c.default.createElement(f.MenuSelect,{"aria-label":"Select sort order",items:y,onSelectValue:function(e){return I(e)},value:k||null,defaultLabel:c.default.createElement("i",null,"Choose"),icon:"sort",prefix:c.default.createElement("b",null,"Sort: ")}),c.default.createElement(f.MenuSelect,{"aria-label":"Select preview type",items:v,value:D,onSelectValue:function(e){return M(e)},icon:"control",prefix:c.default.createElement("b",null,"Size: ")}),c.default.createElement(f.Popover,{"aria-label":"Choose preview elements",content:c.default.createElement(p.default,{content:a.content,onChangeContent:j})},c.default.createElement(d.Button,{outlined:!0,icon:"settings",rightIcon:"caret-down"},"Pub elements")),c.default.createElement(f.Popover,{"aria-label":"Limit number of Pubs",content:c.default.createElement(h.default,{limit:a.content.limit,onChangeLimit:N})},c.default.createElement(d.Button,{outlined:!0,icon:"dashboard",rightIcon:"caret-down"},"Limit Pubs",P?" ("+P+")":"")),c.default.createElement(f.Popover,{"aria-label":"Choose pinned Pubs for this block",className:"order-picker-popover",placement:"bottom-end",content:c.default.createElement(b.default,{onPubIds:T,pubIds:O,pubsInBlock:i,scopedCollectionId:_})},c.default.createElement(d.Button,{outlined:!0,icon:"pin",rightIcon:"caret-down"},"Pinned Pubs",O.length?" ("+O.length+")":"")))),c.default.createElement(m.LayoutPubs,{pubs:i,content:a.content}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l={hideByline:"Byline",hideContributors:"Contributors",hideDates:"Dates",hideDescription:"Description",hideEdges:"Connections"};t.default=function(e){var t=e.content,n=e.onChangeContent;return i.default.createElement(o.Card,{className:"layout-editor-pubs_preview-elements-component"},Object.entries(l).map((function(e){var a=r(e,2),l=a[0],u=a[1],c=function(e,t){var n=e.pubPreviewType,r=e[t],a="minimal"===n&&("hideDescription"===t||"hideDates"===t||"hideContributors"===t);return{hidden:!!a||r,disabled:a}}(t,l),s=c.disabled,d=c.hidden;return i.default.createElement(o.Checkbox,{key:l,disabled:s,label:u,checked:!d,onChange:function(){var e;return n(((e={})[l]=!d,e))}})})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(6),s=n(271);t.default=function(e){var t=e.limit,n=e.onChangeLimit,r=o((0,l.useState)(t||10),2),a=r[0],i=r[1];return l.default.createElement(u.Card,{className:"layout-editor-pubs_limit-pubs-component"},l.default.createElement(u.RadioGroup,{onChange:function(e){"all"===e.currentTarget.value?n(void 0):(n(10),i(10))},selectedValue:t?"limit":"all"},l.default.createElement(u.Radio,{value:"all",label:"Show up to "+s.maxPubsPerBlock+" Pubs"}),l.default.createElement(u.Radio,{value:"limit",labelElement:l.default.createElement(l.default.Fragment,null,"Limit shown Pubs",!!t&&l.default.createElement(c.SliderInput,{"aria-label":"Number of Pubs to display",min:1,max:s.maxPubsPerBlock,onChange:function(e,t){i(e),t&&n(e)},value:a,labelStepSize:s.maxPubsPerBlock-1}))})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(137),d=n(6),f=n(133),m=n(62);t.default=function(e){var t=e.pubIds,n=e.pubsInBlock,a=e.onPubIds,i=e.scopedCollectionId,o=l((0,c.useState)(""),2),p=o[0],h=o[1],b=l((0,s.useDebounce)(p,200),1)[0],v=(0,f.useManyPubs)({query:{scopedCollectionId:i,term:b,ordering:{field:"title",direction:"ASC"}}}),y=v.currentQuery,g=y.pubs,_=y.loadMorePubs,E=y.hasLoadedAllPubs,P=v.allQueries.isLoading,w=function(e,t,n,a){var i=(0,c.useRef)({});return(0,c.useMemo)((function(){i.current=r(r({},i.current),(0,m.indexByProperty)(u(u([],l(t),!1),l(n),!1),"id"));var o=i.current,c=n.filter((function(t){return!e.includes(t.id)}));return{selectedPubs:e.map((function(e){return o[e]})).filter((function(e){return e})),availablePubs:a?c:(0,m.unique)(u(u([],l(t.filter((function(t){return!e.includes(t.id)}))),!1),l(c),!1),(function(e){return e.id}))}}),[e,t,n,a])}(t,n,g,b),O=w.selectedPubs,C=w.availablePubs;return c.default.createElement(d.OrderPicker,{selectedItems:O,availableItems:C,onSelectedItems:function(e){return a(e.map((function(e){return e.id})))},selectedTitle:"Pinned Pubs",availableTitle:"Available Pubs",renderItem:function(e,t){return c.default.createElement(d.PubMenuItem,{title:e.title,id:e.id,contributors:e.attributions,onClick:t})},searchTerm:p,onSearch:h,searchPlaceholder:"Search for Pubs",onRequestMoreItems:_,scrollForMoreItems:!E,isRequestingMoreItems:P})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useManyPubs=void 0;var l=n(0),u=n(71),c=n(9),s=n(62),d=n(18),f=n(439),m=n(1040),p={field:"creationDate",direction:"DESC"};t.useManyPubs=function(e){var t=e.query,n=void 0===t?{}:t,h=e.pubOptions,b=void 0===h?{}:h,v=e.batchSize,y=void 0===v?50:v,g=e.isEager,_=void 0===g||g,E=e.initialPubs,P=void 0===E?[]:E,w=e.initiallyLoadedAllPubs,O=void 0!==w&&w,C=e.cacheQueries,S=void 0===C||C,D=(0,c.usePageContext)().communityData,k=o((0,l.useState)(b),1)[0],j=(0,u.useUpdate)(),M={term:n.term,scopedCollectionId:n.scopedCollectionId,ordering:n.ordering||p,isReleased:n.isReleased,submissionStatuses:n.submissionStatuses,relatedUserIds:n.relatedUserIds},N=(0,f.useLazyRef)((function(){return(0,s.indexByProperty)(P,"id")})),I=function(e){var t=e.term,n=void 0===t?"":t,r=e.scopedCollectionId,a=void 0===r?"":r,i=e.ordering,o=i.field,l=i.direction,u=e.isReleased,c=e.submissionStatuses,s=e.relatedUserIds;return JSON.stringify({submissionStatuses:c,term:n,scopedCollectionId:a,field:o,direction:l,isReleased:u,relatedUserIds:s})}(M),x=(0,f.useLazyRef)((function(){var e;return Object.keys(N.current).length>0||O?((e={})[I]=(0,m.getInitialPubsState)(M,N.current,O),e):{}})),T=(0,l.useCallback)((function(){return x.current[I]||m.initialQueryState}),[I,x]),A=(0,l.useCallback)((function(e){var t;x.current=r(r({},x.current),((t={})[I]=e,t)),j()}),[I,j,x]),R=function(){return a(void 0,void 0,void 0,(function(){var e,t,a,o,l,u,c,f,p,h,b,v,g;return i(this,(function(i){switch(i.label){case 0:return e=T(),t=e.isLoading,a=e.hasLoadedAllPubs,o=e.offset,t||a?[2]:(l=r(r(r({},M),n),{limit:y,offset:o,communityId:D.id}),u=(0,m.getStartLoadingPubsState)(e,y),A(u),[4,d.apiFetch.post("/api/pubs/many",{query:l,pubOptions:k,alreadyFetchedPubIds:Object.keys(N.current)})]);case 1:return c=i.sent(),f=c.loadedAllPubs,p=c.pubsById,h=c.pubIds,b=r(r({},N.current),p),v=h.map((function(e){return b[e]})),g=(0,s.indexByProperty)(v,"id"),N.current=b,A((0,m.getFinishedLoadingPubsState)(u,l,g,f)),[2]}}))}))};(0,u.useUpdateEffect)((function(){var e;S||(N.current={},x.current=((e={})[I]=m.initialQueryState,e))}),[S,I]),(0,l.useEffect)((function(){var e=T();_&&0===e.offset&&R()}),[_,I]);var B=T();return{currentQuery:{loadMorePubs:R,isLoading:B.isLoading,hasLoadedAllPubs:B.hasLoadedAllPubs,pubs:B.orderedPubs.pubsInOrder},allQueries:{isLoading:Object.values(x.current).some((function(e){return e.isLoading}))}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialPubsState=t.getFinishedLoadingPubsState=t.getStartLoadingPubsState=t.initialQueryState=void 0;var a=n(1041);t.initialQueryState={hasLoadedAllPubs:!1,isLoading:!1,offset:0,orderedPubs:{pubsInOrder:[],pubsById:{},orderingValuesByPubId:{}}};t.getStartLoadingPubsState=function(e,t){return r(r({},e),{isLoading:!0,offset:e.offset+t})};t.getFinishedLoadingPubsState=function(e,t,n,i){void 0===i&&(i=!1);var o=e.orderedPubs,l=t.ordering,u=t.scopedCollectionId,c=o||{},s=c.pubsById,d=void 0===s?{}:s,f=c.orderingValuesByPubId,m=void 0===f?{}:f,p=(0,a.getOrderingValuesByPubId)(n,l,u),h=r(r({},d),n),b=r(r({},m),p);return r(r({},e),{isLoading:!1,hasLoadedAllPubs:i,orderedPubs:{orderingValuesByPubId:b,pubsById:h,pubsInOrder:(0,a.getPubsInOrder)(h,b,l)}})};t.getInitialPubsState=function(e,n,a){return(0,t.getFinishedLoadingPubsState)(r(r({},t.initialQueryState),{offset:Object.keys(n).length}),e,n,a)}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.getPubsInOrder=t.getOrderingValuesByPubId=void 0;var a=n(99),i={collectionRank:function(e,t){var n;if(t){var r=null===(n=e.collectionPubs)||void 0===n?void 0:n.find((function(e){return e.id===t}));if(r)return r.rank}return""},creationDate:function(e){return e.createdAt},publishDate:function(e){var t;return(null===(t=(0,a.getPubPublishedDate)(e))||void 0===t?void 0:t.toString())||"a"},updatedDate:function(e){var t;return[null===(t=e.draft)||void 0===t?void 0:t.latestKeyAt,e.updatedAt].filter((function(e){return!!e})).reduce((function(e,t){return e>t?e:t}),"a")},submittedDate:function(e){var t;return(null===(t=e.submission)||void 0===t?void 0:t.submittedAt)||"a"},title:function(e){return e.title.toLowerCase()}};t.getOrderingValuesByPubId=function(e,t,n){var a={},o=i[t.field];return Object.entries(e).forEach((function(e){var t=r(e,2),i=t[0],l=t[1];a[i]=o(l,n)})),a};t.getPubsInOrder=function(e,t,n){var r=Object.values(e).sort((function(e,n){return t[e.id]>t[n.id]?1:-1}));return"DESC"===n.direction&&r.reverse(),r}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(5),f=n(6),m=c(n(273)),p=function(e,t){return{type:t,id:e.id,title:e.title}},h=function(e){return{type:e.type,id:e.id}},b=[{value:"center",label:"Center"},{value:"space-between",label:"Space Between"},{value:"space-around",label:"Space Around"},{value:"left",label:"Left"}];t.default=function(e){var t=e.layoutIndex,n=e.onChange,a=e.content,i=e.collections,o=e.pages,c=(0,s.useMemo)((function(){return function(e,t){return u(u([],l(e.map((function(e){return p(e,"collection")}))),!1),l(t.map((function(e){return p(e,"page")}))),!1).sort((function(e,t){return e.title>t.title?1:-1}))}(i,o)}),[i,o]),v=l((0,s.useMemo)((function(){return[a.items.map((function(e){return c.find((function(t){return e.id===t.id}))})).filter((function(e){return!!e})),c.filter((function(e){return!a.items.some((function(t){return t.id===e.id}))}))]}),[a.items,c]),2),y=v[0],g=v[1],_=(0,s.useCallback)((function(e){return n(t,r(r({},a),{title:e}))}),[n,t,a]),E=(0,s.useCallback)((function(e){return n(t,r(r({},a),{items:e.map(h)}))}),[n,t,a]),P=(0,s.useCallback)((function(e){return n(t,r(r({},a),{justify:e}))}),[n,t,a]);return s.default.createElement("div",{className:"layout-editor-pages-component"},s.default.createElement("div",{className:"block-header"},s.default.createElement(f.InputField,{label:"Title",value:a.title,onChange:function(e){return _(e.target.value)}}),s.default.createElement("div",{className:"dropdown-grouping"},s.default.createElement("div",{className:"dropdown"},s.default.createElement(d.FormGroup,{label:"Justify Content"},s.default.createElement(f.MenuSelect,{value:a.justify||"space-between",items:b,onSelectValue:P,"aria-label":"Choose Justify Content",buttonProps:{fill:!0}}))),s.default.createElement("div",{className:"dropdown"},s.default.createElement(d.FormGroup,{label:"Collections & Pages"},s.default.createElement(f.Popover,{"aria-label":"Choose pinned Pubs for this block",className:"order-picker-popover",placement:"bottom-end",content:s.default.createElement(f.OrderPicker,{availableItems:g,selectedItems:y,onSelectedItems:E,renderItem:function(e,t){return s.default.createElement(f.PubMenuItem,{title:e.title,id:e.id,onClick:t})}})},s.default.createElement(d.Button,{rightIcon:"caret-down",outlined:!0},"Choose Items",y.length?" ("+y.length+")":"")))))),s.default.createElement(m.default,{content:a,pages:o,collections:i}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(6),s=n(116),d=l(n(41));t.default=function(e){var t=e.onChange,n=e.content,r=e.layoutIndex,a=o((0,u.useState)(),2),i=a[0],l=a[1],f=(0,u.useRef)(null),m=(0,u.useCallback)((function(e){return t(r,{text:e.toJSON()})}),[r,t]);return u.default.createElement("div",{className:"layout-editor-text-component"},u.default.createElement("div",{className:"block-header"},u.default.createElement("div",{className:"formatting-wrapper"},u.default.createElement(s.FormattingBar,{editorChangeObject:i,buttons:s.buttons.layoutEditorButtonSet,controlsConfiguration:{isAbsolutelyPositioned:!0,container:f.current}}))),u.default.createElement("div",{className:"block-content",ref:f},u.default.createElement(c.GridWrapper,null,u.default.createElement(d.default,{placeholder:"Enter text...",initialContent:n.text,onChange:l,onEdit:m,debounceEditsMs:300}))))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.layoutEditorButtonSet=t.fullButtonSet=t.workflowButtonSet=t.inlineMenuButtonSet=t.discussionButtonSet=t.reviewButtonSet=t.abstractButtonSet=t.minimalButtonSet=t.simpleMedia=t.media=t.math=t.table=t.horizontalRule=t.footnote=t.reference=t.citation=t.strikethrough=t.superscript=t.subscript=t.code=t.heading2=t.heading1=t.blockquote=t.numberedList=t.bulletList=t.link=t.em=t.strong=t.rightToLeft=t.alignRight=t.alignCenter=t.alignLeft=void 0;var i=n(181),o=n(41),l=n(1045),u=a(n(1075)),c=n(268),s=n(267),d=function(e){var t=e.latestDomEvent;return"click"===(null==t?void 0:t.type)},f=function(e,t,n){var a=Array.isArray(t)?t:[t];return r({showCloseButton:!0,enterKeyTriggers:!0,captureFocusOnMount:!1,component:e,trigger:d,show:function(e){return!!e.selectedNode},indicate:function(e){var t=e.selectedNode;return!!t&&a.some((function(e){return e===t.type.name}))}},n)},m=function(e){var t=e.selectionInTable,n=e.selection;return t&&d(e)&&(n.empty||n.$anchorCell)};t.alignLeft={key:"align-left",title:"Align left",icon:"align-left",command:i.alignTextLeft},t.alignCenter={key:"align-center",title:"Align center",icon:"align-center",command:i.alignTextCenter},t.alignRight={key:"align-right",title:"Align right",icon:"align-right",command:i.alignTextRight},t.rightToLeft={key:"toggle-right-to-left",title:"RTL",icon:"rtl",command:i.rtlToggle},t.strong={key:"strong",title:"Bold",icon:"bold",isToggle:!0,command:i.strongToggle},t.em={key:"em",title:"Italic",icon:"italic",isToggle:!0,command:i.emToggle},t.link={key:"link",title:"Link",icon:"link",isToggle:!0,command:i.linkToggle,controls:{component:l.ControlsLink,indicate:function(e){return!!e.activeLink},trigger:function(e){var t=e.latestDomEvent;return t&&t.metaKey&&"k"===t.key||d(e)},show:function(e){return!!e.activeLink},floatingPosition:c.positionNearLink}},t.bulletList={key:"bullet-list",title:"Bullet List",icon:"list-ul",command:i.bulletListToggle},t.numberedList={key:"ordered-list",title:"Ordered List",icon:"list-ol",command:i.orderedListToggle},t.blockquote={key:"blockquote",title:"Blockquote",icon:"citation",command:i.blockquoteToggle},t.heading1={key:"heading1",title:"Heading 1",icon:"header-one",command:i.heading1Toggle},t.heading2={key:"heading2",title:"Heading 2",icon:"header-two",command:i.heading2Toggle},t.code={key:"code",title:"Code",icon:"code",isToggle:!0,command:i.codeToggle},t.subscript={key:"subscript",title:"Subscript",icon:"subscript",isToggle:!0,command:i.subscriptToggle},t.superscript={key:"superscript",title:"Superscript",icon:"superscript",isToggle:!0,command:i.superscriptToggle},t.strikethrough={key:"strikethrough",title:"Strikethrough",ariaTitle:"strike through",icon:"strikethrough",isToggle:!0,command:i.strikethroughToggle},t.citation={key:"citation",title:"Citation",icon:"bookmark",controls:f(l.ControlsFootnoteCitation,"citation"),insertNodeType:"citation"},t.reference={key:"reference",title:"Reference",icon:"at",insertNodeType:"reference",controls:f(l.ControlsReference,"reference",{floatingPosition:c.positionNearSelection,showCloseButton:!1}),isDisabled:function(e){if(e.view){var t=e.view.state,n=(0,o.getCurrentNodeLabels)(t);return!Object.values(n).some((function(e){return e.enabled}))}return!0},popover:{condition:s.FormattingBarButtonPopoverCondition.Disabled,component:l.ControlsReferencePopover}},t.footnote={key:"footnote",title:"Footnote",icon:"asterisk",insertNodeType:"footnote",controls:f(l.ControlsFootnoteCitation,"footnote")},t.horizontalRule={key:"horizontal_rule",title:"Horizontal Line",insertNodeType:"horizontal_rule",icon:"minus"},t.table={key:"table",title:"Table",icon:"th",insertNodeType:"table",controls:{captureFocusOnMount:!1,indicate:function(e){return e.selectionInTable},show:m,trigger:m,floatingPosition:c.positionNearSelection,component:l.ControlsTable}},t.math={key:"math",title:"Math",icon:"function",insertNodeType:"math_inline",controls:f(l.ControlsMath,["math_inline","math_display"],{floatingPosition:c.positionNearSelection,showCloseButton:!1})},t.media={key:"media",title:"Media",icon:"media",component:u.default,isMedia:!0,controls:f(l.ControlsMedia,["image","video","audio","iframe"])},t.simpleMedia={key:"media",title:"Media",icon:"media",component:u.default,isMedia:!0},t.minimalButtonSet=[[t.strong,t.em,t.link,t.rightToLeft,t.math]],t.abstractButtonSet=[[t.strong,t.em,t.link,t.rightToLeft,t.math]],t.reviewButtonSet=[[t.heading1,t.heading2,t.strong,t.em,t.link,t.rightToLeft,t.bulletList,t.numberedList,t.blockquote,t.code,t.subscript,t.superscript,t.strikethrough,t.horizontalRule,t.math]],t.discussionButtonSet=[[t.strong,t.em,t.link],[t.rightToLeft],[t.simpleMedia]],t.inlineMenuButtonSet=[[t.heading1,t.heading2,t.strong,t.em,t.link]],t.workflowButtonSet=[[t.heading1,t.heading2,t.strong,t.em,t.link],[t.rightToLeft],[t.simpleMedia]],t.fullButtonSet=[[t.alignLeft,t.alignCenter,t.alignRight],[t.rightToLeft],[t.strong,t.em,t.link,t.bulletList,t.numberedList,t.blockquote,t.code,t.subscript,t.superscript,t.strikethrough,t.horizontalRule,t.math,t.reference,t.citation,t.footnote,t.table],[t.media]],t.layoutEditorButtonSet=[[t.alignLeft,t.alignCenter,t.alignRight],[t.rightToLeft],[t.strong,t.em,t.link,t.bulletList,t.numberedList,t.blockquote,t.code,t.subscript,t.superscript,t.strikethrough,t.horizontalRule,t.math,t.citation,t.footnote,t.table],[t.media]]},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlsMath=t.ControlsTable=t.ControlsMedia=t.ControlsReferencePopover=t.ControlsReference=t.ControlsLink=t.ControlsFootnoteCitation=void 0;var a=n(1046);Object.defineProperty(t,"ControlsFootnoteCitation",{enumerable:!0,get:function(){return r(a).default}});var i=n(1065);Object.defineProperty(t,"ControlsLink",{enumerable:!0,get:function(){return r(i).default}});var o=n(446);Object.defineProperty(t,"ControlsReference",{enumerable:!0,get:function(){return r(o).default}}),Object.defineProperty(t,"ControlsReferencePopover",{enumerable:!0,get:function(){return o.ControlsReferencePopover}});var l=n(1067);Object.defineProperty(t,"ControlsMedia",{enumerable:!0,get:function(){return r(l).default}});var u=n(1073);Object.defineProperty(t,"ControlsTable",{enumerable:!0,get:function(){return r(u).default}});var c=n(1074);Object.defineProperty(t,"ControlsMath",{enumerable:!0,get:function(){return r(c).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1047);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(137),f=n(6),m=n(389),p=n(39),h=n(444),b=c(n(1064));n(445);t.default=function(e){var t=e.editorChangeObject,n=e.onClose,a=e.pendingAttrs,i=t.selectedNode,o=(0,p.usePubContext)().noteManager,c="footnote"===i.type.name,v=a.commitChanges,y=a.hasPendingChanges,g=a.updateAttrs,_=function(e,t){var n=e.structuredValue,a=e.unstructuredValue,i=e.value,o=l(e,["structuredValue","unstructuredValue","value"]);return r(r({},o),t?{unstructuredValue:i,structuredValue:n}:{structuredValue:i,unstructuredValue:a})}(a.attrs,c),E=_.structuredValue,P=_.unstructuredValue,w=_.customLabel,O=function(e,t){return function(n){var a=n.structuredValue,i=n.unstructuredValue,o=l(n,["structuredValue","unstructuredValue"]),u=r({},o);return"structuredValue"in n&&(u[t?"structuredValue":"value"]=a),"unstructuredValue"in n&&(u[t?"value":"unstructuredValue"]=i),e(u)}}(g,c),C=u((0,s.useState)(o.getRenderedValueSync(E)),2),S=C[0],D=C[1],k=u((0,d.useDebounce)(E,250),1)[0],j=null==S?void 0:S.html,M=j||P;(0,s.useEffect)((function(){o.getRenderedValue(k).then((function(e){return D(e)}))}),[k,o]);var N=s.default.createElement("div",{className:"section",key:"structured"},s.default.createElement("div",{className:"title"},"Structured Data"),s.default.createElement("textarea",{className:"structured-data",placeholder:"Enter bibtex, DOI, wikidata url, or bibjson...",value:E,onChange:function(e){return O({structuredValue:e.target.value})}})),I=s.default.createElement("div",{className:"section",key:"unstructured"},s.default.createElement("div",{className:"title"},"Rich Text"),s.default.createElement(f.SimpleEditor,{initialHtmlString:P,onChange:function(e){O({unstructuredValue:e})}})),x=c?[I,N]:[N,I];return s.default.createElement("div",{className:"controls-citation-component"},x,M&&s.default.createElement("div",{className:"section preview"},s.default.createElement("div",{className:"title"},"Preview"),s.default.createElement(f.PubNoteContent,{structured:j,unstructured:P}),!c&&function(){if(c)return null;var e=(0,m.getCitationInlineLabel)(r(r({},i),{attrs:r(r({},i.attrs),{citation:S,customLabel:w})}));return s.default.createElement(s.default.Fragment,null,s.default.createElement("div",{className:"title"},"Inline format"),s.default.createElement(b.default,{defaultLabel:e,customLabel:w,onUpdateCustomLabel:function(e){return O({customLabel:e})}}))}(),s.default.createElement(h.ControlsButtonGroup,null,s.default.createElement(h.ControlsButton,{disabled:!y,onClick:function(){v(),n()}},"Update ",i.type.name))))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.NoteManagerCore=void 0;var a=function(){function e(e,t,n,a){void 0===a&&(a={}),this.citationStyleKind=t,this.citationInlineStyleKind=n,this.notes=r({},a),this.callbacks=new Set,this.renderStructuredValues=e}return e.prototype.subscribe=function(e){var t=this;return this.callbacks.add(e),function(){t.callbacks.delete(e)}},e.prototype.getRenderedValueSync=function(e){return this.notes[e]||null},e.prototype.getRenderedValue=function(e){var t=this,n=this.getRenderedValueSync(e);return n?Promise.resolve(n):this.renderStructuredValues([e],this.citationStyleKind,this.citationInlineStyleKind).then((function(n){var r=n[e];return t.notes[e]=r,t.callbacks.forEach((function(e){return e(t.notes)})),r}))},e}();t.NoteManagerCore=a},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubSubmissionState=void 0;var o=n(0),l=n(41),u=n(218);t.usePubSubmissionState=function(e){var t,n=e.pubData,c=e.editorChangeObject,s=a((0,u.useIdlyUpdatedState)((function(){return!(t=(e=n).submission)||e.isRelease||e.isReview?null:{selectedTab:"incomplete"===t.status?"instructions":"preview",submission:t};var e,t})),2),d=s[0],f=s[1],m=null===(t=null==c?void 0:c.view)||void 0===t?void 0:t.state.doc,p="incomplete"===(null==d?void 0:d.submission.status)&&"preview"===(null==d?void 0:d.selectedTab)&&(null==d?void 0:d.submission.abstract),h=(0,o.useMemo)((function(){return p&&m?(e=m.toJSON(),t=p,(0,l.isEmptyDoc)(t)?e:r(r({},e),{content:i(i([{type:"heading",attrs:{level:1,id:"abstract"},content:[{type:"text",text:"Abstract"}]}],a(t.content),!1),a(e.content),!1)})):null;var e,t}),[m,p]);return[d?r(r({},d),{submissionPreviewDoc:h}):null,f]}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubCollabState=void 0;var a=n(0),i=n(275),o=n(9),l=n(1051),u=n(218),c=function(e,t){var n=(0,i.getRandomColor)(t.id);return{id:t.id,backgroundColor:"rgba("+n+", 0.2)",cursorColor:"rgba("+n+", 1.0)",image:t.avatar||null,name:t.fullName||"Anonymous",initials:t.initials||"?",canEdit:e}};t.usePubCollabState=function(e){var t=e.pubData,n=t.draft,i=t.firebaseToken,s=(0,o.usePageContext)(),d=s.loginData,f=s.scopeData.activePermissions,m=f.canEdit,p=f.canEditDraft,h=r((0,u.useIdlyUpdatedState)((function(){return{editorChangeObject:{},status:"connecting",localCollabUser:c(m||p,d),remoteCollabUsers:[],firebaseDraftRef:null}})),2),b=h[0],v=h[1],y=(0,a.useCallback)((function(e){var t=e.val();if(t){var n=Object.values(t).filter((function(e){return e.id!==d.id}));v({remoteCollabUsers:n})}}),[v,d]);return(0,a.useEffect)((function(){n&&i&&(0,l.initFirebase)(n.firebasePath,i).then((function(e){e&&(v({firebaseDraftRef:e}),null==e||e.child("cursors").on("value",y))}))}),[n,i,v,y]),[b,v]}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initFirebase=void 0;var o=i(n(1052));n(1056),n(1058);var l=n(1061);t.initFirebase=function(e,t){return r(void 0,void 0,void 0,(function(){var n,r,i,u,c,s;return a(this,(function(a){switch(a.label){case 0:n="App-"+e,r=o.default.apps.reduce((function(e,t){return t.name===n?t:e}),void 0),i=r||o.default.initializeApp((0,l.getFirebaseConfig)(),n),u=o.default.database(i),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,o.default.auth(i)];case 2:return[4,(c=a.sent()).signOut()];case 3:return a.sent(),[4,c.signInWithCustomToken(t)];case 4:return a.sent(),[2,u.ref(e)];case 5:return s=a.sent(),console.error("Error authenticating firebase",s),[2,null];case 6:return[2]}}))}))}},,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFirebaseConfig=void 0;var r=n(130);t.getFirebaseConfig=function(){return{apiKey:"AIzaSyCVBq7I9ddJpHhs-DzVEEdM09-VqTVex1g",authDomain:"pubpub-v6.firebaseapp.com",projectId:"pubpub-v6",storageBucket:"pubpub-v6.appspot.com",messagingSenderId:"503345633278",databaseURL:(0,r.isProd)()?"https://pubpub-v6-prod.firebaseio.com":"https://pubpub-v6-dev.firebaseio.com"}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubHistoryState=void 0;var o=n(0),l=i(n(435)),u=n(9),c=n(18),s=n(218);t.usePubHistoryState=function(e){var t=e.pubData,n=e.editorView,i=t.initialDoc,d=(0,u.usePageContext)().locationData.query.access,f=a((0,s.useIdlyUpdatedState)((function(){var e,n=t.historyData,a=n.currentKey!==n.latestKey,o=a?i:null;return r(r({},n),{timestamps:r((e={},e[-1]=new Date(t.createdAt).valueOf(),e),n.timestamps),outstandingRequests:0,latestKeyReceivedAt:null,isViewingHistory:a,loadedIntoHistory:a,historyDoc:o,latestHistoryDoc:o,historyDocEditorKey:"history-"+n.currentKey})})),2),m=f[0],p=f[1],h=t.id,b=m.isViewingHistory,v=m.currentKey,y=m.latestKey,g=(0,o.useCallback)((function(e){return p((function(t){var n;return{currentKey:e,latestKey:e,timestamps:r((n={},n[e]=Date.now(),n),t.timestamps)}}))}),[p]),_=(0,o.useCallback)((function(e){return p({currentKey:e})}),[p]),E=(0,o.useCallback)((function(e){if(e){var t=n?n.state.doc.toJSON():i;p({isViewingHistory:!0,latestHistoryDoc:t,historyDoc:t})}else p({isViewingHistory:!1})}),[p,n,i]);return(0,o.useEffect)((function(){b&&(v===y?p((function(e){return{historyDoc:e.latestHistoryDoc,historyDocEditorKey:"history-"+y}})):(p((function(e){return{outstandingRequests:e.outstandingRequests+1}})),function(e,t,n){return c.apiFetch.get("/api/pubHistory?"+l.default.stringify({pubId:e,historyKey:t,accessHash:n}))}(h,v,d).then((function(e){var t=e.doc,n=e.historyData.timestamps;p((function(e){var a={outstandingRequests:e.outstandingRequests-1};return e.currentKey===v?r(r({},a),{historyDoc:t,historyDocEditorKey:"history-"+v,timestamps:r(r({},e.timestamps),n)}):a}))}))))}),[b,v,y,d,h,p]),r(r({},m),{setCurrentHistoryKey:_,setLatestHistoryKey:g,setIsViewingHistory:E})}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubBodyState=void 0;var i=n(0),o=n(9);t.usePubBodyState=function(e){var t=e.pubData,n=t.initialDoc,l=t.initialDocKey,u=t.isInMaintenanceMode,c=t.isRelease,s=t.isReview,d=t.discussions,f=e.submissionState,m=e.historyData,p=m.currentKey,h=m.isViewingHistory,b=m.historyDoc,v=m.historyDocEditorKey,y=e.collabData.firebaseDraftRef,g=(0,o.usePageContext)().scopeData.activePermissions,_=g.canEdit,E=g.canEditDraft,P=(0,i.useMemo)((function(){return c?d.map((function(e){return e.anchors.filter((function(e){return e.historyKey===p}))})).reduce((function(e,t){return a(a([],r(e),!1),r(t),!1)}),[]):[]}),[d,c,p]);if(u)return{editorKey:"maintenance",isReadOnly:!0,initialContent:n,initialHistoryKey:l,includeCollabPlugin:!1,includeDiscussionsPlugin:!1,discussionAnchors:null,canCreateAnchoredDiscussions:!1};if(h&&b&&v)return{editorKey:v,isReadOnly:!0,initialContent:b,initialHistoryKey:l,includeCollabPlugin:!1,includeDiscussionsPlugin:!1,discussionAnchors:null,canCreateAnchoredDiscussions:!1};if(f){var w=null==f?void 0:f.submissionPreviewDoc;if(w)return{editorKey:"submission-preview-"+p,isReadOnly:!0,initialContent:w,initialHistoryKey:l,includeCollabPlugin:!1,includeDiscussionsPlugin:!1,discussionAnchors:P,canCreateAnchoredDiscussions:!1};if("instructions"===f.selectedTab)return{editorKey:"",hidePubBody:!0,isReadOnly:!0,includeCollabPlugin:!1,initialContent:n,initialHistoryKey:l,includeDiscussionsPlugin:!1,discussionAnchors:null,canCreateAnchoredDiscussions:!1}}return c?{editorKey:"release",isReadOnly:!0,initialHistoryKey:l,initialContent:n,includeCollabPlugin:!1,includeDiscussionsPlugin:!0,discussionAnchors:P,canCreateAnchoredDiscussions:!0}:s?{editorKey:"review",isReadOnly:!0,initialHistoryKey:l,initialContent:n,includeCollabPlugin:!1,includeDiscussionsPlugin:!1,discussionAnchors:null,canCreateAnchoredDiscussions:!1}:{editorKey:y?"ready":"unready",isReadOnly:!(_||E),initialContent:n,initialHistoryKey:l,includeCollabPlugin:!!y,includeDiscussionsPlugin:!0,discussionAnchors:P,canCreateAnchoredDiscussions:!0}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(57),s=n(39);t.default=function(e){var t=e.customLabel,n=e.defaultLabel,r=e.onUpdateCustomLabel,a=(0,s.usePubContext)().inPub,i=o((0,l.useState)(!!t),2),d=i[0],f=i[1],m=a?"Pub Default":"Default",p=d?"Custom":m;return l.default.createElement(u.ControlGroup,{className:"inline-label-editor-component"},l.default.createElement(c.MenuButton,{"aria-label":"Choose an inline label type",buttonProps:{minimal:!0,rightIcon:"chevron-down",className:"label-type-menu"},buttonContent:p},l.default.createElement(c.MenuItem,{text:m,onClick:function(){f(!1),r("")}}),l.default.createElement(c.MenuItem,{text:"Custom",onClick:function(){t||r(n),f(!0)}})),l.default.createElement(u.InputGroup,{disabled:!d,value:d?t:n,onChange:function(e){return r(e.target.value)}}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(137),c=n(41),s=n(5),d=n(39),f=n(35),m=n(9);t.default=function(e){var t=e.editorChangeObject,n=t.activeLink,r=t.view,a=e.onClose,i=(0,m.usePageContext)().communityData,p=(0,d.usePubContext)(),h=p.inPub,b=p.pubData,v=o((0,l.useState)(n.attrs.href),2),y=v[0],g=v[1],_=o((0,u.useDebounce)(y,250),1)[0],E=(0,l.useRef)();(0,l.useEffect)((function(){return n.updateAttrs({href:_})}),[_]),(0,l.useEffect)((function(){E.current&&"function"==typeof E.current.focus&&!y&&E.current.focus()}),[y]);var P=(0,l.useCallback)((function(){r.focus(),(0,c.moveToEndOfSelection)(r)}),[r]);return l.default.createElement("div",{className:"controls-link-component"},l.default.createElement(s.InputGroup,{placeholder:"Enter a URL",value:y,onChange:function(e){return function(e){if(h){var t=(0,f.pubUrl)(i,b),n=e.match("^"+t+"(.*)?#(.*)$");g(n?"#"+n[2]:e)}g(e)}(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(n.updateAttrs({href:y}),a(),setTimeout(P,0))},inputRef:E}),l.default.createElement(s.AnchorButton,{small:!0,minimal:!0,title:"Visit",icon:"share",href:y,target:"_blank"}),l.default.createElement(s.Button,{small:!0,minimal:!0,title:"Remove",icon:"disable",onClick:n.removeLink}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1068);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=o(n(3)),s=n(6),d=n(41),f=n(444),m=o(n(1069)),p=o(n(1070)),h=o(n(1071)),b=n(446);n(1072);t.default=function(e){var t,n,r=e.editorChangeObject,a=e.pendingAttrs,i=r.selectedNode,o=r.updateNode,v=a.hasPendingChanges,y=a.commitChanges,g=a.updateAttrs,_=a.attrs.altText,E=i.attrs,P=E.size,w=E.align,O=E.href,C=E.height,S=E.caption,D=E.url,k=E.fullResolution,j=E.hideLabel,M=!!(null===(t=i.type.spec.attrs)||void 0===t?void 0:t.altText),N=function(e){return"iframe"===e.type.name}(i),I=function(e){var t=e.type.name;return"iframe"===t?"item":t}(i),x=(0,d.getCurrentNodeLabels)(r.view.state),T=x&&(null===(n=x[i.type.name])||void 0===n?void 0:n.enabled),A=(0,d.isResizeableFormat)(D),R=(0,l.useCallback)((function(e){return o({hideLabel:e.target.checked})}),[o]),B=(0,l.useCallback)((function(e){return o({fullResolution:e.target.checked})}),[o]),F=function(){return l.default.createElement(f.ControlsButtonGroup,null,l.default.createElement(f.ControlsButton,{disabled:!v,onClick:y},"Update"))},L=function(){return l.default.createElement("div",{className:"section"},l.default.createElement(s.SimpleEditor,{placeholder:"Add a caption for this "+I,initialHtmlString:S,onChange:function(e){return g({caption:e})}}),F())};return l.default.createElement("div",{className:"controls-media-component"},l.default.createElement("div",{className:"section"},l.default.createElement(s.SliderInput,{min:1,max:100,leftLabel:"Width",rightLabel:"%","aria-label":"Figure width (percentage)",value:P,disabled:"full"===w,onChange:function(e){return o({size:e})}}),N&&l.default.createElement(s.SliderInput,{min:150,max:800,"aria-label":"Figure height (pixels)",leftLabel:"Height",rightLabel:"px",value:C,disabled:!1,onChange:function(e){return o({height:e})}}),l.default.createElement(m.default,{value:w,onChange:function(e){return o({align:e})}}),l.default.createElement(p.default,{onChange:function(e){return o({href:e})},value:O}),l.default.createElement(h.default,{selectedNode:i,updateNode:o}),l.default.createElement("div",{className:"controls-row"},A&&l.default.createElement(u.Checkbox,{onClick:B,alignIndicator:"right",label:"Always use full resolution",checked:k})),T&&l.default.createElement("div",{className:"controls-row"},l.default.createElement(u.Checkbox,{onClick:R,alignIndicator:"right",label:"Hide label",checked:j},!T&&l.default.createElement(l.default.Fragment,null," ","(",l.default.createElement(b.ControlsReferenceSettingsLink,{dark:!0,small:!0}),")")))),M?l.default.createElement(u.Tabs,{id:"media-controls-caption-alt",className:(0,c.default)(u.Classes.DARK,"caption-alt-tabs")},l.default.createElement(u.Tab,{id:"caption",title:"Caption",panel:L()}),l.default.createElement(u.Tab,{id:"alt",title:"Alt text",panel:l.default.createElement("div",{className:"section"},l.default.createElement("p",null,"Alt text provides information about an image's contents to screenreader users that may be too detailed to include in a caption. Avoid duplicating text between these fields. If an image is purely decorative, leave this field blank."),l.default.createElement("textarea",{placeholder:"Add alt text for this "+I,value:_,onChange:function(e){return g({altText:e.target.value})}}),F())})):L())}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(78),c=n(6),s=[{key:"left",icon:"align-left"},{key:"center",icon:"align-center"},{key:"right",icon:"align-right"},{key:"full",icon:"vertical-distribution"},{key:"breakout",icon:"fullscreen"}];t.default=function(e){var t=e.onChange,n=e.value,i=(0,u.useRadioState)();return o.default.createElement("div",{className:"controls-row"},o.default.createElement("div",{className:"left-label"},"Alignment"),o.default.createElement(u.RadioGroup,{className:"controls","aria-label":"Figure alignment",as:"div"},s.map((function(e){return o.default.createElement(u.Radio,r({},i,{"aria-label":e.key,title:e.key,key:e.key,checked:n===e.key,onClick:function(){return t(e.key)}}),(function(t){var i=t.ref,u=a(t,["ref"]);return o.default.createElement(l.Button,r({elementRef:i,icon:o.default.createElement(c.Icon,{icon:e.icon,iconSize:16}),minimal:!0,"aria-label":e.key,active:n===e.key},u))}))}))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5);t.default=function(e){var t=o((0,l.useState)(e.value),2),n=t[0],r=t[1];return l.default.createElement("div",{className:"controls-row"},l.default.createElement("div",{className:"left-label"},"Link to"),l.default.createElement(u.InputGroup,{fill:!0,value:n,onBlur:function(){return e.onChange(n)},placeholder:"https://example.com",onChange:function(e){return r(e.target.value)},onKeyPress:function(t){"Enter"===t.key&&e.onChange(n)}}),l.default.createElement(u.AnchorButton,{minimal:!0,title:"Visit",icon:"share",href:n,target:"_blank"}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=l(n(259)),d=n(6),f=n(98);t.default=function(e){var t=e.selectedNode,n=e.updateNode,r=t.attrs,a=o((0,u.useState)(!1),2),i=a[0],l=a[1],m=o((0,u.useState)(r.url),2),p=m[0],h=m[1],b=(0,u.useRef)(s.default.v4()),v="iframe"===t.type.name,y=function(e){var t=e.target.files;if(t.length>0){var r=o(t,1)[0];(0,f.s3Upload)(r,(function(){}),(function(e,t,r,a){l(!1),n({url:"https://assets.pubpub.org/"+a})})),l(!0)}};return u.default.createElement("div",{className:"controls-row"},u.default.createElement("div",{className:"left-label"},"Source"),u.default.createElement("div",{className:"controls"},!v&&u.default.createElement(c.AnchorButton,{"aria-label":"Download source file",icon:u.default.createElement(d.Icon,{icon:"download",iconSize:16}),minimal:!0,href:r.url,target:"_blank",rel:"noopener noreferrer"}),v?u.default.createElement(c.InputGroup,{value:p,onChange:function(e){return h(e.target.value)},onBlur:function(){return n({url:p})},placeholder:"Enter URL..."}):u.default.createElement("label",{htmlFor:b.current,className:"file-select"},u.default.createElement(c.AnchorButton,{icon:u.default.createElement(d.Icon,{icon:"edit2",iconSize:16}),minimal:!0,loading:i,"aria-label":"Upload new source file"}),u.default.createElement("input",{id:b.current,style:{display:"none"},name:"image",type:"file",accept:"image/png, image/jpeg, image/gif, image/svg+xml",onChange:y,className:"file-input"}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(78),d=n(5),f=n(181),m=u(n(423)),p=[{key:"table-add-row-before",title:"Add row before",icon:"add-row-top",command:f.tableAddRowBefore},{key:"table-add-row-after",title:"Add row after",icon:"add-row-bottom",command:f.tableAddRowAfter},{key:"table-toggle-header-row",title:"Toggle header row",icon:"page-layout",command:f.tableToggleHeaderRow},{key:"table-delete-row",title:"Delete row",icon:"disable",command:f.tableDeleteRow}],h=[{key:"table-add-column-before",title:"Add column before",icon:"add-column-left",command:f.tableAddColumnBefore},{key:"table-add-column-after",title:"Add column after",icon:"add-column-right",command:f.tableAddColumnAfter},{key:"table-toggle-header-column",title:"Toggle header column",icon:"page-layout",command:f.tableToggleHeaderColumn},{key:"table-delete-column",title:"Delete column",icon:"disable",command:f.tableDeleteColumn}],b=[{key:"table-merge-cells",title:"Merge cells",icon:"merge-columns",command:f.tableMergeCells},{key:"table-split-cell",title:"Split cell",icon:"split-columns",command:f.tableSplitCell},{key:"toggle-header-cell",title:"Toggle header cells",icon:"header",command:f.tableToggleHeaderCell},{key:"table-toggle-label",title:"Toggle label",icon:"tag",command:f.tableToggleLabel},{key:"table-delete",title:"Remove table",icon:"trash",command:f.tableDelete}];t.default=function(e){var t=e.editorChangeObject,n=e.onClose,a=t.view,i=(0,s.useToolbarState)({loop:!0});return(0,c.useEffect)((function(){return a?(a.dom.addEventListener("keydown",n),function(){return a.dom.removeEventListener("keydown",n)}):function(){}}),[a,n]),c.default.createElement(s.Toolbar,r({},i,{className:"controls-table-component","aria-label":"Table options"}),c.default.createElement(s.ToolbarItem,r({"aria-label":"Table options",as:m.default,disclosure:function(e,t){var n=t.ref,a=l(t,["ref"]);return c.default.createElement(d.Button,r({minimal:!0,rightIcon:"caret-down",elementRef:n,icon:"th"},a))},commands:[p,h,b],editorChangeObject:t,markActiveItems:!1},i)))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(116),o=n(181);n(445);t.default=function(e){var t=e.editorChangeObject,n=t.selectedNode,r="math_display"===n.type.name?"inline":"display",l="math_display"===(null==n?void 0:n.type.name),u=l&&n.attrs.hideLabel?{icon:"eye-open",label:"Show"}:{icon:"eye-off",label:"Hide"},c={key:"change-math-node-type",title:"Change display position",label:"Make "+r,icon:"swap-horizontal",command:o.mathToggleKind},s={key:"toggle-math-display-label",title:"Toggle label",label:u.label+" label",icon:u.icon,command:o.mathToggleLabel},d=[[c]];return l&&d.push([s]),a.default.createElement(i.FormattingBar,{editorChangeObject:t,buttons:d,showBlockTypes:!1})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(6),f=c(n(425)),m=c(n(1076)),p=n(41),h=s.default.forwardRef((function(e,t){var n=e.view,a=e.isSmall,i=e.onClick,o=e.isIndicated,c=e.isOpen,h=l(e,["view","isSmall","onClick","isIndicated","isOpen"]),b=u((0,s.useState)(!1),2),v=b[0],y=b[1];return s.default.createElement(s.default.Fragment,null,s.default.createElement(d.Overlay,{isOpen:v,onClose:function(){return y(!1)},maxWidth:750},s.default.createElement(m.default,{onInsert:function(e,t){(0,p.insertNodeIntoEditor)(n,e,t),y(!1)},isSmall:Boolean(a)})),s.default.createElement(f.default,r({},h,{ref:t,isIndicated:o,isOpen:c,isSmall:a,label:"Media",onClick:o||c?i:function(){return y(!0)}})))}));t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=n(6),m=c(n(1077)),p=c(n(1078)),h=c(n(1079)),b=c(n(1080)),v=c(n(1082)),y=c(n(1083)),g=c(n(1084)),_=c(n(1085)),E=c(n(1086)),P=c(n(1087)),w=c(n(1088));n(1089);var O=[{text:"Image",icon:"media"},{text:"Video",icon:"video"},{text:"Audio",icon:"volume-up"},{text:"Other",icon:"document"}],C=[{text:"Iframe",icon:"application"},{text:"YouTube",icon:"youtube"},{text:"Twitter",icon:"twitter"},{text:"Codepen",icon:"codepen"},{text:"Vimeo",icon:"vimeo"},{text:"SoundCloud",icon:"soundcloud"},{text:"GitHub Gist",icon:"github"}],S=function(e){function t(t){var n=e.call(this,t)||this;return n.state={activeItem:"Image"},n}return a(t,e),t.prototype.render=function(){var e=this,t=this.state.activeItem,n={onInsert:this.props.onInsert,isSmall:this.props.isSmall};return s.default.createElement("div",{className:"formatting-bar_media-component"},s.default.createElement("div",{className:"options"},s.default.createElement(d.Menu,null,s.default.createElement("li",{className:"bp3-menu-header"},s.default.createElement("h6",null,"Files")),O.map((function(n){return s.default.createElement(d.MenuItem,{key:n.text,text:n.text,icon:s.default.createElement(f.Icon,{icon:n.icon,iconSize:30,useColor:!0}),active:t===n.text,onClick:function(){e.setState({activeItem:n.text})}})})),s.default.createElement("li",{className:"bp3-menu-header"},s.default.createElement("h6",null,"Apps")),C.map((function(n){return s.default.createElement(d.MenuItem,{key:n.text,text:n.text,icon:s.default.createElement(f.Icon,{icon:n.icon,iconSize:30,useColor:!0}),active:t===n.text,onClick:function(){e.setState({activeItem:n.text})}})})))),"Image"===t&&s.default.createElement(m.default,i({},n)),"Video"===t&&s.default.createElement(p.default,i({},n)),"Audio"===t&&s.default.createElement(h.default,i({},n)),"Other"===t&&s.default.createElement(b.default,i({},n)),"Iframe"===t&&s.default.createElement(v.default,i({},n)),"YouTube"===t&&s.default.createElement(y.default,i({},n)),"Twitter"===t&&s.default.createElement(w.default,i({},n)),"Codepen"===t&&s.default.createElement(g.default,i({},n)),"Vimeo"===t&&s.default.createElement(_.default,i({},n)),"SoundCloud"===t&&s.default.createElement(E.default,i({},n)),"GitHub Gist"===t&&s.default.createElement(P.default,i({},n)))},t}(s.Component);t.default=S},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=c(n(185)),m=c(n(58)),p=n(98),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isUploading:!1,progress:0},n.onDrop=n.onDrop.bind(n),n.onUploadFinish=n.onUploadFinish.bind(n),n.onUploadProgress=n.onUploadProgress.bind(n),n}return a(t,e),t.prototype.onDrop=function(e){e.length&&((0,p.s3Upload)(e[0],this.onUploadProgress,this.onUploadFinish,0),this.setState({isUploading:!0}))},t.prototype.onUploadProgress=function(e){this.setState({progress:e.loaded/e.total})},t.prototype.onUploadFinish=function(e,t,n,r){this.props.onInsert("image",{url:"https://assets.pubpub.org/"+r,align:this.props.isSmall?"full":void 0})},t.prototype.render=function(){var e=this;return s.default.createElement(f.default,{onDrop:this.onDrop,accept:"image/png, image/jpeg, image/gif, image/webp, image/svg+xml"},(function(t){var n=t.getRootProps,r=t.getInputProps,a=t.isDragActive;return s.default.createElement("div",i({},n(),{className:"formatting-bar_media-component-content dropzone "+(a?"dropzone--isActive":"")}),s.default.createElement("input",i({},r())),!e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(m.default,{icon:"circle-arrow-up",iconSize:50}),s.default.createElement("div",{className:"drag-title"},"Drag & drop to upload an Image"),s.default.createElement("div",{className:"drag-details"},"Or click to browse files"),s.default.createElement("div",{className:"drag-details"},".jpeg, .png, .svg, .webp, or .gif")),e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(d.Spinner,{value:1===e.state.progress?null:e.state.progress})))}))},t}(s.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=c(n(185)),m=c(n(58)),p=n(98),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isUploading:!1,progress:0},n.onDrop=n.onDrop.bind(n),n.onUploadFinish=n.onUploadFinish.bind(n),n.onUploadProgress=n.onUploadProgress.bind(n),n}return a(t,e),t.prototype.onDrop=function(e){e.length&&((0,p.s3Upload)(e[0],this.onUploadProgress,this.onUploadFinish,0),this.setState({isUploading:!0}))},t.prototype.onUploadProgress=function(e){this.setState({progress:e.loaded/e.total})},t.prototype.onUploadFinish=function(e,t,n,r){this.props.onInsert("video",{url:"https://assets.pubpub.org/"+r,align:this.props.isSmall?"full":void 0})},t.prototype.render=function(){var e=this;return s.default.createElement(f.default,{onDrop:this.onDrop,accept:"video/mp4, video/webm"},(function(t){var n=t.getRootProps,r=t.getInputProps,a=t.isDragActive;return s.default.createElement("div",i({},n(),{className:"formatting-bar_media-component-content dropzone "+(a?"dropzone--isActive":"")}),s.default.createElement("input",i({},r())),!e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(m.default,{icon:"circle-arrow-up",iconSize:50}),s.default.createElement("div",{className:"drag-title"},"Drag & drop to upload a Video"),s.default.createElement("div",{className:"drag-details"},"Or click to browse files"),s.default.createElement("div",{className:"drag-details"},".mp4 or .webm")),e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(d.Spinner,{value:1===e.state.progress?null:e.state.progress})))}))},t}(s.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=c(n(185)),m=c(n(58)),p=n(98),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isUploading:!1,progress:0},n.onDrop=n.onDrop.bind(n),n.onUploadFinish=n.onUploadFinish.bind(n),n.onUploadProgress=n.onUploadProgress.bind(n),n}return a(t,e),t.prototype.onDrop=function(e){e.length&&((0,p.s3Upload)(e[0],this.onUploadProgress,this.onUploadFinish,0),this.setState({isUploading:!0}))},t.prototype.onUploadProgress=function(e){this.setState({progress:e.loaded/e.total})},t.prototype.onUploadFinish=function(e,t,n,r){this.props.onInsert("audio",{url:"https://assets.pubpub.org/"+r,align:this.props.isSmall?"full":void 0})},t.prototype.render=function(){var e=this;return s.default.createElement(f.default,{onDrop:this.onDrop,accept:"audio/mpeg, audio/ogg, audio/wav, audio/x-wav"},(function(t){var n=t.getRootProps,r=t.getInputProps,a=t.isDragActive;return s.default.createElement("div",i({},n(),{className:"formatting-bar_media-component-content dropzone "+(a?"dropzone--isActive":"")}),s.default.createElement("input",i({},r())),!e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(m.default,{icon:"circle-arrow-up",iconSize:50}),s.default.createElement("div",{className:"drag-title"},"Drag & drop to upload Audio"),s.default.createElement("div",{className:"drag-details"},"Or click to browse files"),s.default.createElement("div",{className:"drag-details"},".mp3, .wav, or .ogg")),e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(d.Spinner,{value:1===e.state.progress?null:e.state.progress})))}))},t}(s.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=c(n(185)),m=c(n(1081)),p=c(n(58)),h=n(98),b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isUploading:!1,progress:0,loadingFileName:"",loadingFileSize:""},n.onDrop=n.onDrop.bind(n),n.onUploadFinish=n.onUploadFinish.bind(n),n.onUploadProgress=n.onUploadProgress.bind(n),n}return a(t,e),t.prototype.onDrop=function(e){e.length&&((0,h.s3Upload)(e[0],this.onUploadProgress,this.onUploadFinish,0),this.setState({isUploading:!0,loadingFileName:e[0].name,loadingFileSize:(0,m.default)(e[0].size,{round:0})}))},t.prototype.onUploadProgress=function(e){this.setState({progress:e.loaded/e.total})},t.prototype.onUploadFinish=function(e,t,n,r){this.props.onInsert("file",{url:"https://assets.pubpub.org/"+r,fileName:this.state.loadingFileName,fileSize:this.state.loadingFileSize})},t.prototype.render=function(){var e=this;return s.default.createElement(f.default,{onDrop:this.onDrop},(function(t){var n=t.getRootProps,r=t.getInputProps,a=t.isDragActive;return s.default.createElement("div",i({},n(),{className:"formatting-bar_media-component-content dropzone "+(a?"dropzone--isActive":"")}),s.default.createElement("input",i({},r())),!e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(p.default,{icon:"circle-arrow-up",iconSize:50}),s.default.createElement("div",{className:"drag-title"},"Drag & drop to upload a File"),s.default.createElement("div",{className:"drag-details"},"Or click to browse files")),e.state.isUploading&&s.default.createElement("div",{className:"drag-message"},s.default.createElement(d.Spinner,{value:e.state.progress})))}))},t}(s.Component);t.default=b},,function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var u=l(n(0)),c=n(5),s=n(134),d=n(135),f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={url:""},n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:this.state.url,align:this.props.isSmall?"full":void 0})},t.prototype.render=function(){var e=this,t=(0,s.isHttpsUri)(this.state.url);return u.default.createElement("div",{className:"formatting-bar_media-component-content"},u.default.createElement(c.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter URL",value:this.state.url,large:!0,onChange:function(t){var n=t.target.value;e.setState({url:(0,d.getIframeSrc)(n)||n})},rightElement:u.default.createElement(c.Button,{text:"Insert",intent:c.Intent.PRIMARY,disabled:!t,large:!0,onClick:this.handleInsert})}),t&&u.default.createElement("div",{className:"preview-wrapper"},u.default.createElement("iframe",{frameBorder:"none",src:this.state.url,title:"URL preview"})),!t&&u.default.createElement("div",{className:"preview-wrapper"},u.default.createElement(c.NonIdealState,{title:"Enter an HTTPS URL above",icon:"application"})))},t}(u.Component);t.default=f},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(134),f=u(n(58)),m=n(18),p=n(135),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isValid:!1,input:"",embedUrl:"",embedTitle:""},n.handleInput=n.handleInput.bind(n),n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInput=function(e){var t=this,n=(0,p.getIframeSrc)(e)||e,r=(0,d.isHttpsUri)(n)&&"youtube"===(0,p.getEmbedType)(n);this.setState({input:n,isValid:r},(function(){if(!t.state.isValid)return t.setState({embedUrl:"",embedTitle:""});var e="?type="+(0,p.getEmbedType)(n)+"&input="+n;return(0,m.apiFetch)("/api/editor/embed"+e).then((function(e){t.setState({embedUrl:(0,p.getIframeSrc)(e.html),embedTitle:e.title})}))}))},t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:this.state.embedUrl,caption:this.state.embedTitle,align:"full"})},t.prototype.render=function(){var e=this;return c.default.createElement("div",{className:"formatting-bar_media-component-content"},c.default.createElement(s.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter YouTube URL",large:!0,value:this.state.input,onChange:function(t){e.handleInput(t.target.value)},rightElement:c.default.createElement(s.Button,{text:"Insert",intent:s.Intent.PRIMARY,disabled:!this.state.embedUrl,large:!0,onClick:this.handleInsert})}),this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement("iframe",{frameBorder:"none",src:this.state.embedUrl,title:"URL preview"})),!this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement(s.NonIdealState,{title:"Paste a YouTube URL above",icon:c.default.createElement(f.default,{icon:"youtube",iconSize:60,useColor:!0}),action:c.default.createElement(s.Button,{text:"Load Sample URL",onClick:function(){e.handleInput("https://www.youtube.com/watch?v=k5Q6-hh49mU")}})})))},t}(c.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(134),f=u(n(58)),m=n(18),p=n(135),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isValid:!1,input:"",embedUrl:"",embedTitle:""},n.handleInput=n.handleInput.bind(n),n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInput=function(e){var t=this,n=(0,p.getIframeSrc)(e)||e,r=(0,d.isHttpsUri)(n)&&"codepen"===(0,p.getEmbedType)(n);this.setState({input:n,isValid:r},(function(){if(!t.state.isValid)return t.setState({embedUrl:"",embedTitle:""});var e="?type="+(0,p.getEmbedType)(n)+"&input="+n;return(0,m.apiFetch)("/api/editor/embed"+e).then((function(e){t.setState({embedUrl:(0,p.getIframeSrc)(e.html),embedTitle:e.title})}))}))},t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:this.state.embedUrl,caption:this.state.embedTitle,align:"full"})},t.prototype.render=function(){var e=this;return c.default.createElement("div",{className:"formatting-bar_media-component-content"},c.default.createElement(s.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter Codepen URL",large:!0,value:this.state.input,onChange:function(t){e.handleInput(t.target.value)},rightElement:c.default.createElement(s.Button,{text:"Insert",intent:s.Intent.PRIMARY,disabled:!this.state.embedUrl,large:!0,onClick:this.handleInsert})}),this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement("iframe",{frameBorder:"none",src:this.state.embedUrl,title:"URL preview"})),!this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement(s.NonIdealState,{title:"Paste a Codepen URL above",icon:c.default.createElement(f.default,{icon:"codepen",iconSize:60,useColor:!0}),action:c.default.createElement(s.Button,{text:"Load Sample URL",onClick:function(){e.handleInput("https://codepen.io/juliangarnier/pen/idhuG")}})})))},t}(c.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(134),f=u(n(58)),m=n(18),p=n(135),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isValid:!1,input:"",embedUrl:"",embedTitle:""},n.handleInput=n.handleInput.bind(n),n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInput=function(e){var t=this,n=(0,p.getIframeSrc)(e)||e,r=(0,d.isHttpsUri)(n)&&"vimeo"===(0,p.getEmbedType)(n);this.setState({input:n,isValid:r},(function(){if(!t.state.isValid)return t.setState({embedUrl:"",embedTitle:""});var e="?type="+(0,p.getEmbedType)(n)+"&input="+n;return(0,m.apiFetch)("/api/editor/embed"+e).then((function(e){t.setState({embedUrl:(0,p.getIframeSrc)(e.html),embedTitle:e.title})}))}))},t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:this.state.embedUrl,caption:this.state.embedTitle,align:"full"})},t.prototype.render=function(){var e=this;return c.default.createElement("div",{className:"formatting-bar_media-component-content"},c.default.createElement(s.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter Vimeo URL",large:!0,value:this.state.input,onChange:function(t){e.handleInput(t.target.value)},rightElement:c.default.createElement(s.Button,{text:"Insert",intent:s.Intent.PRIMARY,disabled:!this.state.embedUrl,large:!0,onClick:this.handleInsert})}),this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement("iframe",{frameBorder:"none",src:this.state.embedUrl,title:"URL preview"})),!this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement(s.NonIdealState,{title:"Paste a Vimeo URL above",icon:c.default.createElement(f.default,{icon:"vimeo",iconSize:60,useColor:!0}),action:c.default.createElement(s.Button,{text:"Load Sample URL",onClick:function(){e.handleInput("https://vimeo.com/146022717")}})})))},t}(c.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(134),f=u(n(58)),m=n(18),p=n(135),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isValid:!1,input:"",embedUrl:"",embedTitle:""},n.handleInput=n.handleInput.bind(n),n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInput=function(e){var t=this,n=(0,p.getIframeSrc)(e)||e,r=(0,d.isHttpsUri)(n)&&"soundcloud"===(0,p.getEmbedType)(n);this.setState({input:n,isValid:r},(function(){if(!t.state.isValid)return t.setState({embedUrl:"",embedTitle:""});var e="?type="+(0,p.getEmbedType)(n)+"&input="+n;return(0,m.apiFetch)("/api/editor/embed"+e).then((function(e){t.setState({embedUrl:(0,p.getIframeSrc)(e.html),embedTitle:e.title})}))}))},t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:this.state.embedUrl,caption:this.state.embedTitle,align:"full",height:150})},t.prototype.render=function(){var e=this;return c.default.createElement("div",{className:"formatting-bar_media-component-content"},c.default.createElement(s.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter SoundCloud URL",large:!0,value:this.state.input,onChange:function(t){e.handleInput(t.target.value)},rightElement:c.default.createElement(s.Button,{text:"Insert",intent:s.Intent.PRIMARY,disabled:!this.state.embedUrl,large:!0,onClick:this.handleInsert})}),this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement("iframe",{frameBorder:"none",src:this.state.embedUrl,title:"URL preview",className:"short"})),!this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement(s.NonIdealState,{title:"Paste a SoundCloud URL above",icon:c.default.createElement(f.default,{icon:"soundcloud",iconSize:60,useColor:!0}),action:c.default.createElement(s.Button,{text:"Load Sample URL",onClick:function(){e.handleInput("https://soundcloud.com/romainroux/charlotte-dada-dont-let-me-down-ghana-1971")}})})))},t}(c.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(134),f=u(n(58)),m=n(18),p=n(135),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isValid:!1,input:"",embedUrl:"",embedTitle:""},n.handleInput=n.handleInput.bind(n),n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInput=function(e){var t=this,n=(0,p.getIframeSrc)(e)||e,r=(0,d.isHttpsUri)(n)&&"github"===(0,p.getEmbedType)(n);this.setState({input:n,isValid:r},(function(){if(!t.state.isValid)return t.setState({embedUrl:"",embedTitle:""});var e="?type="+(0,p.getEmbedType)(n)+"&input="+n;return(0,m.apiFetch)("/api/editor/embed"+e).then((function(e){t.setState({embedUrl:"data:text/html;charset=utf-8,"+e.html,embedTitle:e.title})}))}))},t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:this.state.embedUrl,caption:this.state.embedTitle,align:"full",height:800})},t.prototype.render=function(){var e=this;return c.default.createElement("div",{className:"formatting-bar_media-component-content"},c.default.createElement(s.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter GitHub Gist URL",large:!0,value:this.state.input,onChange:function(t){e.handleInput(t.target.value)},rightElement:c.default.createElement(s.Button,{text:"Insert",intent:s.Intent.PRIMARY,disabled:!this.state.embedUrl,large:!0,onClick:this.handleInsert})}),this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement("iframe",{frameBorder:"none",src:this.state.embedUrl,title:"URL preview"})),!this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement(s.NonIdealState,{title:"Paste a GitHub Gist URL above",icon:c.default.createElement(f.default,{icon:"github",iconSize:60,useColor:!0}),action:c.default.createElement(s.Button,{text:"Load Sample URL",onClick:function(){e.handleInput("https://gist.github.com/gabestein/16fd6244f88625c0ea02e044a22d4ac5")}})})))},t}(c.Component);t.default=h},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(134),f=u(n(58)),m=n(18),p=n(135),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isValid:!1,input:"",embedUrl:"",embedTitle:""},n.handleInput=n.handleInput.bind(n),n.handleInsert=n.handleInsert.bind(n),n}return a(t,e),t.prototype.handleInput=function(e){var t=this,n=e,r=(0,d.isHttpsUri)(n)&&"twitter"===(0,p.getEmbedType)(n);if(this.setState({input:n,isValid:r}),r){var a="?type="+(0,p.getEmbedType)(n)+"&input="+n;(0,m.apiFetch)("/api/editor/embed"+a).then((function(e){t.setState({embedUrl:e.html,embedTitle:e.title})}))}else this.setState({embedUrl:"",embedTitle:""})},t.prototype.handleInsert=function(){this.props.onInsert("iframe",{url:"data:text/html;charset=utf-8,"+encodeURIComponent(this.state.embedUrl),caption:this.state.embedTitle,align:"full"})},t.prototype.render=function(){var e=this;return c.default.createElement("div",{className:"formatting-bar_media-component-content"},c.default.createElement(s.InputGroup,{className:"top-input",fill:!0,placeholder:"Enter Twitter URL",large:!0,value:this.state.input,onChange:function(t){e.handleInput(t.target.value)},rightElement:c.default.createElement(s.Button,{text:"Insert",intent:s.Intent.PRIMARY,disabled:!this.state.embedUrl,large:!0,onClick:this.handleInsert})}),this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement("iframe",{frameBorder:"none",src:"data:text/html;charset=utf-8,"+encodeURIComponent(this.state.embedUrl),title:"URL preview"})),!this.state.isValid&&c.default.createElement("div",{className:"preview-wrapper"},c.default.createElement(s.NonIdealState,{title:"Paste a Twitter URL above. You can embed a tweet, profile, list, collection, or likes timeline.",icon:c.default.createElement(f.default,{icon:"twitter",iconSize:60,useColor:!0}),action:c.default.createElement(s.Button,{text:"Load Sample URL",onClick:function(){e.handleInput("https://twitter.com/pubpub")}})})))},t}(c.Component);t.default=h},function(e,t,n){},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0)),s=n(6),d=function(e){function t(t){var n=e.call(this,t)||this;return n.setText=n.setText.bind(n),n}return a(t,e),t.prototype.setText=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{html:e.target.value}))},t.prototype.render=function(){return c.default.createElement("div",{className:"layout-editor-html-component"},c.default.createElement("div",{className:"block-header"}),c.default.createElement("div",{className:"block-content"},c.default.createElement(s.GridWrapper,null,c.default.createElement("textarea",{value:this.props.content.html,onChange:this.setText,placeholder:"Type HTML here..."}))))},t}(c.Component);t.default=d},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=u(n(0)),m=d(n(80)),p=n(5),h=d(n(344)),b=d(n(215)),v=d(n(270)),y=d(n(345)),g=n(88),_=n(272);n(1092);var E=function(e){function t(t){var n=e.call(this,t)||this;return n.setAlign=n.setAlign.bind(n),n.setBackgroundSize=n.setBackgroundSize.bind(n),n.setBackgroundHeight=n.setBackgroundHeight.bind(n),n.setBackgroundColor=n.setBackgroundColor.bind(n),n.setBackgroundImage=n.setBackgroundImage.bind(n),n.setDefaultCollectionIds=n.setDefaultCollectionIds.bind(n),n.setText=n.setText.bind(n),n.setShowButton=n.setShowButton.bind(n),n.setButtonType=n.setButtonType.bind(n),n.setButtonText=n.setButtonText.bind(n),n.setButtonUrl=n.setButtonUrl.bind(n),n}return a(t,e),t.prototype.setAlign=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{align:e}))},t.prototype.setBackgroundSize=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{backgroundSize:e}))},t.prototype.setBackgroundHeight=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{backgroundHeight:e}))},t.prototype.setBackgroundColor=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{backgroundColor:e.hex}))},t.prototype.setBackgroundImage=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{backgroundImage:e}))},t.prototype.setText=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{text:e.target.value}))},t.prototype.setShowButton=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{showButton:e.target.checked}))},t.prototype.setButtonType=function(e){var t=e.target.value;return this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{showButton:"none"!==t,buttonType:t}))},t.prototype.setButtonText=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{buttonText:e.target.value}))},t.prototype.setButtonUrl=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{buttonUrl:e.target.value}))},t.prototype.setDefaultCollectionIds=function(e){this.props.onChange(this.props.layoutIndex,i(i({},this.props.content),{defaultCollectionIds:e}))},t.prototype.render=function(){var e=this,t=this.props.content.backgroundImage?'url("'+(0,g.getResizedUrl)(this.props.content.backgroundImage,"inside",1500,600)+'")':void 0,n={textAlign:this.props.content.align||"left"},r={color:this.props.content.backgroundImage||!(0,m.default)(this.props.content.backgroundColor).isLight()?"#FFFFFF":"#000000",lineHeight:"1em",fontSize:"narrow"===this.props.content.backgroundHeight?"18px":"28px"},a={backgroundColor:this.props.content.backgroundColor,backgroundImage:t,textShadow:this.props.content.backgroundImage?"0 0 2px #000":"",minHeight:"narrow"===this.props.content.backgroundHeight?"60px":"200px",display:"flex",alignItems:"center",maxWidth:"none"},i=this.props.content.buttonType||this.props.content.showButton&&"create-pub",o=(0,_.getButtonText)(i,this.props.content.buttonText);return f.default.createElement("div",{className:"layout-editor-banner-component"},f.default.createElement("div",{className:"block-header"},f.default.createElement(b.default,{label:"Text",value:this.props.content.text,onChange:this.setText}),f.default.createElement(b.default,{label:"Color"},f.default.createElement(y.default,{value:this.props.content.backgroundColor,onChange:this.setBackgroundColor})),f.default.createElement(b.default,{label:"Align"},f.default.createElement(p.ButtonGroup,null,f.default.createElement(p.Button,{active:"left"===this.props.content.align,onClick:function(){e.setAlign("left")},text:"Left"}),f.default.createElement(p.Button,{active:"center"===this.props.content.align,onClick:function(){e.setAlign("center")},text:"Center"}))),f.default.createElement(b.default,{label:"Size"},f.default.createElement(p.ButtonGroup,null,f.default.createElement(p.Button,{active:"full"===this.props.content.backgroundSize,onClick:function(){e.setBackgroundSize("full")},text:"Full"}),f.default.createElement(p.Button,{active:"standard"===this.props.content.backgroundSize,onClick:function(){e.setBackgroundSize("standard")},text:"Standard"}))),f.default.createElement(b.default,{label:"Height"},f.default.createElement(p.ButtonGroup,null,f.default.createElement(p.Button,{active:"tall"===this.props.content.backgroundHeight,onClick:function(){e.setBackgroundHeight("tall")},text:"Tall"}),f.default.createElement(p.Button,{active:"narrow"===this.props.content.backgroundHeight,onClick:function(){e.setBackgroundHeight("narrow")},text:"Narrow"}))),f.default.createElement(v.default,{label:"Image",htmlFor:"section-title-"+this.props.layoutIndex,defaultImage:this.props.content.backgroundImage,onNewImage:this.setBackgroundImage,canClear:!0,width:50,height:35}),f.default.createElement("div",{className:"line-break"}),f.default.createElement(b.default,{label:"Banner Button Type"},f.default.createElement("div",{className:"bp3-button-group bp3-select"},f.default.createElement("select",{value:i,onChange:this.setButtonType},f.default.createElement("option",{value:"none"},"None"),f.default.createElement("option",{value:"create-pub"},"Create Pub"),f.default.createElement("option",{value:"signup"},"Create Account"),f.default.createElement("option",{value:"link"},"Link")))),this.props.content.showButton&&f.default.createElement(b.default,{label:"Button Text",value:this.props.content.buttonText,onChange:this.setButtonText}),this.props.content.showButton&&"create-pub"===i&&f.default.createElement(b.default,{label:"Default Pub Collections"},f.default.createElement(h.default,{allCollections:this.props.communityData.collections,selectedCollectionIds:this.props.content.defaultCollectionIds||[],onItemSelect:function(t){var n=e.props.content.defaultCollectionIds||[],r=s(s([],c(n),!1),[t],!1);e.setDefaultCollectionIds(r)},onRemove:function(t,n){var r=(e.props.content.defaultCollectionIds||[]).filter((function(e,t){return t!==n}));e.setDefaultCollectionIds(r)},placeholder:"Add collections..."})),this.props.content.showButton&&"link"===i&&f.default.createElement(b.default,{label:"Link",value:this.props.content.buttonUrl,onChange:this.setButtonUrl})),f.default.createElement("div",{className:"block-content",style:"full"===this.props.content.backgroundSize?a:void 0},this.props.content.backgroundImage&&"full"===this.props.content.backgroundSize&&f.default.createElement("div",{className:"dim"}),f.default.createElement("div",{className:"container"},f.default.createElement("div",{className:"row",style:"standard"===this.props.content.backgroundSize?a:void 0},this.props.content.backgroundImage&&"standard"===this.props.content.backgroundSize&&f.default.createElement("div",{className:"dim"}),f.default.createElement("div",{className:"col-12",style:n},this.props.content.text&&f.default.createElement("h2",{style:r},this.props.content.text),this.props.content.showButton&&f.default.createElement(p.Button,{className:"bp3-large",onClick:function(){},text:o}))))))},t}(f.Component);t.default=E},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1094);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(6),s=n(274),d=o(n(1095)),f=o(n(1096));t.default=function(e){var t=e.onChange,n=e.layoutIndex,r=e.block,a=e.collection,i=(0,l.useCallback)((function(e){return t(n,e)}),[t,n]);return l.default.createElement("div",{className:"layout-editor-collection-header-component"},l.default.createElement("div",{className:"block-header rows"},l.default.createElement("div",{className:"controls-row"},l.default.createElement(c.Popover,{"aria-label":"Choose preview elements",content:l.default.createElement(f.default,{content:r.content,onChange:i})},l.default.createElement(u.Button,{outlined:!0,icon:"layout-grid",rightIcon:"caret-down"},"Detail fields")),"tag"!==a.kind&&l.default.createElement(c.Popover,{"aria-label":"Choose metadata elements",content:l.default.createElement(d.default,{content:r.content,collection:a,onChange:i})},l.default.createElement(u.Button,{outlined:!0,icon:"property",rightIcon:"caret-down"},"Metadata fields")))),l.default.createElement(s.LayoutCollectionHeader,{collection:a,content:r.content}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(436),c=function(e){var t=e.content,n=e.onChange,i=e.collection,c=i.metadata,s=i.kind;if(!c||"tag"===s)return null;var d=(0,u.getOrderedCollectionMetadataFields)(i).filter((function(e){return"url"!==e.name})),f=t.hiddenMetadataFields,m=void 0===f?[]:f;return o.default.createElement(o.default.Fragment,null,d.map((function(e){var t=!!c[e.name],i=m.includes(e.name);return o.default.createElement(o.default.Fragment,null,o.default.createElement(l.Checkbox,{disabled:!t,checked:!!t&&!i,onChange:function(){return t=e.name,i=m.includes(t)?m.filter((function(e){return e!==t})):a(a([],r(m),!1),[t],!1),void n({hiddenMetadataFields:i});var t,i},label:e.label}))})))};t.default=function(e){var t=e.content,n=e.onChange,r=e.collection;return void 0===r.kind||"tag"===r.kind?null:o.default.createElement(l.Card,null,o.default.createElement(c,{content:t,onChange:n,collection:r}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5);t.default=function(e){var t=e.content,n=e.onChange,r=t.hideCollectionKind,o=t.hideByline,l=t.hideContributors,u=t.hideDate;return a.default.createElement(i.Card,{className:"layout-editor-pubs_preview-elements-component"},a.default.createElement(i.Checkbox,{checked:!o,onChange:function(){return n({hideByline:!o})},label:"Byline"}),a.default.createElement(i.Checkbox,{disabled:o,checked:!o&&!l,onChange:function(){return n({hideContributors:!l})},label:"Contributors"}),a.default.createElement(i.Checkbox,{checked:!r,onChange:function(){return n({hideCollectionKind:!r})},label:"Collection kind"}),a.default.createElement(i.Checkbox,{checked:!u,onChange:function(){return n({hideDate:!u})},label:"Creation date"}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(71),d=n(5),f=n(1099),m=n(219),p=n(9),h=n(1100);n(1101);var b=[{title:"Terms of service",shouldShow:function(){return(0,f.shouldShowTosUpdate)()},notice:function(){return u.default.createElement("p",null,"We've updated PubPub's Terms of Service to clarify the relationship between PubPub, third-party publishers, and users, and to further underscore our commitment to the highest standards of user privacy.")},buttons:function(e,t){var n=e.loginData;return u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Button,{large:!0,onClick:function(){(0,f.markTosUpdateSeen)(),t()},intent:"success"},(0,m.shouldShowGdprBanner)(n)?"Next":"Close"),u.default.createElement(d.Button,{large:!0,onClick:function(){window.open("https://www.pubpub.org/legal/terms","_blank")}},"See terms"))}},{title:"Cookies and data privacy",shouldShow:function(e){var t=e.loginData;return(0,m.shouldShowGdprBanner)(t)},notice:function(){return u.default.createElement("p",null,"PubPub uses third-party cookies to help our team and our communities understand which features and content on PubPub are receiving traffic."," ",u.default.createElement("b",null,"We don't sell this data or share it with anyone else"),", and we don't use third-party processors who aggregate and sell data. Visit your"," ",u.default.createElement("a",{href:"/legal/settings"},"privacy settings")," to learn more.")},buttons:function(e,t){var n=e.loginData,r=function(e){(0,m.updateGdprConsent)(n,e),t()};return u.default.createElement(u.default.Fragment,null,u.default.createElement(d.Button,{large:!0,onClick:function(){return r(!0)},intent:"success"},"Accept"),u.default.createElement(d.Button,{large:!0,onClick:function(){return r(!1)}},"Disable"))}},{title:"Take our User Satisfaction Survey",shouldShow:function(e){var t=e.dismissedUserDismissables,n=e.featureFlags;return!!e.loginData.id&&!t.surveySummer22&&n.surveySummer22},notice:function(){return u.default.createElement("p",null,"We'd like to understand who our users are, how they value PubPub, and how we can better service publishing communities. This will directly inform our roadmap and priorities. It should take less than 5 minutes to complete and can be filled out anonymously.")},buttons:function(e,t){return u.default.createElement(u.default.Fragment,null,u.default.createElement(d.AnchorButton,{large:!0,href:"https://forms.gle/cecnRw7BDbeYyML4A",target:"_blank",style:{padding:"0 10px"},intent:"primary"},"Take the survey"),u.default.createElement(d.Button,{large:!0,onClick:function(){(0,h.dismissUserDismissable)("surveySummer22"),t()}},"Dismiss"))}}];t.default=function(){var e=(0,p.usePageContext)(),t=o((0,u.useState)(-1),2),n=t[0],r=t[1],a=b[n],i=o((0,u.useState)(b.filter((function(t){return t.shouldShow(e)}))),1)[0],l=function(){var t=n;do{++t}while(b[t]&&!b[t].shouldShow(e));r(t)};if((0,s.useEffectOnce)(l),!a)return null;return u.default.createElement("div",{className:"legal-banner-component"},u.default.createElement("div",{className:"logo"},u.default.createElement("img",{src:"/static/logo.png",alt:""})),u.default.createElement("div",{className:"notice"},u.default.createElement("div",{className:"notice-steps"},i.map((function(e,t){return u.default.createElement("div",{key:t,className:(0,c.default)("step",b.indexOf(e)===n&&"current")},e.title)}))),a.notice()),u.default.createElement("div",{className:"legal-buttons"},a.buttons(e,l)))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.markTosUpdateSeen=t.shouldShowTosUpdate=void 0;var a=r(n(170)),i=n(447);Date.parse("2020-01-01");t.shouldShowTosUpdate=function(){var e=a.default.get("tos-update");return e&&parseInt(e,10),!1};t.markTosUpdateSeen=function(){var e=Date.now();a.default.set("tos-update",e,(0,i.getCookieOptions)())}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.dismissUserDismissable=void 0;var i=n(18);t.dismissUserDismissable=function(e){return r(void 0,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,i.apiFetch.post("/api/userDismissable",{key:e})];case 1:return t.sent(),[2]}}))}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(5),i=r(n(3)),o=r(n(0));n(1103);t.default=function(e){var t=e.length,n=e.maxLength,r=e.visibilityThreshold,l=t/n;return l>(void 0===r?.9:r)?o.default.createElement(a.Text,{className:(0,i.default)("length-indicator-component",1===l&&"at-max-length")},t," / ",n):null}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(448),s=n(9),d=n(18);n(1106);var f=function(e){var t=e.children,n=e.onSelect,r=e.persistSelections,a=e.pubData,i=e.updateLocalData,f=o((0,l.useState)(!1),2),m=f[0],p=f[1],h=(0,s.usePageContext)().communityData,b=(0,c.getLicenseForPub)(a,h),v=function(e){return l.default.createElement("img",{width:75,alt:"",src:"/static/license/"+e.slug+".svg"})};return l.default.createElement(u.Popover,{content:l.default.createElement(u.Menu,null,c.licenses.filter((function(e){return h.premiumLicenseFlag||!e.requiresPremium})).map((function(e){return l.default.createElement(u.MenuItem,{key:e.slug,onClick:function(){return function(e){n(e),r&&(p(!0),(0,d.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify({licenseSlug:e.slug,pubId:a.id,communityId:h.id})}).then((function(){p(!1),i("pub",{licenseSlug:e.slug})})))}(e)},className:"license-select-component__menu-item",text:l.default.createElement("div",null,l.default.createElement("div",{className:"title"},e.short," ",e.link&&l.default.createElement("a",{href:e.link,className:"link",onClick:function(e){return e.stopPropagation()},target:"_blank",rel:"noopener noreferrer"},"Learn more",l.default.createElement(u.Icon,{iconSize:12,icon:"share"}))),l.default.createElement("div",{className:"full"},e.full)),icon:v(e),labelElement:e.slug===b.slug&&l.default.createElement(u.Icon,{icon:"tick"})})})))},t({icon:v(b),title:b.full,isPersisting:m}))};f.defaultProps={onSelect:function(){},updateLocalData:function(){},persistSelections:!0},t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPublisherString=void 0;t.getPublisherString=function(e){return e.publishAs||e.title}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(107),s=o(n(173));t.default=function(e){var t=e.pages,n=e.onSelectPage,r=e.selectedPageId,a=e.disabled,i=t.find((function(e){return e.id===r}));return l.createElement(c.Select,{items:t,itemRenderer:function(e,t){var n=t.handleClick;return l.createElement(u.MenuItem,{key:e.title,onClick:n,text:e.title})},itemListPredicate:function(e,t){return t.filter((function(t){return(0,s.default)(e.toLowerCase(),t.title.toLowerCase())}))},onItemSelect:n,popoverProps:{popoverClassName:"bp3-minimal"}},l.createElement(u.Button,{className:"linked-page-select-button",text:i?i.title:l.createElement("em",null,"Choose a Page"),rightIcon:"chevron-down",disabled:a,minimal:!0,outlined:!0}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=n(9),f=n(40),m=l(n(449));n(1113);t.default=function(e){var t=e.members,n=e.scope,r=o((0,u.useState)(!1),2),a=r[0],i=r[1],l=(0,d.usePageContext)().scopeData;return u.default.createElement("div",{className:"inherited-members-block-component"},u.default.createElement("div",{className:"top"},u.default.createElement("div",{className:"scope"},n," Members with access: ",t.length),u.default.createElement(c.Button,{outlined:!0,small:!0,text:a?"Hide Details":"Show Details",onClick:function(){i(!a)}})),!a&&u.default.createElement("div",{className:"preview-block"},t.map((function(e){return u.default.createElement(s.Avatar,{key:e.id,initials:e.user.initials,avatar:e.user.avatar,width:20})}))),a&&u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"explanation-block"},function(e,t){var n=t.elements,r=n.activeTargetName,a=n.activeCommunity.title,i="Community"===e?"the "+a+" community":"a collection that contains it",o=u.default.createElement(u.default.Fragment,null,"These users are members of this ",r," because they are members of"," ",i,".");return"Community"===e&&t.activePermissions.canManageCommunity?u.default.createElement(u.default.Fragment,null,o," You can manage this list of members from the"," ",u.default.createElement("a",{href:(0,f.getDashUrl)({mode:"members"})},"Community members tab.")):o}(n,l)),u.default.createElement("div",{className:"members-block"},t.map((function(e){return u.default.createElement(m.default,{memberData:e,key:e.id,isReadOnly:!0})})))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(9),s=function(e){var t=e.dialogType,n=e.isOpen,r=e.onConfirm,a=e.onCancel,i=o((0,l.useState)(!1),2),s=i[0],d=i[1],f=function(e,t){return"delete"===e?{explanation:l.default.createElement(l.default.Fragment,null,"If you remove yourself as a Member from this ",t,", you won't be able to undo this action. Another Member will need to add you again."),checkboxLabel:"Yes, I really want to remove myself!",confirmButtonLabel:"Remove me"}:"demote"===e?{explanation:l.default.createElement(l.default.Fragment,null,"If you choose a less capable permission for yourself, you won't be able to undo this action. Another Member will need to restore it for you."),checkboxLabel:"Yes, I really want to change my permissions!",confirmButtonLabel:"Change my permissions"}:{explanation:null,checkboxLabel:null,confirmButtonLabel:null}}(t,(0,c.usePageContext)().scopeData.elements.activeTargetName),m=f.explanation,p=f.checkboxLabel,h=f.confirmButtonLabel;return l.default.createElement(u.Dialog,{lazy:!0,isOpen:n,onClose:a,title:"Are you sure?"},l.default.createElement("div",{className:u.Classes.DIALOG_BODY},l.default.createElement("p",null,m),l.default.createElement(u.Checkbox,{checked:s,onChange:function(){return d(!s)},label:p})),l.default.createElement("div",{className:u.Classes.DIALOG_FOOTER},l.default.createElement("div",{className:u.Classes.DIALOG_FOOTER_ACTIONS},l.default.createElement(u.Button,{onClick:a},"Cancel"),l.default.createElement(u.Button,{disabled:!s,onClick:r,intent:"danger"},h))))};s.defaultProps={},t.default=s},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(6),l=n(9),u=n(450);n(1111);var c={pub:[{title:"View Pub drafts",activeAt:"view"},{title:"View member-only Discussions and Reviews",activeAt:"view"},{title:"Edit Pub draft",activeAt:"edit"},{title:"Create Reviews",activeAt:"edit"},{title:"Manage Pub settings",activeAt:"manage"},{title:"Create Releases",activeAt:"admin"},{title:"See all Discussions and Reviews",activeAt:"admin"},{title:"Delete Pub",activeAt:"admin"}],collection:[{title:"View all Pub drafts",activeAt:"view"},{title:"View member-only Discussions and Reviews",activeAt:"view"},{title:"Edit Pub drafts",activeAt:"edit"},{title:"Create Reviews",activeAt:"edit"},{title:"Manage Pub settings",activeAt:"manage"},{title:"Manage Collection settings",activeAt:"manage"},{title:"Create new Pubs in this Collection",activeAt:"manage"},{title:"Create Pub Releases",activeAt:"admin"},{title:"See all Discussions and Reviews",activeAt:"admin"},{title:"Delete Pubs",activeAt:"admin"},{title:"Delete Collection",activeAt:"admin"}],community:[{title:"View all Pub drafts",activeAt:"view"},{title:"View member-only Discussions and Reviews",activeAt:"view"},{title:"Edit Pub drafts",activeAt:"edit"},{title:"Create Reviews",activeAt:"edit"},{title:"Manage Pub settings",activeAt:"manage"},{title:"Manage Collection settings",activeAt:"manage"},{title:"Manage Community settings",activeAt:"manage"},{title:"Create new Pubs",activeAt:"manage"},{title:"Create new Collections",activeAt:"manage"},{title:"Create Pub Releases",activeAt:"admin"},{title:"See all Discussions and Reviews",activeAt:"admin"},{title:"Assign DOIs",activeAt:"admin"},{title:"Delete Pubs",activeAt:"admin"},{title:"Delete Collections",activeAt:"admin"},{title:"Delete Community",activeAt:"admin"}]},s=function(e){var t=e.activeTargetType,n=e.activePermission,r=e.onSelect,s=e.canAdmin,d=(0,l.usePageContext)().communityData,f=c[t];return a.default.createElement("div",{className:"member-permission-picker-component"},a.default.createElement("style",null,".active .header-row .bp3-icon { background: "+d.accentColorDark+"}"),a.default.createElement("div",{className:"picker-column"},a.default.createElement("div",{className:"header-row"}),f.map((function(e){return a.default.createElement("div",{className:"row title-row",key:e.title},e.title)}))),u.permissionValues.map((function(e,t){var l=e===n,c="admin"===e&&!s;return a.default.createElement("button",{className:(0,i.default)("picker-column",l&&"active",c&&"disabled"),key:e,disabled:c,type:"button",onClick:function(){return r(e)}},a.default.createElement("div",{className:"header-row"},a.default.createElement("div",null,e),l&&a.default.createElement(o.Icon,{icon:"small-tick",color:"#fff"})),f.map((function(e){var n=u.permissionValues.indexOf(e.activeAt)<t+1;return a.default.createElement("div",{className:"row"},n?"â€¢":"")})))})))};s.defaultProps={onSelect:function(e){console.log(e)}},t.default=s},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=c(n(3)),f=o(n(41));n(1115);var m=function(){return!0},p=function(e){return e.minimalButtonSet};t.default=function(e){var t=e.customNodes,a=e.debounceEditsMs,i=void 0===a?0:a,c=e.initialContent,h=e.constrainHeight,b=void 0!==h&&h,v=e.noMinHeight,y=void 0!==v&&v,g=e.onEdit,_=e.onContent,E=e.useFormattingBar,P=void 0!==E&&E,w=e.focusOnLoad,O=void 0!==w&&w,C=e.placeholder,S=e.isReadOnly,D=void 0!==S&&S,k=e.isTranslucent,j=void 0!==k&&k,M=e.getButtons,N=void 0===M?p:M,I=l((0,s.useState)(null),2),x=I[0],T=I[1],A=l((0,s.useState)(null),2),R=A[0],B=A[1],F=(0,s.useRef)(null);(0,s.useEffect)((function(){O&&(null==x?void 0:x.view)&&x.view.focus()}),[]),(0,s.useEffect)((function(){Promise.resolve().then((function(){return o(n(116))})).then((function(e){var t=e.buttons,n=e.FormattingBar;B((function(){return function(e){return s.default.createElement(n,r({},e,{buttons:N(t)}))}}))}))}),[]);var L=(0,s.useCallback)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(g&&g.apply(void 0,u([],l(e),!1)),_){var n=l(e,1),r=n[0];_({content:r.toJSON(),text:(0,f.getTextFromDoc)(r)})}}),[g,_]);return s.default.createElement("div",{className:(0,d.default)("minimal-editor-component",b&&"constrain-height",j&&"translucent",P&&"has-formatting-bar",y&&"no-min-height")},P&&R&&s.default.createElement(R,{editorChangeObject:x,isTranslucent:j,showBlockTypes:!1,isSmall:!0,controlsConfiguration:{container:F.current}}),s.default.createElement("div",{className:"editor-wrapper",onClick:function(){if(x){var e=x.view;e.hasFocus()||e.focus()}}},s.default.createElement("div",{ref:F}),s.default.createElement(f.default,{isReadOnly:D,customNodes:t,debounceEditsMs:i,initialContent:c,placeholder:C,onScrollToSelection:m,onEdit:L,onChange:T,customPlugins:{headerIds:null,highlights:null}})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1117);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=n(278);n(1118);var s=function(e,t,n,a,i){if(!e)return null;var o=a===i;if(!n&&!o)return null;var l=r({className:i?"mobile-aware-component__mobile":"mobile-aware-component__desktop"},o?{ref:t}:null);return"function"==typeof e?e(l):u.default.cloneElement(e,l)},d=u.default.forwardRef((function(e,t){var n=e.mobile,r=void 0===n?null:n,a=e.desktop,i=void 0===a?null:a,o=l((0,u.useState)(!0),2),d=o[0],f=o[1],m=(0,c.useViewport)({withEarlyMeasurement:!0}).isMobile;return(0,u.useEffect)((function(){return f(!1)}),[]),u.default.createElement(u.default.Fragment,null,s(r,t,d,m,!0),s(i,t,d,m,!1))}));t.default=d},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(163),l=n(9),u=n(6),c=n(57);n(1120);var s={previewContext:i.default.object},d={previewContext:void 0},f=function(e){var t=(0,l.usePageContext)(e.previewContext).communityData,n=t.pages,r=void 0===n?[]:n,i=t.collections,s=void 0===i?[]:i,d=t.navigation,f=void 0===d?[]:d,m=(0,o.getNavItemsForCommunityNavigation)({navigation:f,pages:r,collections:s}),p=(0,o.createSocialNavItems)(t),h=function(e,t){return(0,o.isNavbarMenu)(e)?null:a.default.createElement(c.MenuItem,{key:t,href:e.href,icon:e.isPrivate&&a.default.createElement(u.Icon,{icon:"lock2",iconSize:14}),rightElement:e.isExternal&&a.default.createElement(u.Icon,{icon:"share",iconSize:14}),text:e.title})};return a.default.createElement("nav",{className:"nav-bar-component accent-background accent-color"},a.default.createElement(u.GridWrapper,null,a.default.createElement("div",{className:"scrollable-nav"},a.default.createElement("ul",{className:"nav-list"},m.filter((function(e){return e})).map((function(e){return(0,o.isNavbarMenu)(e)?a.default.createElement(c.Menu,{"aria-label":e.title,disclosure:a.default.createElement("li",{className:"dropdown"},a.default.createElement("span",{className:"title"},e.title),a.default.createElement("span",{className:"bp3-icon-standard bp3-icon-caret-down bp3-align-right"})),className:"nav-bar-popover",key:"nav-item-"+e.id},e.children.map(h)):a.default.createElement("a",{href:e.href,key:"nav-item-"+e.id},a.default.createElement("li",null,e.isPrivate&&a.default.createElement(u.Icon,{icon:"lock2",iconSize:14}),a.default.createElement("span",{className:"title"},e.title),e.isExternal&&a.default.createElement(u.Icon,{icon:"share",iconSize:11,className:"external-icon"})))}))),a.default.createElement("div",{className:"overflow-gradient"})),p.length?a.default.createElement("ul",{className:"social-list"},p.map((function(e){return a.default.createElement("a",{href:e.url,key:"social-item-"+e.id,"aria-label":e.title},a.default.createElement("li",null,a.default.createElement(u.Icon,{icon:e.icon})))}))):null))};f.propTypes=s,f.defaultProps=d,t.default=f},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=c(n(3)),f=n(5),m=n(6),p=n(182),h=n(1122),b=n(161);n(1123);t.default=function(e){var t=e.availableItems,n=e.selectedItems,a=e.onSearch,i=e.onRequestMoreItems,o=e.onSelectedItems,c=e.renderItem,v=e.selectedTitle,y=void 0===v?"Selected":v,g=e.availableTitle,_=void 0===g?"Available":g,E=e.searchPlaceholder,P=e.searchTerm,w=e.scrollForMoreItems,O=void 0!==w&&w,C=e.isRequestingMoreItems,S=void 0!==C&&C,D=(0,s.useRef)(null),k=l((0,s.useState)((function(){return(0,b.generateHash)(10)})),1)[0],j=(0,h.useHotkeys)().hotkeyRef;(0,p.useInfiniteScroll)({element:D.current,enabled:O&&!S,onRequestMoreItems:i});var M=function(e){return s.default.createElement("div",{className:"column-header"},e)};return s.default.createElement("div",{className:"order-picker-component"},s.default.createElement("div",{className:"column",ref:j("ArrowLeft")},M(_),s.default.createElement("div",{className:"items-listing",ref:D},a&&s.default.createElement("div",{className:"search-bar"},s.default.createElement(f.InputGroup,{leftIcon:"search",value:P,placeholder:E,onChange:function(e){return a(e.target.value)}})),s.default.createElement("ul",null,t.map((function(e){return s.default.createElement("li",{key:e.id},c(e,(function(){return function(e){o(u(u([],l(n),!1),[e],!1))}(e)})))}))),S&&s.default.createElement(f.Spinner,{size:25,className:"more-spinner"}))),s.default.createElement("div",{className:"column",ref:j("ArrowRight")},M(y),s.default.createElement(m.DragDropOrdering,{className:"items-listing",droppableType:k,items:n,renderItem:function(e,t,a){return function(e,t,n,r,a){return void 0===r&&(r=!1),void 0===a&&(a=null),s.default.createElement("div",{key:e.id,className:(0,d.default)("order-picker-component_item",r&&"is-dragging")},t,s.default.createElement("div",{className:"content"},c(e,a)),n)}(e,t&&s.default.createElement("div",r({className:"drag-handle"},t),s.default.createElement(f.Icon,{icon:"drag-handle-vertical"})),s.default.createElement(f.Button,{minimal:!0,icon:"cross",onClick:function(){return function(e){var t=u([],l(n),!1),r=t.findIndex((function(t){return t.id===e.id}));t.splice(r,1),o(t)}(e)}}),a)},onReorderItems:o,renderDragElementInPortal:!0,withDragHandles:!0})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHotkeys=void 0;var r=n(0),a=n(422),i=["a","button","input","textarea","select","details",'[tabindex]:not([tabindex="-1"])'].map((function(e){return e+":not([disabled])"})).join(",");t.useHotkeys=function(e){void 0===e&&(e={});var t=e.allowTakingFocusFromChild,n=void 0!==t&&t,o=(0,a.useRefMap)(),l=o.refs,u=o.getRef;return(0,r.useEffect)((function(){var e=function(e){var t,r=e.key;if(l[r]){var a=l[r].current;if(a){var o=(t=a).matches(i)?t:t.querySelector(i);o&&!function(e,t){if(e)return!1;var n=document.activeElement;return n===t||t.contains(n)}(n,a)&&o.focus()}}};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),{hotkeyRef:u}}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(9);t.default=function(e){var t=e.children,n=o((0,l.useState)(0),2),r=n[0],a=n[1],i=(0,l.useCallback)((function(){return a((function(e){return e-1}))}),[]),c=(0,l.useCallback)((function(e){return a((function(e){return e+1})),e.then((function(e){return i(),e})).catch((function(e){throw i(),e}))}),[i]);return l.default.createElement(u.PendingChanges.Provider,{value:{pendingCount:r,pendingPromise:c}},t)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=n(5),l=n(6),u={prefix:i.default.node,isSmall:i.default.bool,isMinimal:i.default.bool,onChange:i.default.func,isDisabled:i.default.bool,allowedTypes:i.default.array.isRequired,value:i.default.string.isRequired},c=function(e){var t={none:{value:"none",title:"None",onClick:function(){e.onChange("none")}},view:{value:"view",title:"View",onClick:function(){e.onChange("view")}},discuss:{value:"discuss",title:"Discuss",onClick:function(){e.onChange("discuss")}},edit:{value:"edit",title:"Edit",onClick:function(){e.onChange("edit")}},manage:{value:"manage",title:"Manage",onClick:function(){e.onChange("manage")}}};Object.keys(t).forEach((function(n){e.allowedTypes.includes(n)||delete t[n]}));var n=e.value||t[e.allowedTypes[0]].value,r={marginRight:e.prefix?"1em":"0em"};return a.default.createElement("div",{className:"permissions-dropdown-component"},a.default.createElement(l.DropdownButton,{label:a.default.createElement(a.default.Fragment,null,a.default.createElement("span",{style:r,key:"prefix"},e.prefix),a.default.createElement("span",{key:"title"},t[n]&&t[n].title)),isRightAligned:!0,isDisabled:e.isDisabled,isSmall:e.isSmall,isMinimal:e.isMinimal},a.default.createElement(o.Menu,null,Object.keys(t).map((function(e){var n=t[e];return a.default.createElement(o.MenuItem,{key:n.value+"-option",text:n.title,onClick:n.onClick})})))))};c.propTypes=u,c.defaultProps={prefix:"",isSmall:!0,isMinimal:!1,onChange:function(){},isDisabled:!1},t.default=c},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=l(n(259)),d=n(88),f=n(451);t.default=function(e){var t=e.className,n=void 0===t?"":t,r=e.fitIn,a=void 0===r?800:r,i=e.src,l=void 0===i?null:i,m=e.id,p=o((0,u.useState)((function(){return s.default.v4()})),1)[0],h=(0,d.getResizedUrl)(l,"inside",a),b=m||p,v=l?{backgroundImage:'url("'+h+'")'}:{background:(0,f.generatePubBackground)(b)};return u.default.createElement("div",{className:(0,c.default)("preview-image-component",n),style:v})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPsuedorandomChoiceForUuid=t.getPsuedorandomFractionForUuid=void 0;t.getPsuedorandomFractionForUuid=function(e){var t=e.split("-").pop(),n=parseInt(t,16);return(0xffffffffffff===n?n-1:n)/0xffffffffffff};t.getPsuedorandomChoiceForUuid=function(e,n){var r=(0,t.getPsuedorandomFractionForUuid)(e);return n[Math.floor(n.length*r)]}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PopoverButton=t.Popover=void 0;var o=n(1129);Object.defineProperty(t,"Popover",{enumerable:!0,get:function(){return i(o).default}});var l=n(1130);Object.defineProperty(t,"PopoverButton",{enumerable:!0,get:function(){return i(l).default}}),a(n(220),t)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(78),l=n(220);t.default=function(e){var t=e["aria-label"],n=e.children,a=e.className,u=e.content,c=e.placement,s=void 0===c?"bottom-start":c,d=e.preventBodyScroll,f=void 0===d||d,m=e.gutter,p=void 0===m?5:m,h=e.lazy,b=void 0===h||h,v=e.unstable_fixed,y=void 0!==v&&v,g=(0,o.usePopoverState)({placement:s,gutter:p,unstable_fixed:y});return i.default.createElement(i.default.Fragment,null,i.default.createElement(o.PopoverDisclosure,r({},g,n.props),(function(e){return(0,l.adaptDisclosureElementForBlueprintButton)(n,e,g.visible)})),i.default.createElement(o.Popover,r({"aria-label":t,className:a,modal:!0,preventBodyScroll:f,style:{zIndex:20}},g),(!b||g.visible)&&u))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(78),u=n(5),c=n(220);t.default=function(e){var t=e.component,n=e["aria-label"],i=e.children,s=e.className,d=a(e,["component","aria-label","children","className"]),f=(0,l.usePopoverState)({unstable_fixed:!1,placement:"bottom-end",gutter:5});return o.default.createElement(o.default.Fragment,null,o.default.createElement(l.PopoverDisclosure,r({},f,i.props),(function(e){return(0,c.adaptDisclosureElementForBlueprintButton)(i,e,f.visible)})),o.default.createElement(l.Popover,r({"aria-label":n,className:s,unstable_portal:!0,tabIndex:0},f),o.default.createElement(u.Card,{elevation:2},o.default.createElement(t,r({},d)))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=a.default.createElement(a.default.Fragment,null,"A Pub can belong to many Collections, but its Primary Collection is the most important one. It is associated with the Pub in metadata, PDF exports, and more.");t.default=function(e){var t=e.children,n=void 0===t?"Primary Collection":t;return a.default.createElement(a.default.Fragment,null,a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Tooltip,{content:o},a.default.createElement("span",{className:i.Classes.TOOLTIP_INDICATOR},n))))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=i(n(452));n(1133);t.default=function(e){var t=e.isOpen,n=e.onClose,i=a(e,["isOpen","onClose"]);return o.default.createElement(l.Dialog,{className:"pub-attribution-dialog-component",title:"Edit Pub contributors",isOpen:t,onClose:n},o.default.createElement("div",{className:l.Classes.DIALOG_BODY},o.default.createElement(u.default,r({},i))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(275);n(1135);var l=a.default.forwardRef((function(e,t){var n=e.children,r=void 0===n?null:n,l=e.className,u=void 0===l?"":l,c=e.pubData,s=e.communityData,d=e.blur,f=void 0!==d&&d,m=e.style,p=void 0===m?{}:m,h=e.safetyLayer,b=void 0===h?null:h,v=c.headerBackgroundColor,y=c.headerBackgroundImage,g=(0,o.calculateBackgroundColor)(v,s.accentColorDark);return a.default.createElement("div",{className:(0,i.default)("pub-header-background-component","pub-header-theme-"+c.headerStyle,u),style:p,ref:t},a.default.createElement("div",{className:"background-element background-white-layer"}),y&&a.default.createElement("div",{className:(0,i.default)("background-element","background-image",f&&"blur"),style:{backgroundImage:"url('"+y+"')"}}),g&&a.default.createElement("div",{className:"background-element background-color",style:{backgroundColor:g}}),!!b&&a.default.createElement("div",{className:(0,i.default)("background-element","background-safety-layer","full-height"===b&&"full-height")}),r)}));t.default=l},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(132),l=a(n(217)),u=function(e){var t=e.pubData,n=e.hideAuthors,a=void 0!==n&&n,u=e.hideContributors,c=void 0!==u&&u,s=(0,o.getAllPubContributors)(t,"contributors",a,c);return i.default.createElement(l.default,r({},e,{contributors:s}))};u.defaultProps={hideAuthors:!1,hideContributors:!0},t.default=u},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=o(n(0)),m=d(n(3)),p=n(118),h=n(5),b=n(112),v=n(6),y=n(164),g=n(74),_=n(1138),E=n(131),P=n(9),w=n(453),O=o(n(279)),C=n(40);n(1139);t.default=function(e){var t=e.allCollections,n=e.canManage,a=e.collectionPubs,i=e.pub,o=e.renderTriggerButtonForQueryList,d=e.updateCollectionPubs,S=e.onQueryListClose,D=e.renderDragElementInPortal,k=(0,P.usePageContext)(),j=k.communityData,M=k.scopeData,N=(0,P.usePendingChanges)().pendingPromise,I=(0,f.useMemo)((function(){var e=new Set(a.map((function(e){return e.collectionId}))),n=(0,_.getUserManagedCollections)(t,M);return{canAddCollections:n.filter((function(t){return!e.has(t.id)})),canRemoveCollectionIds:new Set(n.map((function(e){return e.id})).filter((function(t){return e.has(t)})))}}),[t,M,a]),x=I.canAddCollections,T=I.canRemoveCollectionIds,A=(0,E.getPrimaryCollection)(a),R=function(e){return l(void 0,void 0,void 0,(function(){var t,n,o;return u(this,(function(l){switch(l.label){case 0:return"tagTitleToCreate"in e?[4,O.createTagCollection({title:e.tagTitleToCreate,communityId:j.id,isPublic:!0})]:[3,2];case 1:return n=l.sent(),[3,3];case 2:n=e,l.label=3;case 3:return t=n,[4,N(O.addCollectionPub({communityId:j.id,pubId:i.id,collectionId:t.id}))];case 4:return o=l.sent(),d(s(s([],c(a),!1),[r(r({},o),{collection:t})],!1)),[2]}}))}))},B=function(e,t,n,r){void 0===t&&(t=!0);var a=f.default.createElement(f.default.Fragment,null,f.default.createElement(v.Icon,{icon:(0,g.getIconForCollectionKind)(e.kind),className:"collection-kind-icon"}),t?f.default.createElement("a",{href:(0,C.getDashUrl)({collectionSlug:e.slug}),className:"title",target:"_blank",rel:"noopener noreferrer"},e.title):e.title,!e.isPublic&&f.default.createElement(v.Icon,{icon:"lock2",className:"title-icon"}),(null==A?void 0:A.id)===e.id&&f.default.createElement(h.Tooltip,{content:"Primary Collection"},f.default.createElement(v.Icon,{icon:"star",className:"title-icon",ariaLabel:"Primary Collection"}))),i=(0,m.default)("pub-collections-listing-component_collection-title",!!n&&"interactive",r&&"active");return n?f.default.createElement(b.Button,{as:"div",onClick:n,className:i,key:e.id},a):f.default.createElement("div",{className:i,key:e.id},a)},F=function(e,t){var n=t.handleClick,r=t.modifiers.active;return"id"in e?B(e,!1,n,r):null},L=M.activePermissions.canManageCommunity?{createNewItemFromQuery:function(e){return{tagTitleToCreate:e}},createNewItemRenderer:function(e,t,n){return B({title:"Create new tag: "+e,kind:"tag",slug:"",id:"",isPublic:!0},!1,n,t)},searchPlaceholder:"Search for Collections (or create a Tag)",emptyListPlaceholder:""}:{emptyListPlaceholder:"No Collections match this search.",searchPlaceholder:"Search for Collections"},U=function(e){return x.length>0?f.default.createElement(v.QueryListDropdown,r({itemPredicate:function(e,t){return(0,w.fuzzyMatchCollection)(t,e)},items:x,itemRenderer:F,onItemSelect:R,position:"bottom-left",onClose:S,usePortal:!1},L),e):null};return o?U(o()):0===a.length&&0===x.length?f.default.createElement(f.default.Fragment,null,"You don't have permission to add this Pub to any Collections."):f.default.createElement("div",{className:"pub-collections-listing-component"},U(f.default.createElement(h.Button,{icon:"plus",className:"add-button"},"Add to Collections")),a.length>0&&f.default.createElement("div",{className:"reorder-explanation"},"Reorder Collections to indicate their importance to this Pub; the highest public, non-Tag Collection will serve as its ",f.default.createElement(v.PrimaryCollectionExplanation,null),"."),f.default.createElement(p.DragDropContext,{onDragEnd:function(e){var t=e.source.index,n=e.destination.index,i=s([],c(a),!1),o=c(i.splice(t,1),1)[0],l=(0,y.findRankInRankedList)(i,n,"pubRank"),u=r(r({},o),{pubRank:l});i.splice(n,0,u),N(O.updateCollectionPub({communityId:j.id,id:u.id,update:{pubRank:l}})),d(i)}},f.default.createElement(v.DragDropListing,{items:(0,y.sortByRank)(a,"pubRank"),renderItem:function(e,t,n){var i=e.collection,o=T.has(i.id);return f.default.createElement("div",{key:e.id},f.default.createElement("div",{className:(0,m.default)("pub-collections-listing-component_collection-row",n&&"is-dragging")},t&&f.default.createElement("span",r({},t),f.default.createElement(v.Icon,{icon:"drag-handle-vertical"})),B(i),o&&f.default.createElement(h.Button,{small:!0,minimal:!0,icon:"small-cross","aria-label":"Remove",onClick:function(){return t=e.id,N(O.removeCollectionPub({communityId:j.id,id:t})),void d(a.filter((function(e){return e.id!==t})));var t}})),f.default.createElement(h.Divider,null))},renderEmptyState:function(){return f.default.createElement(f.default.Fragment,null,"This Pub isn't in any Collections yet.")},droppableId:"pubCollectionsListing",droppableType:"COLLECTION_PUB",withDragHandles:n,renderDragElementInPortal:D})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserManagedCollections=void 0;var r=n(264);t.getUserManagedCollections=function(e,t){var n=t.activePermissions.canManageCommunity,a=t.memberData;if(n)return e;var i=new Set(a.filter((function(e){return(0,r.checkMemberPermission)(e.permissions,"manage")&&e.collectionId})).map((function(e){return e.collectionId})));return e.filter((function(e){return!e.isRestricted||i.has(e.id)}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(3)),d=n(6),f=n(9),m=n(165),p=u(n(454)),h=u(n(455)),b=u(n(217));n(281);t.default=function(e){var t,n,a=e.actsLikeLink,i=void 0!==a&&a,o=e.pubEdge,u=e.viewingFromTarget,v=void 0!==u&&u,y=e.showDescriptionByDefault,g=void 0!==y&&y,_=l((0,c.useState)(g),2),E=_[0],P=_[1],w=(0,f.usePageContext)().communityData,O=(0,m.getValuesFromPubEdge)(o,w,v),C=O.avatar,S=O.contributors,D=O.description,k=O.publishedAt,j=O.title,M=O.url,N=o.externalPublication,I="edge-details-"+o.id,x=D&&c.default.createElement("details",{open:E,id:I},c.default.createElement("summary",null,"Description"),c.default.createElement("hr",null),c.default.createElement("p",null,D)),T=(0,c.useCallback)((function(e){("click"===e.type||"key"in e&&"Enter"===e.key)&&(e.preventDefault(),e.stopPropagation(),P(!E))}),[E]),A=function(e,t){return void 0===t&&(t={}),e?i?c.default.createElement("span",r({className:"link"},t),e):c.default.createElement("a",r({href:M},t),e):null};return(0,c.useEffect)((function(){return P(g)}),[g]),t=c.default.createElement(p.default,{topLeftElement:A(C&&c.default.createElement("img",{src:C,alt:j}),{tabIndex:"-1"}),titleElement:A(j),bylineElement:S&&S.length>0&&(N?c.default.createElement(d.Byline,{contributors:S}):c.default.createElement(b.default,{contributors:S})),metadataElements:[D&&c.default.createElement(h.default,{onToggle:T,open:E,targetId:I}),k&&c.default.createElement(c.default.Fragment,null,"Published on ",k),M&&c.default.createElement("span",{className:"location"},(0,m.getHostnameForUrl)(M))],detailsElement:x}),void 0===(n={className:(0,s.default)("pub-edge-component",i&&"acts-like-link")})&&(n={}),i?c.default.createElement("a",r({href:M},n),t):c.default.createElement("div",r({},n),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getValuesFromPubEdge=t.getDisplayedPubForPubEdge=t.isViewingEdgeFromTarget=t.getUrlForPub=t.getHostnameForUrl=void 0;var r=n(67),a=n(35),i=n(99),o=n(132);t.getHostnameForUrl=function(e){try{return new URL(e).hostname}catch(t){return e}};t.getUrlForPub=function(e,t){return t.id===e.communityId?(0,a.pubUrl)(t,e):e.community?(0,a.pubUrl)(e.communityId,e):(0,a.pubShortUrl)(e)};t.isViewingEdgeFromTarget=function(e,t,n){var r=e.pubIsParent;return t?!r:n};t.getDisplayedPubForPubEdge=function(e,n){var r=e.pub,a=e.targetPub;return("viewingFromTarget"in n?n.viewingFromTarget:(0,t.isViewingEdgeFromTarget)(e,n.viewingFromSibling,n.isInboundEdge))?r:a};t.getValuesFromPubEdge=function(e,n,a){var l=e.externalPublication,u=(0,t.getDisplayedPubForPubEdge)(e,{viewingFromTarget:a});if(u){var c=u.title,s=u.description,d=u.avatar,f=(0,t.getUrlForPub)(u,n),m=(0,i.getPubPublishedDate)(u);return{displayedPubId:u.id,avatar:d,contributors:(0,o.getAllPubContributors)(u,"contributors",!1,!0),description:s,publishedAt:m&&(0,r.formatDate)(m),title:c,url:f}}if(l){c=l.title,s=l.description;var p=l.contributors,h=(d=l.avatar,f=l.url,l.publicationDate);return{avatar:d,contributors:p||"",description:s,publishedAt:h&&(0,r.formatDate)(h,{inUtcTime:!0}),title:c,url:f}}return{}}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(112),d=n(6),f=n(165),m=l(n(454)),p=l(n(455));n(281);t.default=function(e){var t=e.pubData,n=e.externalPublication,r=n.title,a=n.description,i=n.contributors,l=n.avatar,h=n.url,b=n.publicationDate,v=e.onUpdateExternalPublication,y=o((0,u.useState)(t.pubEdgeDescriptionVisible),2),g=y[0],_=y[1];(0,u.useEffect)((function(){return _(t.pubEdgeDescriptionVisible)}),[t.pubEdgeDescriptionVisible]);return u.default.createElement(m.default,{className:"pub-edge-editor-component",topLeftElement:l&&u.default.createElement("img",{src:l,alt:""}),titleElement:u.default.createElement(c.EditableText,{placeholder:"Add a title for this publication",multiline:!0,value:r,onChange:function(e){return v({title:e})}}),bylineElement:u.default.createElement(c.TagInput,{placeholder:"Add authors for this publication",values:i,onChange:function(e){v({contributors:e})}}),metadataElements:[u.default.createElement(p.default,{onToggle:function(){return _((function(e){return!e}))},open:!!g,targetId:""}),function(){if(b)return u.default.createElement(u.default.Fragment,null,"Published on"," ",u.default.createElement(d.DatePicker,{small:!0,className:"editable-date",onSelectDate:function(e){return v({publicationDate:e})},date:b}));var e=function(){return v({publicationDate:(new Date).toISOString()})};return u.default.createElement(s.Button,{as:"a",tabIndex:"0",onKeyDown:function(t){return"Enter"===t.key&&e()},onClick:e},"Add publication date")}(),u.default.createElement("a",{href:h,alt:r},(0,f.getHostnameForUrl)(h))],detailsElement:g&&u.default.createElement(c.EditableText,{className:"editable-details",placeholder:"Add a description for this publication",multiline:!0,value:a,onChange:function(e){return v({description:e})}})})}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));t.default=function(e){var t=e.index,n=e.count;return a.default.createElement("span",{className:"pub-edge-listing-counter-component"},0===n?0:t+1," of ",n)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(64),c=n(282);n(1147);var s=function(e){var t=e.accentColor,n=e.carouselControlsDisabled,r=e.filters,a=e.mode,i=e.showFilterMenu,s=e.single,d=e.onNextClick,f=e.onBackClick,m=e.onModeChange,p=e.onFilterToggle,h=e.onAllFilterToggle,b=(0,o.useCallback)((function(){return m(c.Mode.Carousel)}),[m]),v=(0,o.useCallback)((function(){return m(c.Mode.List)}),[m]),y=c.allFilters.map((function(e){var t=r.indexOf(e)>-1;return o.default.createElement(l.Checkbox,{key:e,checked:t,onChange:function(){return p(e)}},(0,u.toTitleCase)(e)," items of this pub")})).concat(o.default.createElement(l.Checkbox,{key:"all",onChange:h,checked:r.length===c.allFilters.length},"All related items")),g=o.default.createElement("div",{className:"pub-edge-listing-controls-component-menu",style:{border:"1px solid "+t}},o.default.createElement("h6",null,"Include:"),y,o.default.createElement("h6",null,"Show as:"),o.default.createElement(l.Radio,{checked:a===c.Mode.Carousel,onChange:b},"Carousel"),o.default.createElement(l.Radio,{checked:a===c.Mode.List,onChange:v},"List")),_=n?"#a1a1a1":t;return o.default.createElement("nav",{className:"pub-edge-listing-controls-component"},o.default.createElement("span",{className:"filters"},s&&1===r.length?r[0]:r.length>0&&(0,u.joinOxford)(r.map(c.filterToPlural))),o.default.createElement(l.ButtonGroup,{minimal:!0},a===c.Mode.Carousel&&o.default.createElement(o.default.Fragment,null,o.default.createElement(l.Button,{onClick:f,minimal:!0,small:!0,"aria-label":"Previous connection",disabled:n},o.default.createElement(l.Icon,{icon:"circle-arrow-left",color:_})),o.default.createElement(l.Button,{onClick:d,minimal:!0,small:!0,"aria-label":"Next connection",disabled:n},o.default.createElement(l.Icon,{icon:"circle-arrow-right",color:_}))),i&&o.default.createElement(l.Popover,{content:g,minimal:!0},o.default.createElement(l.Button,{color:t,minimal:!0,small:!0,"aria-label":"Show filtering options"},o.default.createElement(l.Icon,{icon:"filter",color:t})))))};s.defaultProps={carouselControlsDisabled:!1,showFilterMenu:!1,single:!1},t.default=s},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=u(n(3)),d=n(5),f=n(6),m=n(9),p=n(183),h=n(67),b=n(35);n(1150);var v=function(e,t){return Math.floor(e/t)},y=function(e,t){if(t[e])return new Date(t[e]);var n=Object.keys(t),r=n.findIndex((function(t){return t>e}));if(r>0){var a=n[r],i=n[r-1],o=new Date(t[a]);if(new Date(t[i]).toDateString()===o.toDateString())return o}return null};t.default=function(e){var t=e.historyData,n=e.pubData,r=e.onSetCurrentHistoryKey,a=e.onClose,i=t.timestamps,u=t.latestKey,g=t.currentKey,_=t.outstandingRequests,E=t.loadedIntoHistory,P=n.releases,w=(0,m.usePageContext)().communityData,O=o((0,c.useState)(g),2),C=O[0],S=O[1],D=(0,c.useRef)(null),k=(0,c.useRef)(null),j=_>0,M=u>=0;D.current=null;var N=y(g,i),I=function(e,t){void 0===t&&(t=9e5);for(var n=[],r=[],a=null,i=Object.keys(e).map((function(e){return parseInt(e,10)})).sort((function(e,t){return e-t})),l=0;l<i.length;++l){var u=i[l],c=e[u],s=v(c,t);a||(a=s),s!==a?(n.push(r),r=[[u,c]],a=s):r.push([u,c])}return n.push(r),n.filter((function(e){return e.length>0})).map((function(e){var t=o(e[0],2),n=t[0],r=t[1],a=o(e[e.length-1],1)[0];return{type:"edits",date:new Date(r),range:[n,a]}}))}(i),x=function(e){return e.map((function(e,t){return{type:"release",date:new Date(e.createdAt),releaseNumber:t+1}}))}(P),T=l(l([{type:"created",date:new Date(n.createdAt)}],o(I),!1),o(x),!1).sort((function(e,t){return e.date>t.date?1:-1}));(0,p.useSticky)({target:".pub-history-viewer-component",offset:62}),(0,c.useEffect)((function(){S(g+1)}),[g]),(0,c.useEffect)((function(){if(D.current){var e=D.current,t=e.offsetParent,n=e.offsetTop;if(t&&!Number.isNaN(n)){var r=n-7;"function"==typeof t.scrollTo&&k.current?t.scrollTo({top:r,behavior:"smooth"}):t.scrollTop=r,k.current=!0}}}),[g]);var A=function(e){var t=g+e;return t>=0&&t<=u},R=function(e){r(g+e)},B=function(e){var t=e.date,a=e.type+"_"+t.valueOf().toString();if("edits"===e.type){var i=o(e.range,2),l=i[0],u=i[1],s=g>=l&&g<=u,f=(0,h.formatDate)(t,{includeTime:!0,includeDate:!1});return c.default.createElement(d.MenuItem,{icon:"blank",text:f,key:a,onClick:function(){return r(l)},active:s,intent:s?"primary":"none"})}if("release"===e.type){var m=e.releaseNumber;f=(0,h.formatDate)(t,{includeTime:!0,includeDate:!1,includePreposition:!0});return c.default.createElement(d.MenuItem,{text:"Release "+f,intent:"success",icon:"document-share",key:a,href:(0,b.pubUrl)(w,n,{releaseNumber:m}),target:"_blank"})}if("created"===e.type){f=(0,h.formatDate)(t,{includeTime:!0,includeDate:!1,includePreposition:!0});return c.default.createElement(d.MenuItem,{key:"created",text:"Created "+f,disabled:!0,icon:"clean"})}return null};return c.default.createElement("div",{className:(0,s.default)("pub-history-viewer-component",j&&"loading")},c.default.createElement("div",{className:"top-line"},c.default.createElement("div",{className:"title-and-spinner"},c.default.createElement("h4",null,"Pub History"),c.default.createElement(d.Spinner,{size:16})),!E&&c.default.createElement(d.Button,{minimal:!0,small:!0,icon:"cross",onClick:a,className:"close-button"})),M&&c.default.createElement(d.ButtonGroup,{className:"playback-button-group"},c.default.createElement(d.Button,{minimal:!0,icon:"double-chevron-left",disabled:!A(-50),onClick:function(){return R(-50)}}),c.default.createElement(d.Button,{minimal:!0,icon:"chevron-left",disabled:!A(-1),onClick:function(){return R(-1)}}),c.default.createElement(f.ClickToCopyButton,{copyString:(0,b.pubUrl)(w,n,{isDraft:!0,historyKey:g.toString()}),beforeCopyPrompt:"Copy link to this point in history"},(function(e){return c.default.createElement(d.Button,{minimal:!0,icon:"link",onClick:e},"Link here")})),c.default.createElement(d.Button,{minimal:!0,icon:"chevron-right",disabled:!A(1),onClick:function(){return R(1)}}),c.default.createElement(d.Button,{minimal:!0,icon:"double-chevron-right",disabled:!A(50),onClick:function(){return R(50)}})),M&&c.default.createElement(d.Slider,{min:0,max:u+1,stepSize:1,labelRenderer:function(e){var t=y(e-1,i);if(t){var n=(0,h.formatDate)(t),r=(0,h.formatDate)(t,{includeDate:!1,includeTime:!0});return c.default.createElement("span",{className:"date-and-time"},c.default.createElement("span",{className:"date"},n)," ",c.default.createElement("span",{className:"time"},r))}return j?"Loading...":"Release slider to load"},labelStepSize:u+1,value:C,onChange:S,onRelease:function(e){return r(e-1)}}),c.default.createElement(d.Menu,null,function(e){var t={};return e.forEach((function(e){var n=e.date.toDateString(),r=t[n]||[];r.push(e),t[n]=r})),Object.entries(t)}(T).map((function(e){var t=o(e,2);return function(e,t){var n=N&&e===N.toDateString()?D:null,r=c.default.createElement("h6",{ref:n},c.default.createElement("li",{className:"bp3-menu-header"},e)),a=t.map(B);return c.default.createElement("div",{key:e},r,a)}(t[0],t[1])}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(3)),l=n(112),u=n(6);n(1152);var c=i.default.forwardRef((function(e,t){var n=e.active,a=void 0!==n&&n,c=e.contributors,s=e.disabled,d=void 0!==s&&s,f=e.image,m=void 0===f?"":f,p=e.isSkeleton,h=void 0!==p&&p,b=e.onClick,v=e.showImage,y=void 0!==v&&v,g=e.title,_=e.id,E=e.bylineProps,P=void 0===E?{}:E,w=(0,o.default)(h&&"bp3-skeleton"),O={ref:t,className:(0,o.default)("bp3-menu-item","pub-menu-item-component",a&&"active",d&&"bp3-disabled",h&&"is-skeleton",!b&&"unselectable"),children:i.default.createElement(i.default.Fragment,null,y&&i.default.createElement(u.PreviewImage,{src:m,id:_,className:w}),i.default.createElement("div",{className:"inner"},i.default.createElement("div",{className:(0,o.default)("title",w)},g),c&&i.default.createElement("div",{className:(0,o.default)("subtitle",w)},i.default.createElement(u.Byline,r({contributors:c,linkToUsers:!1,truncateAt:4},P)))))};return b?i.default.createElement(l.Button,r({as:"button"},O,{onClick:b})):i.default.createElement("div",r({},O))}));t.default=c},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(417));n(1154);var c=l.default.forwardRef((function(e,t){var n=e.structured,r=void 0===n?"":n,a=e.unstructured,i=void 0===a?"":a,o=(0,l.useMemo)((function(){return(0,u.default)(r)}),[r]),c=(0,l.useMemo)((function(){return(0,u.default)(i)}),[i]);return l.default.createElement("span",{ref:t,className:"pub-note-content-component"},l.default.createElement("span",{dangerouslySetInnerHTML:{__html:(o||"").split("\n").join("")}}),l.default.createElement("span",{dangerouslySetInnerHTML:{__html:(c||"").split("\n").join("")}}))}));t.default=c},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(88),d=n(99),f=n(1156),m=n(132),p=n(35),h=n(9),b=n(6),v=l(n(1157)),y=l(n(1159)),g=l(n(1161)),_=l(n(381));n(1163);t.default=function(e){var t=e.communityData,n=e.customizePubUrl,r=e.hideByline,a=void 0!==r&&r,i=e.hideContributors,l=void 0!==i&&i,E=e.hideDates,P=void 0!==E&&E,w=e.hideDescription,O=void 0!==w&&w,C=e.hideEdges,S=void 0!==C&&C,D=e.pubData,k=e.size,j=void 0===k?"large":k,M=(0,h.usePageContext)(),N=M.communityData,I=M.scopeData,x=o((0,u.useState)(!1),2),T=x[0],A=x[1],R=o((0,u.useState)(!1),2),B=R[0],F=R[1],L=(0,u.useRef)(null),U=t&&(0,s.getResizedUrl)(t.headerLogo,"inside",125,35),z=(0,d.getPubPublishedDateString)(D),H=!(0,f.isPubPublic)(D,I),V=["large","medium"].includes(j),q=!a&&["minimal"].includes(j),W=!a&&["large","medium","small"].includes(j),G=!P&&["large","medium","small"].includes(j),K=!l&&["large","medium","small"].includes(j),J=D.description&&!O,Y=B&&["large","medium"].includes(j),$=function(e,t,n){var r=(0,p.bestPubUrl)({pubData:e,communityData:t});return n?n(r):r}(D,t||N,n),Q=function(){return u.default.createElement(y.default,{truncateAt:8,pubData:D,linkToUsers:!1,isExpanded:T})};return(0,u.useEffect)((function(){var e=L.current;e&&e.scrollHeight-e.clientHeight>0&&F(!0)}),[]),u.default.createElement("div",{className:(0,c.default)("pub-preview-component",j+"-preview",T&&"expanded")},u.default.createElement("div",{className:"preview-image-wrapper"},V&&u.default.createElement("a",{href:$,title:D.title},u.default.createElement(b.PreviewImage,{src:D.avatar,id:D.id}))),u.default.createElement("div",{className:"content-wrapper"},u.default.createElement("div",{className:"content",ref:L},q&&u.default.createElement("div",{className:"authors",style:{color:N.accentColorDark}},Q()),u.default.createElement("div",{className:"title-wrapper"},t&&u.default.createElement("a",{href:(0,p.communityUrl)(t),title:t.title,className:"community-banner",style:{backgroundColor:t.accentColorDark}},u.default.createElement("img",{alt:"in Community "+t.title,src:U})),u.default.createElement("a",{href:$,title:D.title},u.default.createElement("h3",{className:"pub-title"},u.default.createElement(b.PubTitle,{pubData:D}),H&&u.default.createElement(b.Icon,{className:"lock-icon",icon:"lock2"})))),W&&u.default.createElement("div",{className:"authors"},Q()),K&&u.default.createElement(_.default,{attributions:(0,m.getAllPubContributors)(D,"contributors"),truncateAt:6,className:"contributor-avatars"}),G&&u.default.createElement("div",{className:"date-details"},z?u.default.createElement("span",{className:"date"},"Published: ",z):u.default.createElement("span",{className:"date"},"Unpublished")),J&&u.default.createElement("div",{className:"description"},D.description),!S&&u.default.createElement(g.default,{pubData:D,accentColor:N.accentColorDark})),Y&&u.default.createElement(v.default,{accentColor:N.accentColorDark,isExpanded:T,onClick:function(){return A(!T)}})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPubPublic=void 0;t.isPubPublic=function(e,t){return e.releases.length||t.canViewDraft}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(112),o=n(6);n(1158);t.default=function(e){var t=e.accentColor,n=e.isExpanded,r=e.onClick;return a.default.createElement(i.Button,{as:"div",className:"expand-button-component",onClick:r,"aria-hidden":!0},a.default.createElement("div",{className:"relative-container"},a.default.createElement("div",{className:"icon-container",style:{color:t}},a.default.createElement(o.Icon,{icon:n?"chevron-up":"chevron-down"}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(132),u=i(n(217));n(1160);t.default=function(e){var t=e.pubData,n=e.truncateAt,i=e.isExpanded,c=a(e,["pubData","truncateAt","isExpanded"]),s=(0,l.getAllPubContributors)(t,"contributors",!1,!0),d=s.length>n;return 0===s.length?null:i&&d?o.default.createElement(o.default.Fragment,null,o.default.createElement(u.default,{contributors:s,linkToUsers:!1})):o.default.createElement(u.default,r({contributors:s,renderTruncation:function(e){return e+" more"},truncateAt:n},c))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),u=n(6),c=n(35),s=n(62),d=n(280),f=n(9);n(1162);var m={bylinePrefix:null,truncateAt:1,ampersand:!0};t.default=function(e){var t=(0,f.usePageContext)().communityData,n=e.accentColor,o=function(e){var t=e.inboundEdges,n=void 0===t?[]:t,r=e.outboundEdges,o=void 0===r?[]:r;return i(i([],a(n.filter((function(t){if(!t.pubIsParent){var n=t.pub;if(n)return n.communityId===e.communityId}return!1}))),!1),a(o.filter((function(e){return e.pubIsParent}))),!1)}(e.pubData);if(0===o.length)return null;var p,h=(p={},o.forEach((function(e){var t=e.relationType;p[t]=p[t]||[],p[t].push(e)})),p),b="1a71ef4d-f6fe-40d3-8379-42fa2141db58"===t.id;return l.default.createElement("div",{className:"pub-preview-edges-component"},l.default.createElement("div",{className:"hairline"}),l.default.createElement("div",{className:"heading",style:{color:n}},l.default.createElement("div",{className:"icon-container"},l.default.createElement(u.Icon,{icon:"layout-auto",iconSize:12})),"Connections"),l.default.createElement("div",{className:"listing"},Object.keys(h).sort().map((function(e){var t=(0,d.getRelationTypeName)(e,!0),a=h[e];return l.default.createElement("div",{className:"edge-list",key:"edge-list-"+e},l.default.createElement("strong",{style:{color:n}},t," (",a.length,"):"),"Â ",(0,s.intersperse)(a.map((function(e){return function(e,t){void 0===t&&(t=!1);var n=e.pubIsParent,a=e.targetPub,i=e.pub,o=e.externalPublication;if(o){var s=o.contributors,d=void 0===s?[]:s,f=o.title,p=o.url;return l.default.createElement("a",{href:p,key:e.id,className:"edge-link"},t?f:l.default.createElement(u.Byline,r({},m,{contributors:d,renderEmptyState:function(){return f}})))}var h=n?a:i;return l.default.createElement("a",{href:(0,c.pubShortUrl)(h),key:e.id,className:"edge-link"},t?h.title:l.default.createElement(u.PubByline,r({},m,{pubData:h,linkToUsers:!1,renderEmptyState:function(){return h.title}})))}(e,b)}))," â€¢ "))}))))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=o(n(0)),f=s(n(117)),m=n(5),p=n(35),h=n(67),b=n(9),v=n(18),y=n(6);n(1167);t.default=function(e){var t,n,a=e.isOpen,i=e.onClose,o=e.historyKey,s=e.pub,g=e.onCreateRelease,_=(0,b.usePageContext)().communityData,E=c((0,d.useState)({}),2),P=E[0],w=E[1],O=c((0,d.useState)(!1),2),C=O[0],S=O[1],D=c((0,d.useState)(!1),2),k=D[0],j=D[1],M=c((0,d.useState)(null),2),N=M[0],I=M[1],x=s.releases,T=x?x.length:0,A=x[T-1],R=function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){return S(!0),function(e){var t=e.historyKey,n=e.pubId,r=e.communityId,a=e.noteContent,i=e.noteText;return(0,v.apiFetch)("/api/releases",{method:"POST",body:JSON.stringify({pubId:n,communityId:r,noteContent:a,noteText:i,historyKey:t})})}({communityId:_.id,pubId:s.id,noteContent:P.content,noteText:P.text,historyKey:o}).then((function(e){I(null),j(e),S(!1),null==g||g(e)})).catch((function(e){I(e),S(!1)})),[2]}))}))},B=function(e,t){return d.default.createElement("div",null,d.default.createElement("p",{className:"text-info"},e),d.default.createElement(m.ControlGroup,{className:"url-select"},d.default.createElement(m.InputGroup,{className:"display-url",value:t,fill:!0,small:!0,disabled:!0}),d.default.createElement(y.ClickToCopyButton,{minimal:!0,copyString:t,icon:"duplicate",beforeCopyPrompt:"Copy URL to clipboard",afterCopyPrompt:"Copied URL!"})))};return d.default.createElement(m.Dialog,{lazy:!0,title:"Publish",onClose:i,isOpen:a,className:"pub-release-dialog-component"},d.default.createElement("div",{className:m.Classes.DIALOG_BODY},!k&&d.default.createElement(d.default.Fragment,null,T<1&&d.default.createElement("p",null,"To publish this Pub, you can ",d.default.createElement("i",null,"create a Release")," that will make the pub available at a publicly accessible URL."),A&&(t=A,n=(0,p.pubUrl)(_,s,{releaseNumber:T}),d.default.createElement(d.default.Fragment,null,d.default.createElement("p",null,d.default.createElement(m.Icon,{icon:"history",iconSize:12,color:"#888888"})," The previous Release (",d.default.createElement("a",{href:n,rel:"noopener noreferrer",target:"_blank"},"#"+T),") was created ",d.default.createElement(f.default,r({},h.timeAgoBaseProps,{date:t.createdAt})),"."),d.default.createElement("p",null,"You are about to create the next Release (#",T+1,"), making it the latest release of this Pub that readers will be shown by default."))),d.default.createElement("p",{className:"notes-header"},d.default.createElement(m.Icon,{icon:"manually-entered-data",iconSize:12}),"  ","Release Note"),d.default.createElement(y.MinimalEditor,{onContent:w,focusOnLoad:!0,placeholder:"(optional) Add a note describing this new Release.\r\nThis will be included in the publicly-visible changelog of this Pub."})),function(){if(N)return d.default.createElement(m.Callout,{intent:"warning",title:"There was an error creating this release."});if(k){if(x&&1===T){var e=x[T-1],t=(0,h.formatDate)(e.createdAt,{includeTime:!0,includePreposition:!0});return d.default.createElement(d.default.Fragment,null,d.default.createElement(m.Callout,{intent:"success",title:"Created Release #1",icon:"tick-circle"},d.default.createElement("span",{className:"release-date"},t)),d.default.createElement("p",{className:"text-info"},"Congratulations! You have just created the first Release of this pub that is publicly viewable."),B("Link that always points to the latest Release for this pub:",(0,p.pubUrl)(_,s)))}if(x&&T>1){e=x[T-1],t=(0,h.formatDate)(e.createdAt,{includeTime:!0,includePreposition:!0});var n=(0,p.pubUrl)(_,s,{releaseNumber:T});return d.default.createElement(d.default.Fragment,null,d.default.createElement(m.Callout,{intent:"success",title:"Created Release #"+T,icon:"tick-circle"},d.default.createElement("span",{className:"release-date"},t,". This is now the latest Release of this pub.")),B("Link to access Release #"+T+" specifically:",n),B("Link that always points to the latest Release for this pub:",(0,p.pubUrl)(_,s)),d.default.createElement("p",{className:"text-info"},"Older Releases can be viewed using the"," ",d.default.createElement(m.Icon,{icon:"history",iconSize:12,color:"#888888"})," History button in the Pub."))}}return null}()),d.default.createElement("div",{className:m.Classes.DIALOG_FOOTER},d.default.createElement("div",{className:m.Classes.DIALOG_FOOTER_ACTIONS},k&&d.default.createElement(d.default.Fragment,null,d.default.createElement(m.Button,{onClick:i},"Return to draft"),d.default.createElement(m.AnchorButton,{intent:"primary",href:(0,p.pubUrl)(_,s)},"Go to latest Release")),!k&&d.default.createElement(d.default.Fragment,null,d.default.createElement(m.Button,{disabled:C,onClick:i},"Return to draft"),d.default.createElement(m.Button,{loading:C,intent:"primary",onClick:R},x&&T<1?"Create Release":"Create Release #"+(T+1))))))}},,,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=n(9),f=n(18);n(1169);var m=function(e){var t=e.isOpen,n=e.onClose,r=e.pubData,a=e.updatePubData,i=(0,d.usePageContext)().communityData,m=o((0,u.useState)({}),2),p=m[0],h=m[1],b=o((0,u.useState)(!1),2),v=b[0],y=b[1],g=o((0,u.useState)(!1),2),_=g[0],E=g[1],P=o((0,u.useState)(null),2),w=P[0],O=P[1],C=function(){y(!0),(0,f.apiFetch)("/api/reviews",{method:"POST",body:JSON.stringify({communityId:i.id,pubId:r.id,content:p.content,text:p.text,releaseRequested:!0})}).then((function(e){O(null),E(e),y(!1),a((function(t){return{reviews:l(l([],o(t.reviews),!1),[e],!1)}}))})).catch((function(e){O(e),y(!1)}))};return u.default.createElement(c.Dialog,{lazy:!0,title:"Request Publication",onClose:n,isOpen:t,className:"pub-release-review-dialog-component"},u.default.createElement("div",{className:c.Classes.DIALOG_BODY},!_&&u.default.createElement(u.default.Fragment,null,u.default.createElement("p",null,"To request publication, you can create a Review that will be sent to the community managers."),u.default.createElement(s.MinimalEditor,{onContent:h,focusOnLoad:!0,placeholder:"Add a note for the community managers."})),w?u.default.createElement(c.Callout,{intent:"warning",title:"There was an error creating this review."}):_?u.default.createElement(c.Callout,{intent:"success",title:"Created Review!"},"Your Review requesting publication was succesfully created!"):null),u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER},u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS},_&&u.default.createElement(u.default.Fragment,null,u.default.createElement(c.Button,{onClick:n},"Close"),u.default.createElement(c.AnchorButton,{intent:"primary",href:"/dash/pub/"+r.slug+"/reviews/"+_.number},"Go to Review")),!_&&u.default.createElement(u.default.Fragment,null,u.default.createElement(c.Button,{disabled:v,onClick:n},"Cancel"),u.default.createElement(c.Button,{loading:v,intent:"primary",onClick:C},"Create Review")))))};m.defaultProps={},t.default=m},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=n(6),u=n(9),c=n(457),s=n(35),d=n(39);n(1171);var f=function(e){var t=e.pubData,n=(0,u.usePageContext)(),a=n.communityData,c=n.featureFlags,f=(0,d.usePubContext)().historyData,m=t.reviewHash,p=t.viewHash,h=t.editHash,b=function(e,t){return i.default.createElement(o.ControlGroup,{className:"hash-row"},i.default.createElement(l.ClickToCopyButton,{minimal:!1,copyString:t},"Copy ",e," URL"),i.default.createElement(o.InputGroup,{className:"display-url",value:t,fill:!0}))},v=!t.isRelease,y=function(e,n){return(0,s.pubUrl)(a,t,r({accessHash:e},n))},g=y(m,{historyKey:f.currentKey,isReview:!0});return i.default.createElement("div",{className:"access-hash-options"},i.default.createElement("p",null,"You can grant visitors permission to view, edit, or review the draft of this Pub by sharing a URL."),p&&b("View",y(p,{isDraft:v})),h&&b("Edit",y(h,{isDraft:v})),c.reviews&&b("Review",g))},m=function(e){var t=e.pubData.membersData.members,n=(0,u.usePendingChanges)().pendingCount,r=(0,u.usePageContext)().scopeData,a=r.activePermissions.canManage,s=r.elements,d=s.activeTargetName,f=s.activeTargetType,m=(0,c.useMembersState)({initialMembers:t}),p=m.membersByType,h=m.addMember,b=m.updateMember,v=m.removeMember,y=p[f];return i.default.createElement(i.default.Fragment,null,i.default.createElement("p",null,function(e,t,n){return n?"To let others collaborate on this "+e+", add them as Members."+("pub"===t?"":" They'll have access to all the Pubs it contains."):"Members can collaborate on this "+e+("pub"===t?".":" as well as all the Pubs it contains.")}(d,f,a)),a&&i.default.createElement(o.ControlGroup,{className:"add-member-controls"},i.default.createElement(l.UserAutocomplete,{onSelect:h,usedUserIds:y.map((function(e){return e.userId}))}),i.default.createElement(o.Button,{large:!0,text:"Add",intent:"primary",loading:n>0})),i.default.createElement("div",{className:"members-container"},p[f].map((function(e){return i.default.createElement(l.MemberRow,{memberData:e,isOnlyMemberInScope:1===p[f].length,isReadOnly:!a,onUpdate:b,onDelete:v,key:e.id})}))),!!p.collection.length&&"collection"!==f&&i.default.createElement(l.InheritedMembersBlock,{members:p.collection,scope:"Collection"}),!!p.community.length&&"community"!==f&&i.default.createElement(l.InheritedMembersBlock,{members:p.community,scope:"Community"}),!!p.organization.length&&"organization"!==f&&i.default.createElement(l.InheritedMembersBlock,{members:p.organization,scope:"Organization"}))};t.default=function(e){var t=e.isOpen,n=e.onClose,r=e.pubData,a=r.viewHash,u=r.editHash,c=!(!a&&!u);return i.default.createElement(o.Dialog,{lazy:!0,title:"Share Pub",className:"pub-share-dialog-component",isOpen:t,onClose:n},i.default.createElement(l.MenuConfigProvider,{config:{usePortal:!1}},i.default.createElement(l.PendingChangesProvider,null,i.default.createElement("div",{className:o.Classes.DIALOG_BODY},i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"pane"},i.default.createElement("h6",{className:"pane-title"},"Members"),i.default.createElement("div",{className:"pane-content"},i.default.createElement(m,{pubData:r}))),c&&i.default.createElement(i.default.Fragment,null,i.default.createElement(o.Divider,null),i.default.createElement("div",{className:"pane"},i.default.createElement("h6",{className:"pane-title"},"Share a URL"),i.default.createElement(f,{pubData:r}))))))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6),o=n(275),l=r(n(1173)),u=r(n(1174));n(1175),"undefined"!=typeof Image&&((new Image).src="/static/transparency.png");t.default=function(e){var t=e.updatePubData,n=e.pubData,r=e.communityData,c=n.headerBackgroundColor,s=n.headerBackgroundImage,d=n.headerStyle,f=function(e){return t({headerBackgroundColor:e})},m=function(e){return t({headerStyle:e})},p=c&&"community"!==c&&"dark"!==c&&"light"!==c;return a.default.createElement("div",{className:"theme-picker-component"},a.default.createElement("div",{className:"section"},a.default.createElement("div",{className:"title"},"Background image"),a.default.createElement(i.ImageUpload,{key:s,defaultImage:s,onNewImage:function(e){return t({headerBackgroundImage:e})},width:150,canClear:!0,helperText:a.default.createElement("span",null,"Suggested minimum dimensions: ",a.default.createElement("br",null),"1200px x 800px")})),a.default.createElement("div",{className:"section"},a.default.createElement("div",{className:"title"},"Background tint"),a.default.createElement("div",{className:"section-row"},a.default.createElement(u.default,{label:"Light",color:(0,o.calculateBackgroundColor)("light"),onClick:function(){return f("light")},selected:"light"===c}),a.default.createElement(u.default,{label:"Community accent color",color:(0,o.calculateBackgroundColor)("community",r.accentColorDark),onClick:function(){return f("community")},selected:"community"===c}),a.default.createElement(u.default,{label:"Dark",color:(0,o.calculateBackgroundColor)("dark"),onClick:function(){return f("dark")},selected:"dark"===c}),a.default.createElement(i.ColorInput,{value:p?c:"black",onChange:function(e){var t=e.rgb,n=t.r,r=t.g,a=t.b,i=t.a;f("rgba("+n+","+r+","+a+","+i+")")}},(function(e){return a.default.createElement(u.default,{label:"Custom",className:"light",color:e,selected:p})})))),a.default.createElement("div",{className:"section"},a.default.createElement("div",{className:"title"},"Text style"),a.default.createElement("div",{className:"section-row"},a.default.createElement(l.default,{pubData:n,communityData:r,label:"Light",className:"light",onClick:function(){return m("light")},selected:!d||"light"===d}),a.default.createElement(l.default,{pubData:n,communityData:r,label:"Dark",className:"dark",onClick:function(){return m("dark")},selected:"dark"===d}),a.default.createElement(l.default,{pubData:n,communityData:r,label:"White Blocks",className:"white-blocks",onClick:function(){return m("white-blocks")},selected:"white-blocks"===d}),a.default.createElement(l.default,{pubData:n,communityData:r,label:"Black Blocks",className:"black-blocks",onClick:function(){return m("black-blocks")},selected:"black-blocks"===d}))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(78),l=n(6),u=a.default.forwardRef((function(e,t){var n=e.label,r=e.className,u=e.onClick,c=e.selected,s=void 0!==c&&c,d=e.style,f=void 0===d?{}:d,m=e.pubData,p=e.communityData;return a.default.createElement(o.Button,{className:(0,i.default)("text-style-choice"),onClick:u,ref:t,title:n},a.default.createElement(l.PubHeaderBackground,{pubData:m,communityData:p,blur:!0,className:(0,i.default)("example",r,"selectable",s&&"selected"),style:f||{}},a.default.createElement("div",{className:"example-text"},"Aa")),a.default.createElement("div",{className:"label"},n))}));t.default=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(78),l=a.default.forwardRef((function(e,t){var n=e.label,r=e.onClick,l=e.color,u=e.selected;return a.default.createElement(o.Button,{className:"tint-choice",onClick:r,ref:t,title:n},a.default.createElement("div",{className:"example"},a.default.createElement("div",{className:"transparency"}),a.default.createElement("div",{className:(0,i.default)("inner","selectable",u&&"selected"),style:{backgroundColor:l}})),a.default.createElement("div",{className:"label"},n))}));t.default=l},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(9);t.default=function(e){var t=e.shouldUseHtmlTitle,n=e.pubData,r=n.title,o=n.htmlTitle,l=(0,i.usePageContext)().featureFlags;return(t||l.htmlTitles)&&o?a.default.createElement("span",{dangerouslySetInnerHTML:{__html:o}}):a.default.createElement(a.default.Fragment,null,r)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(57);t.default=function(e){var t=e.references,n=e.selectedReference,r=e.onSelect,o=n?n.icon:"disable",l=n?n.label:t.length?"No referenced item":"No items to reference";return a.default.createElement("div",{className:"controls-link-component"},a.default.createElement(i.MenuButton,{disabled:0===t.length,"aria-label":"Select an item to reference",buttonContent:l,buttonProps:{rightIcon:"chevron-down",minimal:!0,icon:o}},t.map((function(e){var t=e.icon,o=e.node,l=e.label;return a.default.createElement(i.MenuItem,{onClick:function(){r(e)},key:o.attrs.id,active:Boolean(n&&n.node===o),text:l,icon:t})}))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(107);n(1179);t.default=function(e){var t=e.children,n=e.emptyListPlaceholder,r=e.itemPredicate,l=e.items,u=e.onItemSelect,c=e.onClose,s=e.onQueryChange,d=e.position,f=void 0===d?"bottom-right":d,m=e.itemRenderer,p=e.searchPlaceholder,h=e.usePortal,b=void 0===h||h,v=e.query,y=e.createNewItemFromQuery,g=e.createNewItemRenderer,_=function(e){var t=e.handleKeyDown,n=e.handleKeyUp,r=e.handleQueryChange,o=e.itemList;return a.default.createElement("div",{className:"search-wrapper",onKeyDown:t,onKeyUp:n},a.default.createElement(i.InputGroup,{inputRef:function(e){return e&&setTimeout((function(){return e.focus()}),0)},placeholder:p,leftIcon:"search",onChange:r}),o)};return a.default.createElement(o.QueryList,{renderer:function(e){return a.default.createElement(i.Popover,{minimal:!0,popoverClassName:"query-list-dropdown-component",position:f,usePortal:b,onClose:c,content:_(e)},t)},itemRenderer:m,items:l,itemPredicate:r,onItemSelect:u,onQueryChange:s,query:v,noResults:a.default.createElement("div",{className:"empty-list"},n),createNewItemFromQuery:y,createNewItemRenderer:g})}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(3)),c=n(40),s=n(9),d=n(6),f=n(131),m=n(164),p=n(265);n(1181);var h=function(e,t,n){return!!e.find((function(e){return e.id===t.id&&e.members.find((function(e){return e.userId===n&&("manage"===e.permissions||"admin"===e.permissions)}))}))};t.default=function(e){var t=e.isDashboard,n=(0,s.usePageContext)(),r=n.loginData,a=n.locationData,i=n.communityData,o=n.scopeData,b=n.pageData,v=o.elements,y=v.activeCollection,g=v.activePub,_=o.activePermissions,E=_.canManageCommunity,P=_.canManage,w=a.params.collectionSlug||a.query.collectionSlug,O=a.params.pubSlug,C=(0,l.useMemo)((function(){return function(e,t){if(e&&e.collectionPubs&&0!==e.collectionPubs.length){var n=(0,f.getPrimaryCollectionPub)(e.collectionPubs)||(0,m.sortByRank)(e.collectionPubs,"pubRank")[0];return t.collections.find((function(e){return n.collectionId===e.id}))}}(g,i)}),[g,i]),S=[];return S.push({type:"Community",icon:p.pubPubIcons.community,title:i.title,avatar:i.avatar,href:(0,c.getDashUrl)({}),showSettings:E}),b&&E&&!t&&S.push({type:"Page",icon:p.pubPubIcons.page,iconSize:12,title:b.title,avatar:b.avatar,slugs:{pageSlug:b.slug||"home"},href:(0,c.getDashUrl)({mode:"pages",subMode:b.slug||"home"}),showSettings:E}),y&&S.push({type:"Collection",icon:p.pubPubIcons.collection,title:y.title,avatar:y.avatar,slugs:{collectionSlug:w},href:(0,c.getDashUrl)({collectionSlug:w}),showSettings:E||h(i.collections,y,r.id)}),!y&&C&&S.push({type:"Collection",icon:p.pubPubIcons.collection,title:C.title,avatar:C.avatar,slugs:{collectionSlug:C.slug},href:(0,c.getDashUrl)({collectionSlug:C.slug}),showSettings:E||h(i.collections,C,r.id)}),g&&S.push({type:"Pub",icon:p.pubPubIcons.pub,title:g.title,avatar:g.avatar,slugs:{pubSlug:""+O},href:(0,c.getDashUrl)({collectionSlug:w,pubSlug:O}),showSettings:P}),l.default.createElement("div",{className:(0,u.default)("scope-dropdown-component",t&&"in-dashboard")},t&&l.default.createElement("div",{className:"intro"},"Select Scope:"),l.default.createElement("div",{className:"scopes"},S.map((function(e,t){return l.default.createElement(d.MenuItem,{href:e.href,key:e.type,text:l.default.createElement("div",{className:"scope-item item-"+t},l.default.createElement("div",{className:"content"},l.default.createElement("div",{className:"top"},l.default.createElement(d.Icon,{icon:e.icon,iconSize:e.iconSize||10}),e.type),l.default.createElement("div",{className:"bottom"},l.default.createElement(d.Avatar,{avatar:e.avatar,initials:e.title[0],width:18,isBlock:!0}),e.title)),e.showSettings&&"Page"!==e.type&&l.default.createElement("div",{className:"settings"},l.default.createElement("a",{href:(0,c.getDashUrl)({collectionSlug:e.slugs&&e.slugs.collectionSlug,pubSlug:e.slugs&&e.slugs.pubSlug,mode:"settings"})},l.default.createElement(d.Icon,{icon:p.pubPubIcons.settings,iconSize:12})),l.default.createElement("a",{href:(0,c.getDashUrl)({collectionSlug:e.slugs&&e.slugs.collectionSlug,pubSlug:e.slugs&&e.slugs.pubSlug,mode:"members"})},l.default.createElement(d.Icon,{icon:p.pubPubIcons.member,iconSize:12})),l.default.createElement("a",{href:(0,c.getDashUrl)({collectionSlug:e.slugs&&e.slugs.collectionSlug,pubSlug:e.slugs&&e.slugs.pubSlug,mode:"impact"})},l.default.createElement(d.Icon,{icon:p.pubPubIcons.impact,iconSize:12})),"Collection"===e.type&&l.default.createElement("a",{href:(0,c.getDashUrl)({collectionSlug:e.slugs&&e.slugs.collectionSlug,pubSlug:e.slugs&&e.slugs.pubSlug,mode:"layout"})},l.default.createElement(d.Icon,{icon:p.pubPubIcons.layout,iconSize:12})),l.default.createElement("a",{href:"/"+(e.slugs&&e.slugs.pubSlug&&"pub/"+e.slugs.pubSlug||e.slugs&&e.slugs.collectionSlug)},l.default.createElement(d.Icon,{icon:"globe",iconSize:12}))),e.showSettings&&"Page"===e.type&&l.default.createElement("div",{className:"settings"},l.default.createElement("a",{href:"/"+(e.slugs&&e.slugs.pageSlug||"/")},l.default.createElement(d.Icon,{icon:"globe",iconSize:12}))))})}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(64);n(1183);t.default=function(e){var t=e.className,n=e.title,r=e.id,a=e.children,i=o((0,u.useState)(!1),2),l=i[0],d=i[1];return(0,u.useEffect)((function(){window&&r&&r===window.location.hash.slice(1)&&d(!0)}),[r]),u.default.createElement("div",{onClick:function(){return d(!1)},className:(0,c.default)("settings-section-component",l&&"emphasized",t),id:r||(0,s.slugifyString)(e.title)},u.default.createElement("div",{className:"title"},n),u.default.createElement("div",{className:"content"},a))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10));n(1185);var o={content:i.default.node.isRequired,options:i.default.node,isAddCard:i.default.bool,isFlatCard:i.default.bool},l={options:void 0,isAddCard:!1,isFlatCard:!1},u=function(e){return a.default.createElement("div",{className:"sharing-card-component "+(e.isAddCard?"add":"")+" "+(e.isFlatCard?"flat bp3-elevation-0":"bp3-elevation-1")},a.default.createElement("div",{className:"content"},e.content),e.options&&a.default.createElement("div",{className:"options"},e.options))};u.propTypes=o,u.defaultProps=l,t.default=u},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var u=n(41),c=i(n(0)),s=n(1187),d=n(6),f=n(39);t.default=function(e){var t=(0,f.usePubContext)(),n=t.noteManager,r=t.pubData.nodeLabels,a=e.onChange,i=e.placeholder,m=e.initialHtmlString,p=(0,c.useRef)();p.current||(p.current=(0,u.getDocForHtmlString)(m,u.editorSchema).toJSON());var h=(0,c.useCallback)((function(e){var t=e.type.schema;if((0,u.isEmptyDocNode)(e))a("");else{var i=(0,s.renderToString)(c.default.createElement.apply(c.default,l([c.default.Fragment,{}],o((0,u.renderStatic)({schema:t,doc:e.toJSON(),nodeLabels:r,noteManager:n})),!1)));a(i)}}),[a,r,n]);return c.default.createElement(d.MinimalEditor,{onEdit:h,placeholder:i,initialContent:p.current,useFormattingBar:!0,isTranslucent:!0,constrainHeight:!0})}},,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5);n(1190);t.default=function(e){var t=e["aria-label"],n=e.disabled,r=void 0!==n&&n,o=e.inputStepSize,l=void 0===o?10:o,u=e.labelRenderer,c=void 0!==u&&u,s=e.labelStepSize,d=e.leftLabel,f=void 0===d?null:d,m=e.max,p=e.min,h=e.onChange,b=e.rightLabel,v=void 0===b?null:b,y=e.sliderStepSize,g=void 0===y?1:y,_=e.value,E=function(e){var t=e.target.value,n=parseInt(t,10),r=Math.max(p,Math.min(m,n));Number.isNaN(n)||h(r,!0)};return a.default.createElement("div",{className:"slider-input-component"},a.default.createElement("div",{className:"left-label"},f),a.default.createElement(i.Slider,{min:p,max:m,stepSize:g,value:_,onChange:function(e){return h(e,!1)},onRelease:function(e){return h(e,!0)},labelRenderer:c,disabled:r,labelStepSize:s}),a.default.createElement(i.NumericInput,{value:_,min:p,max:m,stepSize:l,buttonPosition:"none",disabled:r,"aria-label":t,clampValueOnBlur:!0,onKeyDown:function(e){"Enter"===e.key&&E(e)},onBlur:E}),a.default.createElement("div",{className:"right-label"},v))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1192);t.default=function(e){var t=e.targetId,n=e.children;return a.default.createElement(i.TabToShow,{className:"skip-link-component",href:"#"+t,children:n})}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(35);t.default=function(e){var t=e.community,n=e.customText,r=e.submissionTitle,o=e.collectionTitle,l=e.submissionUrl,u=e.submitterName,c=e.kind,s=a.default.createElement("a",{href:(0,i.communityUrl)(t)},t.title),d=l?a.default.createElement("a",{href:l},r):a.default.createElement("u",null,r),f=a.default.createElement(a.default.Fragment,null,"Your submission ",d," to ",a.default.createElement("i",null,o)," in ",s);return a.default.createElement("div",null,a.default.createElement("p",null,"Hello ",u,","),a.default.createElement("p",null,"received"===c?a.default.createElement(a.default.Fragment,null,f," has been received. You may reply to this email thread to reach us."):"accepted"===c?a.default.createElement(a.default.Fragment,null,f," has been accepted."):a.default.createElement(a.default.Fragment,null,f," has been declined.")),n)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=n(6),u=n(220),c=n(1195),s=[{value:"active",label:i.default.createElement(i.default.Fragment,null,"Enabled")},{value:"inactive",label:i.default.createElement(i.default.Fragment,null,"Disabled")}],d=[{value:"active",label:i.default.createElement(i.default.Fragment,null,"Enabled")},{value:"inactive",label:i.default.createElement(i.default.Fragment,null,"Only if subscribed to Pub")},{value:"muted",label:i.default.createElement(i.default.Fragment,null,"Muted")}],f={active:"notifications-updated",inactive:"notifications",muted:"ban-circle"};t.default=function(e){var t=e.target,n=e.subscription,a=e.parentSubscription,m=e.onUpdateSubscription,p=e.children,h=e.menuLabel,b=(0,c.useSubscriptionState)({target:t,subscription:n,parentSubscription:a,onUpdateSubscription:m}),v=b.status,y=b.isLoading,g=b.updateStatus,_="pubId"in t,E=_?"Pub":"thread",P=_?s:d,w=f[v];return i.default.createElement(l.Menu,{"aria-label":"Manage subscription",disclosure:function(e){return(0,u.adaptDisclosureElementForBlueprintButton)(p,r(r({},e),{loading:y,icon:w}),e.visible)}},i.default.createElement("li",{className:o.Classes.MENU_HEADER},i.default.createElement("h6",{className:o.Classes.HEADING},h||"Notifications for this "+E)),P.map((function(e){var t=e.value,n=e.label;return i.default.createElement(l.MenuItem,{key:t,text:n,active:t===v,icon:f[t],onClick:function(){return g(t)}})})))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useSubscriptionState=void 0;var o=n(0),l=n(18),u=function(e){return e?e.status:"inactive"};t.useSubscriptionState=function(e){var t=e.subscription,n=e.parentSubscription,c=void 0===n?null:n,s=e.target,d=e.onUpdateSubscription,f=i((0,o.useState)(!1),2),m=f[0],p=f[1];return{status:u(t),parentStatus:u(c),updateStatus:function(e){return r(void 0,void 0,void 0,(function(){var t,n;return a(this,(function(r){switch(r.label){case 0:return p(!0),"pubId"in s?(t=d,[4,l.apiFetch.put("/api/pubs/subscriptions",{pubId:s.pubId,status:e})]):[3,2];case 1:t.apply(void 0,[r.sent()]),r.label=2;case 2:return"threadId"in s?(n=d,[4,l.apiFetch.put("/api/threads/subscriptions",{threadId:s.threadId,status:e})]):[3,4];case 3:n.apply(void 0,[r.sent()]),r.label=4;case 4:return p(!1),[2]}}))}))},isLoading:m}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(10)),u=i(n(3));n(1197);var c={children:l.default.node.isRequired,className:l.default.string,holdOpen:l.default.bool,onFocus:l.default.func,tagName:l.default.string},s=o.default.forwardRef((function(e,t){var n=e.children,i=e.className,l=e.holdOpen,c=e.onFocus,s=e.tagName,d=a(e,["children","className","holdOpen","onFocus","tagName"]);return o.default.createElement(s,r(r({},d),{ref:t,tabIndex:0,onFocus:c,className:(0,u.default)(i,"tab-to-show-component",l&&"hold-open")}),n)}));s.propTypes=c,s.defaultProps={className:"",holdOpen:!1,tagName:"a",onFocus:function(){}},t.default=s},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=c(n(3)),d=n(71),f=o(n(0)),m=n(6);n(1199);var p=new Set(["i","em","b","strong"]);function h(e){var t,n,r;if(p.has(e.tagName.toLowerCase()))if(function(e){for(;e.attributes.length>0;)e.removeAttribute(e.attributes[0].name)}(e),e.nodeType===Node.ELEMENT_NODE)for(var a=e.children.length-1;a>=0;a--)h(e.children[a]);else e.nodeType===Node.TEXT_NODE&&(e.textContent=null!==(r=null===(n=e.textContent)||void 0===n?void 0:n.replace(/[\r\n]+/gm,""))&&void 0!==r?r:null);else{var i=e.parentNode;if(null!==e.textContent&&e.textContent.length>0){var o=document.createTextNode(null!==(t=e.textContent)&&void 0!==t?t:"");i.replaceChild(o,e)}else i.removeChild(e)}}var b={role:"textbox","aria-label":"Edit Pub title",tabIndex:0};t.default=function(e){var t=e.initialValue,n=void 0===t?"":t,a=e.onChange,i=e.onInput,o=e.isReadOnly,c=void 0!==o&&o,p=l(e,["initialValue","onChange","onInput","isReadOnly"]),v=(0,f.useRef)(null),y=(0,f.useRef)(!1),g=u((0,f.useState)(!1),2),_=g[0],E=g[1],P=r(r(r({},b),p),{className:(0,s.default)("title-editor-component",p.className),"data-placeholder":p.placeholder}),w=(0,f.useCallback)((function(e){e.preventDefault();var t=v.current;if(null!==t){var n=getSelection();if(null!==n){var r=n.getRangeAt(0),a=function(e){var t=document.createElement("template");return t.innerHTML=e,t}(e.clipboardData.getData("text/html"));!function(e){for(var t=e.children.length-1;t>=0;t--)h(e.children[t])}(a.content);var i=!1;if("execCommand"in document&&(i=document.execCommand("insertHTML",!1,a.innerHTML)),!1===i){var o=n.focusNode;if(!o)return;if(!function(e,t){for(var n=e;null!==n;){if(n===t)return!0;n=n.parentNode}return!1}(o,t))return;r.deleteContents(),r.insertNode(a.content),r.collapse(!1)}}}}),[v]),O=(0,f.useCallback)((function(e){"Enter"===e.key||"u"===e.key.toLowerCase()&&e.metaKey?e.preventDefault():"b"===e.key.toLowerCase()&&e.metaKey?(e.preventDefault(),document.execCommand("Bold",!1)):"i"===e.key.toLowerCase()&&e.metaKey&&(e.preventDefault(),document.execCommand("Italic",!1))}),[]),C=(0,f.useCallback)((function(){var e,t,n,r,a;if(""===(null===(e=v.current)||void 0===e?void 0:e.textContent)&&(v.current.innerHTML=""),i){var o=null!==(n=null===(t=v.current)||void 0===t?void 0:t.innerHTML)&&void 0!==n?n:"",l=null!==(a=null===(r=v.current)||void 0===r?void 0:r.innerText)&&void 0!==a?a:"";i(o,l)}}),[v,i]),S=(0,f.useCallback)((function(){E(!0)}),[]),D=(0,f.useCallback)((function(){var e,t,n,r,i=null!==(t=null===(e=v.current)||void 0===e?void 0:e.innerHTML)&&void 0!==t?t:"",o=null!==(r=null===(n=v.current)||void 0===n?void 0:n.innerText)&&void 0!==r?r:"";null==a||a(i,o),E(!1)}),[a]);(0,f.useEffect)((function(){y.current||v.current&&(v.current.innerHTML=n,y.current=!0)}),[n,a]),(0,d.useBeforeUnload)((function(){var e;return!c&&_&&(null===(e=v.current)||void 0===e?void 0:e.innerHTML)!==n}),"You have unsaved changes to this Pub. Are you sure you want to navigate away?");var k=f.default.createElement("div",r({},P,{contentEditable:!c,dangerouslySetInnerHTML:{__html:n}}));return c?k:f.default.createElement(m.ClientOnly,{fallback:k},f.default.createElement("div",r({},P,{contentEditable:!0,ref:v,onKeyDown:O,onPaste:w,onInput:C,onFocus:S,onBlur:D})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(1201)),u=i(n(1203));n(1205);t.default=function(e){var t=e.threadData,n=a(a([],r(t.comments),!1),r(t.events),!1);return o.default.createElement("div",{className:"thread-component clearfix"},n.sort((function(e,t){return e.createdAt>t.createdAt?1:e.createdAt<t.createdAt?-1:0})).filter((function(e){return!(e.data&&"created"===e.data.statusChange)})).map((function(e){return e.content?o.default.createElement(l.default,{key:e.id,commentData:e}):o.default.createElement(u.default,{key:e.id,eventData:e})})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(117)),l=n(6),u=n(67),c=a(n(41));n(1202);t.default=function(e){var t=e.commentData,n=t.author,a=t.content,s=t.createdAt;return i.default.createElement("div",{className:"thread-comment2-component"},i.default.createElement("div",{className:"header"},i.default.createElement(l.Avatar,{width:30,initials:n.initials,avatar:n.avatar}),i.default.createElement("div",{className:"comment-title"},i.default.createElement("a",{className:"hoverline",href:"/user/"+n.slug},n.fullName)," ","said ",i.default.createElement(o.default,r({},u.timeAgoBaseProps,{date:s})))),i.default.createElement("div",{className:"content"},i.default.createElement(c.default,{initialContent:a,isReadOnly:!0})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=a(n(117)),l=n(6),u=n(9),c=n(67);n(1204);t.default=function(e){var t=e.eventData,n=t.type,a=t.data,s=t.user,d=t.createdAt,f=(0,u.usePageContext)().communityData.accentColorDark,m=i.default.createElement(o.default,r({},c.timeAgoBaseProps,{date:d}));return i.default.createElement("div",{className:"thread-event-component"},i.default.createElement("style",null,".status-block.released { background: "+f),i.default.createElement(l.Icon,{className:"status-block "+a.statusChange,iconSize:14,icon:{created:"clean",completed:"tick",closed:"disable",released:"document-share"}[a.statusChange],color:"#fff"}),i.default.createElement(l.Avatar,{width:18,initials:s.initials,avatar:s.avatar}),i.default.createElement("div",null,i.default.createElement("a",{className:"hoverline",href:"/user/"+s.slug},s.fullName),"status"===n&&"created"===a.statusChange&&i.default.createElement("span",null," created this review ",m),"status"===n&&"closed"===a.statusChange&&i.default.createElement("span",null," closed this review ",m),"status"===n&&"completed"===a.statusChange&&i.default.createElement("span",null," marked this review complete ",m),"status"===n&&"released"===a.statusChange&&i.default.createElement("span",null," ","created a"," ",i.default.createElement("a",{className:"hoverline",href:"/pub/"+a.pubSlug+"/release/"+a.releaseNumber},i.default.createElement("b",null,"Release"))," ","from this review ",m)))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var d=o(n(0)),f=n(5),m=n(6),p=o(n(41)),h=n(116),b=n(9),v=n(18);n(1207);var y=function(e){var t=e.parentId,n=e.threadData,a=e.pubId,i=e.onThreadUpdate,o=(0,b.usePageContext)(),y=o.loginData,g=o.locationData,_=o.communityData,E=c((0,d.useState)(),2),P=E[0],w=E[1],O=c((0,d.useState)(Date.now()),2),C=O[0],S=O[1],D=c((0,d.useState)(!1),2),k=D[0],j=D[1];return d.default.createElement("div",{className:"thread-input-component"},!y.id&&d.default.createElement("div",{className:"thread-input-component"},d.default.createElement(f.AnchorButton,{text:"Login to Reply",href:"/login?redirect="+g.path,large:!0})),y.id&&d.default.createElement(d.default.Fragment,null,d.default.createElement("div",{className:"thread-comment2-component"},d.default.createElement("div",{className:"header"},d.default.createElement(m.Avatar,{width:30,initials:y.initials,avatar:y.avatar}),d.default.createElement("div",{className:"comment-title"},"Reply as ",y.fullName),P&&d.default.createElement(h.FormattingBar,{editorChangeObject:P,buttons:h.buttons.discussionButtonSet,isSmall:!0})),d.default.createElement("div",{className:"content"},d.default.createElement(p.default,{key:C,placeholder:"Add a comment...",onChange:w}))),d.default.createElement(f.Button,{className:"comment-button",text:"Add Comment",intent:f.Intent.PRIMARY,loading:k,onClick:function(){return l(void 0,void 0,void 0,(function(){var e,o;return u(this,(function(l){switch(l.label){case 0:return j(!0),[4,(0,v.apiFetch)("/api/threadComment",{method:"POST",body:JSON.stringify({accessHash:g.query.access,parentId:t,threadId:n.id,pubId:a,communityId:_.id,content:(0,p.getJSON)(P.view),text:(0,p.getText)(P.view)||""})})];case 1:return e=l.sent(),o=r(r({},n),{comments:s(s([],c(n.comments),!1),[e],!1)}),i(o),j(!1),S(Date.now()),[2]}}))}))}})))};y.defaultProps={onThreadUpdate:function(){}},t.default=y},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(117)),d=u(n(3)),f=n(67);t.default=function(e){var t=e.className,n=e.date,a=e.now,i=e.useDateCutoffDays,o=void 0===i?7:i,u=l((0,c.useState)((function(){return new Date})),1)[0],m=(0,c.useMemo)((function(){return new Date(n)}),[n]),p=(0,d.default)("time-ago-component",t),h=(0,c.useMemo)((function(){var e=864e5*o;return new Date(null!=a?a:u).valueOf()-m.valueOf()>e}),[m,u,a,o]),b=(0,c.useMemo)((function(){return a?{now:function(){return a}}:{}}),[a]);return h?c.default.createElement("time",{className:p,dateTime:m.toISOString()},(0,f.formatDate)(m)):c.default.createElement(s.default,r({},f.timeAgoBaseProps,b,{live:!1,date:m,className:p}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineItem=t.TimelineCondenser=t.Timeline=void 0;var a=n(1210);Object.defineProperty(t,"Timeline",{enumerable:!0,get:function(){return r(a).default}});var i=n(1212);Object.defineProperty(t,"TimelineCondenser",{enumerable:!0,get:function(){return r(i).default}});var o=n(460);Object.defineProperty(t,"TimelineItem",{enumerable:!0,get:function(){return r(o).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(459);n(1211);var l=function(e){var t=e.accentColor,n=e.children,r=e.className;return a.default.createElement("div",{className:(0,i.default)("timeline-component",r)},a.default.createElement(o.TimelineContext.Provider,{value:{accentColor:t}},n))};l.defaultProps={accentColor:null,className:""},t.default=l},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TimelineCondenser=void 0;var d=o(n(0)),f=n(5),m=s(n(460));t.TimelineCondenser=function(e){var t=u((0,d.useState)(!1),2),n=t[0],a=t[1],i=e.children,o=e.shownItemsLimit,s=l(e,["children","shownItemsLimit"]),p=d.default.Children.toArray(i);return p.length>o&&!n?d.default.createElement(d.default.Fragment,null,c(c([],u(p.slice(0,o)),!1),[d.default.createElement(m.default,{key:"__timeline-condenser-expand-element__",hollow:!0,icon:"expand-all",title:d.default.createElement("i",null,p.length-o," more hidden"),controls:d.default.createElement(f.Button,r({outlined:!0,onClick:function(){return a(!0)}},s),"Show all")})],!1)):d.default.createElement(d.default.Fragment,null,i)},t.default=t.TimelineCondenser},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var s=l(n(0)),d=n(5),f=n(107),m=n(6),p=n(18);n(1214);var h={allowCustomUser:!1,onSelect:function(){},placeholder:"Search for users...",usedUserIds:[]},b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={items:[],queryValue:""},n.inputRef=void 0,n.handleSelect=n.handleSelect.bind(n),n}return a(t,e),t.prototype.componentDidUpdate=function(e,t){var n=this,r=this.state.queryValue;r!==t.queryValue&&(0,p.apiFetch)("/api/search/users?q="+r).then((function(e){var t=n.props.usedUserIds;n.setState({items:e.filter((function(e){return!t.includes(e.id)}))})}))},t.prototype.handleSelect=function(e){this.props.onSelect(e),this.inputRef.focus()},t.prototype.render=function(){var e=this,t=this.props.allowCustomUser,n=this.state,r=n.queryValue,a=n.items,i=r?t?c([{name:r}],u(a),!1):a:[];return s.default.createElement("div",{className:"user-autocomplete-component"},s.default.createElement(f.Suggest,{className:"input",items:i,inputProps:{placeholder:this.props.placeholder,large:!0,inputRef:function(t){e.inputRef=t}},inputValueRenderer:function(){return""},onQueryChange:function(t){return e.setState({queryValue:t.trim()})},itemRenderer:function(e,t){var n=t.handleClick,r=t.modifiers;return s.default.createElement("li",{key:e.id||"empty-user-create"},s.default.createElement("button",{type:"button",tabIndex:-1,onClick:n,className:r.active?"bp3-menu-item bp3-active":"bp3-menu-item"},e.fullName&&s.default.createElement(m.Avatar,{initials:e.initials,avatar:e.avatar,width:25}),e.name&&s.default.createElement("span",null,"Add collaborator named: "),s.default.createElement("span",{className:"autocomplete-name"},e.name||e.fullName)))},resetOnSelect:!0,onItemSelect:this.handleSelect,noResults:r?s.default.createElement(d.MenuItem,{disabled:!0,text:"No results"}):null,popoverProps:{popoverClassName:"user-autocomplete-popover",minimal:!0,position:d.Position.BOTTOM_LEFT,modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}}}}))},t.defaultProps=h,t}(s.Component);t.default=b},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(6),c=n(9),s=o(n(1216)),d=n(1223),f=n(221);n(1242);t.default=function(e){var t=e.children,n=(0,c.usePageContext)().initialNotificationsData,r=(0,d.useNotificationsState)(),a=(0,l.useMemo)((function(){return function(e,t){if(t){var n=e.hasNotifications,r=t.pubStates,a=r.some((function(e){return e.threadStates.some((function(e){return e.notifications.some((function(e){return!e.isRead}))}))}));return{hasNotifications:r.length>0||n,hasUnreadNotifications:a}}return e}(n,null==r?void 0:r.state)}),[n,r]),i=a.hasNotifications,o=a.hasUnreadNotifications;if(i){var m=t({hasUnreadNotifications:o});if(r){var p=r.state,h=r.context;return l.default.createElement(f.UserNotificationsContext.Provider,{value:h},l.default.createElement(u.Popover,{"aria-label":"Notifications",placement:"bottom-end",className:"user-notifications-popover",content:l.default.createElement(s.default,{state:p}),preventBodyScroll:!1,unstable_fixed:!0},m))}return m}return null}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(5),d=n(221),f=l(n(1217)),m=l(n(1221));t.default=function(e){var t=e.state,n=t.pubStates,r=o((0,u.useState)(null),2),a=r[0],i=r[1],l=o((0,u.useState)(null),2),p=l[0],h=l[1],b=o((0,u.useState)(!1),2),v=b[0],y=b[1],g=(0,d.useNotificationsContext)().actions;return u.default.createElement("div",{ref:h,className:(0,c.default)("user-notifications-component",s.Classes.CARD,s.Classes.ELEVATION_2)},v?u.default.createElement(m.default,{preferences:t.notificationPreferences,onUpdatePreferences:g.updateUserNotificationPreferences,onClose:function(){return y(!1)}}):u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"top-controls-bar"},u.default.createElement(s.InputGroup,{fill:!0,leftIcon:"search",value:a||"",placeholder:"Filter threads",onChange:function(e){return i(e.target.value)}}),u.default.createElement(s.Button,{minimal:!0,className:"preferences-button",icon:"cog",onClick:function(){return y(!0)}})),u.default.createElement("div",{className:"pubs"},n.map((function(e){return u.default.createElement(f.default,{state:e,key:e.pub.id,filterTerm:a,container:p})})))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=l(n(3)),d=n(35),f=n(9),m=n(6),p=l(n(1218)),h=n(1220),b=n(221);t.default=function(e){var t=e.state,n=e.filterTerm,r=e.container,a=t.pub,i=t.community,l=t.threadStates,v=t.subscription,y=t.location,g=o((0,u.useState)(!0),2),_=g[0],E=g[1],P=o((0,u.useState)((function(){return"active"===(null==v?void 0:v.status)})),1)[0],w=(0,b.useNotificationsContext)().actions,O=(0,f.usePageContext)().communityData.id===i.id,C=(0,h.pubStateMatchesTerm)(t,n),S=!(!n||C),D=_||S,k=S?l.filter((function(e){return(0,h.threadStateMatchesTerm)(e,n)})):l;return 0===k.length?null:u.default.createElement("div",{className:(0,s.default)("pub-notifications-component",D&&"expanded")},u.default.createElement(m.PubHeaderBackground,{className:"header",pubData:a,communityData:i,blur:!0},u.default.createElement("div",{className:"header-content"},u.default.createElement(c.Button,{disabled:S,"aria-label":D?"Collapse Pub threads":"Expand Pub threads",className:"collapse-button",onClick:function(){return E((function(e){return!e}))},minimal:!0,icon:D?"chevron-down":"chevron-right"}),u.default.createElement("div",{className:"text-content"},u.default.createElement("div",{className:"title"},u.default.createElement("a",{href:(0,d.pubUrl)(i,a)},a.title)),!O&&u.default.createElement("div",{className:"community"},"in ",u.default.createElement("a",{href:(0,d.communityUrl)(i)},i.title))),u.default.createElement("div",{className:"controls"},P&&u.default.createElement(m.SubscriptionButton,{buttonProps:{small:!0},target:{pubId:y.pubId},subscription:v,onUpdateSubscription:function(e){return w.updateSubscriptionStatus(y,e)}},u.default.createElement(c.Button,{small:!0,minimal:!0,"aria-label":"Manage subscription"})),u.default.createElement(c.Button,{small:!0,minimal:!0,icon:"cross","aria-label":"Dismiss",onClick:function(){return w.dismissPubThreads(y,t)}})))),D&&k.map((function(e){return u.default.createElement(p.default,{key:e.thread.id,parentSubscription:v,state:e,container:r,communityAccentColor:i.accentColorDark})})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=l(n(80)),d=n(5),f=n(62),m=n(6),p=n(1219),h=n(221),b=function(e){return(0,f.unique)(e.map((function(e){return e.actor})).filter((function(e){return!!e})),(function(e){return e.id}))};t.default=function(e){var t=e.state,n=e.parentSubscription,r=e.container,a=e.communityAccentColor,i=t.notifications,l=t.location,f=t.subscription,v=t.activityItems,y=(0,h.useNotificationsContext)(),g=y.actions,_=y.notificationPreferences.markReadTrigger,E=i.every((function(e){return e.isRead})),P=i.some((function(e){return e.manuallySetIsRead})),w=function(e,t){var n=t?"#aaa":e;return{opaque:n,transparent:(0,s.default)(n).alpha(.04)}}(a,E),O=o((0,u.useState)(null),2),C=O[0],S=O[1],D=v[0],k=D.message,j=D.excerpt,M=D.timestamp;return(0,p.useElementSeen)({container:r,element:C,enabled:!P&&"seen"===_,alreadySeen:E,onElementSeen:function(){return g.updateThreadReadStatus(t,{isRead:!0,manuallySetIsRead:!1})}}),(0,u.useEffect)((function(){if(C&&!E&&"clicked-through"===_){var e=function(e){e.target instanceof HTMLAnchorElement&&g.updateThreadReadStatus(t,{isRead:!0,manuallySetIsRead:!0,useBeacon:!0})};return C.addEventListener("click",e),function(){C.removeEventListener("click",e)}}return function(){}}),[C,E,_,g,t]),u.default.createElement("div",{ref:S,className:(0,c.default)("thread-notifications-component",E&&"is-read"),style:E?{}:{backgroundColor:w.transparent}},u.default.createElement("div",{className:"top-details"},u.default.createElement(m.Avatars,{users:b(v),size:24,borderColor:w.opaque}),u.default.createElement("div",{className:"controls"},u.default.createElement(m.SubscriptionButton,{target:{threadId:l.threadId},subscription:f,parentSubscription:n,onUpdateSubscription:function(e){return g.updateSubscriptionStatus(l,e)}},u.default.createElement(d.Button,{small:!0,minimal:!0,"aria-label":"Manage subscription"})),u.default.createElement(d.Button,{small:!0,minimal:!0,icon:"cross","aria-label":"Dismiss",onClick:function(){return g.dismissThread(l,t)}}))),u.default.createElement("div",{className:"message"},u.default.createElement("span",{className:(0,c.default)("blip",E&&"is-read"),style:{color:w.opaque}}),k),u.default.createElement("div",{className:"excerpt"},j),u.default.createElement("div",{className:"bottom-details"},u.default.createElement(m.TimeAgo,{className:"time-ago",date:M}),u.default.createElement(d.Button,{small:!0,minimal:!0,className:"mark-read-button",icon:E?"envelope":"tick",onClick:function(){return g.updateThreadReadStatus(t,{isRead:!E,manuallySetIsRead:!0})}},E?"Mark unread":"Mark read")))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useElementSeen=void 0;var a=n(0);t.useElementSeen=function(e){var t=e.container,n=e.element,i=e.enabled,o=e.onElementSeen,l=e.alreadySeen,u=r((0,a.useState)(l),2),c=u[0],s=u[1],d=(0,a.useRef)(o);d.current=o,(0,a.useEffect)((function(){if(t&&n&&i&&!c){var e=new IntersectionObserver((function(e){var t;r(e,1)[0].isIntersecting&&(s(!0),null===(t=d.current)||void 0===t||t.call(d))}),{threshold:1,root:t});return e.observe(n),function(){return e.disconnect()}}return function(){}}),[t,n,i,c])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.threadStateMatchesTerm=t.pubStateMatchesTerm=void 0;var r=function(e,t){return t.toLowerCase().includes(e.toLowerCase().trim())};t.pubStateMatchesTerm=function(e,t){var n=e.pub,a=e.community;return!t||(r(t,n.title)||r(t,a.title)||r(t,a.subdomain))};t.threadStateMatchesTerm=function(e,t){if(t){if(e.activityItems.some((function(e){return!!e.actor&&r(t,e.actor.fullName)})))return!0;var n=e.notifications[0].activityItem.payload.threadComment.text;return!(!n||!r(t,n))}return!0}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6);n(1222);var l=[{value:0,label:"Immediately when they appear"},{value:15,label:"No more than once every 15 minutes"},{value:60,label:"No more than once an hour"},{value:240,label:"No more than once every 4 hours"},{value:480,label:"No more than once every 8 hours"}],u=[{value:"seen",label:"When seen"},{value:"clicked-through",label:"When clicked through"},{value:"manual",label:"Manually"}];t.default=function(e){var t=e.preferences,n=e.onUpdatePreferences,r=e.onClose,c=t.receiveNotifications,s=t.subscribeToThreadsAsCommenter,d=t.subscribeToPubsAsMember,f=t.subscribeToPubsAsContributor,m=t.notificationCadence,p=t.markReadTrigger,h=function(e){var r;n(((r={})[e]=!t[e],r))};return a.default.createElement("div",{className:"user-notification-preferences-component"},a.default.createElement("h4",{className:i.Classes.HEADING},"Notification preferences"),a.default.createElement("p",null,a.default.createElement(i.Switch,{label:"Receive notifications from PubPub",checked:c,onChange:function(){return h("receiveNotifications")}})),a.default.createElement(i.FormGroup,{label:"Automatically subscribe me to...",disabled:!c},a.default.createElement(i.Switch,{disabled:!c,label:"Threads that I comment in",checked:s,onChange:function(){return h("subscribeToThreadsAsCommenter")}}),a.default.createElement(i.Switch,{disabled:!c,label:"Pubs that I am added to as a Member",checked:d,onChange:function(){return h("subscribeToPubsAsMember")}}),a.default.createElement(i.Switch,{disabled:!c,label:"Pubs that I am added to as a contributor",checked:f,onChange:function(){return h("subscribeToPubsAsContributor")}})),a.default.createElement(i.FormGroup,{label:"Show new notifications...",disabled:!c},a.default.createElement(o.MenuSelect,{disabled:!c,"aria-label":"Select notification cadence",items:l,value:m,onSelectValue:function(e){return n({notificationCadence:e})}})),a.default.createElement(i.FormGroup,{label:"Mark notifications read...",disabled:!c},a.default.createElement(o.MenuSelect,{disabled:!c,"aria-label":"Select when notifications should be marked read",items:u,value:p,onSelectValue:function(e){return n({markReadTrigger:e})}})),a.default.createElement(i.Button,{icon:"tick",intent:"primary",onClick:r},"Done"))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.useNotificationsState=void 0;var i=n(0),o=n(9),l=n(18),u=n(461),c=n(1241);t.useNotificationsState=function(){var e=a((0,i.useState)(null),2),t=e[0],n=e[1],s=(0,i.useMemo)((function(){return(0,c.bindActions)(n)}),[]),d=(0,o.usePageContext)().loginData.id;return(0,i.useEffect)((function(){d&&l.apiFetch.get("/api/userNotifications").then((function(e){n((0,u.createInitialState)(r(r({},e),{userId:d})))}))}),[d]),t?{state:t,context:{notificationPreferences:t.notificationPreferences,actions:s}}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderActivityItem=void 0;var r=n(1225);t.renderActivityItem=function(e,t){var n=r.activityItemRenderers[e.kind];return(null==n?void 0:n(e,t))||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.activityItemRenderers=void 0;var r=n(1226),a=n(1236),i=n(1237),o=n(1238),l=n(1239),u=n(1240);t.activityItemRenderers={"community-created":r.renderCommunityCreated,"community-updated":r.renderCommunityUpdated,"collection-created":a.renderCollectionCreated,"collection-updated":a.renderCollectionUpdated,"collection-removed":a.renderCollectionRemoved,"collection-pub-created":a.renderCollectionPubCreated,"collection-pub-removed":a.renderCollectionPubRemoved,"page-created":i.renderPageCreated,"page-updated":i.renderPageUpdated,"page-removed":i.renderPageRemoved,"pub-created":o.renderPubCreated,"pub-updated":o.renderPubUpdated,"pub-removed":o.renderPubRemoved,"pub-release-created":o.renderPubReleased,"pub-edge-created":o.renderPubEdgeCreated,"pub-edge-removed":o.renderPubEdgeRemoved,"pub-discussion-comment-added":o.renderPubDiscussionCommentAdded,"pub-review-created":o.renderPubReviewCreated,"pub-review-comment-added":o.renderPubReviewCommentAdded,"pub-review-updated":o.renderPubReviewUpdated,"member-created":l.renderMemberCreated,"member-updated":l.renderMemberUpdated,"member-removed":l.renderMemberRemoved,"submission-status-updated":u.renderSubmissionUpdated}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderCommunityUpdated=t.renderCommunityCreated=void 0;var a=r(n(0)),i=n(136),o=n(166);t.renderCommunityCreated=(0,o.itemRenderer)({icon:"office",titleRenderers:{community:i.communityTitle},message:function(e){var t=e.titles,n=t.actor,r=t.community;return a.default.createElement(a.default.Fragment,null,n," created ",r)}}),t.renderCommunityUpdated=(0,o.itemRenderer)({icon:"office",titleRenderers:{community:i.communityTitle},message:function(e){var t=e.titles,n=e.item.payload,r=t.actor,i=t.community;if(n.subdomain){var o=n.subdomain,l=o.from,u=o.to;return a.default.createElement(a.default.Fragment,null,r," changed the subdomain of ",i," from ",l," to ",u)}if(n.title){var c=n.title;l=c.from,u=c.to;return a.default.createElement(a.default.Fragment,null,r," changed the title of ",i," from ",a.default.createElement("i",null,l)," to ",a.default.createElement("i",null,u))}return a.default.createElement(a.default.Fragment,null,r," updated the settings for ",i)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.discussionTitle=void 0;var r=n(35),a=n(106);t.discussionTitle=function(e,t){var n=(0,a.getPubFromContext)(e.pubId,t),i=n&&t.associations.community[n.communityId];return{title:e.payload.isReply?"a reply to a Discussion":"a new Discussion",href:n?(0,r.pubUrl)(i,n,{discussionId:e.payload.discussionId}):null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pageTitle=void 0;var r=n(40);t.pageTitle=function(e,t){var n=t.associations.page[e.payload.page.id];return n?{prefix:"the Page",title:n.title,href:(0,r.getDashUrl)({mode:"pages",subMode:n.slug})}:"page"in e.payload?{prefix:"the Page",title:e.payload.page.title}:{title:"an unknown Page"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pubEdgeTitle=t.pubEdgeTargetTitle=void 0;var r=n(35),a=n(40),i=n(165),o=n(106);t.pubEdgeTargetTitle=function(e){var t=e.payload.target;if("pub"in t){var n=t.pub;return{title:n.title,href:(0,r.pubShortUrl)(n)}}var a=t.externalPublication;return{title:a.title,href:a.url}};t.pubEdgeTitle=function(e,t){var n=(0,o.getPubEdgeFromContext)(e.payload.pubEdgeId,t),r=(0,o.getPubFromContext)(e.pubId,t);if(n&&r){var l=n.relationType,u=i.relationTypeDefinitions[l];if(u)return{title:u.article+" "+u.name.toLowerCase()+" Connection",href:(0,a.getDashUrl)({pubSlug:r.slug,mode:"connections"})}}return{title:"a Connection"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.releaseTitle=void 0;var r=n(35),a=n(106);t.releaseTitle=function(e,t){var n=(0,a.getPubFromContext)(e.pubId,t);return{title:"a Release",href:n?(0,r.pubUrl)(null,n,{releaseId:e.payload.releaseId}):null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reviewTitle=void 0;var r=n(40),a=n(106);t.reviewTitle=function(e,t){var n=(0,a.getPubFromContext)(e.pubId,t),i=(0,a.getReviewFromContext)(e.payload.review.id,t),o=n&&i?(0,r.getDashUrl)({pubSlug:n.slug,mode:"reviews",subMode:String(i.number)}):null;return{prefix:"the Review",title:(null==i?void 0:i.title)||e.payload.review.title,href:o}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.membershipScopeTitle=void 0;var a=n(463),i=n(464),o=n(465);t.membershipScopeTitle=function(e,t){var n=e.pubId,l=e.collectionId,u=e.communityId;return"string"==typeof n?(0,o.pubTitle)(r(r({},e),{pubId:n}),t):"string"==typeof l?(0,a.collectionTitle)(r(r({},e),{collectionId:l}),t):(0,i.communityTitle)(r(r({},e),{communityId:u}),t)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.memberTitle=t.actorTitle=void 0;var a=n(64),i=n(106),o=function(e,t,n){if(e){if(e===t.userId)return{title:"you"};var r=(0,i.getUserFromContext)(e,t);if(r)return{title:r.fullName,href:"/user/"+r.slug}}return{title:n}};t.actorTitle=function(e,t){var n=t.otherActorsCount,i=o(e.actorId,t,"someone");if(n){var l=(0,a.naivePluralize)("other",n);return r(r({},i),{suffix:"and "+n+" "+l})}return i};t.memberTitle=function(e,t){return o(e.payload.userId,t,"unknown user")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.submissionTitle=void 0;var r=n(40),a=n(106),i="the Submission";t.submissionTitle=function(e,t){if("collectionId"in t.scope&&t.scope.collectionId===e.collectionId)return{title:"this Submission"};var n=(0,a.getCollectionFromContext)(e.payload.submissionId,t);return n?{prefix:i,title:n.title,href:(0,r.getDashUrl)({collectionSlug:n.slug})}:"submmission"in e.payload?{prefix:i,title:e.payload}:{prefix:i,title:"an unknown Submission"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isExternalUrl=t.parseUrl=void 0;t.parseUrl=function(e){try{return new URL(e)}catch(e){return null}};t.isExternalUrl=function(e){return!e.startsWith("/")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderCollectionPubRemoved=t.renderCollectionPubCreated=t.renderCollectionRemoved=t.renderCollectionUpdated=t.renderCollectionCreated=void 0;var a=r(n(0)),i=n(136),o=n(166);t.renderCollectionCreated=(0,o.itemRenderer)({icon:"collection",titleRenderers:{collection:i.collectionTitle},message:function(e){var t=e.titles,n=t.actor,r=t.collection;return a.default.createElement(a.default.Fragment,null,n," created ",r)}}),t.renderCollectionUpdated=(0,o.itemRenderer)({icon:"collection",titleRenderers:{collection:i.collectionTitle},message:function(e){var t=e.titles,n=e.item.payload,r=t.actor,i=t.collection;return n.title?a.default.createElement(a.default.Fragment,null,r," changed the title of ",i," from ",a.default.createElement("i",null,n.title.from)," to"," ",a.default.createElement("i",null,n.title.to)):n.slug?a.default.createElement(a.default.Fragment,null,r," changed the slug of ",i," from ",n.slug.from," to"," ",n.slug.to):n.layout?a.default.createElement(a.default.Fragment,null,r," updated the layout of ",i):n.doi?a.default.createElement(a.default.Fragment,null,r," set the DOI of ",i," to ",n.doi.to):n.metadata?a.default.createElement(a.default.Fragment,null,r," updated the metadata for ",i):n.isRestricted?n.isRestricted.to?a.default.createElement(a.default.Fragment,null,r," made ",i," restricted"):a.default.createElement(a.default.Fragment,null,r," made ",i," open"):n.isPublic?n.isPublic.to?a.default.createElement(a.default.Fragment,null,r," made ",i," public"):a.default.createElement(a.default.Fragment,null,r," made ",i," private"):a.default.createElement(a.default.Fragment,null,r," updated the settings for ",i)}}),t.renderCollectionRemoved=(0,o.itemRenderer)({icon:"collection",titleRenderers:{collection:i.collectionTitle},message:function(e){var t=e.titles,n=t.actor,r=t.collection;return a.default.createElement(a.default.Fragment,null,n," removed ",r)}}),t.renderCollectionPubCreated=(0,o.itemRenderer)({icon:function(e){return"collectionId"in e.context.scope?"pubDoc":"collection"},titleRenderers:{collection:i.collectionTitle,pub:i.pubTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub,i=t.collection;return a.default.createElement(a.default.Fragment,null,n," added ",r," to ",i)}}),t.renderCollectionPubRemoved=(0,o.itemRenderer)({icon:function(e){return"collectionId"in e.context.scope?"pubDoc":"collection"},titleRenderers:{collection:i.collectionTitle,pub:i.pubTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub,i=t.collection;return a.default.createElement(a.default.Fragment,null,n," removed ",r," from ",i)}})},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderPageRemoved=t.renderPageUpdated=t.renderPageCreated=void 0;var i=a(n(0)),o=n(136),l=n(166);t.renderPageCreated=(0,l.itemRenderer)({icon:"page-layout",titleRenderers:{page:o.pageTitle},message:function(e){var t=e.titles,n=t.actor,r=t.page;return i.default.createElement(i.default.Fragment,null,n," created ",r)}}),t.renderPageUpdated=(0,l.itemRenderer)({icon:"page-layout",titleRenderers:{page:o.pageTitle},message:function(e){var t=e.titles,n=e.item.payload,a=t.actor,o=t.page,l=[];if(n.title){var u=n.title;l.push((function(e){return i.default.createElement(i.default.Fragment,null,"changed the title of ",e," from ",u.from," to ",u.to)}))}if(n.slug){var c=n.slug;l.push((function(e){return i.default.createElement(i.default.Fragment,null,"changed the slug of ",e," from ",c.from," to ",c.to)}))}if(n.layout&&l.push((function(e){return i.default.createElement(i.default.Fragment,null,"updated the layout of ",e)})),n.isPublic){var s=n.isPublic.to;l.push((function(e){var t=s?"public":"private";return i.default.createElement(i.default.Fragment,null,"made ",e," ",t)}))}if(l.length>1)return i.default.createElement(i.default.Fragment,null,a," made the following changes to ",o,":",i.default.createElement("ul",null,l.map((function(e,t){return i.default.createElement("li",{key:t},e("the Page"))}))));if(1===l.length){var d=r(l,1)[0];return i.default.createElement(i.default.Fragment,null,a," ",d(o))}return i.default.createElement(i.default.Fragment,null,a," updated the settings for ",o)}}),t.renderPageRemoved=(0,l.itemRenderer)({icon:"page-layout",titleRenderers:{page:o.pageTitle},message:function(e){var t=e.titles,n=t.actor,r=t.page;return i.default.createElement(i.default.Fragment,null,n," removed ",r)}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderPubReviewUpdated=t.renderPubReviewCommentAdded=t.renderPubReviewCreated=t.renderPubDiscussionCommentAdded=t.renderPubEdgeRemoved=t.renderPubEdgeCreated=t.renderPubReleased=t.renderPubRemoved=t.renderPubUpdated=t.renderPubCreated=void 0;var a=r(n(0)),i=n(136),o=n(166);t.renderPubCreated=(0,o.itemRenderer)({icon:"pubDoc",titleRenderers:{pub:i.pubTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub;return a.default.createElement(a.default.Fragment,null,n," created ",r)}}),t.renderPubUpdated=(0,o.itemRenderer)({icon:"pubDoc",titleRenderers:{pub:i.pubTitle},message:function(e){var t=e.item,n=e.titles,r=t.payload,i=n.actor,o=n.pub;return r.draft?a.default.createElement(a.default.Fragment,null,i," edited ",o):r.doi?a.default.createElement(a.default.Fragment,null,i," set the DOI of ",o," to ",r.doi.to):r.attributions?a.default.createElement(a.default.Fragment,null,i," updated the contributors to ",o):r.title?a.default.createElement(a.default.Fragment,null,i," changed the title of ",o," from ",a.default.createElement("i",null,r.title.from)," to"," ",a.default.createElement("i",null,r.title.to)):r.slug?a.default.createElement(a.default.Fragment,null,i," changed the slug of ",o," from ",r.slug.from," to ",r.slug.to):a.default.createElement(a.default.Fragment,null,i," updated the settings for ",o)}}),t.renderPubRemoved=(0,o.itemRenderer)({icon:"pubDoc",titleRenderers:{pub:i.pubTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub;return a.default.createElement(a.default.Fragment,null,n," removed ",r)}}),t.renderPubReleased=(0,o.itemRenderer)({icon:"document-share",titleRenderers:{pub:i.pubTitle,release:i.releaseTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub,i=t.release;return a.default.createElement(a.default.Fragment,null,n," created ",i," of ",r)}}),t.renderPubEdgeCreated=(0,o.itemRenderer)({icon:"layout-auto",titleRenderers:{pub:i.pubTitle,edge:i.pubEdgeTitle,target:i.pubEdgeTargetTitle},message:function(e){var t=e.titles,n=t.actor,r=t.edge,i=t.target,o=t.pub;return a.default.createElement(a.default.Fragment,null,n," created ",r," with ",i," for ",o)}}),t.renderPubEdgeRemoved=(0,o.itemRenderer)({icon:"layout-auto",titleRenderers:{pub:i.pubTitle,edge:i.pubEdgeTitle,target:i.pubEdgeTargetTitle},message:function(e){var t=e.titles,n=t.actor,r=t.edge,i=t.target,o=t.pub;return a.default.createElement(a.default.Fragment,null,n," removed ",r," with ",i," from ",o)}}),t.renderPubDiscussionCommentAdded=(0,o.itemRenderer)({icon:"chat",titleRenderers:{pub:i.pubTitle,discussion:i.discussionTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub,i=t.discussion;return a.default.createElement(a.default.Fragment,null,n," added ",i," to ",r)},excerpt:function(e){return e.item.payload.threadComment.text}}),t.renderPubReviewCreated=(0,o.itemRenderer)({icon:"social-media",titleRenderers:{pub:i.pubTitle,review:i.reviewTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub,i=t.review;return a.default.createElement(a.default.Fragment,null,n," created ",i," on ",r)},excerpt:function(e){var t=e.item.payload.threadComment;return t?t.text:null}}),t.renderPubReviewCommentAdded=(0,o.itemRenderer)({icon:"social-media",titleRenderers:{pub:i.pubTitle,review:i.reviewTitle},message:function(e){var t=e.titles,n=t.actor,r=t.pub,i=t.review;return a.default.createElement(a.default.Fragment,null,n," added a comment to ",i," on ",r)},excerpt:function(e){return e.item.payload.threadComment.text}}),t.renderPubReviewUpdated=(0,o.itemRenderer)({icon:"social-media",titleRenderers:{pub:i.pubTitle,review:i.reviewTitle},message:function(e){var t=e.titles,n=e.item,r=t.actor,i=t.pub,o=t.review,l=n.payload.status;return l?a.default.createElement(a.default.Fragment,null,r," changed the status of ",o," on ",i," from ",a.default.createElement("i",null,l.from)," to"," ",a.default.createElement("i",null,l.to)):a.default.createElement(a.default.Fragment,null,r," updated ",o," on ",i)}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderMemberRemoved=t.renderMemberUpdated=t.renderMemberCreated=void 0;var a=r(n(0)),i=n(136),o=n(166);t.renderMemberCreated=(0,o.itemRenderer)({icon:"people",titleRenderers:{member:i.memberTitle,scope:i.membershipScopeTitle},message:function(e){var t=e.item,n=e.titles,r=n.actor,i=n.member,o=n.scope,l=t.payload.permissions;return a.default.createElement(a.default.Fragment,null,r," added ",i," as a member of ",o," with ",a.default.createElement("i",null,l)," permissions")}}),t.renderMemberUpdated=(0,o.itemRenderer)({icon:"people",titleRenderers:{member:i.memberTitle,scope:i.membershipScopeTitle},message:function(e){var t=e.item,n=e.titles,r=n.actor,i=n.member,o=n.scope,l=t.payload.permissions;return l?a.default.createElement(a.default.Fragment,null,r," changed the membership permissions of ",i," in ",o," from"," ",a.default.createElement("i",null,l.from)," to ",a.default.createElement("i",null,l.to)):a.default.createElement(a.default.Fragment,null,r," changed the membership permissions of ",i," in ",o)}}),t.renderMemberRemoved=(0,o.itemRenderer)({icon:"people",titleRenderers:{member:i.memberTitle,scope:i.membershipScopeTitle},message:function(e){var t=e.titles,n=t.actor,r=t.member,i=t.scope;return a.default.createElement(a.default.Fragment,null,n," removed ",r," as a member from ",i)}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.renderSubmissionUpdated=void 0;var a=r(n(0)),i=n(136),o=n(166);t.renderSubmissionUpdated=(0,o.itemRenderer)({icon:"manually-entered-data",titleRenderers:{pub:i.pubTitle,collection:i.collectionTitle},message:function(e){var t=e.titles,n=e.item.payload,r=t.actor,i=t.pub,o=t.collection,l=n.status,u=l.from,c=l.to;return"received"===c?a.default.createElement(a.default.Fragment,null,r," submitted ",i," into ",o):a.default.createElement(a.default.Fragment,null,r," updated the submission status for ",i," in ",o," from ",a.default.createElement("i",null,u)," ","to ",a.default.createElement("i",null,c))}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.bindActions=void 0;var l=n(18),u=n(62),c=n(461),s={updateSubscriptionStatus:function(e){return function(t,n){e((function(e){return"threadId"in t?(0,c.updateThread)(e,t,{subscription:n}):(0,c.updatePub)(e,t,{subscription:n})}))}},updateThreadReadStatus:function(e){return function(t,n){return a(void 0,void 0,void 0,(function(){var a,o,u,s,d;return i(this,(function(i){switch(i.label){case 0:return a=n.isRead,o=n.manuallySetIsRead,u=n.useBeacon,s=t.notifications.map((function(e){return e.id})),e((function(e){return(0,c.updateThread)(e,t.location,(function(e){return{notifications:e.notifications.map((function(e){return r(r({},e),{isRead:a,manuallySetIsRead:o})}))}}))})),u&&"sendBeacon"in navigator?(d=new Blob([JSON.stringify({userNotificationIds:s,isRead:a,manuallySetIsRead:o})],{type:"application/json"}),navigator.sendBeacon("/api/userNotifications",d),[3,3]):[3,1];case 1:return[4,l.apiFetch.post("/api/userNotifications",{userNotificationIds:s,isRead:a,manuallySetIsRead:o})];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}},updateUserNotificationPreferences:function(e){return function(t){return a(void 0,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return e((function(e){return r(r({},e),{notificationPreferences:r(r({},e.notificationPreferences),t)})})),[4,l.apiFetch.put("/api/userNotificationPreferences",{preferences:t})];case 1:return n.sent(),[2]}}))}))}},dismissPubThreads:function(e){return function(t,n){return a(void 0,void 0,void 0,(function(){var r;return i(this,(function(a){switch(a.label){case 0:return e((function(e){return(0,c.updatePub)(e,t,null)})),r=(0,u.flattenOnce)(n.threadStates.map((function(e){return e.notifications.map((function(e){return e.id}))}))),[4,l.apiFetch.delete("/api/userNotifications",{userNotificationIds:r})];case 1:return a.sent(),[2]}}))}))}},dismissThread:function(e){return function(t,n){return a(void 0,void 0,void 0,(function(){var r;return i(this,(function(a){switch(a.label){case 0:return e((function(e){return(0,c.updateThread)(e,t,null)})),r=n.notifications.map((function(e){return e.id})),[4,l.apiFetch.delete("/api/userNotifications",{userNotificationIds:r})];case 1:return a.sent(),[2]}}))}))}}};t.bindActions=function(e){var t={};return Object.entries(s).forEach((function(n){var r=o(n,2),a=r[0],i=r[1];t[a]=i(e)})),t}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hydrateWrapper=void 0;var l=o(n(0)),u=i(n(297)),c=n(31),s=n(5),d=n(130),f=n(1244),m=n(1245);t.hydrateWrapper=function(e){if("undefined"!=typeof window&&("http://localhost:9001"!==(b=window).location.origin&&"react"!==b.STORYBOOK_ENV)){var t=(0,f.getClientInitialData)(),n=t.locationData,r=n.isProd,a=n.isDuqDuq,i=n.isQubQub,o=n.appCommit;(0,d.setEnvironment)(r,a,i),(0,d.setAppCommit)(o),s.FocusStyleManager.onlyShowFocusOnTabs(),window.navigator&&navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((function(e){e.forEach((function(e){e.unregister()}))}));var p=JSON.parse(document.getElementById("view-data").getAttribute("data-json")),h=JSON.parse(document.getElementById("chunk-name").getAttribute("data-json"));(function(e){return e.location.origin.indexOf("localhost:")>-1})(window)||((0,m.setupHeap)(t),window.sentryIsActive=!0,u.init({dsn:"https://abe1c84bbb3045bd982f9fea7407efaa@sentry.io/1505439",environment:r?"prod":"dev",release:o}),u.setUser({id:t.loginData.id,username:t.loginData.slug})),(0,c.hydrate)(l.default.createElement(e,{initialData:t,viewData:p,chunkName:h}),document.getElementById("root"))}var b}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getClientInitialData=void 0;t.getClientInitialData=function(){return r||(r=JSON.parse(document.getElementById("initial-data").getAttribute("data-json"))),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setupHeap=void 0;var r=n(130),a=n(219);t.setupHeap=function(e){var t=e.communityData,n=e.collectionData,i=e.pubData,o=e.loginData,l=(0,a.getGdprConsentElection)(o),u=(0,r.isProd)()?"422727431":"3777990325";window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://cdn.heapanalytics.com/js/heap-"+e+".js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r);for(var a=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},i=["addEventProperties","addUserProperties","clearEventProperties","identify","resetIdentity","removeEventProperty","setEventProperties","track","unsetEventProperty"],o=0;o<i.length;o++)heap[i[o]]=a(i[o])},window.heap.load(u);var c={communityId:null,pageId:null,pubId:null};t&&(c.communityId=t.id),n&&(c.pageId=n.id),i&&(c.pubId=i.id),l&&o.id&&(c.loggedIn="true",window.heap.identify(o.id)),window.heap.addEventProperties(c)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1247);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(6),l=n(9),u=r(n(466));n(1249);t.default=function(e){var t=e.className,n=(0,l.usePageContext)().dashboardMenu.menuItems;return a.default.createElement("div",{className:(0,i.default)("side-menu-component",t)},a.default.createElement(u.default,null),a.default.createElement("div",{className:"content"},n.map((function(e){var t=e.title,n=e.href,r=e.active,l=e.count,u=e.icon;return a.default.createElement("div",{key:t,className:(0,i.default)({menu:!0,active:r})},a.default.createElement("a",{href:n,className:"content-title"},a.default.createElement(o.Icon,{className:"side-icon",icon:u}),a.default.createElement("span",{className:"side-text"},t),l?a.default.createElement("div",{className:"count"},l):null))}))))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1251);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(5),d=u(n(3)),f=n(6),m=n(9),p=n(40),h=n(18),b=u(n(467));n(1254);t.default=function(e){var t=e.className,n=(0,m.usePageContext)(),a=n.locationData,i=n.communityData,o=n.scopeData,u=n.dashboardMenu,v=o.elements,y=v.activeTargetType,g=v.activePub,_=v.activeCollection,E=o.activePermissions.activePermission,P=a.params.collectionSlug||a.query.collectionSlug,w=a.params.pubSlug,O=u.activeMode,C=O.mode,S=O.subMode,D=l((0,c.useState)(!1),2),k=D[0],j=D[1],M=l((0,c.useState)(!1),2),N=M[0],I=M[1],x=i.title,T=i.avatar,A=!1;_&&(x=_.title,T=_.avatar,A=!_.isPublic),g&&(x=g.title,T=g.avatar);var R=function(){return j(!0),h.apiFetch.post("/api/pubs",{communityId:i.id,collectionId:_&&_.id}).then((function(e){window.location.href="/pub/"+e.slug})).catch((function(e){console.error(e),j(!1)}))},B={community:[{text:"Create Collection",onClick:function(){I(!0)},minPermissions:"manage"},{text:"Create Pub",onClick:R,minPermissions:"manage"}],collection:[{text:"Create Pub",onClick:R,minPermissions:"manage"},_&&{text:"Visit Collection",href:"/"+_.slug}].filter((function(e){return e})),pub:[{text:"Go to Pub",href:g?"/pub/"+g.slug+(_?"?collectionSlug="+_.slug:""):void 0}]};return c.default.createElement("div",{className:(0,d.default)("breadcrumbs-component",t)},c.default.createElement("div",{className:"breadcrumbs-content"},c.default.createElement(f.Avatar,{avatar:T,initials:x[0],communityData:i,width:40,isBlock:!0}),c.default.createElement("div",{className:"titles"},c.default.createElement("div",{className:"title",title:x},x,A&&c.default.createElement(f.Icon,{icon:"lock2",className:"lock-icon",iconSize:20})),c.default.createElement("div",{className:"crumbs"},c.default.createElement("a",{className:"crumb truncate",href:(0,p.getDashUrl)({})},c.default.createElement(f.Icon,{icon:"office",iconSize:10}),c.default.createElement("span",{className:"bottom-text"},i.title)),_&&c.default.createElement(c.default.Fragment,null,c.default.createElement(f.Icon,{icon:"chevron-right",className:"crumb-icon",iconSize:12}),c.default.createElement("a",{className:"crumb truncate",href:(0,p.getDashUrl)({collectionSlug:P})},c.default.createElement(f.Icon,{icon:"collection",iconSize:10}),c.default.createElement("span",{className:"bottom-text"},_.title))),g&&c.default.createElement(c.default.Fragment,null,c.default.createElement(f.Icon,{icon:"chevron-right",className:"crumb-icon",iconSize:12}),c.default.createElement("a",{className:"crumb truncate",href:(0,p.getDashUrl)({collectionSlug:P,pubSlug:w})},c.default.createElement(f.Icon,{icon:"pubDoc",iconSize:10}),c.default.createElement("span",{className:"bottom-text"},g.title))),C&&c.default.createElement(c.default.Fragment,null,c.default.createElement(f.Icon,{icon:"chevron-right",className:"crumb-icon",iconSize:12}),c.default.createElement("a",{className:"crumb capitalize no-shrink",href:(0,p.getDashUrl)({collectionSlug:P,pubSlug:w,mode:C})},C)),S&&c.default.createElement(c.default.Fragment,null,c.default.createElement(f.Icon,{icon:"chevron-right",className:"crumb-icon",iconSize:12}),c.default.createElement("a",{className:"crumb no-shrink capitalize",href:(0,p.getDashUrl)({collectionSlug:P,pubSlug:w,mode:C,subMode:S})},S)))),c.default.createElement("div",{className:"breadcrumb-actions"},B[y].filter((function(e){var t=["view","edit","manage","admin"];return t.indexOf(E)>=t.indexOf(e.minPermissions)})).map((function(e){var t={key:e.text,text:e.text,intent:s.Intent.PRIMARY,onClick:e.onClick,href:e.href,loading:"Create Pub"===e.text&&k,disabled:"Create Pub"!==e.text&&k,outlined:!0};return t.href?c.default.createElement(s.AnchorButton,r({},t)):c.default.createElement(s.Button,r({},t))})))),c.default.createElement(b.default,{isOpen:N,onClose:function(){I(!1)}}))}},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1256);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(6),l=n(9),u=r(n(466));n(1257);t.default=function(e){var t=e.className,n=e.isMobile,r=(0,l.usePageContext)().dashboardMenu,c=r.activeMode,s=r.menuItems;return a.default.createElement("div",{className:(0,i.default)("bottom-menu-component",t)},a.default.createElement("div",{className:"content"},a.default.createElement(u.default,{isMobile:n}),a.default.createElement("div",{className:"mode-menu-component"},a.default.createElement(o.MenuButton,{"aria-label":"Dashboard Mode",buttonContent:a.default.createElement("div",{className:"current-mode"},c.mode),buttonProps:{className:"mode-button",fill:!0,minimal:!0,rightIcon:"caret-down"},className:"mode-menu",unstable_fixed:!0},a.default.createElement("div",{className:"mode-dropdown-component"},s.map((function(e){var t=e.active,n=e.href,r=e.icon,l=e.title;return a.default.createElement(o.MenuItem,{href:n,key:l,text:a.default.createElement("div",{key:l,className:(0,i.default)({menu:!0,active:t})},a.default.createElement("div",{className:"side-icon"},a.default.createElement(o.Icon,{icon:r})),a.default.createElement("div",{className:"side-text"},l))})})))))))}},function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1259);t.default=function(e,t,n){return{About:{ActiveComponent:r.About,hideNav:t.isBasePubPub},AdminDashboard:{ActiveComponent:r.AdminDashboard,hideNav:!0,hideFooter:!0},Collection:{ActiveComponent:r.Collection},CommunityCreate:{ActiveComponent:r.CommunityCreate,hideNav:!0,hideFooter:!0},CommunityServices:{ActiveComponent:r.CommunityServices,hideNav:!0,hideFooter:!0},DashboardActivity:{ActiveComponent:r.DashboardActivity,isDashboard:!0},DashboardDiscussions:{ActiveComponent:r.DashboardDiscussions,isDashboard:!0},DashboardEdges:{ActiveComponent:r.DashboardEdges,isDashboard:!0},DashboardImpact:{ActiveComponent:r.DashboardImpact,isDashboard:!0},DashboardMembers:{ActiveComponent:r.DashboardMembers,isDashboard:!0},DashboardCommunityOverview:{ActiveComponent:r.DashboardCommunityOverview,isDashboard:!0},DashboardCollectionOverview:{ActiveComponent:r.DashboardCollectionOverview,isDashboard:!0},DashboardPubOverview:{ActiveComponent:r.DashboardPubOverview,isDashboard:!0},DashboardPages:{ActiveComponent:r.DashboardPages,isDashboard:!0},DashboardPage:{ActiveComponent:r.DashboardPage,isDashboard:!0},DashboardReviews:{ActiveComponent:r.DashboardReviews,isDashboard:!0},DashboardReview:{ActiveComponent:r.DashboardReview,isDashboard:!0},DashboardSettings:{ActiveComponent:r.DashboardSettings,isDashboard:!0},DashboardSubmissions:{ActiveComponent:r.DashboardSubmissions,isDashboard:!0},DashboardSubmissionWorkflow:{ActiveComponent:r.DashboardSubmissionWorkflow,isDashboard:!0},DashboardCollectionLayout:{ActiveComponent:r.DashboardCollectionLayout,isDashboard:!0},DashboardCustomScripts:{ActiveComponent:r.DashboardCustomScripts,isDashboard:!0},Explore:{ActiveComponent:r.Explore,hideNav:!0},Landing:{ActiveComponent:r.Landing,hideNav:!0},Legal:{ActiveComponent:r.Legal,hideNav:t.isBasePubPub},Login:{ActiveComponent:r.Login,hideNav:!0,hideFooter:!0},NoMatch:{ActiveComponent:r.NoMatch,hideNav:t.isBasePubPub,hideFooter:!0},Page:{ActiveComponent:r.Page},PasswordReset:{ActiveComponent:r.PasswordReset,hideNav:!0,hideFooter:!0},Pricing:{ActiveComponent:r.Pricing,hideNav:!0,hideFooter:!0},Pub:{ActiveComponent:r.Pub},Search:{ActiveComponent:r.Search,hideNav:t.isBasePubPub,hideFooter:!0},Signup:{ActiveComponent:r.Signup,hideNav:!0,hideFooter:!0},User:{ActiveComponent:r.User,hideNav:t.isBasePubPub},UserCreate:{ActiveComponent:r.UserCreate,hideNav:t.isBasePubPub,hideFooter:!0}}[n]}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserCreate=t.User=t.Signup=t.Search=t.Pub=t.Legal=t.Pricing=t.PasswordReset=t.Page=t.NoMatch=t.Login=t.Landing=t.Explore=t.DashboardSubmissionWorkflow=t.DashboardSubmissions=t.DashboardSettings=t.DashboardReviews=t.DashboardReview=t.DashboardPages=t.DashboardPage=t.DashboardPubOverview=t.DashboardCollectionOverview=t.DashboardCommunityOverview=t.DashboardMembers=t.DashboardImpact=t.DashboardEdges=t.DashboardDiscussions=t.DashboardCustomScripts=t.DashboardCollectionLayout=t.DashboardActivity=t.CommunityServices=t.CommunityCreate=t.Collection=t.AdminDashboard=t.About=void 0;var a=n(1260);Object.defineProperty(t,"About",{enumerable:!0,get:function(){return r(a).default}});var i=n(1262);Object.defineProperty(t,"AdminDashboard",{enumerable:!0,get:function(){return r(i).default}});var o=n(1264);Object.defineProperty(t,"Collection",{enumerable:!0,get:function(){return r(o).default}});var l=n(1265);Object.defineProperty(t,"CommunityCreate",{enumerable:!0,get:function(){return r(l).default}});var u=n(1267);Object.defineProperty(t,"CommunityServices",{enumerable:!0,get:function(){return r(u).default}});var c=n(1271);Object.defineProperty(t,"DashboardActivity",{enumerable:!0,get:function(){return r(c).default}});var s=n(1282);Object.defineProperty(t,"DashboardCollectionLayout",{enumerable:!0,get:function(){return r(s).default}});var d=n(1284);Object.defineProperty(t,"DashboardCustomScripts",{enumerable:!0,get:function(){return r(d).default}});var f=n(1289);Object.defineProperty(t,"DashboardDiscussions",{enumerable:!0,get:function(){return r(f).default}});var m=n(1291);Object.defineProperty(t,"DashboardEdges",{enumerable:!0,get:function(){return r(m).default}});var p=n(1299);Object.defineProperty(t,"DashboardImpact",{enumerable:!0,get:function(){return r(p).default}});var h=n(1301);Object.defineProperty(t,"DashboardMembers",{enumerable:!0,get:function(){return r(h).default}});var b=n(1303);Object.defineProperty(t,"DashboardCommunityOverview",{enumerable:!0,get:function(){return b.DashboardCommunityOverview}}),Object.defineProperty(t,"DashboardCollectionOverview",{enumerable:!0,get:function(){return b.DashboardCollectionOverview}}),Object.defineProperty(t,"DashboardPubOverview",{enumerable:!0,get:function(){return b.DashboardPubOverview}});var v=n(1344);Object.defineProperty(t,"DashboardPage",{enumerable:!0,get:function(){return r(v).default}});var y=n(1347);Object.defineProperty(t,"DashboardPages",{enumerable:!0,get:function(){return r(y).default}});var g=n(1351);Object.defineProperty(t,"DashboardReview",{enumerable:!0,get:function(){return r(g).default}});var _=n(1353);Object.defineProperty(t,"DashboardReviews",{enumerable:!0,get:function(){return r(_).default}});var E=n(1355);Object.defineProperty(t,"DashboardSettings",{enumerable:!0,get:function(){return r(E).default}});var P=n(1379);Object.defineProperty(t,"DashboardSubmissions",{enumerable:!0,get:function(){return r(P).default}});var w=n(1392);Object.defineProperty(t,"DashboardSubmissionWorkflow",{enumerable:!0,get:function(){return r(w).default}});var O=n(1404);Object.defineProperty(t,"Explore",{enumerable:!0,get:function(){return r(O).default}});var C=n(1406);Object.defineProperty(t,"Landing",{enumerable:!0,get:function(){return r(C).default}});var S=n(1408);Object.defineProperty(t,"Login",{enumerable:!0,get:function(){return r(S).default}});var D=n(1411);Object.defineProperty(t,"NoMatch",{enumerable:!0,get:function(){return r(D).default}});var k=n(1413);Object.defineProperty(t,"Page",{enumerable:!0,get:function(){return r(k).default}});var j=n(1414);Object.defineProperty(t,"PasswordReset",{enumerable:!0,get:function(){return r(j).default}});var M=n(1416);Object.defineProperty(t,"Pricing",{enumerable:!0,get:function(){return r(M).default}});var N=n(1418);Object.defineProperty(t,"Legal",{enumerable:!0,get:function(){return r(N).default}});var I=n(1424);Object.defineProperty(t,"Pub",{enumerable:!0,get:function(){return r(I).default}});var x=n(1562);Object.defineProperty(t,"Search",{enumerable:!0,get:function(){return r(x).default}});var T=n(1565);Object.defineProperty(t,"Signup",{enumerable:!0,get:function(){return r(T).default}});var A=n(1567);Object.defineProperty(t,"User",{enumerable:!0,get:function(){return r(A).default}});var R=n(1575);Object.defineProperty(t,"UserCreate",{enumerable:!0,get:function(){return r(R).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1261);t.default=function(){return a.default.createElement("div",{id:"about-container"},a.default.createElement(i.GridWrapper,{containerClassName:"narrow"},a.default.createElement("h1",null,"Our Mission"),a.default.createElement("h2",null,"PubPub makes knowledge creation accessible to everyone."),a.default.createElement("p",null,"PubPub supports over three thousand communities, from peer-reviewed scholarly journals and books to novel community publishing experiments, and everything in between. These communities are created and maintained by university presses, society publishers, library publishers, independent scholar-led publishers, academic departments, research labs, ad-hoc communities, individuals, and many others. PubPub provides infrastructure for each part of the publishing process, from drafting documents, conducting peer review, and hosting entire journal and book websites to collecting and displaying reader feedback and analytics."),a.default.createElement("p",null,"You can get started now by"," ",a.default.createElement("a",{href:"/community/create"},"creating your community"),"."),a.default.createElement("h2",null,"Features, Benefits, and Tradeoffs"),a.default.createElement("p",null,"PubPub is an open-source, hosted, free-to-use content management system designed to help knowledge communities of all types collaboratively create and share knowledge online. PubPubâ€™s flexible, extensible system allows communities to create the dynamic content that best represents their work, whether itâ€™s a traditional academic journal, a book, a repository of interactive documents, a blog, all of the above, or something in between. If needed, PubPub then helps communities integrate their work into academic infrastructure like Crossref and Google Scholar without the need to remake it to conform to legacy expectations of how academic outputs are structured."),a.default.createElement("p",null,"PubPub is built for communities of all types, but may be ideal for you if your community:"),a.default.createElement("ul",null,a.default.createElement("li",null,"Wants to create web-native, dynamic content."),a.default.createElement("li",null,"Wants to collaborate on content creation."),a.default.createElement("li",null,"Wants to integrate your content into academic systems and formats like Crossref, Google Scholar, and JATS XML with as little effort as possible."),a.default.createElement("li",null,"Doesnâ€™t have high levels of technical expertise on-staff."),a.default.createElement("li",null,"Doesnâ€™t want to manage your own servers and worry about updates, plugin compatibility, or users breaking layouts.")),a.default.createElement("p",null,"PubPub may not be ideal if your community:"),a.default.createElement("ul",null,a.default.createElement("li",null,"Publishes primarily PDF content, or has an audience that primarily consumes content as PDF."),a.default.createElement("li",null,"Needs precise control over the look and feel of its website or its PDFs."),a.default.createElement("li",null,"Needs precise control over academic metadata or output formats like JATS XML."),a.default.createElement("li",null,"Needs or wants to self-host their technology.")),a.default.createElement("p",null,"To learn more about the features, benefits and tradeoffs of using PubPub, see our ",a.default.createElement("a",{href:"https://help.pubpub.org/getting-started"},"Getting Started guide"),"."),a.default.createElement("h2",null,"Technical Support"),a.default.createElement("p",null,"We offer forum-based, community support for all PubPub users. Feel free to post on our ",a.default.createElement("a",{href:"https://github.com/pubpub/pubpub/discussions"},"user forum")," at any time. If you need more support, consider becoming a"," ",a.default.createElement("a",{href:"https://knowledgefutures.org/membership"},"KFG Member"),". KFG Contributing Members and above receive email support, as well as strategy consultation and training from our team."),a.default.createElement("p",null,"For groups that want personalized support, we offer production, training, and strategy services for building high quality, effective publishing communities. Services include content production, editorial services, site design, back file import, training, interactive production, branding, and more."," ",a.default.createElement("a",{href:"/community-services"},"Learn more about our Community Services offerings"),"."),a.default.createElement("h2",null,"Roadmap & Contribution"),a.default.createElement("p",null,"PubPub maintains a high-level public roadmap"," ",a.default.createElement("a",{href:"https://github.com/orgs/pubpub/projects/9"},"on GitHub"),". To suggest a feature, report a bug, or inquire about contributing, start by browsing our"," ",a.default.createElement("a",{href:"https://github.com/pubpub/pubpub/issues"},"GitHub issues")," or posting to our ",a.default.createElement("a",{href:"https://github.com/pubpub/pubpub/discussions"},"user forum"),"."),a.default.createElement("h2",null,"Mission, Values, and Sustainability"),a.default.createElement("p",null,"PubPub provides open-source infrastructure to publish knowledge credibly and tools to facilitate community participation. For-profit academic publishing models that mount paywalls to monopolize publicly funded research hinder the reach of public knowledge and thereby contradict the ultimate goal of its creators. At PubPub we value the creation of knowledge and advocate for the people that are contributing to our collective understanding."),a.default.createElement("p",null,"In the last several years, many once-independent publishing tools have been consolidated into closed platforms. We believe researchers need open-source, academically supported, end-to-end alternatives to these proprietary platforms and publishing models. In our vision of the future, knowledge communities play a lead role in building and maintaining our knowledge systems, reclaiming territory that was ceded to proprietary solutions."),a.default.createElement("p",null,"PubPub is built and maintained by the"," ",a.default.createElement("a",{href:"https://knowledgefutures.org"},"Knowledge Futures Group"),", a nonprofit organization dedicated to building public knowledge infrastructure. KFG is governed by an independent board, and supported and driven by Members."," ",a.default.createElement("a",{href:"https://knowledgefutures.org/membership"},"Membership")," allows individuals and organizations of all sizes to support open infrastructure; receive discounts on Community Services; receive additional support on our products; meet and share ideas with other innovative knowledge communities; and join a community passionate about the future of knowledge infrastructure and its development. If you value PubPub, we encourage you to"," ",a.default.createElement("a",{href:"https://knowledgefutures.org/membership"},"become a KFG Member"),"."),a.default.createElement("p",null,"We believe that for PubPub to succeed, it must be sustainable for the long term. For us, sustainability means primarily being supported by mission-oriented revenue streams, rather than being grant and gift-supported or relying on ancillary revenue streams."," ",a.default.createElement("a",{href:"https://notes.knowledgefutures.org/pub/oozjbyky"},"Learn more about our sustainability plans"),"."),a.default.createElement("h2",null,"Other Useful Resources"),a.default.createElement("ul",null,a.default.createElement("li",null,a.default.createElement("a",{href:"/explore"},"Check out our Explore Page")," for a curated list of some of the most interesting PubPub communities (and we're constantly on the lookout for new ones)."," "),a.default.createElement("li",null,a.default.createElement("a",{href:"https://help.pubpub.org"},"Visit our Help Site")," for guides and reference materials for setting up and maintaining communities."),a.default.createElement("li",null,a.default.createElement("a",{href:"https://knowledgefutures.us5.list-manage.com/subscribe?u=9b9b78707f3dd62d0d47ec03d&id=be26e45660"},"Subscribe to our our twice-monthly newsletter")," ","for useful community and product updates."),a.default.createElement("li",null,a.default.createElement("a",{href:"https://twitter.com/pubpub"},"Follow us on Twitter")," for great examples of communities using PubPub effectively."),a.default.createElement("li",null,a.default.createElement("a",{href:"https://github.com/pubpub/pubpub"},"Browse our GitHub Repository")," ","to see our code, as well as the latest development activiy."),a.default.createElement("li",null,"If you have questions or are interested in collaborating, get in touch directly at"," ",a.default.createElement("a",{href:"mailto:hello@pubpub.org?subject=About+Page+Question"},"hello@pubpub.org"),".")),a.default.createElement("p",null,"â€”The PubPub Team")))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(468));n(1263);t.default=function(e){var t="https://metabase.pubpub.org/embed/dashboard/"+e.impactData.baseToken+"#bordered=false&titled=false";return a.default.createElement("div",{className:"dashboard-impact-container admin-dashboard"},a.default.createElement("section",null,a.default.createElement("h3",null,"PubPub Top Analytics")),a.default.createElement("section",null,"(",a.default.createElement(i.default,{className:"metabase main",src:t,title:"Analytics",frameBorder:"0",onResized:function(e){var t=e.iframe,n=e.height,r=e.width;t.style.height=n-function(e){return e<960?45:61}(r)+"px"}}),")"))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);t.default=function(e){var t=e.layoutPubsByBlock,n=e.layout,r=e.collection;if(n){var o=n.blocks,l=n.isNarrow;return a.default.createElement(i.Layout,{blocks:o,isNarrow:l,layoutPubsByBlock:t,collection:r})}return null}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(6),s=n(64),d=n(9),f=n(18);n(1266);t.default=function(){var e=(0,d.usePageContext)().loginData,t=o((0,l.useState)(""),2),n=t[0],r=t[1],a=o((0,l.useState)(""),2),i=a[0],m=a[1],p=o((0,l.useState)(""),2),h=p[0],b=p[1],v=o((0,l.useState)(""),2),y=v[0],g=v[1],_=o((0,l.useState)("#2D2E2F"),2),E=_[0],P=_[1],w=o((0,l.useState)("#FFFFFF"),2),O=w[0],C=w[1],S=o((0,l.useState)(!1),2),D=S[0],k=S[1],j=o((0,l.useState)(!1),2),M=j[0],N=j[1],I=o((0,l.useState)(void 0),2),x=I[0],T=I[1],A=function(e){return e.preventDefault(),N(!0),T(!0),!!D&&(0,f.apiFetch)("/api/communities",{method:"POST",body:JSON.stringify({subdomain:n,title:i,description:h,headerLogo:y,heroLogo:y,accentColorLight:O,accentColorDark:E})}).then((function(){N(!1),T(void 0),window.location.href="https://"+n+".pubpub.org"})).catch((function(e){N(!1),T(e)}))};return l.default.createElement("div",{id:"community-create-container"},l.default.createElement(c.GridWrapper,{containerClassName:"small"},!e.id&&l.default.createElement(u.NonIdealState,{title:"To create your community, create an account or login.",visual:"error",action:l.default.createElement("a",{href:"/login?redirect=/community/create",className:"bp3-button"},"Login or Signup")}),e.id&&l.default.createElement("div",null,l.default.createElement("h1",null,"Create Community"),l.default.createElement("p",null,"PubPub and all its features are free to use.",l.default.createElement("sup",null,"*")," If you value PubPub, we ask you to consider supporting our work by becoming a member of the Knowledge Futures Group."," ",l.default.createElement("a",{href:"https://knowledgefutures.org/membership",target:"_blank",rel:"noreferrer"},"Learn more"),"."),l.default.createElement("form",{onSubmit:A},l.default.createElement(c.InputField,{label:"URL",isRequired:!0,value:n,onChange:function(e){r((0,s.slugifyString)(e.target.value))},helperText:"https://"+(n||"[URL]")+".pubpub.org"}),l.default.createElement(c.InputField,{label:"Title",isRequired:!0,value:i,onChange:function(e){m(e.target.value)}}),l.default.createElement(c.InputField,{label:"Description",isTextarea:!0,value:h,onChange:function(e){b(e.target.value.substring(0,280).replace(/\n/g," "))},helperText:h.length+"/280 characters"}),l.default.createElement(c.ImageUpload,{htmlFor:"large-header-logo-upload",label:"Community Logo",defaultImage:y,height:60,width:150,onNewImage:function(e){g(e)},helperText:"Used on the landing page. Suggested height: 200px"}),l.default.createElement(c.InputField,{label:"Light Accent Color"},l.default.createElement(c.ColorInput,{value:O,onChange:function(e){C(e.hex)}})),l.default.createElement(c.InputField,{label:"Dark Accent Color"},l.default.createElement(c.ColorInput,{value:E,onChange:function(e){P(e.hex)}})),l.default.createElement(c.InputField,null,l.default.createElement(u.Checkbox,{checked:D,onChange:function(){k(!D)}},"I have read and agree to the PubPub"," ",l.default.createElement("a",{href:"/legal/terms",target:"_blank"},"Terms of Service")," ","and"," ",l.default.createElement("a",{href:"/legal/privacy",target:"_blank"},"Privacy Policy"),".")),l.default.createElement(c.InputField,{error:x&&"Error Creating Community"},l.default.createElement(u.Button,{name:"create",type:"submit",className:"bp3-button bp3-intent-primary create-account-button",onClick:A,text:"Create Community",disabled:!n||!i||!D,loading:M}))),l.default.createElement("p",null,l.default.createElement("sup",null,"*")," We limit DOI registrations to 10 per community per year, if published via PubPub's Crossref membership. Once the limit is reached, we ask that you become a"," ",l.default.createElement("a",{href:"https://knowledgefutures.org/membership",target:"_blank",rel:"noreferrer"},"KFG member"),", at any level, and allow us to pass on the Crossref fee of $1 per DOI registered. For groups with their own Crossref membership, there is no additional fee for creating or depositing DOIs."))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(5),d=n(6),f=n(18),m=u(n(1268));n(1270);t.default=function(){var e=[{title:"Content Production",options:["None","Low Volume","Medium Volume","High Volume"],tooltips:["","~10 articles or chapters per year","~20-30 articles or chapters per year","50+ articles or chapters per year"],prices:["$0","$4,000 - $5,000","$9,000 - $15,000","$20,000+"],initOption:0,description:"We ingest finalized, copyedited content into PubPub for you, assure its quality, implement necessary revisions, assign DOIs (if applicable), and implement any Pub design. Content on PubPub does not require typesetting and can be exported to many different file types, including PDF."},{title:"Embedded Managing Editor",options:{None:["Requires Content Production"],"Low Volume":["Do not Include","Include"],"Medium Volume":["Do not Include","Include"],"High Volume":["Do not Include","Include"]},prices:{None:["$0"],"Low Volume":["$0","$5,000"],"Medium Volume":["$0","$10,000 - $15,000"],"High Volume":["$0","$20,000+"]},initOption:0,description:"We assign one person from our team to work as your dedicated production point person. This work includes regular calls, communication with authors, and providing general publication strategy as well as insights. Teams who find this service most useful include those that publish on a regular basis but do not have the internal bandwidth to manage these activities nor the budget to hire an additional full-time person to do so."},{title:"Community Structure and Design",options:["Do not Include","Include"],prices:["$0","$2,000 - $3,000"],initOption:0,description:"We believe the content you publish (and how you want readers to understand and interact with it) should inform the structure and design of your community on PubPub. We'll work with you to understand your contentâ€”from traditional journal articles and books, to rviews, to video tutorialsâ€”in order to design a space that best supports your work."},{title:"Back File Import",options:["Do not Include","Include"],prices:["$0","$1,000 - $5,000"],initOption:0,description:"We help you migrate years of existing content into PubPub so that your existing publication can start its new phase on PubPub without losing its history and archives. This activity often also makes past work more discoverable and navigable for readers."},{title:"Training",options:["Do not Include","Include"],prices:["$0","$500"],initOption:0,description:"We offer two recorded training sessions of up to 90 minutes on a one-off or ongoing (yearly) basis for your team. These sessions cover basics on how to use PubPub, specifics on your group's workflow, and leave plenty of time for your team to practice and ask questions."},{title:"Interactives",options:["Do not Include","Include"],prices:["$0","$500/interactive"],initOption:0,description:"We work with you or directly with your authors to develop media and/or interactive elements to enhance your Community. Our focus is always on more effectively communicating the message(s) of your content."},{title:"Branding",options:["Do not Include","Include"],prices:["$0","$4,500 - $5,500"],initOption:0,description:"Our design team will develop a brand and design scheme for your Community. Groups that find this most useful are those who are starting a new publication, such as a journal, and need a brand to inform the design and appearance of their PubPub Community and other possible communication elements, such as a newsletter."},{title:"Knowledge Futures Membership",options:["None","Supporter","Contributor","Network"],prices:["$0","$60","$1,150 - $12,500","Custom"],initOption:2,description:c.default.createElement(c.default.Fragment,null,"PubPub is built and maintained by"," ",c.default.createElement("a",{href:"https://www.knowledgefutures.org"},"Knowledge Futures Group"),", a nonprofit organization dedicated to building public knowledge infrastructure. KFG is supported by Members."," ",c.default.createElement("a",{href:"https://www.knowledgefutures.org/membership"},"Membership")," allows individuals and organizations of all sizes to support open infrastructure; receive discounts on Community Services; receive additional support on our products; meet and share ideas with other innovative knowledge communities; and join a community passionate about the future of knowledge infrastructure and its development."),discounts:["0% discount on all services","5% discount on all services","10% discount on all services","15% discount on all services"]}],t=l((0,c.useState)(e.reduce((function(e,t){var n;return r(r({},e),((n={})[t.title]=t.initOption,n))}),{})),2),n=t[0],a=t[1],i=l((0,c.useState)(""),2),o=i[0],u=i[1],p=l((0,c.useState)(""),2),h=p[0],b=p[1],v=l((0,c.useState)(!1),2),y=v[0],g=v[1],_=l((0,c.useState)(!1),2),E=_[0],P=_[1],w=function(e){a(r(r({},n),e))},O=[{url:"https://hdsr.mitpress.mit.edu/",img:"/static/landing/hdsr.png",title:"Harvard Data Science Review",source:"Harvard Data Science Initiative"},{url:"https://mit-serc.pubpub.org/",img:"/static/landing/serc.png",title:"The MIT Case Studies in Social and Ethical Responsibilities of Computing",source:"MIT Schwarzman College of Computing"},{quote:c.default.createElement(c.default.Fragment,null,"\"The amazing partnership and expertise of the PubPub team have allowed our editors to work with our authors in exciting new ways. They've helped us to develop works in progress, offer supplements and updates to traditionally published books, and produce enhanced digital editions (such as"," ",c.default.createElement("a",{href:"https://www.frankenbook.org/"},"Frankenbook"),') with innovative features to support teaching and learning. The future of publishing is here, and PubPub is helping us to take advantage of all that the digital medium can offer."'),source:"Gita Manaktala, Editorial Director, MIT Press"},{quote:c.default.createElement(c.default.Fragment,null,'"PubPub has been the ideal technology publishing partner for'," ",c.default.createElement("i",null,"Harvard Data Science Review"),' since launching in 2019. The talented team is flexible, easy to work with, and always aligned with our goals and what we are trying to accomplish."'),source:"Rebecca McLeod, Managing Director, Harvard Data Science Review"},{url:"https://tmb.apaopen.org/",img:"/static/landing/tmb.png",title:"Technology, Mind, and Behavior",source:"American Physcological Association"},{url:"https://phone-and-spear.pubpub.org/",img:"/static/landing/ps.png",title:"Phone & Spear",source:"Goldsmiths Press"},{quote:'"The PubPub team is bringing academic publishing into the 21st century. For decades I have been hoping to embed interactivity into figures and tables, and for the first time in my career I was able to do so with PubPub. The team\'s innovation and experience made for an incredible collaboration."',source:'Jeremy Bailenson, Author, "A Theoretical Argument for the Causes of Zoom Fatigue"'},{quote:'"Dawit and the PubPub team have been great in helping our article to be more interactive and exciting. Their expertise and open-minded approach have allowed us to present our work in a way that engages much more with our readers. Collaborating with the PubPub team has been a smooth and enriching experience, where we learned and experimented together with great fun!"',source:'Silvio Carta,  Author, "Self-Organizing Floor Plans"'},{url:"https://jbt.pubpub.org/",img:"/static/landing/jbt.png",title:"Journal of Biomolecular Techniques",source:"Association of Biomolecular Resource Facilities"},{url:"https://contours.pubpub.org",img:"/static/landing/contours.png",title:"Contours Collaborations",source:"Vanderbilt university"},{quote:'"PubPub has helped us transform the way we display and share scholarly works with the research community. The editorial boards of the open access journals that we engage with appreciate the option to embed interactive content and data visualizations into the body of a scholarly article.  Catherine and the PubPub team were incredibly responsive and fun to work with, and were also open to our feedback on platform development. In our experience, PubPub is the clear leader in next-generation academic publishing."',source:"Agnes B. Gambill, J.D., LLM"}];return c.default.createElement("div",{id:"community-services-container"},c.default.createElement(d.GridWrapper,{containerClassName:"narrow"},c.default.createElement("h1",null,"Community Services"),c.default.createElement("p",{className:"description top"},"PubPub is free to use. For groups that want personalized support we offer production, training, and strategy services for building high quality, effective publishing communities."),c.default.createElement("p",null,"For those looking to structure and operate their PubPub Community on their own, check out our"," ",c.default.createElement("a",{href:"https://help.pubpub.org/getting-started"},"Getting Started guide"),"!"),c.default.createElement("div",{className:"option-form"},c.default.createElement("div",{className:"title"},"To get started, tell us about your project"),c.default.createElement("p",{className:"description"},"We will work with you to identify exactly what your community needs. Below is our Community Services menu along with estimated costs. As a starting point for our conversation, please select the options you're considering and submit the form. We'll then be in touch to schedule a call."),e.map((function(t,a){if(1===a){var i=e[0].options[n["Content Production"]];return c.default.createElement(m.default,r({},t,{key:t.title,setVal:w,options:t.options[i],prices:t.prices[i]}))}return c.default.createElement(m.default,r({},t,{key:t.title,setVal:w}))})),c.default.createElement("div",{className:"title"},"Additional Details"),c.default.createElement(s.TextArea,{fill:!0,growVertically:!0,large:!0,placeholder:"Tell us anything else youâ€™d like us to know (e.g. timeline, content types, file types, links to example content, ...)",value:o,onChange:function(e){u(e.target.value)}}),c.default.createElement("div",{className:"title"},"Contact Email *"),c.default.createElement(s.InputGroup,{placeholder:"you@email.com...",value:h,required:!0,onChange:function(e){b(e.target.value)}}),c.default.createElement("div",{className:"success-row"},c.default.createElement(s.Button,{className:"button",intent:s.Intent.SUCCESS,text:"Send Details",disabled:!h.includes("@"),onClick:function(){P(!0);var t=Object.keys(n).reduce((function(t,r){var a=e.find((function(e){return e.title===r}));if(!a)return t;var i=n[r],o="Embedded Managing Editor"===r,l=e[0].options[n["Content Production"]],u=o?a.options[l]:a.options,c=o?a.prices[l]:a.prices;return(t+"\n\t\t\t"+r+": "+u[i]+", "+c[i]).trim()}),"");return(0,f.apiFetch)("/api/communityServices",{method:"POST",body:JSON.stringify({contactEmail:h,selections:t,additionalDetails:o})}).then((function(){b(""),u(""),P(!1),g(!0),setTimeout((function(){g(!1)}),5e3)})).catch((function(e){console.error(e),P(!1)}))},loading:E}),y&&c.default.createElement("div",{className:"tag-wrapper"},c.default.createElement(s.Tag,{icon:"tick",intent:s.Intent.SUCCESS,minimal:!0},"Submitted! We'll be in touch shortly.")))),c.default.createElement("p",{className:"mitops"},"For publishing services such as peer-review, copyediting, and research support, we partner with MITops. The"," ",c.default.createElement("a",{href:"https://mitops.mit.edu/services"},"full list of services offered by MITops")," ","is available on their site. Please"," ",c.default.createElement("a",{href:"https://mitops.mit.edu/contact"},"contact them directly")," to inquire about their offering."),c.default.createElement("h2",null,"See what we can do together!"),c.default.createElement("p",null,"Browse some of our previous and ongoing Community Services projects as well as testimonials from recent collaborators."),c.default.createElement("div",{className:"grid-wrapper"},O.map((function(e){return c.default.createElement("div",{className:"example",key:e.title||e.source},!!e.title&&c.default.createElement(c.default.Fragment,null,c.default.createElement("a",{href:e.url},c.default.createElement("img",{className:"example-img",src:e.img,alt:e.title})),c.default.createElement("a",{href:e.url,className:"hoverline"},c.default.createElement("div",{className:"example-title"},e.title)),c.default.createElement("div",{className:"example-source"},e.source)),!e.title&&c.default.createElement(c.default.Fragment,null,c.default.createElement("div",{className:"testimonial",key:e.source},c.default.createElement("div",{className:"testimonial-quote"},e.quote),c.default.createElement("div",{className:"testimonial-source"},"â€” ",e.source))))})))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=n(5),u=i(n(0));n(1269);t.default=function(e){var t=e.title,n=e.options,r=e.tooltips,a=e.prices,i=e.initOption,c=e.description,s=e.discounts,d=e.setVal,f=o((0,u.useState)(i),2),m=f[0],p=f[1];return u.default.createElement("div",{className:"service-option"},u.default.createElement("div",{className:"option-title-row"},u.default.createElement("div",{className:"option-title"},t),s&&u.default.createElement("div",{className:"option-discount"},s[m])),u.default.createElement("div",{className:"option-row"},u.default.createElement(l.ButtonGroup,null,n.map((function(e,n){var a=r?r[n]:"";return u.default.createElement(l.Tooltip,{key:e,content:a},u.default.createElement(l.Button,{text:e,active:m===n,disabled:"Requires Content Production"===e,onClick:function(){var e;p(n),d(((e={})[t]=n,e))}}))}))),u.default.createElement("div",{className:"option-price"},a[m])),u.default.createElement("div",{className:"option-description"},c))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(9),d=n(6),f=n(182),m=i(n(458)),p=n(264),h=n(1272),b=n(1274),v=l(n(1275)),y=l(n(1277));n(1281);t.default=function(e){var t=e.activityData,n=(0,s.usePageContext)(),r=n.scopeData,a=n.loginData.id,i=n.featureFlags,l=r.scope,g=r.memberData,_=o((0,u.useState)(g.find((function(e){return e.communityId}))),2),E=_[0],P=_[1],w=o((0,u.useState)([]),2),O=w[0],C=w[1],S=(0,h.useActivityItems)({initialActivityData:t,scope:l,userId:a,filters:O}),D=S.items,k=S.loadMoreItems,j=S.isLoading,M=S.loadedAllItems,N=(0,u.useMemo)((function(){return(0,b.getBoundaryGroupsForSortedActivityItems)(D)}),[D]),I=i.activityDigestSubscribeToggle&&E&&(0,p.checkMemberPermission)(E.permissions,"manage")&&"community"===r.elements.activeTargetType;return(0,f.useInfiniteScroll)({enabled:!j&&!M,useDocumentElement:!0,onRequestMoreItems:k,scrollTolerance:200}),u.default.createElement(d.DashboardFrame,{className:"dashboard-activity-container",title:"Activity",controls:I&&u.default.createElement(c.Switch,{checked:E.subscribedToActivityDigest,className:"parent-approval-switch",onChange:function(e){return(t=e.target.checked,m.updateMember({member:E,update:{subscribedToActivityDigest:t},scopeIds:{communityId:l.communityId}})).then(P);var t},label:"Subscribe to daily Activity digest emails"})},u.default.createElement(v.default,{activeFilters:O,onUpdateActiveFilters:C,scope:l}),D.length>0&&u.default.createElement("div",{className:"activity-items"},N.map((function(e){return u.default.createElement(y.default,{items:e.items,label:e.label,key:e.key})}))),0===D.length&&M&&u.default.createElement(c.NonIdealState,{icon:"clean",className:"empty-state",title:"No matching activity to show",action:u.default.createElement(c.Button,{outlined:!0,onClick:function(){return C([])}},"Clear filters")}),j&&u.default.createElement("div",{className:"loading-indicator"},u.default.createElement(c.Spinner,{size:28})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useActivityItems=void 0;var l=n(0),u=n(462),c=n(18),s=n(1273),d={queries:{},associations:(0,s.createActivityAssociations)(),itemsById:{}},f={isLoading:!1,loadedAllItems:!1,offset:0,itemIds:[]},m=function(e){var t=e.filters.concat().sort();return JSON.stringify({filters:t})},p=function(e,t){var n=t.activityItems,r=t.fetchedAllItems,a=e||f,l=a.itemIds,u=a.offset,c=n.map((function(e){return e.id}));return{loadedAllItems:r,isLoading:!1,itemIds:o(o([],i(l),!1),i(c),!1),offset:u+c.length}},h=function(e,t,n){var a=r({},e);return t.forEach((function(e){a[e.id]||(a[e.id]=(0,u.renderActivityItem)(e,n))})),a},b=function(e,t,n,a){var i,o=m(t),l=function(e,t){var n=(0,s.createActivityAssociations)();return Object.keys(n).forEach((function(a){n[a]=r(r({},e[a]),t[a])})),n}(e.associations,n.associations);return r(r({},e),{associations:l,queries:r(r({},e.queries),(i={},i[o]=p(e.queries[o],n),i)),itemsById:h(e.itemsById,n.activityItems,r(r({},a),{associations:l}))})};t.useActivityItems=function(e){var t=e.filters,n=void 0===t?[]:t,o=e.initialActivityData,u=e.batchSize,s=void 0===u?50:u,p=a(e,["filters","initialActivityData","batchSize"]),h=i((0,l.useState)((function(){return b(d,{filters:n},o,p)})),2),v=h[0],y=h[1],g={filters:n},_=m({filters:n}),E=v.queries[_]||f;return{items:(0,l.useMemo)((function(){var e=E.itemIds,t=v.itemsById;return e.map((function(e){return t[e]})).filter((function(e){return!!e}))}),[E,v]),loadMoreItems:function(){y((function(e){return function(e,t){var n,a=m(t);return r(r({},e),{queries:r(r({},e.queries),(n={},n[a]=r(r(r({},f),e.queries[a]),{isLoading:!0}),n))})}(e,g)})),c.apiFetch.post("/api/activityItems",{offset:E.offset,scope:p.scope,filters:g.filters,limit:s}).then((function(e){y((function(t){return b(t,g,e,p)}))}))},isLoading:E.isLoading,loadedAllItems:E.loadedAllItems}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createActivityAssociations=t.createActivityAssociationSets=t.createActivityAssociationArrays=void 0;var r=n(340),a=function(e){var t={};return r.activityAssociationTypes.forEach((function(n){t[n]=e()})),t};t.createActivityAssociationArrays=function(){return a((function(){return[]}))};t.createActivityAssociationSets=function(){return a((function(){return new Set}))};t.createActivityAssociations=function(){return a((function(){return{}}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundaryGroupsForSortedActivityItems=void 0;var o=i(n(87)),l=function(e){var t=new Date(e);return t.setHours(23,59,59,999),t.valueOf()},u=function(e){return{definition:l(e),label:"Today"}},c=function(e,t){var n=new Date(t);n.setDate(n.getDate()-e);var r=1===e?"Yesterday":"This week";return{definition:l(n),label:r}},s=function(e,t){var n=new Date(t);n.setDate(n.getDate()-n.getDay());var r=new Date(n);r.setDate(r.getDate()-7*(e-1));var a=1===e?"Last week":e+" weeks ago";return{definition:l(r),label:a}},d=function(e,t){var n=new Date(t.getFullYear(),t.getMonth()+1,1),r=new Date(n);r.setMonth(r.getMonth()-e);var a=new Date(r);a.setDate(a.getDate()-1);var i=(0,o.default)(a,"mmmm yyyy");return{definition:l(a),label:i}};t.getBoundaryGroupsForSortedActivityItems=function(e){if(0===e.length)return[];for(var t,n,i,o,l=new Date,f=a([],r(e),!1),m=function(e,t){for(var n=t.valueOf(),r=[u(e),c(1,e),c(2,e),s(1,e)],a=1;r[r.length-1].definition>=n;)r.push(d(a,e)),++a;return r.push(d(a,e)),r}(l,f[f.length-1].timestamp),p=[],h=0;h<m.length-2;h++){for(var b=m[h],v=m[h+1],y=[];f[0]&&(t=f[0],n=b,i=v,o=void 0,(o=t.timestamp.valueOf())<n.definition&&o>=i.definition);)y.push(f.shift());y.length>0&&p.push({label:b.label,key:b.definition,items:y})}return p}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(469),c=n(6);n(1276);var s={community:{label:"Community",icon:"office"},collection:{label:"Collections",icon:"collection"},pub:{label:"Pubs",icon:"pubDoc"},page:{label:"Pages",icon:"page-layout"},member:{label:"Members",icon:"people"},review:{label:"Reviews",icon:"social-media"},discussion:{label:"Discussions",icon:"chat"},pubEdge:{label:"Connections",icon:"layout-auto"},submission:{label:"Submissions",icon:"manually-entered-data"}},d=Object.keys(s),f=function(e){return e.concat().sort((function(e,t){return d.indexOf(e)-d.indexOf(t)}))},m={community:f(["community","collection","pub","page","member","review","discussion","submission"]),collection:f(["pub","member","review","discussion","submission"]),pub:f(["member","review","discussion","pubEdge","submission"])};t.default=function(e){var t=e.activeFilters,n=e.onUpdateActiveFilters,i=e.scope;return o.default.createElement("div",{className:(0,l.default)("activity-filters-component",t.length>0&&"some-filters-active")},o.default.createElement("div",{className:"label"},"Filter by"),function(e){return"pubId"in e&&e.pubId?m.pub:"collectionId"in e&&e.collectionId?m.collection:m.community}(i).map((function(e){var i=s[e],l=i.label,d=i.icon;return o.default.createElement(u.Checkbox,{key:e,as:"div",className:"activity-filter",checked:t.includes(e),onChange:function(){return n((o=e,(i=t).includes(o)?i.filter((function(e){return e!==o})):a(a([],r(i),!1),[o],!1)));var i,o}},o.default.createElement(c.Icon,{icon:d,iconSize:12}),l)})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(1278));n(1280);t.default=function(e){var t=e.items,n=e.label;return a.default.createElement("div",{className:"activity-item-group-component"},a.default.createElement("div",{className:"heading"},a.default.createElement("div",{className:"label"},n)),t.map((function(e){return a.default.createElement(i.default,{item:e,key:e.id})})))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(67),o=n(6);n(1279);t.default=function(e){var t=e.item,n=t.message,r=t.excerpt,l=t.timestamp,u=t.icon;return a.default.createElement("div",{className:"activity-item-row-component"},a.default.createElement("div",{className:"timestamp"},(0,i.formatDate)(l,{includeTime:!0})),a.default.createElement("div",{className:"icon"},a.default.createElement(o.Icon,{icon:u})),a.default.createElement("div",{className:"message"},n),r&&a.default.createElement("div",{className:"excerpt"},r))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(71),f=n(5),m=n(6),p=n(9),h=o(n(279));n(1283);t.default=function(e){var t=(0,p.usePageContext)().communityData,n=c((0,s.useState)(e.collection),2),a=n[0],i=n[1],o=c((0,s.useState)({}),2),b=o[0],v=o[1],y=c((0,s.useState)(!1),2),g=y[0],_=y[1],E=r(r({},a),b),P=c((0,s.useState)(!E.pageId),2),w=P[0],O=P[1],C=E.layout,S=void 0===C?{blocks:[]}:C,D=Object.keys(b).length>0,k=D&&(w||E.pageId),j=(0,s.useCallback)((function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return _(!0),[4,h.updateCollection({communityId:t.id,collectionId:E.id,updatedCollection:b})];case 1:return e.sent(),_(!1),i((function(e){return r(r({},e),b)})),v({}),[2]}}))}))}),[E.id,t.id,b]),M=(0,s.useCallback)((function(e){return v((function(t){return r(r({},t),e)}))}),[]),N=(0,s.useCallback)((function(e){return v((function(t){return r(r({},t),{layout:r(r({},S),e)})}))}),[S]);(0,d.useUpdateEffect)((function(){w&&M({pageId:null})}),[w,M]),(0,d.useBeforeUnload)(D,"You have unsaved changes to this Collection. Are you sure you want to navigate away?");return s.default.createElement(m.DashboardFrame,{className:"dashboard-collection-layout-container",title:"Layout",details:"Change how this Collection is presented to readers.",controls:s.default.createElement(s.default.Fragment,null,s.default.createElement(f.Button,{type:"button",intent:"primary",text:"Save Changes",disabled:!k,loading:g,onClick:j}))},s.default.createElement(m.SettingsSection,{title:"General"},s.default.createElement(f.RadioGroup,{className:"layout-enable-radio",selectedValue:w?1:0,onChange:function(e){return O("1"===e.target.value)}},s.default.createElement(f.Radio,{labelElement:"Use a layout for this Collection",value:1}),s.default.createElement(f.Radio,{className:"page-select",labelElement:s.default.createElement(s.default.Fragment,null,"Use a Page as the landing page for this Collection: Â ",s.default.createElement(m.LinkedPageSelect,{pages:t.pages,selectedPageId:E.pageId||null,onSelectPage:function(e){return M({pageId:e.id})},disabled:w})),value:0})),s.default.createElement(m.ImageUpload,{htmlFor:"dashboard-page-avatar",label:"Preview Image",defaultImage:E.avatar,onNewImage:function(e){return M({avatar:e})},canClear:!0,helperText:"This image will appear in links from other Collections or Pages to this Collection."}),w&&s.default.createElement(m.InputField,{label:"Layout width"},s.default.createElement(f.ButtonGroup,null,s.default.createElement(f.Button,{active:!S.isNarrow,onClick:function(){return N({isNarrow:!1})},text:"Wide"}),s.default.createElement(f.Button,{active:S.isNarrow,onClick:function(){return N({isNarrow:!0})},text:"Narrow"})))),w&&s.default.createElement(m.SettingsSection,{title:"Blocks"},s.default.createElement(m.LayoutEditor,{initialLayout:S.blocks,initialLayoutPubsByBlock:e.layoutPubsByBlock,collection:E,communityData:t,onChange:function(e){return N({blocks:e})}})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(9),d=n(1285),f=n(6),m=l(n(1286));n(1288);t.default=function(e){var t=e.customScripts,r=t.js,a=t.css,l=(0,s.usePageContext)().communityData.id,p=o((0,u.useState)(null),2),h=p[0],b=p[1];(0,u.useEffect)((function(){Promise.resolve().then((function(){return i(n(1580))})).then((function(e){var t=e.default;return b(t)}))}),[]);return u.default.createElement(f.DashboardFrame,{className:"dashboard-custom-scripts-container",title:"Custom Scripts"},u.default.createElement("div",{className:"callout-text"},u.default.createElement(c.Callout,{className:"error-callout",intent:"warning",title:"Warning: Experimental"},"Custom CSS lets you change the look and feel of your Community, but it also lets you introduce bugs that make it hard or impossible to use. The PubPub team may also make changes to our own source code that could break your CSS without warning. We don't provide support for problems caused by Custom CSS. Use caution (but have fun!) ",u.default.createElement("br",null),"Note that Custom CSS is not loaded on your Dashboard â€” including this page â€” so you can always return here to undo your changes if they are causing problems.")),!h&&u.default.createElement("div",{className:"loading-indicator"},u.default.createElement(c.Spinner,{size:14})," Loading editor"),h&&u.default.createElement(c.Tabs,{id:"custom-scripts-tabs"},u.default.createElement(c.Tab,{id:"css",title:"CSS",panel:u.default.createElement(m.default,{initialContent:a,type:"css",language:"css",label:"CSS",EditorComponent:h})}),(0,d.communityCanUseCustomScripts)(l)&&u.default.createElement(c.Tab,{id:"js",title:"JavaScript",panel:u.default.createElement(m.default,{initialContent:r,type:"js",language:"javascript",label:"JavaScript",EditorComponent:h})})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.communityCanUseCustomScripts=void 0;var r=["6ffd8432-b3c1-4094-8ee1-a9de2e72cc27","eb361ef0-d557-4cac-a949-8bd196e096e7","e164d5cb-585e-4170-bad8-10d09e08d1bc","0417b0c0-cd38-48bd-8a84-b0b95da98813","36a3e2c8-74ed-417f-b616-4b57b85b9338"];t.communityCanUseCustomScripts=function(e){return r.includes(e)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=n(71),d=n(5),f=n(18),m=n(9);n(1287);var p=function(e,t,n){return f.apiFetch.post("/api/customScripts",{communityId:e,type:t,content:n})};t.default=function(e){var t=(0,m.usePageContext)().communityData,n=e.EditorComponent,r=e.initialContent,a=e.language,i=e.label,f=e.type,h=u((0,c.useState)(r||""),2),b=h[0],v=h[1],y=u((0,c.useState)(b),2),g=y[0],_=y[1],E=u((0,c.useState)(!1),2),P=E[0],w=E[1],O=b!==g;(0,s.useBeforeUnload)(O);return c.default.createElement("div",{className:"custom-script-panel-component"},c.default.createElement(d.Button,{outlined:!0,disabled:!O,onClick:function(){return o(void 0,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return w(!0),[4,p(t.id,f,b)];case 1:return e.sent(),_(b),w(!1),[2]}}))}))},intent:"primary",className:"save-changes-button"},P?"Saving...":"Save "+i),c.default.createElement(n,{value:b,onChange:function(e){return void 0!==e&&v(e)},theme:"vs-dark",defaultLanguage:a,options:{minimap:{enabled:!1}}}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(9);n(1290);t.default=function(e){e.discussionsData,(0,i.usePageContext)().scopeData;return a.default.createElement("div",{className:"dashboard-discussions-container"},a.default.createElement("h2",{className:"dashboard-content-header"},"Discussions"))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=o(n(0)),m=n(5),p=n(18),h=n(6),b=n(9),v=n(40),y=d(n(1292)),g=d(n(470)),_=n(1297);n(1298);var E=f.default.createElement(f.default.Fragment,null,f.default.createElement("p",null,"Create & manage relationships between this Pub and other Pubs in your Community or publications elsewhere on the internet."),f.default.createElement("p",null,"Connection previews will be shown near the header and footer of this Pub's layout."));t.default=function(e){var t,n=e.pubData,a=(0,b.usePageContext)().scopeData.activePermissions.canManage,i=c((0,f.useState)(n),2),o=i[0],d=i[1],P=c((0,f.useState)(null),2),w=P[0],O=P[1],C=(0,b.usePendingChanges)().pendingPromise,S=c((0,f.useState)(!1),2),D=S[0],k=S[1],j=c((0,f.useState)(),2),M=j[0],N=j[1],I=!w,x=(0,_.useDashboardEdges)(n),T=x.inboundEdges,A=x.outboundEdges,R=x.addCreatedOutboundEdge,B=x.reorderOutboundEdges,F=x.updateOutboundEdge,L=x.removeOutboundEdge,U=x.updateInboundEdgeApproval,z=function(e){return l(void 0,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),d(r(r({},o),e)),[4,(0,p.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify(r({pubId:o.id},e))})];case 1:return t.sent(),[3,3];case 2:return t.sent(),d(o),[3,3];case 3:return[2]}}))}))},H=function(e){k(!0),C(p.apiFetch.post("/api/pubEdges",r(r({},e),{pubId:n.id,targetPub:void 0}))).then((function(e){O(null),k(!1),R(e)})).catch((function(e){O(null),k(!1),N(e.message)}))};return f.default.createElement(h.DashboardFrame,{className:"dashboard-edges-container",title:"Connections",details:f.default.createElement(f.default.Fragment,null,E," ",a&&n.crossrefDepositRecord&&f.default.createElement(m.Callout,{intent:m.Intent.WARNING,title:"Redeposit Warning"},"This Pub has been deposited to Crossref. If you choose to update this Pub's connections, you will need to"," ",f.default.createElement("a",{href:(0,v.getDashUrl)({pubSlug:n.slug,mode:"settings"})},"re-deposit the Pub")," ","for the updated relationships to appear in Crossref."))},a&&f.default.createElement("div",{className:"default-settings"},f.default.createElement(m.RadioGroup,{inline:!0,className:"carousel-radio",onChange:function(e){var t="carousel"===e.target.value;z({pubEdgeListingDefaultsToCarousel:t})},selectedValue:o.pubEdgeListingDefaultsToCarousel?"carousel":"list",label:"Show multiple Connections as:"},f.default.createElement(m.Radio,{value:"carousel"},"Carousel"),f.default.createElement(m.Radio,{value:"list"},"List")),f.default.createElement(m.Switch,{inline:!0,label:"Show Description by default",checked:o.pubEdgeDescriptionVisible,onChange:function(e){return z({pubEdgeDescriptionVisible:e.target.checked})}})),f.default.createElement(m.Tabs,{id:"pub-dashboard-connections-tabs"},f.default.createElement(m.Tab,{id:"created-by-this-pub",panel:(t=s([n.id],c(n.outboundEdges.map((function(e){return e.targetPub&&e.targetPub.id})).filter((function(e){return!!e}))),!1),f.default.createElement(f.default.Fragment,null,a&&f.default.createElement(g.default,{usedPubIds:t,pubData:o,pubEdge:w,onCancel:function(){return O(null)},onSave:H,onChange:O,loading:D,error:M}),f.default.createElement(y.default,{pubData:o,pubEdges:A,onUpdateEdge:a?F:void 0,onReorderEdges:a?B:void 0,onRemoveEdge:a?L:void 0,isInbound:!1,renderEmptyState:function(){return I&&f.default.createElement(m.NonIdealState,{icon:"layout-auto",title:"No connections yet",description:a?"Start typing above to add a new connection.":"Connections created from this Pub will appear here."})}}))),title:"Created by this Pub"}),f.default.createElement(m.Tab,{id:"created-by-other-pubs",panel:f.default.createElement(y.default,{pubData:o,pubEdges:T,onUpdateEdgeApproval:a?U:void 0,isInbound:!0,renderEmptyState:function(){return f.default.createElement(m.NonIdealState,{icon:"layout-auto",title:"No connections from other Pubs",description:"When other authors add connections to this Pub, they will be listed here."})}}),title:"Created by other Pubs"})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(5),s=u(n(3)),d=o(n(0)),f=n(118),m=n(9),p=n(18),h=n(6),b=u(n(470));t.default=function(e){var t=e.isInbound,n=e.onUpdateEdge,a=void 0===n?null:n,i=e.onRemoveEdge,o=void 0===i?null:i,u=e.onReorderEdges,v=void 0===u?null:u,y=e.onUpdateEdgeApproval,g=void 0===y?null:y,_=e.pubData,E=e.pubEdges,P=e.renderEmptyState,w=l((0,d.useState)(),2),O=w[0],C=w[1],S=(0,m.usePendingChanges)().pendingPromise,D=l((0,d.useState)(!1),2),k=D[0],j=D[1],M=l((0,d.useState)(),2),N=M[0],I=M[1],x=function(e){j(!0),S(p.apiFetch.put("/api/pubEdges",r(r({pubEdgeId:e.id},e),{pubId:_.id,targetPub:void 0}))).then((function(e){C(void 0),j(!1),null==a||a(e)})).catch((function(e){C(void 0),j(!1),I(e.message)}))};return d.default.createElement(f.DragDropContext,{onDragEnd:function(e){var t=e.source,n=e.destination;v&&v(t.index,n.index)}},d.default.createElement(h.DragDropListing,{className:"dashboard-edges-listing-component",disabled:!v,itemId:function(e){return e.id},items:E,renderItem:function(e,n,i){var l,u=e.approvedByTarget,f=!!g&&!u;return d.default.createElement("div",{className:(0,s.default)("dashboard-edge-listing-item",i&&"is-dragging",f&&"not-approved")},v&&d.default.createElement("div",r({},n,{className:"drag-handle"}),d.default.createElement(c.Icon,{icon:"drag-handle-vertical"})),(null==O?void 0:O.id)===e.id?d.default.createElement(b.default,{pubData:_,pubEdge:O,usedPubIds:[],onCancel:function(){return C(void 0)},onChange:C,onSave:x,saveButtonLabel:"Save connection",loading:k,error:N}):d.default.createElement(h.PubEdgeListingCard,{pubData:_,pubEdge:e,isInboundEdge:t,accentColor:"#ccc"},a&&d.default.createElement(c.Button,{onClick:function(){return C(e)},outlined:!0,minimal:!0,icon:"edit"},"Edit"),o&&(l=function(){return o(e)},d.default.createElement(h.ConfirmDialog,{onConfirm:l,confirmLabel:"Remove",text:"Are you sure you want to remove this connection?"},(function(e){var t=e.open;return d.default.createElement(c.Button,{onClick:t,outlined:!0,minimal:!0,icon:"small-cross"},"Remove")}))),g&&d.default.createElement(c.Switch,{className:"parent-approval-switch",onChange:function(){return g(e,!u)},checked:u,label:"Show on this Pub"})))},renderEmptyState:P,droppableId:"dashboardEdges",droppableType:"DASHBOARD_EDGE",withDragHandles:!!v}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(107),d=l(n(1294)),f=n(6),m=n(18),p=n(471),h=n(9),b=n(133);n(1295);var v={wrapperTagName:"div",minimal:!0,position:c.Position.BOTTOM_LEFT,modifiers:{preventOverflow:{enabled:!1},hide:{enabled:!1}},usePortal:!1},y=u.default.createElement(f.PubMenuItem,{key:"indeterminate",title:"X".repeat(50),contributors:["ABC","XYZ"],isSkeleton:!0,showImage:!0,disabled:!0,id:null,onClick:function(){}}),g=function(){return""};t.default=function(e){var t=e.usedPubIds,n=e.onSelectItem,r=o((0,u.useState)(""),2),a=r[0],i=r[1],l=(0,h.useThrottled)(a,250,!0,!0),_=o((0,u.useState)(null),2),E=_[0],P=_[1],w=o((0,u.useState)(null),2),O=w[0],C=w[1],S=(0,b.useManyPubs)({query:{term:E||""},batchSize:5}),D=S.allQueries.isLoading,k=S.currentQuery.pubs,j=O?[O]:k.map((function(e){return{targetPub:e}}));(0,u.useEffect)((function(){(0,d.default)(l)||(0,p.isDoi)(l)?(C({indeterminate:!0}),m.apiFetch.get("/api/pubEdgeProposal?object="+encodeURIComponent(l)).then((function(e){C(e||{createNewFromUrl:l})}))):(P(l),C(null))}),[l,t]);return u.default.createElement(s.Suggest,{className:"new-edge-input-component",items:j,inputProps:{large:!0,placeholder:"Search to add Pubs from this Community, or enter a URL or DOI"},inputValueRenderer:g,onQueryChange:function(e){return i(e.trim())},itemRenderer:function(e,t){var n=t.handleClick,r=t.modifiers;if("indeterminate"in e&&e.indeterminate)return y;if("targetPub"in e&&e.targetPub){var a=e.targetPub;return u.default.createElement(f.PubMenuItem,{id:a.id,key:a.id,title:u.default.createElement(f.PubTitle,{pubData:a}),contributors:a.attributions.filter((function(e){return e.isAuthor})),image:a.avatar,active:r.active,onClick:n,showImage:!0})}if("externalPublication"in e&&e.externalPublication&&e.externalPublication.title){var i=e.externalPublication,o=i.title,l=i.contributors,s=i.avatar,d=i.id;return u.default.createElement(f.PubMenuItem,{key:o,id:d,title:o,contributors:l,image:s,onClick:n,showImage:!!s,active:r.active})}return u.default.createElement(c.MenuItem,{key:"from-url",onClick:n,text:"Create a connection for this URL"})},resetOnSelect:!0,onItemSelect:n,noResults:a?u.default.createElement(c.MenuItem,{disabled:!0,className:"loading-menu-item",text:D?"Loading...":"No results",icon:D&&u.default.createElement(c.Spinner,{size:16})}):null,popoverProps:v})}},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useDashboardEdges=void 0;var o=n(0),l=n(9),u=n(164),c=n(18);t.useDashboardEdges=function(e){var t=a((0,o.useState)((0,u.sortByRank)(e.outboundEdges)),2),n=t[0],s=t[1],d=a((0,o.useState)((0,u.sortByRank)(e.inboundEdges)),2),f=d[0],m=d[1],p=(0,l.usePendingChanges)().pendingPromise;return{outboundEdges:n,inboundEdges:f,addCreatedOutboundEdge:function(e){s((0,u.sortByRank)(i(i([],a(n),!1),[e],!1)))},reorderOutboundEdges:function(e,t){var o=i([],a(n),!1),l=a(o.splice(e,1),1)[0],d=(0,u.findRankInRankedList)(o,t),f=r(r({},l),{rank:d});o.splice(t,0,f),p(c.apiFetch.put("/api/pubEdges",{pubEdgeId:f.id,rank:d})),s(o)},updateOutboundEdge:function(e){var t=n.findIndex((function(t){return t.id===e.id})),r=i([],a(n),!1);r[t]=e,s(r)},removeOutboundEdge:function(e){p(c.apiFetch.delete("/api/pubEdges",{pubEdgeId:e.id})),s(n.filter((function(t){return t.id!==e.id})))},updateInboundEdgeApproval:function(e,t){m(f.map((function(n){return n.id===e.id?r(r({},n),{approvedByTarget:t}):n}))),p(c.apiFetch.put("/api/pubEdges/approvedByTarget",{pubEdgeId:e.id,approvedByTarget:t}))}}}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(9),o=n(5),l=r(n(468)),u=n(6);n(1300);t.default=function(e){var t=e.impactData,n=t.baseToken,r=t.benchmarkToken,c=(0,i.usePageContext)().scopeData,s=c.elements,d=s.activeTargetType,f=s.activeTargetName,m=s.activeTarget,p=c.activePermissions.canView,h=m.createdAt<"2020-04-29",b="collection"===d,v=function(e){return"https://metabase.pubpub.org/embed/dashboard/"+e+"#bordered=false&titled=false"},y=function(e){return e<960?45:61};return a.default.createElement(u.DashboardFrame,{title:"Impact",className:"dashboard-impact-container",details:"Learn more about who your "+f+" is reaching."},a.default.createElement("section",null,a.default.createElement("h3",{id:"historical_benchmark",className:"absolute-header"},"Analytics",p&&!b&&h&&a.default.createElement(o.Tooltip,{content:a.default.createElement("div",{className:"impact-warning-tooltip"},"Analytics data collected before April 30, 2020 used a different analytics system than data collected after April 30, 2020. As a result, the Users metric will be inconsistent between these two periods, and should not be used for direct comparisons. For more information, see our"," ",a.default.createElement("a",{href:"https://discourse.knowledgefutures.org/t/user-metric-discrepancies-between-july-12-2019-and-april-30-2020/259",target:"_blank",rel:"noopener noreferrer"},"explanatory Discourse post")," ","and the"," ",a.default.createElement("a",{href:"#historical_benchmark"},"Historical Benchmark Dashboard"),", below."),hoverCloseDelay:300,intent:o.Intent.WARNING,position:o.Position.BOTTOM_LEFT,interactionKind:o.PopoverInteractionKind.HOVER},a.default.createElement(o.Button,{className:"warning-button",intent:o.Intent.WARNING,icon:"warning-sign",minimal:!0}))),p?a.default.createElement(l.default,{className:"metabase main",src:v(n),title:"Analytics",frameBorder:"0",onResized:function(e){var t=e.iframe,n=e.height,r=e.width;t.style.height=n-y(r)+"px"}}):a.default.createElement("p",null,"Login or ask the community administrator for access to impact data.")),a.default.createElement("section",null,p&&h&&a.default.createElement(a.default.Fragment,null,a.default.createElement("h3",{id:"historical_benchmark",className:"absolute-header"},"Historical User Benchmark",a.default.createElement(o.Tooltip,{content:a.default.createElement("div",{className:"impact-warning-tooltip"},"This dashboard shows the historical user metric (prior to April 30, 2020) graphed against the new user metric during an overlap period, for making comparisons between the two. For more information, see our"," ",a.default.createElement("a",{href:"https://discourse.knowledgefutures.org/t/user-metric-discrepancies-between-july-12-2019-and-april-30-2020/259",target:"_blank",rel:"noopener noreferrer"},"explanatory Discourse post")),hoverCloseDelay:300,intent:o.Intent.WARNING,position:o.Position.BOTTOM_LEFT,interactionKind:o.PopoverInteractionKind.HOVER},a.default.createElement(o.Button,{className:"warning-button",intent:o.Intent.WARNING,icon:"warning-sign",minimal:!0}))),a.default.createElement(l.default,{className:"metabase benchmark",src:v(r),title:"Benchmark",frameBorder:"0",onResized:function(e){var t=e.iframe,n=e.height,r=e.width;t.style.height=n-y(r)+"px"}}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=n(9),u=n(457);n(1302);t.default=function(e){var t=e.membersData,n=(0,u.useMembersState)({initialMembers:t.members}),r=n.membersByType,c=n.addMember,s=n.updateMember,d=n.removeMember,f=(0,l.usePageContext)().scopeData,m=f.elements,p=m.activeTargetType,h=m.activeTargetName,b=f.activePermissions.canManage,v=r[p],y=!v.length&&!t.invitations.length,g=r.collection.length&&"collection"!==p||r.community.length&&"community"!==p||r.organization.length&&"organization"!==p;return a.default.createElement(o.DashboardFrame,{className:"dashboard-members-container",title:"Members",details:"Invite and manage collaborators on this "+h+"."},b&&a.default.createElement(o.SettingsSection,{title:"Add Member"},a.default.createElement(i.ControlGroup,{className:"add-member-controls"},a.default.createElement(o.UserAutocomplete,{onSelect:c,usedUserIds:v.map((function(e){return e.userId}))}),a.default.createElement(i.Button,{large:!0,text:"Add",intent:i.Intent.PRIMARY}))),a.default.createElement(o.SettingsSection,{title:"Members ("+v.length+")"},y&&a.default.createElement("i",null,"No members yet."),t.invitations.map((function(e){return a.default.createElement(o.MemberRow,{isInvitation:!0,memberData:e,key:e.id})})),r[p].map((function(e){return a.default.createElement(o.MemberRow,{memberData:e,isReadOnly:!b,isOnlyMemberInScope:1===r[p].length,onUpdate:s,onDelete:d,key:e.id})}))),!!g&&a.default.createElement(o.SettingsSection,{title:"Inherited Members"},!!r.collection.length&&"collection"!==p&&a.default.createElement(o.InheritedMembersBlock,{members:r.collection,scope:"Collection"}),!!r.community.length&&"community"!==p&&a.default.createElement(o.InheritedMembersBlock,{members:r.community,scope:"Community"}),!!r.organization.length&&"organization"!==p&&a.default.createElement(o.InheritedMembersBlock,{members:r.organization,scope:"Organization"})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DashboardPubOverview=t.DashboardCollectionOverview=t.DashboardCommunityOverview=void 0;var a=n(1304);Object.defineProperty(t,"DashboardCommunityOverview",{enumerable:!0,get:function(){return r(a).default}});var i=n(1330);Object.defineProperty(t,"DashboardCollectionOverview",{enumerable:!0,get:function(){return r(i).default}});var o=n(1337);Object.defineProperty(t,"DashboardPubOverview",{enumerable:!0,get:function(){return r(o).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1305);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=n(9),f=n(40),m=l(n(467)),p=l(n(1306)),h=n(223),b=[{label:"Edit home page",icon:"page-layout",href:(0,f.getDashUrl)({mode:"pages",subMode:"home"})},{label:"Edit nav bar",icon:"cog",href:(0,f.getDashUrl)({mode:"settings",section:"navigation"})},{label:"Edit members/roles",icon:"people",href:(0,f.getDashUrl)({mode:"members"})}];t.default=function(e){var t=e.overviewData,n=t.pubs,r=t.recentPubs,a=t.userScopeVisits,i=t.collections,l=t.includesAllPubs,f=(0,d.usePageContext)(),v=f.communityData,y=f.scopeData.activePermissions.canManage,g=o((0,u.useState)(!1),2),_=g[0],E=g[1];return u.default.createElement(s.DashboardFrame,{title:"Overview",controls:y&&u.default.createElement(s.MobileAware,{mobile:u.default.createElement("div",null,u.default.createElement(c.Button,{icon:"plus",onClick:function(){return E(!0)},outlined:!0},"Create Collection"),u.default.createElement(m.default,{isOpen:_,onClose:function(){E(!1)}}))})},u.default.createElement(h.OverviewFrame,{primary:u.default.createElement(h.OverviewSection,{title:"Explore",icon:"overview",descendTitle:!0},u.default.createElement(p.default,{initialPubs:n,collections:i,initiallyLoadedAllPubs:l})),secondary:u.default.createElement(u.default.Fragment,null,a.length>0&&u.default.createElement(h.OverviewSection,{title:"recently viewed"},u.default.createElement(h.RecentVisitList,{userScopeVisits:a,pubs:r,collections:i})),y&&u.default.createElement(h.OverviewSection,{title:"Quick Actions",spaced:!0},u.default.createElement(h.QuickActions,{actions:b})),u.default.createElement(h.OverviewSection,{title:"About"},u.default.createElement(h.ScopeSummaryList,{scope:v,scopeKind:"community"})))}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=n(5),s=n(453),d=n(133),f=n(182),m=n(184),p=n(223);n(1329);var h=function(e,t){return e&&t?"Search Collections and Pubs":e?"Search Collections":"Search Pubs"};t.default=function(e){var t=e.collections,n=e.initialPubs,a=e.initiallyLoadedAllPubs,i=l((0,u.useState)(""),2),o=i[0],b=i[1],v=l((0,u.useState)(null),2),y=v[0],g=v[1],_=l((0,u.useState)(!0),2),E=_[0],P=_[1],w=l((0,u.useState)(!0),2),O=w[0],C=w[1],S=null==y?void 0:y.query,D=!!S||!!o,k=(0,u.useMemo)((function(){return t.filter((function(e){return(0,s.fuzzyMatchCollection)(e,o)}))}),[t,o]),j=(0,d.useManyPubs)({isEager:D,initialPubs:n,initiallyLoadedAllPubs:a,batchSize:200,query:r({term:o,ordering:{field:"title",direction:"ASC"}},null==y?void 0:y.query)}).currentQuery,M=j.pubs,N=j.hasLoadedAllPubs,I=j.loadMorePubs,x=!S,T=!N&&E;(0,f.useInfiniteScroll)({enabled:T,useDocumentElement:!0,onRequestMoreItems:I});return u.default.createElement("div",{className:"community-items-component"},u.default.createElement(p.OverviewSearchGroup,{placeholder:h(O,E),onUpdateSearchTerm:function(e){return""===e&&b(e)},onCommitSearchTerm:b,onChooseFilter:g,rightControls:u.default.createElement(u.default.Fragment,null,x&&u.default.createElement(p.KindToggle,{selected:O,onSelect:function(){C(!O),O&&!E&&P(!0)},icon:"collection",label:"Collections",count:k.length}),u.default.createElement(p.KindToggle,{selected:E||!x,onSelect:function(){P(!E),E&&!O&&C(!0)},icon:"pubDoc",label:"Pubs",count:N?M.length:M.length+"+",disabled:!x}))}),u.default.createElement(m.OverviewRows,null,O&&x&&k.map((function(e){return u.default.createElement(m.ExpandableCollectionOverviewRow,{collection:e,key:e.id})})),E&&M.map((function(e){return u.default.createElement(m.PubOverviewRow,{pub:e,key:e.id})})),T&&u.default.createElement(m.LoadMorePubsRow,{isLoading:!0}),function(){if(0===k.length){if(0===n.length)return u.default.createElement(c.NonIdealState,{icon:"clean",title:"This Community looks brand new!",description:"Try creating a Pub or Collection from above."});if(0===M.length&&N&&D)return u.default.createElement(m.SpecialRow,null,"No matching Pubs or Collections.")}return null}()))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=l(n(80)),d=n(133),f=n(183),m=n(9),p=l(n(472)),h=l(n(475)),b=l(n(476)),v=l(n(477)),y=l(n(285));n(1313);t.default=function(e){var t=e.collection,n=o((0,u.useState)(!1),2),r=n[0],a=n[1],i=o((0,u.useState)(null),2),l=i[0],g=i[1],_=(0,m.usePageContext)().communityData,E=(0,u.useRef)(),P=(0,u.useMemo)((function(){return(0,s.default)(_.accentColorDark).alpha(.05)}),[_.accentColorDark]),w=(0,d.useManyPubs)({isEager:!1,batchSize:100,query:{collectionIds:[t.id],ordering:{field:"collectionRank",direction:"ASC"}}}),O=w.currentQuery,C=O.pubs,S=O.loadMorePubs,D=O.hasLoadedAllPubs,k=w.allQueries.isLoading,j=r&&C.length>0;(0,f.useSticky)({target:E.current,isActive:j,offset:140});return u.default.createElement(u.default.Fragment,null,u.default.createElement(p.default,{className:(0,c.default)("expandable-collection-overview-row-component",j&&"expanded"),collection:t,isOpen:r,isLoading:k&&r&&!C.length,onToggleOpen:function(){var e=E.current;if(r)(0,f.isSticky)(e)&&"number"==typeof l&&window.scrollTo({top:l});else{var t=e.getBoundingClientRect().top+window.scrollY;g(t-140),0===C.length&&S()}a(!r)},ref:E}),r&&u.default.createElement(h.default,{style:{backgroundColor:P}},C.map((function(e){return u.default.createElement(b.default,{pub:e,key:e.id,inCollection:t})})),!D&&C.length>0&&u.default.createElement(v.default,{isLoading:k,onClick:S,isDark:!0}),D&&0===C.length&&u.default.createElement(y.default,{isDark:!0},"No Pubs in this Collection yet.")))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(469),o=n(6);n(1315);t.default=function(e){var t=e.selected,n=e.onSelect,r=e.label,l=e.count,u=e.icon,c=e.disabled;return a.default.createElement(i.Checkbox,{as:"div",className:"kind-toggle-component",checked:t,onChange:function(){return n(!t)},unstable_clickOnEnter:!0,disabled:c},a.default.createElement(o.Icon,{icon:u,iconSize:12}),a.default.createElement("span",{className:"label"},r,"Â ",a.default.createElement("span",{className:"count"},"(",l,")")))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1317);t.default=function(e){var t=e.primary,n=e.secondary;return a.default.createElement("div",{className:"overview-frame-component"},a.default.createElement("div",{className:"primary"},t),n&&a.default.createElement(i.MobileAware,{desktop:a.default.createElement("div",{className:"secondary"},n)}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(6);n(1319);t.default=function(e){var t=e.children,n=e.icon,r=e.title,l=e.descendTitle,u=e.spaced;return a.default.createElement("div",{className:(0,i.default)("overview-section-component",u&&"spaced")},a.default.createElement("div",{className:(0,i.default)("title",l&&"descending")},n&&a.default.createElement(o.Icon,{icon:n,iconSize:18}),r),t)}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(3)),d=n(5),f=n(6),m=n(9),p=n(1321);n(1322);t.default=function(e){var t=e.placeholder,n=e.onCommitSearchTerm,a=e.onUpdateSearchTerm,i=e.rightControls,o=e.onChooseFilter,u=e.filter,h=e.filters,b=l((0,c.useState)(!1),2),v=b[0],y=b[1],g=(0,m.usePageContext)(),_=g.loginData.id,E=g.scopeData.activePermissions.canView,P=(0,c.useMemo)((function(){return h||(0,p.getDefaultOverviewSearchFilters)({userId:_,isViewMember:E})}),[_,E,h]),w=(0,c.useCallback)((function(e){var t=e.target.value;a&&a(t.trim())}),[a]),O=(0,c.useCallback)((function(e){var t=e.target.value;"Enter"===e.key&&n&&n(t.trim())}),[n]),C=(0,c.useCallback)((function(e){if(o){var t=P.find((function(t){return t.id===e}));o(t)}}),[P,o]),S=r({},u&&{selectedTabId:u.id});return c.default.createElement("div",{className:"overview-search-group-component"},o&&c.default.createElement(d.Tabs,r({className:"filter-controls",id:"overview-search-group-filter",onChange:C},S),P.map((function(e){return c.default.createElement(d.Tab,{id:e.id,key:e.id,title:e.title})}))),c.default.createElement("div",{className:(0,s.default)("search-bar",v&&"search-focused")},c.default.createElement(f.Icon,{icon:"search",className:"search-icon",iconSize:16}),c.default.createElement("input",{placeholder:t,onFocus:function(){return y(!0)},onBlur:function(){return y(!1)},onChange:w,onKeyDown:O}),i&&c.default.createElement("div",{className:"right-controls"},i)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultOverviewSearchFilters=void 0;var r=n(62);t.getDefaultOverviewSearchFilters=function(e){var t=e.isViewMember,n=e.userId;return(0,r.pruneFalsyValues)([{id:"all",title:"All",query:null},{id:"latest",title:"Latest",query:{ordering:{field:"creationDate",direction:"DESC"}}},t&&{id:"drafts",title:"Drafts",query:{isReleased:!1}},{id:"released",title:"Released",query:{isReleased:!0}},t&&{id:"mine",title:"My Pubs",query:{relatedUserIds:[n],ordering:{field:"creationDate",direction:"DESC"}}}])}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1324);t.default=function(e){var t=e.actions;return a.default.createElement("div",{className:"quick-actions-component"},t.map((function(e){var t=e.icon,n=e.label,r=e.href;return a.default.createElement("a",{className:"quick-action",href:r,key:r},a.default.createElement("div",{className:"icon-wrapper"},a.default.createElement(i.Icon,{icon:t,iconSize:14})),a.default.createElement("div",{className:"label"},n))})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(87)),o=n(6),l=n(74),u=n(64);n(1326);t.default=function(e){var t=e.scopeKind,n=e.scope,r=n.scopeSummary,c=r.collections,s=r.pubs,d=r.submissions,f=r.discussions,m=r.reviews,p=function(e,t,n){return a.default.createElement("div",{className:"entry"},a.default.createElement(o.Icon,{icon:n,iconSize:16}),a.default.createElement("div",{className:"label"},a.default.createElement("span",{className:"count"},t),"Â ",e))};return a.default.createElement("div",{className:"scope-summary-list-component"},a.default.createElement("p",{className:"intro"},function(){var e=(0,i.default)(n.createdAt,"mmmm d, yyyy");if("community"===t)return a.default.createElement(a.default.Fragment,null,"This Community was created on ",e," and contains:");if("collection"===t){var r=(0,l.getSchemaForKind)(n.kind).label;return a.default.createElement(a.default.Fragment,null,"This Collection is ",(0,u.enIndefiniteArticle)(r.singular)," ",(0,u.capitalize)(r.singular),". It was created on ",e," and contains:")}return null}()),"community"===t&&p("Collections",c,"collection"),p("Pubs",s,"pubDoc"),p("Submissions",d,"manually-entered-data"),p("Discussions",f,"chat"),p("Reviews",m,"social-media"))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(6),u=n(40);n(1328);t.default=function(e){var t=function(e,t,n){return e.sort((function(e,t){return e.updatedAt>t.updatedAt?-1:1})).reduce((function(e,i){var o=i.pubId,l=i.collectionId,c=!!o,s=t.find((function(e){return e.id===o})),d=n.find((function(e){return e.id===l}));return s||d?a(a([],r(e),!1),[{href:c?(0,u.getDashUrl)({pubSlug:null==s?void 0:s.slug}):(0,u.getDashUrl)({collectionSlug:null==d?void 0:d.slug}),iconName:c?"pubDoc":"collection",id:i.id,title:(c?null==s?void 0:s.title:null==d?void 0:d.title)||""}],!1):e}),[]).slice(0,5)}(e.userScopeVisits,e.pubs,e.collections);return o.default.createElement("ol",{className:"recent-visit-list-component"},t.map((function(e){var t=e.id,n=e.title,r=e.iconName,a=e.href;return o.default.createElement("li",{key:t,className:"entry"},o.default.createElement(l.Icon,{icon:r,iconSize:16}),o.default.createElement("a",{className:"label",href:a},n))})))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1331);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=c(n(3)),f=n(5),m=n(118),p=c(n(80)),h=n(6),b=n(133),v=n(182),y=n(62),g=n(74),_=n(9),E=n(40),P=n(223),w=n(184),O=n(478),C=c(n(1333)),S=c(n(1335));n(1336);var D=function(e){var t=e.slug;return[{label:"Edit layout",icon:"page-layout",href:(0,E.getDashUrl)({collectionSlug:t,mode:"layout"})},{label:"Edit metadata",icon:"layers",href:(0,E.getDashUrl)({collectionSlug:t,mode:"settings",section:"metadata"})},"tag"!==e.kind&&{label:"Edit attribution",icon:"edit",href:(0,E.getDashUrl)({collectionSlug:t,mode:"settings",section:"attribution"})}].filter(Boolean)};t.default=function(e){var t,n=e.overviewData,a=e.hasEnabledSubmissionWorkflow,i=n.pubs,o=n.collectionPubs,c=n.collection,k=n.includesAllPubs,j=(0,_.usePageContext)(),M=j.scopeData.activePermissions.canManage,N=j.communityData,I=l((0,s.useState)(""),2),x=I[0],T=I[1],A=l((0,s.useState)(null),2),R=A[0],B=A[1],F=l((0,s.useState)([]),2),L=F[0],U=F[1],z=(0,O.useCollectionState)(c),H=z.collection,V=z.updateCollection,q=null==R?void 0:R.query,W=!!x||!!q,G=!W&&M,K=(0,b.useManyPubs)({initialPubs:i,initiallyLoadedAllPubs:k,batchSize:200,isEager:W,query:r({term:x,ordering:{field:"collectionRank",direction:"ASC"},scopedCollectionId:H.id},q),pubOptions:{getCollections:!0}}).currentQuery,J=K.loadMorePubs,Y=K.pubs,$=K.hasLoadedAllPubs,Q=(0,s.useMemo)((function(){var e=u(u([],l(Y),!1),l(L),!1),t=(0,y.indexByProperty)(e,"id");return{pubs:e,pubsById:t,usedPubIds:new Set(Object.keys(t))}}),[Y,L]),Z=Q.pubs,X=Q.pubsById,ee=Q.usedPubIds,te=(0,O.useCollectionPubs)({collection:H,initialCollectionPubs:o,pubs:Z}),ne=te.collectionPubs,re=te.reorderCollectionPubs,ae=te.addCollectionPub,ie=te.setCollectionPubContextHint,oe=te.setCollectionPubIsPrimary,le=te.removeCollectionPub,ue=te.scopeSummary,ce=(0,s.useMemo)((function(){return ne.filter((function(e){return!!X[e.pubId]}))}),[ne,X]);(0,v.useInfiniteScroll)({enabled:!k,useDocumentElement:!0,onRequestMoreItems:J,scrollTolerance:100});var se,de=function(e){var t=e.source,n=e.destination;n&&re(t.index,n.index)},fe=function(e,t,n){var r=X[e.pubId];return s.default.createElement(w.PubOverviewRow,{inCollection:H,className:(0,d.default)(n&&"collection-overview-row-is-dragging"),pub:r,leftIconElement:G&&s.default.createElement(h.DragHandle,{dragHandleProps:t}),rightElement:s.default.createElement(S.default,{pub:r,collection:H,collectionPub:e,setCollectionPubContextHint:ie,setCollectionPubIsPrimary:oe,removeCollectionPub:le})})},me=(0,s.useMemo)((function(){return(0,p.default)(N.accentColorDark).alpha(.1)}),[N.accentColorDark]),pe=s.default.createElement(f.AnchorButton,{minimal:!0,intent:"primary",className:"view-submissions-button",href:(0,E.getDashUrl)({collectionSlug:H.slug,mode:"submissions"})},"View submissions"),he=a&&M?(se="Submissions are now open for this collection!",s.default.createElement(h.Banner,{bannerText:se,accentColor:me,right:pe})):null;return s.default.createElement(h.DashboardFrame,{banner:he,icon:null===(t=(0,g.getSchemaForKind)(H.kind))||void 0===t?void 0:t.bpDisplayIcon,title:"Overview",className:"dashboard-collection-overview-container",controls:s.default.createElement(C.default,{usedPubIds:ee,collection:H,updateCollection:V,addCollectionPub:function(e){U((function(t){return u(u([],l(t),!1),[e],!1)})),ae(e)}})},s.default.createElement(P.OverviewFrame,{primary:s.default.createElement(P.OverviewSection,{title:"Explore",icon:"overview",descendTitle:!0},s.default.createElement(P.OverviewSearchGroup,{placeholder:"Search for Pubs in this Collection",onCommitSearchTerm:T,onUpdateSearchTerm:function(e){return""===e&&T(e)},onChooseFilter:B}),s.default.createElement(m.DragDropContext,{onDragEnd:de},s.default.createElement(h.DragDropListing,{items:ce,renderItem:fe,droppableId:"collectionOverview",droppableType:"collectionPub",withDragHandles:G,disabled:!G})),!$&&s.default.createElement(w.LoadMorePubsRow,{isLoading:!0}),0===Z.length&&$?W?s.default.createElement(w.SpecialRow,null,"No matching Pubs."):s.default.createElement(f.NonIdealState,{className:"collection-empty-state",icon:"clean",title:"This Collection looks brand new!",description:"Try adding a Pub from above."}):null),secondary:s.default.createElement(s.default.Fragment,null,M&&s.default.createElement(P.OverviewSection,{title:"Quick Actions",spaced:!0},s.default.createElement(P.QuickActions,{actions:D(H)})),s.default.createElement(P.OverviewSection,{title:"About"},s.default.createElement(P.ScopeSummaryList,{scopeKind:"collection",scope:r(r({},H),{scopeSummary:ue})})))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subtractScopeSummaries=t.addScopeSummaries=void 0;t.addScopeSummaries=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=0,r=0,a=0,i=0,o=0;return e.forEach((function(e){n+=e.discussions,r+=e.reviews,a+=e.pubs,i+=e.collections,o+=e.submissions})),{discussions:n,reviews:r,pubs:a,collections:i,submissions:o}};t.subtractScopeSummaries=function(e,t){return{collections:e.collections-t.collections,pubs:e.pubs-t.pubs,discussions:e.discussions-t.discussions,reviews:e.reviews-t.reviews,submissions:e.submissions-t.submissions}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(57),l=n(9),u=r(n(1334));t.default=function(e){var t=e.usedPubIds,n=e.collection,r=e.updateCollection,c=e.addCollectionPub,s=(0,l.usePageContext)().scopeData.activePermissions.canManage,d=n.isPublic,f=n.isRestricted;return s?a.default.createElement(a.default.Fragment,null,a.default.createElement(u.default,{usedPubIds:t,onSelectPub:c,collectionId:n.id},a.default.createElement(i.Button,{outlined:!0,icon:"plus"},"Add Pubs")),a.default.createElement(o.MenuButton,{"aria-label":"Choose whether this Collection is restricted",buttonContent:f?"Restricted":"Open",placement:"bottom-end",buttonProps:{minimal:!0,outlined:!0,icon:f?"folder-close":"folder-open",rightIcon:"caret-down"}},a.default.createElement(o.MenuItem,{text:a.default.createElement(a.default.Fragment,null,a.default.createElement("b",null,"Restricted:")," only managers of this Collection can add Pubs"),icon:f?"tick":"blank",onClick:function(){return r({isRestricted:!0})}}),a.default.createElement(o.MenuItem,{text:a.default.createElement(a.default.Fragment,null,a.default.createElement("b",null,"Open:")," anyone in this Community can add their Pub"),icon:f?"blank":"tick",onClick:function(){return r({isRestricted:!1})}})),!d&&a.default.createElement(i.Button,{intent:"primary",icon:"globe",onClick:function(){return r({isPublic:!0})}},"Make public"),d&&a.default.createElement(o.MenuButton,{"aria-label":"Make this collection private",buttonContent:"Public",buttonProps:{icon:"tick",rightIcon:"caret-down",outlined:!0}},a.default.createElement(o.MenuItem,{text:"Make private",onClick:function(){return r({isPublic:!1})}}))):null}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(6),c=n(133),s=n(184);t.default=function(e){var t=e.children,n=e.onSelectPub,r=e.collectionId,a=e.usedPubIds,i=o((0,l.useState)(""),2),d=i[0],f=i[1],m=(0,c.useManyPubs)({batchSize:50,query:{term:d,excludeCollectionIds:[r],ordering:{field:"updatedDate",direction:"DESC"}},pubOptions:{getCollections:!0}}),p=m.allQueries.isLoading,h=m.currentQuery.pubs;return l.default.createElement(u.QueryListDropdown,{itemRenderer:function(e,t){var n=t.handleClick,r=t.modifiers.active;return l.default.createElement(u.PubMenuItem,{key:e.id,id:e.id,onClick:n,title:e.title,contributors:e.attributions,active:r})},items:h.filter((function(e){return!a.has(e.id)})),onQueryChange:f,onItemSelect:n,emptyListPlaceholder:p?l.default.createElement(s.LoadMorePubsRow,{isLoading:!0}):"No Pubs to show",searchPlaceholder:"Search for Pubs",children:t,query:d})}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=n(5),s=n(9),d=n(74),f=n(6),m=n(57),p=n(131),h=u.default.forwardRef((function(e,t){return u.default.createElement(c.Button,r({},e,{elementRef:t}))}));t.default=function(e){var t=e.collectionPub,n=e.collection,a=e.setCollectionPubContextHint,i=e.setCollectionPubIsPrimary,o=e.removeCollectionPub,b=e.pub,v=l((0,u.useState)(!1),2),y=v[0],g=v[1];if(!(0,s.usePageContext)().scopeData.activePermissions.canManage)return null;var _=(0,d.getSchemaForKind)(n.kind),E=function(e,t,n){var a=t.collectionPubs,i=r(r({},e),{collection:n}),o=a.length>0?a.map((function(t){return t.id===e.id?i:t})):[i];return(0,p.getPrimaryCollection)(o)}(t,b,n),P=y||(null==E?void 0:E.id)===n.id;return u.default.createElement(u.default.Fragment,null,"tag"!==n.kind&&u.default.createElement(u.default.Fragment,null,n.isPublic&&(P?u.default.createElement(c.Tooltip,{position:"left",content:u.default.createElement(u.default.Fragment,null,u.default.createElement(c.Icon,{icon:"tick"})," This Pub's Primary Collection")},u.default.createElement(c.Button,{"aria-label":"This Pub's Primary Collection",minimal:!0,small:!0,icon:u.default.createElement(c.Icon,{icon:"star",iconSize:14})})):u.default.createElement(f.PopoverButton,{component:function(){return u.default.createElement("div",{className:"primary-collection-swap-popover"},E&&u.default.createElement(u.default.Fragment,null,"This Pub's ",u.default.createElement(f.PrimaryCollectionExplanation,null)," is currently"," ",u.default.createElement("i",null,E.title),".",u.default.createElement(c.Divider,null)),u.default.createElement(c.Button,{intent:"primary",onClick:function(){i(t),g(!0)}},E?"Use this Collection instead":"Use as Primary Collection"))},"aria-label":"Make this the Primary Collection for this Pub"},u.default.createElement(h,{minimal:!0,small:!0,icon:u.default.createElement(c.Icon,{icon:"star-empty",iconSize:14}),elementRef:!0}))),u.default.createElement(m.MenuButton,{"aria-label":"Collection context hint",buttonProps:{small:!0,minimal:!0,icon:u.default.createElement(c.Icon,{icon:"properties",iconSize:14})},placement:"bottom-end"},u.default.createElement(m.MenuItem,{text:u.default.createElement("i",null,"(No label)"),icon:t.contextHint?"blank":"tick",onClick:function(){return a(t,null)}}),_.contextHints.map((function(e){return u.default.createElement(m.MenuItem,{key:e.value,text:e.label,icon:t.contextHint===e.value?"tick":"blank",onClick:function(){return a(t,e.value)}})})))),u.default.createElement(c.Button,{small:!0,minimal:!0,icon:"cross","aria-label":"Remove this Pub from collection",onClick:function(){return o(t)}}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(87)),o=n(5),l=n(6),u=r(n(287)),c=n(67),s=n(132),d=n(40),f=n(99),m=n(9),p=r(n(1341));n(1343);t.default=function(e){var t,n,r,h,b,v=e.pubData,y=(0,m.usePageContext)().communityData,g=v.description,_=function(e,t){return a.default.createElement("div",{className:"section"},a.default.createElement("div",{className:"section-header"},e),t)};return a.default.createElement(l.DashboardFrame,{className:"pub-overview-component",title:"Overview"},a.default.createElement(l.PubHeaderBackground,{className:"pub-header-component",pubData:v,communityData:y,safetyLayer:"full-height"},a.default.createElement("div",{className:"header-content"},a.default.createElement("h1",{className:"title"},a.default.createElement(l.PubTitle,{pubData:v})),g&&a.default.createElement("div",{className:"description"},g),(h=(0,f.getPubPublishedDateString)(v),b=(0,f.getPubLatestReleaseDate)(v,{excludeFirstRelease:!0}),a.default.createElement("div",{className:"pub-dates"},_("Created on",(0,c.formatDate)(v.createdAt)),_("Published on",h||a.default.createElement("i",null,"Unpublished")),b&&_("Last released on",(0,c.formatDate)(b)))))),a.default.createElement("div",{className:"columns"},a.default.createElement("div",{className:"column"},_("Cite As",a.default.createElement(u.default,{pubData:v,showHeader:!1})),v.doi&&_("DOI",v.doi),a.default.createElement("div",{className:"section"},a.default.createElement("div",{className:"section-header"},"Contributors"),a.default.createElement(l.ContributorsList,{attributions:(0,s.getAllPubContributors)(v,"contributors")})),0===(r=v.collectionPubs).length?null:a.default.createElement("div",{className:"collections section"},a.default.createElement("div",{className:"section-header"},"Appears in Collections (",r.length,")"),v.collectionPubs.map((function(e,t){return a.default.createElement("span",{key:e.id},a.default.createElement("a",{href:(0,d.getDashUrl)({collectionSlug:e.collection.slug})},e.collection.title),t!==v.collectionPubs.length-1&&a.default.createElement("span",null,", "))}))),!!(null===(t=v.reviews)||void 0===t?void 0:t.length)&&(n=v.reviews,a.default.createElement("div",{className:"section list"},a.default.createElement("div",{className:"section-header"},"Reviews"),a.default.createElement(o.Menu,{className:"list-content"},n.sort((function(e,t){return Date.parse(t.createdAt)-Date.parse(e.createdAt)})).map((function(e){return a.default.createElement(o.MenuItem,{key:e.id,href:"/dash/pub/"+v.slug+"/reviews/"+e.number,text:a.default.createElement("div",{className:"list-row"},a.default.createElement("div",{className:"number"},"R",e.number,": ",e.title),a.default.createElement("div",{className:"title"},(0,i.default)(e.createdAt,"mmm dd, yyyy - HH:MM")),a.default.createElement("div",{className:"note"},a.default.createElement(o.Tag,{minimal:!0,className:e.status},e.status)))})})))))),a.default.createElement("div",{className:"column"},a.default.createElement(p.default,{pubData:v}))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(479);n(1339);t.default=function(e){var t=e.citationData,n=e.citationStyle,r=e.isOpen,l=e.onClose,u="";return o.citationStyles.forEach((function(e){e.key===n&&(u=e.name)})),a.default.createElement(i.Dialog,{className:"citations-modal-component",isOpen:r,onClose:l,title:"Cite this pub"},a.default.createElement("div",{className:i.Classes.DIALOG_BODY},a.default.createElement("div",{className:"style-wrapper"},a.default.createElement("div",{className:"style-title"},u," (Default)"),a.default.createElement("div",{className:"style-content",dangerouslySetInnerHTML:{__html:t.pub.default}})),"apa-7"!==n&&"apa"!==n&&a.default.createElement("div",{className:"style-wrapper"},a.default.createElement("div",{className:"style-title"},"APA 7th Edition"),a.default.createElement("div",{className:"style-content",dangerouslySetInnerHTML:{__html:t.pub.apa}})),"harvard"!==n&&a.default.createElement("div",{className:"style-wrapper"},a.default.createElement("div",{className:"style-title"},"Harvard"),a.default.createElement("div",{className:"style-content",dangerouslySetInnerHTML:{__html:t.pub.harvard}})),"vancouver"!==n&&a.default.createElement("div",{className:"style-wrapper"},a.default.createElement("div",{className:"style-title"},"Vancouver"),a.default.createElement("div",{className:"style-content",dangerouslySetInnerHTML:{__html:t.pub.vancouver}})),a.default.createElement("div",{className:"style-wrapper"},a.default.createElement("div",{className:"style-title"},"Bibtex"),a.default.createElement("div",{className:"style-content bibtex",dangerouslySetInnerHTML:{__html:t.pub.bibtex}}))))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=n(9),u=n(67),c=n(35);n(1342);t.default=function(e){var t,n,r=e.pubData,s=(0,l.usePageContext)(),d=s.communityData,f=s.scopeData.activePermissions,m=f.canView,p=f.canViewDraft,h=f.canManage,b=r.releases,v=b.slice(0,b.length-1),y=b[b.length-1],g=null===(t=r.draft)||void 0===t?void 0:t.latestKeyAt,_=!!g,E=g?"Last edited "+(0,u.formatDate)(g,{includeTime:!0}):"Get started by editing the Pub draft.",P=(m||p)&&a.default.createElement(o.TimelineItem,{large:!0,hollow:_,icon:"edit",title:"Pub draft",subtitle:E,controls:a.default.createElement(i.AnchorButton,{outlined:!0,href:(0,c.pubUrl)(d,r,{isDraft:!0})},"Go to draft")}),w=function(e,t,n){return void 0===n&&(n=!1),a.default.createElement(o.TimelineItem,{hollow:!0,large:n,icon:"document-share",key:e.id,title:a.default.createElement("a",{className:"release-link",href:(0,c.pubUrl)(d,r,{releaseNumber:t})},"Release #",t,n&&" (latest)"),subtitle:(0,u.formatDate)(e.createdAt,{includeTime:!0}),controls:h&&e.noteText&&a.default.createElement("details",{className:"release-note"},a.default.createElement("summary",null,"Release notes"),a.default.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:e.noteText}}))})};return a.default.createElement(o.Timeline,{className:"pub-timeline-component",accentColor:d.accentColorDark},0===b.length&&_&&(n=a.default.createElement("div",null,"A Release is a snapshot of a Pub that's visible to the public. Visit the Pub draft and click the ",a.default.createElement(o.Icon,{icon:"document-share",iconSize:12})," Publish button in the header to create a release."),a.default.createElement(o.TimelineItem,{large:!0,icon:"document-share",title:a.default.createElement("i",null,"No releases yet"),subtitle:"Create a Release to share this Pub with the world.",controls:a.default.createElement(i.Popover,{content:n,popoverClassName:i.Classes.POPOVER_CONTENT_SIZING},a.default.createElement(i.Button,{outlined:!0},"Learn more"))})),P,y&&w(y,b.length,!0),a.default.createElement(o.TimelineCondenser,{shownItemsLimit:4},v.map((function(e,t){return w(e,t+1)})).reverse()),a.default.createElement(o.TimelineItem,{hollow:!0,large:!0,title:"Pub created",subtitle:(0,u.formatDate)(r.createdAt,{includeTime:!0}),icon:"clean"}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=n(71),u=n(35),c=n(9),s=n(40),d=n(64),f=n(18),m=n(222),p=n(6),h=n(286),b=a(n(1345));n(1346);t.default=function(e){var t=(0,c.usePageContext)(),n=t.updateCommunity,a=t.locationData,v=t.communityData,y=(0,c.usePendingChanges)().pendingPromise,g=(0,h.usePersistableState)(e.pageData,(function(e){return y((0,f.apiFetch)("/api/pages",{method:"PUT",body:JSON.stringify(r(r({},e),{pageId:E.id,communityId:v.id}))})).then((function(){n((function(t){return{pages:t.pages.map((function(t){return t.id!==E.id?t:r(r({},t),e)}))}}))}))})),_=g.error,E=g.state,P=g.persistedState,w=g.update,O=g.hasChanges,C=g.persist,S=g.isPersisting,D=E.avatar,k=E.description,j=E.isNarrowWidth,M=E.isPublic,N=E.layout,I=E.layoutPubsByBlock,x=E.slug,T=E.title,A=E.viewHash,R=!P.slug,B="forbidden-slug"===(null==_?void 0:_.type)?_.slugStatus:"available",F=(0,m.getSlugError)(x,B);(0,l.useUpdateEffect)((function(){O||window.history.replaceState({},"",(0,s.getDashUrl)({mode:"pages",subMode:x}))}),[x,O]);var L;return i.default.createElement(p.DashboardFrame,{className:"dashboard-page-container",title:"Pages: "+P.title,controls:(L=O&&T&&(x||!P.slug),i.default.createElement(i.default.Fragment,null,i.default.createElement(o.AnchorButton,{icon:"share",href:"/"+x},"Visit page"),i.default.createElement(o.Button,{type:"button",intent:"primary",text:"Save Changes",disabled:!L,loading:S,onClick:C})))},i.default.createElement(p.SettingsSection,{title:"Details"},i.default.createElement(p.InputField,{label:"Title",placeholder:"Enter title",isRequired:!0,value:T,onChange:function(e){return w({title:e.target.value})},error:void 0}),i.default.createElement(p.InputField,{label:"Description",placeholder:"Enter description",isTextarea:!0,helperText:"Used for search results and social media cards. Max 180 characters.",value:k||"",onChange:function(e){return w({description:e.target.value.substring(0,280).replace(/\n/g," ")})},error:void 0}),i.default.createElement(p.ImageUpload,{htmlFor:"dashboard-page-avatar",label:"Preview Image",defaultImage:D,onNewImage:function(e){return w({avatar:e})},canClear:!0,helperText:"This image will appear in links from other Pages or Collections to this Page."}),!R&&i.default.createElement(p.InputField,{label:"Link",placeholder:"Enter link",isRequired:!0,helperText:"Page URL will be https://"+a.hostname+"/"+x,value:x,error:F,onChange:function(e){return w({slug:(0,d.slugifyString)(e.target.value)})}}),i.default.createElement(p.InputField,{label:"Width"},i.default.createElement("div",{className:"bp3-button-group"},i.default.createElement(o.Button,{className:j?"":"bp3-active",onClick:function(){return w({isNarrowWidth:!1})},text:"Wide"}),i.default.createElement(o.Button,{className:j?"bp3-active":"",onClick:function(){return w({isNarrowWidth:!0})},text:"Narrow"}))),!R&&i.default.createElement(p.InputField,{label:"Privacy"},i.default.createElement("div",{className:"bp3-button-group"},i.default.createElement(o.Button,{className:M?"bp3-active":"",onClick:function(){return w({isPublic:!0})},text:"Public",icon:"globe"}),i.default.createElement(o.Button,{className:M?"":"bp3-active",onClick:function(){return w({isPublic:!1})},text:"Private",icon:"lock"}),!M&&i.default.createElement(p.ClickToCopyButton,{className:"copy-button",icon:"duplicate",beforeCopyPrompt:"Anyone with this link can view the private Page.",copyString:(0,u.communityUrl)(v)+"/"+x+"?access="+A},"Copy shareable link")))),i.default.createElement(p.SettingsSection,{title:"Layout"},i.default.createElement(p.LayoutEditor,{onChange:function(e){return w({layout:e})},initialLayout:N,initialLayoutPubsByBlock:I,communityData:v})),i.default.createElement(p.SettingsSection,{title:"Delete"},i.default.createElement(b.default,{isForbidden:R,pageData:E,communityId:v.id})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(6),s=n(9),d=n(18);t.default=function(e){var t=(0,s.usePendingChanges)().pendingPromise,n=e.communityId,r=e.pageData,a=e.isForbidden,i=o((0,l.useState)(""),2),f=i[0],m=i[1],p=o((0,l.useState)(!1),2),h=p[0],b=p[1],v=(0,l.useCallback)((function(){return b(!0),t((0,d.apiFetch)("/api/pages",{method:"DELETE",body:JSON.stringify({pageId:r.id,communityId:n})})).then((function(){window.location.href="/dash"})).catch((function(e){console.error(e),b(!1)}))}),[n,r.id,t]);return a?l.default.createElement("div",{className:"bp3-callout bp3-intent-danger"},l.default.createElement("h5",null,"Delete Page from Community"),l.default.createElement("p",null,l.default.createElement("b",null,r.title)," cannot be deleted because it is the home page for this Community.")):l.default.createElement("div",{className:"bp3-callout bp3-intent-danger"},l.default.createElement("h5",null,"Delete Page from Community"),l.default.createElement("p",null,"Deleting a Page is permanent."),l.default.createElement("p",null,"This will permanently delete ",l.default.createElement("b",null,r.title),". This will not delete pubs that are included in this page's layout."),l.default.createElement("p",null,"Please type the title of the Page below to confirm your intention."),l.default.createElement(c.InputField,{label:l.default.createElement("b",null,"Confirm Page Title"),value:f,onChange:function(e){return m(e.target.value)}}),l.default.createElement("div",{className:"delete-button-wrapper"},l.default.createElement(u.Button,{type:"button",className:"bp3-intent-danger",text:"Delete Page",disabled:f!==r.title,loading:h,onClick:v})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(87)),s=n(5),d=n(9),f=n(6),m=l(n(1348));n(1350);var p=function(){var e,t=(0,d.usePageContext)(),n=t.locationData,r=t.communityData,a=o((0,u.useState)(!1),2),i=a[0],l=a[1];return u.default.createElement(f.DashboardFrame,{className:"dashboard-pages-container",title:"Pages",details:"Create and manage Pages to give stucture to your Community.",controls:u.default.createElement(u.default.Fragment,null,u.default.createElement(s.Button,{icon:"plus",onClick:function(){return l(!0)},outlined:!0},"Create Page"),u.default.createElement(m.default,{onClose:function(){return l(!1)},isOpen:i,communityData:r,hostname:n.hostname}))},u.default.createElement(f.DashboardRowListing,null,(e=r.pages,e.sort((function(e,t){return e.title>t.title?1:-1}))).map((function(e){var t=(0,c.default)(e.createdAt,"mmm dd, yyyy"),n=u.default.createElement(u.default.Fragment,null,u.default.createElement(s.AnchorButton,{icon:u.default.createElement(f.Icon,{icon:"edit2"}),outlined:!0,href:"/dash/pages/"+(e.slug||"home")},"Edit page"),u.default.createElement(s.AnchorButton,{icon:"share",outlined:!0,href:"/"+e.slug},"Visit page"),u.default.createElement("div",{className:"privacy-indicator"},u.default.createElement(f.Icon,{icon:e.isPublic?"globe":"lock",iconSize:14}),e.isPublic?"Public":"Private"));return u.default.createElement(f.DashboardRow,{key:e.id,icon:"page-layout",className:"page-row",title:e.title,subtitle:"Created on "+t,rightSideElements:n})}))))};p.propTypes={},t.default=p},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=c(n(215)),m=n(64),p=n(40),h=n(18),b=n(222);n(1349);var v=function(e){function t(t){var n=e.call(this,t)||this;return n.state={title:"",slug:"",description:"",isLoading:!1,error:void 0},n.handleTitleChange=n.handleTitleChange.bind(n),n.handleSlugChange=n.handleSlugChange.bind(n),n.handleDescriptionChange=n.handleDescriptionChange.bind(n),n.handleCreateSubmit=n.handleCreateSubmit.bind(n),n}return a(t,e),t.prototype.handleTitleChange=function(e){this.setState({title:e.target.value})},t.prototype.handleSlugChange=function(e){this.setState({slug:(0,m.slugifyString)(e.target.value)})},t.prototype.handleDescriptionChange=function(e){this.setState({description:e.target.value.substring(0,280).replace(/\n/g," ")})},t.prototype.handleCreateSubmit=function(e){var t=this;e.preventDefault();var n=this.props.communityData.pages.map((function(e){return e.slug}));if(n.push("home"),n.indexOf(this.state.slug)>-1)return this.setState({error:"URL already used by another Page."});this.setState({isLoading:!0,error:void 0});var r={title:this.state.title,slug:this.state.slug,description:this.state.description};return(0,h.apiFetch)("/api/pages",{method:"POST",body:JSON.stringify(i(i({},r),{communityId:this.props.communityData.id}))}).then((function(e){window.location.href=(0,p.getDashUrl)({mode:"pages",subMode:e.slug})})).catch((function(e){var n="forbidden-slug"===(null==e?void 0:e.type)?e.slugStatus:"available";"available"!==n?t.setState((function(e){return{isLoading:!1,error:(0,b.getSlugError)(e.slug,n)}})):t.setState({isLoading:!1,error:e})}))},t.prototype.render=function(){return s.default.createElement(d.Dialog,{isOpen:this.props.isOpen,onClose:this.props.onClose,title:"Create New Page",className:"create-page-dialog-component",icon:"page-layout"},s.default.createElement("form",{onSubmit:this.handleCreateSubmit},s.default.createElement("div",{className:d.Classes.DIALOG_BODY},s.default.createElement(f.default,{label:"Page Title",placeholder:"Brand New Page",isRequired:!0,value:this.state.title,onChange:this.handleTitleChange}),s.default.createElement(f.default,{label:"Page URL",placeholder:"my-page",isRequired:!0,helperText:this.props.hostname+"/"+this.state.slug,value:this.state.slug,onChange:this.handleSlugChange}),s.default.createElement(f.default,{label:"Description",isTextarea:!0,value:this.state.description,onChange:this.handleDescriptionChange})),s.default.createElement("div",{className:d.Classes.DIALOG_FOOTER},s.default.createElement("div",{className:"footer-dialog"},s.default.createElement(f.default,{error:this.state.error},s.default.createElement(d.Button,{name:"login",type:"submit",className:"bp3-button bp3-intent-primary",onClick:this.handleCreateSubmit,text:"Create Page",disabled:!this.state.title||!this.state.slug,loading:this.state.isLoading}))))))},t}(s.Component);t.default=v},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=o(n(0)),m=n(5),p=d(n(117)),h=n(6),b=n(9),v=n(67),y=n(18),g=n(41);n(1352);t.default=function(e){var t=c((0,f.useState)(e.reviewData),2),n=t[0],a=t[1],i=c((0,f.useState)(!1),2),o=i[0],d=i[1],_=c((0,f.useState)(!1),2),E=_[0],P=_[1],w=(0,b.usePageContext)(),O=w.loginData,C=w.scopeData,S=w.communityData,D=n.author,k=n.status,j=n.thread,M=n.releaseRequested,N=n.reviewContent,I=C.activePermissions.canAdmin,x=O&&D&&O.id===D.id,T=x||I,A="{}"!==JSON.stringify(N)?N:(0,g.getEmptyDoc)();return f.default.createElement(h.DashboardFrame,{className:"dashboard-review-container",title:f.default.createElement("span",null,"Reviews: ",n.title,f.default.createElement("span",{className:"number"},"(R",n.number,")")),details:f.default.createElement(f.default.Fragment,null,f.default.createElement(m.Tag,{className:k,minimal:!0,large:!0},k),f.default.createElement("span",null,n.reviewers?n.reviewers.map((function(e){return f.default.createElement("span",null,e.name,"Â ")})):x?f.default.createElement("span",null,f.default.createElement("a",{href:"/user/"+D.slug},D.fullName)," created this review"," "):"",f.default.createElement(p.default,r({},v.timeAgoBaseProps,{date:n.createdAt})))),controls:T&&"open"===n.status&&f.default.createElement(m.Button,{key:"close",text:"Close Review",loading:o,onClick:function(){return l(void 0,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return d(!0),[4,(0,y.apiFetch)("/api/reviews",{method:"PUT",body:JSON.stringify({status:"closed",reviewId:n.id,pubId:n.pubId,communityId:S.id})})];case 1:return e=t.sent(),d(!1),a(r(r(r({},n),e.updatedValues),{thread:r(r({},n.thread),{events:s(s([],c(n.thread.events),!1),c(e.newReviewEvents),!1)})})),[2]}}))}))}})},f.default.createElement("div",{className:"review"},f.default.createElement(h.Editor,{key:"reviewDoc",isReadOnly:!0,initialContent:A})),f.default.createElement(h.Thread,{threadData:j}),f.default.createElement(h.ThreadInput,{parentId:n.id,pubId:n.pubId,threadData:j,onThreadUpdate:function(e){a(r(r({},n),{thread:e}))}}),I&&"open"===k&&M&&f.default.createElement(m.Callout,{intent:m.Intent.WARNING,icon:"document-share",title:"Publication Requested"},D.fullName," has requested that a Release be published from the Draft. If this review is satisfactory, you can create the Release here directly."," ",f.default.createElement("div",{style:{marginTop:"1em"}},f.default.createElement(m.Button,{text:"Create Release from Draft",intent:m.Intent.PRIMARY,onClick:function(){return l(void 0,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return P(!0),[4,(0,y.apiFetch)("/api/reviews/release",{method:"POST",body:JSON.stringify({threadId:n.threadId,reviewId:n.id,pubId:n.pubId,communityId:S.id})})];case 1:return e=t.sent(),a(r(r({},n),{status:"completed",thread:r(r({},n.thread),{events:s(s([],c(n.thread.events),!1),c(e.reviewEvents),!1)})})),P(!1),[2]}}))}))},loading:E}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=r(n(87)),l=n(6),u=n(9),c=n(40);n(1354);t.default=function(e){var t=e.pubsWithReviews,n=(0,u.usePageContext)().scopeData.elements,r=n.activeCollection,s=n.activeTargetType,d=function(e){return e?e.map((function(e){return a.default.createElement("span",null,e.name)})):""};return a.default.createElement(l.DashboardFrame,{className:"dashboard-reviews-container",title:"Reviews",details:"Reviews allow members of your Community to request feedback on their Pubs and release them to the world."},!t.length&&a.default.createElement(i.Menu,{className:"list-content"},a.default.createElement(i.NonIdealState,{title:"pub"===s?"This Pub has not been reviewed using PubPub":"No reviews here.",icon:"social-media"})),t.map((function(e){var t=(0,c.getDashUrl)({collectionSlug:r?r.slug:void 0,pubSlug:e.slug});return a.default.createElement(a.default.Fragment,{key:e.id},"pub"!==s&&a.default.createElement("a",{className:"pub-title",href:t},e.title),a.default.createElement(i.Menu,{className:"list-content"},e.reviews.sort((function(e,t){return Date.parse(t.createdAt)-Date.parse(e.createdAt)})).map((function(t){var n=t.reviewers&&t.reviewers.length>0,l=t.reviewers,u=(0,c.getDashUrl)({collectionSlug:r?r.slug:void 0,pubSlug:e.slug,mode:"reviews",subMode:String(t.number)});return a.default.createElement(i.MenuItem,{key:t.id,href:u,text:a.default.createElement("div",{className:"list-row"},a.default.createElement("div",{className:"number"},"R",t.number,": ",t.title),n&&a.default.createElement("div",{className:"note"},"by ",d(l),"Â "),a.default.createElement("div",{className:"title"},(0,o.default)(t.createdAt,"mmm dd, yyyy - HH:MM")),a.default.createElement("div",{className:"note"},a.default.createElement(i.Tag,{minimal:!0,className:t.status},t.status)))})}))))})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(9),l=a(n(1356)),u=a(n(1362)),c=a(n(1368));n(1378);var s={community:l.default,collection:u.default,pub:c.default};t.default=function(e){var t=(0,o.usePageContext)().scopeData,n=s[t.elements.activeTargetType];return i.default.createElement("div",{className:"dashboard-settings-container"},i.default.createElement(n,r({},e)))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(9),f=n(5),m=n(6),p=n(64),h=n(163),b=n(40),v=n(35),y=n(130),g=n(18),_=c(n(1357));n(1361);t.default=function(){var e=(0,d.usePageContext)(),t=e.scopeData,n=e.communityData,a="\n\tHello.\n\t%0D%0A%0D%0A\n\tI am writing to request an export of any PubPub community data associated with the community%20\n\t"+n.title+" ("+n.subdomain+").\n\t",i="\n\tHello.\n\t%0D%0A%0D%0A\n\tI am writing to request that the PubPub community "+n.title+"%20\n\t("+n.subdomain+"), and all data associated with that community, be deleted.\n\t%0D%0A%0D%0A\n\tI affirm that I have the legal authority to request this on behalf of my community,%20\n\tand understand that this action may be irreversible.\n\t",o=l((0,s.useState)(!1),2),c=o[0],E=o[1],P=l((0,s.useState)(void 0),2),w=P[0],O=P[1],C=l((0,s.useState)(n.title),2),S=C[0],D=C[1],k=l((0,s.useState)(n.subdomain),2),j=k[0],M=k[1],N=l((0,s.useState)(n.description),2),I=N[0],x=N[1],T=l((0,s.useState)(n.avatar),2),A=T[0],R=T[1],B=l((0,s.useState)(n.favicon),2),F=B[0],L=B[1],U=l((0,s.useState)(n.accentColorLight),2),z=U[0],H=U[1],V=l((0,s.useState)(n.accentColorDark),2),q=V[0],W=V[1],G=l((0,s.useState)(n.citeAs),2),K=G[0],J=G[1],Y=l((0,s.useState)(n.publishAs),2),$=Y[0],Q=Y[1],Z=l((0,s.useState)(n.headerLogo),2),X=Z[0],ee=Z[1],te=l((0,s.useState)(n.headerColorType),2),ne=te[0],re=te[1],ae=l((0,s.useState)(n.hideCreatePubButton||!1),2),ie=ae[0],oe=ae[1],le=l((0,s.useState)(n.defaultPubCollections||[]),2),ue=le[0],ce=le[1],se=l((0,s.useState)(n.hideNav||!1),2),de=se[0],fe=se[1],me=l((0,s.useState)(n.useHeaderTextAccent||!1),2),pe=me[0],he=me[1],be=l((0,s.useState)(n.navigation),2),ve=be[0],ye=be[1],ge=l((0,s.useState)(n.heroLogo),2),_e=ge[0],Ee=ge[1],Pe=l((0,s.useState)(n.heroBackgroundImage),2),we=Pe[0],Oe=Pe[1],Ce=l((0,s.useState)(n.hideHero||!1),2),Se=Ce[0],De=Ce[1],ke=l((0,s.useState)(n.hideHeaderLogo||!1),2),je=ke[0],Me=ke[1],Ne=l((0,s.useState)(n.heroBackgroundColor),2),Ie=Ne[0],xe=Ne[1],Te=l((0,s.useState)(n.heroTextColor),2),Ae=Te[0],Re=Te[1],Be=l((0,s.useState)(n.useHeaderGradient||!1),2),Fe=Be[0],Le=Be[1],Ue=l((0,s.useState)(n.heroImage),2),ze=Ue[0],He=Ue[1],Ve=l((0,s.useState)(n.heroTitle),2),qe=Ve[0],We=Ve[1],Ge=l((0,s.useState)(n.heroText),2),Ke=Ge[0],Je=Ge[1],Ye=l((0,s.useState)(n.heroPrimaryButton||{}),2),$e=Ye[0],Qe=Ye[1],Ze=l((0,s.useState)(n.heroSecondaryButton||{}),2),Xe=Ze[0],et=Ze[1],tt=l((0,s.useState)(n.heroAlign||"left"),2),nt=tt[0],rt=tt[1],at=l((0,s.useState)(n.footerLinks),2),it=at[0],ot=at[1],lt=l((0,s.useState)(n.footerTitle),2),ut=lt[0],ct=lt[1],st=l((0,s.useState)(n.footerLogoLink),2),dt=st[0],ft=st[1],mt=l((0,s.useState)(n.footerImage),2),pt=mt[0],ht=mt[1],bt=l((0,s.useState)(Math.random()),2),vt=bt[0],yt=bt[1],gt=l((0,s.useState)(n.website||""),2),_t=gt[0],Et=gt[1],Pt=l((0,s.useState)(n.twitter||""),2),wt=Pt[0],Ot=Pt[1],Ct=l((0,s.useState)(n.facebook||""),2),St=Ct[0],Dt=Ct[1],kt=l((0,s.useState)(n.email||""),2),jt=kt[0],Mt=kt[1],Nt={title:S,subdomain:j,description:I,citeAs:K,publishAs:$,avatar:A,favicon:F,accentColorLight:z,accentColorDark:q,headerLogo:X,headerColorType:ne,hideCreatePubButton:ie,defaultPubCollections:ue,hideNav:de,useHeaderTextAccent:pe,navigation:ve,heroLogo:_e,heroBackgroundImage:we,hideHero:Se,hideHeaderLogo:je,heroBackgroundColor:Ie,heroTextColor:Ae,useHeaderGradient:Fe,heroImage:ze,heroTitle:qe,heroText:Ke,heroPrimaryButton:$e,heroSecondaryButton:Xe,heroAlign:nt,footerLinks:it,footerTitle:ut,footerLogoLink:dt,footerImage:pt,website:_t,twitter:wt,facebook:St,email:jt},It=n.pages,xt=void 0===It?[]:It,Tt=n.collections,At=void 0===Tt?[]:Tt,Rt=Ae||"#FFFFFF";return s.default.createElement(m.DashboardFrame,{title:"Settings",className:"community-settings-component",controls:s.default.createElement(m.InputField,{error:w},s.default.createElement(f.Button,{name:"create",type:"submit",className:"bp3-button bp3-intent-primary save-community-button",onClick:function(e){return e.preventDefault(),E(!0),O(void 0),(0,g.apiFetch)("/api/communities",{method:"PUT",body:JSON.stringify(r(r({},Nt),{communityId:n.id}))}).then((function(e){if((0,y.isDevelopment)())window.location.reload();else{var t=(0,v.communityUrl)(e),n=(0,b.getDashUrl)({mode:"settings"});window.location.href=t+n}})).catch((function(e){console.error(e),E(!1),O("Error Saving Settings")}))},text:"Save Settings",disabled:!S||!j,loading:c}))},s.default.createElement(m.SettingsSection,{title:"Details"},s.default.createElement(m.InputField,{label:"Title",type:"text",isRequired:!0,value:S,onChange:function(e){D(e.target.value)}}),s.default.createElement(m.InputField,{label:"Domain",type:"text",isRequired:!0,value:j,onChange:function(e){M((0,p.slugifyString)(e.target.value))}}),s.default.createElement(m.InputField,{label:"Description",type:"text",isTextarea:!0,value:I,onChange:function(e){x(e.target.value.substring(0,280).replace(/\n/g," "))}}),s.default.createElement(m.InputField,{htmlFor:"journal-citation",label:s.default.createElement("span",null,"Journal Citation",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"When filled out, this field will be used as the Journal Title for Issue Collections in citations, PDF exports, and Crossref deposits.")},s.default.createElement(m.Icon,{icon:"info-sign"}))),type:"text",value:K,onChange:function(e){J(e.target.value)}}),s.default.createElement(m.InputField,{htmlFor:"publisher",label:s.default.createElement("span",null,"Publisher",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"When filled out, this field will be used as the Publisher for Book and Conference Proceedings Collections in citations, PDF exports, and Crossref deposits.")},s.default.createElement(m.Icon,{icon:"info-sign"}))),type:"text",value:$,onChange:function(e){Q(e.target.value)}}),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.ImageUpload,{htmlFor:"favicon-upload",label:s.default.createElement("span",null,"Favicon",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Used for browser icons. Must be square.",s.default.createElement("br",null),"Recommended: 50*50px")},s.default.createElement(m.Icon,{icon:"info-sign"}))),defaultImage:F,onNewImage:function(e){L(e)}}),s.default.createElement(m.ImageUpload,{htmlFor:"avatar-upload",label:s.default.createElement("span",null,"Preview",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Used as default preview image for social sharing cards.",s.default.createElement("br",null),"Recommended: 500*500px")},s.default.createElement(m.Icon,{icon:"info-sign"}))),defaultImage:A,onNewImage:function(e){R(e)}})),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.InputField,{label:"Dark Accent Color"},s.default.createElement(m.ColorInput,{value:q,onChange:function(e){W(e.hex)}})),s.default.createElement(m.InputField,{label:"Light Accent Color"},s.default.createElement(m.ColorInput,{value:z,onChange:function(e){H(e.hex)}}))),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement("a",{href:(0,b.getDashUrl)({mode:"scripts"})},"Customize CSS"),s.default.createElement(f.Tooltip,{targetClassName:"custom-css-tooltip-target",popoverClassName:"dashboard-settings-container_custom-css-popover",content:s.default.createElement(s.default.Fragment,null,"Warning: Experimental feature. Custom CSS lets you change the look and feel of your Community, but it also lets you introduce bugs that make it hard or impossible to use. The PubPub team may also make changes to our own source code that could break your CSS without warning. We don't provide support for problems caused by Custom CSS. Use caution (but have fun!)")},s.default.createElement(m.Icon,{icon:"warning-sign",color:"orange"})))),s.default.createElement(m.SettingsSection,{title:"Header"},s.default.createElement(m.ImageUpload,{htmlFor:"header-logo-upload",label:s.default.createElement("span",null,"Header Logo",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Used in the header bar.",s.default.createElement("br",null),"Recommended: ~40*150px")},s.default.createElement(m.Icon,{icon:"info-sign"}))),defaultImage:X,height:80,width:150,onNewImage:function(e){ee(e)},useAccentBackground:!0,canClear:!0}),s.default.createElement(m.InputField,{label:"Header Color"},s.default.createElement(f.ButtonGroup,null,s.default.createElement(f.Button,{text:"Light",active:"light"===ne,onClick:function(){re("light")}}),s.default.createElement(f.Button,{text:"Dark",active:"dark"===ne,onClick:function(){re("dark")}}))),s.default.createElement(m.InputField,{label:"Header Text Color"},s.default.createElement(f.ButtonGroup,null,s.default.createElement(f.Button,{text:"light"===ne?"Black":"White",active:!pe,onClick:function(){he(!1)}}),s.default.createElement(f.Button,{text:"light"===ne?"Dark Accent":"Light Accent",active:pe,onClick:function(){he(!0)}}))),s.default.createElement(m.InputField,null,s.default.createElement(f.Switch,{label:s.default.createElement("span",null,"Public 'New Pub' button",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Toggles 'New Pub' button in header bar.",s.default.createElement("br",null),"Button will always be available to community admins.")},s.default.createElement(m.Icon,{icon:"info-sign"}))),checked:!ie,onChange:function(e){oe(!e.target.checked)}})),s.default.createElement(m.InputField,{label:"Default 'Create Pub' Collections",wrapperClassName:ie?"disable-block":""},s.default.createElement(m.CollectionMultiSelect,{allCollections:n.collections,selectedCollectionIds:ue||[],onItemSelect:function(e){var t=u(u([],l(ue||[]),!1),[e],!1);ce(t)},onRemove:function(e,t){var n=(ue||[]).filter((function(e,n){return n!==t}));ce(n)},placeholder:"Select Collections..."}))),s.default.createElement(m.SettingsSection,{title:"Navigation",id:"navigation"},s.default.createElement(m.InputField,null,s.default.createElement(f.Switch,{large:!0,label:"Show Navigation Bar",checked:!de,onChange:function(e){fe(!e.target.checked)}})),s.default.createElement("div",{className:de?"disable-block":""},s.default.createElement(m.InputField,{label:"Navigation"},s.default.createElement(_.default,{initialNav:n.navigation,prefix:[n.navigation[0]],pages:xt,collections:At,onChange:function(e){ye(e)}})),s.default.createElement(m.InputField,{label:"Preview"},s.default.createElement(m.NavBar,{previewContext:{communityData:r(r({},n),Nt),locationData:{path:"/",queryString:"",params:{}},loginData:{},scopeData:t}})))),s.default.createElement(m.SettingsSection,{title:"Homepage"},s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.InputField,null,s.default.createElement(f.Switch,{large:!0,label:"Show Homepage Banner",checked:!Se,onChange:function(e){De(!e.target.checked)}}))),s.default.createElement("div",{className:Se?"disable-block":""},s.default.createElement("div",{className:"row-wrapper image-upload-row"},s.default.createElement(m.ImageUpload,{htmlFor:"hero-logo-upload",label:s.default.createElement("span",null,"Banner Logo",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Used on the landing page.",s.default.createElement("br",null),"Recommended: ~200*750px")},s.default.createElement(m.Icon,{icon:"info-sign"}))),defaultImage:_e,height:80,width:150,onNewImage:function(e){Ee(e)},useAccentBackground:!0,canClear:!0}),s.default.createElement(m.ImageUpload,{htmlFor:"hero-background-upload",label:s.default.createElement("span",null,"Banner Background",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Used on the landing page.",s.default.createElement("br",null),"Recommended: ~1500*600px")},s.default.createElement(m.Icon,{icon:"info-sign"}))),defaultImage:we,onNewImage:function(e){Oe(e)},height:80,width:150,canClear:!0}),s.default.createElement(m.ImageUpload,{htmlFor:"hero-image-upload",label:s.default.createElement("span",null,"Banner Image",s.default.createElement(f.Tooltip,{content:s.default.createElement("span",null,"Used on the landing page.",s.default.createElement("br",null),"Recommended: ~600*600px")},s.default.createElement(m.Icon,{icon:"info-sign"}))),defaultImage:ze,onNewImage:function(e){He(e)},height:80,width:150,canClear:!0})),s.default.createElement(m.InputField,{label:"Banner Title",type:"text",value:qe,onChange:function(e){We(e.target.value)}}),s.default.createElement(m.InputField,{label:"Banner Text",type:"text",value:Ke,onChange:function(e){Je(e.target.value)}}),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.InputField,null,s.default.createElement(f.Switch,{label:"Hide Header Logo",checked:je,onChange:function(e){Me(e.target.checked)}})),s.default.createElement(m.InputField,null,s.default.createElement(f.Switch,{label:"Use Header Gradient",checked:Fe,onChange:function(e){Le(e.target.checked)},disabled:!we}))),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.InputField,{label:"Banner Background Color"},s.default.createElement(m.ColorInput,{value:Ie||n.accentColorDark,onChange:function(e){xe(e.hex)}})),s.default.createElement(m.InputField,{label:"Banner Text Color"},s.default.createElement(f.ButtonGroup,null,s.default.createElement(f.Button,{text:"Light",active:"#FFFFFF"===Rt,onClick:function(){Re("#FFFFFF")}}),s.default.createElement(f.Button,{text:"Dark",active:"#000000"===Rt,onClick:function(){Re("#000000")}})))),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.InputField,{label:"Primary Button Text",type:"text",value:$e.title,onChange:function(e){var t=e.target.value;Qe({title:t,url:$e.url})}}),s.default.createElement(m.InputField,{label:"Primary Button URL",type:"text",value:$e.url,onChange:function(e){var t=e.target.value;Qe({title:$e.title,url:t})}})),s.default.createElement("div",{className:"row-wrapper"},s.default.createElement(m.InputField,{label:"Secondary Button Text",type:"text",value:Xe.title,onChange:function(e){var t=e.target.value;et({title:t,url:Xe.url})}}),s.default.createElement(m.InputField,{label:"Secondary Button URL",type:"text",value:Xe.url,onChange:function(e){var t=e.target.value;et({title:Xe.title,url:t})}})),s.default.createElement(m.InputField,{label:"Banner Align"},s.default.createElement(f.ButtonGroup,null,s.default.createElement(f.Button,{text:"Left",active:"left"===nt,onClick:function(){rt("left")}}),s.default.createElement(f.Button,{text:"Center",active:"center"===nt,onClick:function(){rt("center")}})))),s.default.createElement(m.InputField,{label:"Preview"},s.default.createElement(m.Header,{previewContext:{communityData:r(r({},n),Nt),locationData:{path:"/",queryString:"",params:{}},loginData:{},scopeData:t}}))),s.default.createElement(m.SettingsSection,{title:"Social"},s.default.createElement(m.InputField,{label:"Website",type:"text",value:_t,onChange:function(e){Et(e.target.value)}}),s.default.createElement(m.InputField,{label:"Twitter",type:"text",value:wt,helperText:"https://twitter.com/"+wt,onChange:function(e){Ot(e.target.value)}}),s.default.createElement(m.InputField,{label:"Facebook",type:"text",value:St,helperText:"https://facebook.com/"+St,onChange:function(e){Dt(e.target.value)}}),s.default.createElement(m.InputField,{label:"Contact Email",type:"text",value:jt,onChange:function(e){Mt(e.target.value)}})),s.default.createElement(m.SettingsSection,{title:"Footer"},s.default.createElement(m.InputField,{label:"Footer Title",type:"text",value:ut||"",onChange:function(e){ct(e.target.value)},placeholder:n.title}),s.default.createElement(m.ImageUpload,{key:vt,htmlFor:"footer-logo-upload",label:"Footer Logo",defaultImage:pt,height:80,width:150,onNewImage:function(e){ht(e)},useAccentBackground:!0,canClear:!0}),s.default.createElement(f.Button,{small:!0,style:{margin:"-10px 0px 20px"},text:"Use Header Logo",disabled:!X||pt===X,onClick:function(){ht(X),yt(Math.random())}}),s.default.createElement(m.InputField,{label:"Footer Logo Link",type:"text",value:dt||"",onChange:function(e){ft(e.target.value)},placeholder:(0,v.communityUrl)(n)}),s.default.createElement(m.InputField,{label:"Footer Links"},s.default.createElement(_.default,{initialNav:n.footerLinks||h.defaultFooterLinks,suffix:h.defaultFooterLinks,pages:xt,collections:At,onChange:function(e){ot(e)},disableDropdown:!0})),s.default.createElement(m.InputField,{label:"Preview"},s.default.createElement(m.Footer,{previewContext:{communityData:r(r({},n),Nt),locationData:{path:"/",queryString:"",params:{}},loginData:{},scopeData:t}}))),s.default.createElement(m.SettingsSection,{title:"Export & Delete"},s.default.createElement(f.Card,null,s.default.createElement("h5",null,"Data export"),s.default.createElement("p",null,"You can request an export of the data associated with your Community on PubPub using the button below."),s.default.createElement(f.AnchorButton,{target:"_blank",href:"mailto:privacy@pubpub.org?subject=Community+data+export+request&body="+a.trim()},"Request data export")),s.default.createElement(f.Card,null,s.default.createElement("h5",null,"Community deletion"),s.default.createElement("p",null,"You can request that we completely delete your PubPub community using the button below. If you have published any notable Pubs, we may reserve the right to continue to display them based on the academic research exception to GDPR."),s.default.createElement(f.AnchorButton,{intent:"danger",target:"_blank",href:"mailto:privacy@pubpub.org?subject=Community+deletion+request&body="+i.trim()},"Request community deletion"))))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(118),f=n(5),m=n(161),p=n(163),h=c(n(480)),b=c(n(1359)),v=c(n(481)),y=n(288);n(1360);t.default=function(e){var t=e.initialNav,n=e.pages,a=e.collections,i=e.onChange,o=e.prefix,c=void 0===o?[]:o,g=e.suffix,_=void 0===g?[]:g,E=e.disableDropdown,P=void 0!==E&&E,w=l((0,s.useState)(t),2),O=w[0],C=w[1],S=O.slice(c.length,O.length-_.length),D=function(e,t,n){var r=Array.from(e),a=l(r.splice(t,1),1)[0];return r.splice(n,0,a),r},k=function(e){var t=u(u(u(u([],l(c),!1),[e],!1),l(S),!1),l(_),!1);C(t),i(t)},j={id:(0,m.generateHash)(8),title:"Link Title",href:""},M={id:(0,m.generateHash)(8),title:"Menu Title",children:[]};return s.default.createElement("div",{className:"nav-builder-component"},s.default.createElement("style",null,"body { height: 100vh; overflow: scroll }"),s.default.createElement("div",{className:"new-items"},s.default.createElement(h.default,{items:n,placeholder:"Add Page",usedItems:n.filter((function(e){return O.some((function(t){return t===e.id||t.id===e.id}))})),onSelect:function(e){k({type:"page",id:e.id})}}),s.default.createElement(h.default,{items:a,placeholder:"Add Collection",usedItems:a.filter((function(e){return O.some((function(t){return t.id===e.id}))})),onSelect:function(e){k({type:"collection",id:e.id})}}),s.default.createElement(f.Button,{small:!0,text:"Add Link",onClick:function(){k(j)}}),!P&&s.default.createElement(f.Button,{small:!0,text:"Add Dropdown Menu",onClick:function(){k(M)}})),s.default.createElement(d.DragDropContext,{onDragEnd:function(e){if(e.destination){var t="main-list"===e.destination.droppableId?D(S,e.source.index,e.destination.index):S.map((function(t){return(0,p.isCommunityNavigationMenu)(t)&&t.id===e.destination.droppableId?r(r({},t),{children:D(t.children,e.source.index,e.destination.index)}):t})),n=u(u(u([],l(c),!1),l(t),!1),l(_),!1);C(n),i(n)}}},s.default.createElement(y.NavBuilderContext.Provider,{value:{removeItem:function(e,t){var n="main-list"===t?S.filter((function(t){return t.id!==e&&t!==e})):S.map((function(n){return n.id===t&&(0,p.isCommunityNavigationMenu)(n)?r(r({},n),{children:n.children.filter((function(t){return t.id!==e&&t!==e}))}):n})),a=u(u(u([],l(c),!1),l(n),!1),l(_),!1);C(a),i(a)},updateItem:function(e,t,n){var a="main-list"===e?S.map((function(e,a){return a===t?r(r({},e),n):e})):S.map((function(a){return a.id===e&&(0,p.isCommunityNavigationMenu)(a)?r(r({},a),{children:a.children.map((function(e,a){return a===t?r(r({},e),n):e}))}):a})),o=u(u(u([],l(c),!1),l(a),!1),l(_),!1);C(o),i(o)},pages:n,collections:a}},s.default.createElement("div",{className:"items"},c.map((function(e,t){var n="prefix-"+t;return s.default.createElement("div",{key:n,className:"nav-builder-row"},s.default.createElement(v.default,{item:e,isStatic:!0,dropdownId:"main-list",index:-1}))})),s.default.createElement(b.default,{id:"main-list",items:S,newLink:j}),_.map((function(e,t){var n="suffix-"+t;return s.default.createElement("div",{key:n,className:"nav-builder-row"},s.default.createElement(v.default,{item:e,isStatic:!0,dropdownId:"main-list",index:-1}))}))))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=n(118),s=n(5),d=l(n(58)),f=n(288),m=l(n(481)),p=function(e){var t=e.id,n=e.items,a=void 0===n?[]:n,i=e.newLink,o=(0,u.useContext)(f.NavBuilderContext).removeItem;return u.default.createElement(c.Droppable,{droppableId:t,type:t},(function(e,n){return u.default.createElement("div",r({ref:e.innerRef,className:n.isDraggingOver?"dragging":""},e.droppableProps),a.map((function(e,n){var a="string"==typeof e?e:e.id;return u.default.createElement(c.Draggable,{key:"draggable-"+a+"-"+t,draggableId:"draggable-"+a+"-"+t,index:n,type:t},(function(l,c){return u.default.createElement("div",r({ref:l.innerRef,className:c.isDragging?"dragging nav-builder-row":"nav-builder-row"},l.draggableProps),u.default.createElement("div",{className:"shadow"},u.default.createElement("span",r({},l.dragHandleProps),u.default.createElement(d.default,{className:"drag-handle",icon:"drag-handle-horizontal"})),u.default.createElement(m.default,{dropdownId:t,index:n,item:e,newLink:i,NavBuilderList:p}),u.default.createElement(s.Button,{icon:"small-cross",minimal:!0,small:!0,onClick:function(){return o(a,t)}})))}))})),e.placeholder)}))};t.default=p},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1363);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(71),o=n(9),l=n(40),u=n(6),c=n(478),s=r(n(1364)),d=r(n(1365));t.default=function(){var e=(0,o.usePageContext)(),t=e.communityData,n=e.scopeData.elements.activeCollection,r=(0,c.useCollectionState)(n),f=r.collection,m=r.updateCollection,p=r.deleteCollection,h=r.slugStatus,b=r.hasChanges;return(0,i.useUpdateEffect)((function(){b||window.history.replaceState({},"",(0,l.getDashUrl)({collectionSlug:f.slug,mode:"settings"}))}),[f.slug,b]),a.default.createElement(u.DashboardFrame,{className:"collection-settings-component",title:"Settings"},a.default.createElement(u.SettingsSection,{title:"Details"},a.default.createElement(s.default,{slugStatus:h,communityData:t,collection:f,onUpdateCollection:m,onDeleteCollection:function(){return p().then((function(){window.location.href=(0,l.getDashUrl)({})}))}})),"tag"!==f.kind&&a.default.createElement(u.SettingsSection,{title:"Metadata",id:"metadata"},a.default.createElement(d.default,{collection:f,communityData:t,onUpdateCollection:m})),"tag"!==f.kind&&a.default.createElement(u.SettingsSection,{title:"Attribution",id:"attribution"},a.default.createElement(u.AttributionEditor,{apiRoute:"/api/collectionAttributions",canEdit:!0,hasEmptyState:!1,attributions:f.attributions,listOnBylineText:"List on Collection byline",identifyingProps:{collectionId:f.id,communityId:t.id},onUpdateAttributions:function(e){return m({attributions:e})}})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=n(5),s=n(107),d=n(74),f=n(64),m=n(6),p=n(35),h=n(222),b={none:'Never show "Read Next"',minimal:"Use compact preview with no image",medium:"Use a larger preview with an image","choose-best":"Choose the best preview for each Pub"};t.default=function(e){var t,n=e.communityData,a=e.collection,i=e.onUpdateCollection,o=e.onDeleteCollection,v=e.slugStatus,y=l((0,u.useState)(a.slug),2),g=y[0],_=y[1],E=null===(t=(0,d.getSchemaForKind)(a.kind))||void 0===t?void 0:t.label.singular,P=(0,h.getSlugError)(g,v);return u.default.createElement("div",null,u.default.createElement(m.InputField,{label:"Title",placeholder:"title",isRequired:!0,defaultValue:e.collection.title,onBlur:function(e){e.target.value&&i({title:e.target.value})}}),u.default.createElement(m.InputField,{label:"Link",placeholder:"link",isRequired:!0,defaultValue:g,value:g,error:P,helperText:"Collection URL will be "+(0,p.collectionUrl)(n,r(r({},a),{slug:g})),onChange:function(e){var t=e.target.value;_(t?(0,f.slugifyString)(t):"")},onBlur:function(){return g&&i({slug:g})}}),u.default.createElement(c.FormGroup,{helperText:"Making this "+E+" private means that Members will see it but visitors won't know it exists."},u.default.createElement(c.Checkbox,{checked:!a.isPublic,onChange:function(e){i({isPublic:!e.target.checked})}},"Private")),u.default.createElement(c.FormGroup,{helperText:'You can choose how the "Read Next" Pub preview will appear to readers in this collection.'},u.default.createElement(s.Select,{popoverProps:{minimal:!0},items:["none","choose-best"],itemRenderer:function(e,t){var n=t.handleClick,r=e===a.readNextPreviewSize;return u.default.createElement(c.MenuItem,{onClick:n,key:e,text:b[e],icon:r?"tick":"blank"})},onItemSelect:function(e){return i({readNextPreviewSize:e})},filterable:!1},u.default.createElement(c.Button,{rightIcon:"chevron-down"},b[a.readNextPreviewSize]))),u.default.createElement(c.FormGroup,{helperText:"You can delete this "+E+" permanently."},u.default.createElement(m.ConfirmDialog,{onConfirm:o,confirmLabel:"Delete",text:"Are you sure you want to delete this "+E+"?"},(function(e){var t=e.open;return u.default.createElement(c.Button,{icon:"trash",intent:"danger",onClick:t},"Delete")}))))}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=u(n(0)),d=n(5),f=c(n(380)),m=n(1366),p=n(74),h=n(18);n(1367);var b=function(e){var t=e.type,n=e.value;return!n||!t||t.validate(n)},v=function(e){function t(t){var n=e.call(this,t)||this,r=n.normalizeMetadata(t.collection.metadata||{});return n.state={title:t.collection.title,metadata:r,isGettingDoi:!1,isSaving:!1,deposited:!1,saved:!1},n.handleInputChange=n.handleInputChange.bind(n),n.handleTitleChange=n.handleTitleChange.bind(n),n.handleSaveClick=n.handleSaveClick.bind(n),n.handleGetDoiClick=n.handleGetDoiClick.bind(n),n}return a(t,e),t.prototype.allFieldsValidate=function(){var e=this.props.collection.kind,t=this.state.metadata;return(0,m.enumerateMetadataFields)(t,e).reduce((function(e,t){return e&&b(t)}),!0)},t.prototype.normalizeMetadata=function(e){var t=this.props,n=t.collection,r=t.communityData;return(0,m.normalizeMetadataToKind)(e,n.kind,{community:r,collection:n})},t.prototype.deriveInputValue=function(e){var t=this.props;return e({community:t.communityData,collection:t.collection})},t.prototype.handleGetDoiClick=function(){var e=this,t=this.props,n=t.communityData,r=t.collection,a=t.onUpdateCollection;return this.setState({isGettingDoi:!0,deposited:!1,saved:!1}),(0,h.apiFetch)("/api/doi",{method:"POST",body:JSON.stringify({target:"collection",collectionId:r.id,communityId:n.id})}).then((function(t){var n=t.dois;a({doi:n.collection}),e.setState({isGettingDoi:!1,deposited:!0})})).catch((function(){e.setState({isGettingDoi:!1})}))},t.prototype.handleSaveClick=function(){var e=this,t=this.props,n=t.communityData,r=t.collection,a=t.onUpdateCollection,i=this.state,o=i.metadata,l=i.title;return this.setState({isSaving:!0,deposited:!1,saved:!1}),(0,h.apiFetch)("/api/collections",{method:"PUT",body:JSON.stringify({metadata:o,title:l,id:r.id,communityId:n.id})}).then((function(){a({metadata:o,title:l}),e.setState({isSaving:!1,saved:!0})})).catch((function(){e.setState({isSaving:!1})}))},t.prototype.handleInputChange=function(e,t,n){var r,a=this.state.metadata;n&&!new RegExp(n).test(t)||this.setState({metadata:this.normalizeMetadata(i(i({},a),(r={},r[e]=t,r)))})},t.prototype.handleTitleChange=function(e){this.setState({title:e.target.value})},t.prototype.renderGetDoiButton=function(){var e=this.props.collection,t=this.state.isGettingDoi;return e.doi?s.createElement(d.Button,{icon:"link",loading:t,disabled:t,onClick:this.handleGetDoiClick},"Re-deposit"):s.createElement(f.default,{onConfirm:this.handleGetDoiClick,confirmLabel:"Assign DOI",intent:"primary",text:"This is the first time this collection has been deposited to Crossref. Once assigned, the DOI for this collection cannot be changed."},(function(e){var n=e.open;return s.createElement(d.Button,{icon:"link",loading:t,disabled:t,onClick:n},"Deposit")}))},t.prototype.renderFieldRightElement=function(e){var t=this,n=e.name,r=e.defaultDerivedFrom,a=e.value,i=r&&this.deriveInputValue(r);return i&&s.createElement(d.Button,{minimal:!0,icon:"lightbulb",disabled:a===i,onClick:function(){return t.handleInputChange(n,i)}},"Use default")},t.prototype.renderField=function(e){var t=this,n=e.name,r=e.label,a=e.derivedFrom,i=e.derivedLabelInfo,o=e.pattern,l=e.type,u=e.value,c=a&&this.deriveInputValue(a);return s.createElement(d.FormGroup,{key:n,label:r,labelInfo:c?i:l&&l.labelInfo},s.createElement(d.InputGroup,{className:"field",value:c||u||"",onChange:function(e){return t.handleInputChange(n,e.target.value,o)},intent:b(e)?"none":"danger",rightElement:this.renderFieldRightElement(e)}))},t.prototype.renderFields=function(){var e=this,t=this.props.collection,n=this.state.metadata,r=t.kind,a=(0,m.enumerateMetadataFields)(n,r);return 0===a.length?s.createElement(d.NonIdealState,{className:"fields-empty-state",icon:(0,p.getSchemaForKind)(r).bpDisplayIcon||"help",title:"This collection type has no metadata"}):s.createElement("div",{className:"fields"},a.map((function(t){return e.renderField(t)})))},t.prototype.renderStatusMessage=function(){return this.state.deposited?s.createElement(d.Callout,{intent:"success",title:"Success!"},s.createElement("p",null,"Successfully submitted a DOI registration for this Collection."),s.createElement("p",null,"Registration may take a few hours to complete in Crossref's system. If DOI URLs do not work immediately, the registration is likely still processing.")):this.state.saved?s.createElement(d.Callout,{intent:"success",title:"Success!"},s.createElement("p",null,"Successfully saved Collection metadata.")):null},t.prototype.render=function(){var e=this.state.isSaving;return s.createElement("div",{className:"dashboard-content_collection-metadata-editor"},this.renderFields(),s.createElement(d.ButtonGroup,null,s.createElement(d.Button,{icon:"tick",disabled:e||!this.allFieldsValidate(),onClick:this.handleSaveClick},"Save changes"),s.createElement(d.Divider,null),this.renderGetDoiButton()),this.renderStatusMessage())},t}(s.Component);t.default=v},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateMetadataFields=t.deserializeMetadata=t.normalizeMetadataToKind=t.getAllSchemaKinds=t.mapMetadataFields=void 0;var l=o(n(74)),u=function(e){return null==e};t.mapMetadataFields=function(e,t){var n=(0,l.getSchemaForKind)(e),r={};return n.metadata.forEach((function(e){var n=t(e);void 0!==n&&(r[e.name]=n)})),r};t.getAllSchemaKinds=function(){return l.default.map((function(e){return e.kind}))};t.normalizeMetadataToKind=function(e,n,r){return(0,t.mapMetadataFields)(n,(function(t){var n=t.name,a=t.derivedFrom,i=t.defaultDerivedFrom;if(a){var o=a(r);if(!u(o))return o}var l=e[n];return u(l)?i?i(r):void 0:l}))};t.deserializeMetadata=function(e){var n=e.metadata,r=e.kind,a=e.fallback;return(0,t.mapMetadataFields)(r,(function(e){var t=e.name,r=e.type;return n[t]?r?r.deserialize(n[t]):n[t]:a?a(e):void 0}))};t.enumerateMetadataFields=function(e,t){return(0,l.getSchemaForKind)(t).metadata.map((function(t){var n=t.name;return r(r({},t),{value:e[n]})}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1369);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(71),d=n(5),f=n(6),m=n(18),p=n(64),h=n(9),b=n(40),v=n(35),y=u(n(1370)),g=u(n(1371)),_=u(n(1374)),E=u(n(1376));t.default=function(e){var t=e.settingsData,n=(0,h.usePageContext)(),a=n.scopeData,i=n.communityData,o=a.activePermissions,u=o.canAdminCommunity,P=o.canManage,w=l((0,c.useState)(t.pubData),2),O=w[0],C=w[1],S=l((0,c.useState)({}),2),D=S[0],k=S[1],j=l((0,c.useState)(!1),2),M=j[0],N=j[1],I=(0,h.usePendingChanges)().pendingPromise,x=Object.keys(D).length>0,T=r(r({},O),D),A=T.description||"";(0,s.useBeforeUnload)(x,"You have unsaved changes to this Pub. Are you sure you want to navigate away?");var R,B=function(e){k(r(r({},D),e))},F=function(e){C(r(r({},O),e))},L=function(){return N(!0),I((0,m.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify(r(r({},D),{pubId:T.id,communityId:i.id}))})).then((function(){var e=r(r({},O),D);k({}),N(!1),C(e),O.slug!==e.slug&&(window.location.href=(0,b.getDashUrl)({pubSlug:e.slug,mode:"settings"}))})).catch((function(e){console.error(e),N(!1)}))};return c.default.createElement(f.DashboardFrame,{className:"pub-settings-container",title:"Settings",controls:(R=x&&T.title&&T.slug,c.default.createElement(d.Button,{type:"button",intent:"primary",text:"Save Changes",disabled:!R,loading:M,onClick:L}))},function(){var e;return c.default.createElement(c.default.Fragment,null,c.default.createElement(f.SettingsSection,{title:"Details"},c.default.createElement(f.InputField,{label:"Title",error:T.title?null:"Required"},c.default.createElement(f.TitleEditor,{className:"bp3-input",initialValue:null!==(e=T.htmlTitle)&&void 0!==e?e:void 0,onInput:function(e,t){return B({htmlTitle:e,title:t})}})),c.default.createElement(f.InputField,{label:"Link",helperText:"Pub will be available at "+(0,v.pubUrl)(i,T),value:T.slug,onChange:function(e){return B({slug:(0,p.slugifyString)(e.target.value)})},error:T.slug?null:"Required"}),c.default.createElement(f.InputField,{label:"Custom publication date",helperText:"If set, this will be shown instead of the first Release date."},c.default.createElement(f.DatePicker,{style:{width:200},date:T.customPublishedAt,onSelectDate:function(e){return B({customPublishedAt:e&&e.toUTCString()})}})),c.default.createElement(f.InputField,{label:"Description",placeholder:"Enter description",helperText:(T.description||"").length+"/280 characters",isTextarea:!0,value:A,onChange:function(e){return B({description:e.target.value.substring(0,280).replace(/\n/g," ")})},error:void 0}),c.default.createElement(f.ImageUpload,{htmlFor:"avatar-upload",label:c.default.createElement("span",null,"Preview Image",c.default.createElement(d.Tooltip,{content:c.default.createElement("span",null,"Image to be associated with this pub when it is shown in"," ",c.default.createElement("br",null),"other pages as part a preview link or in a listing of pubs."),tooltipClassName:"bp3-dark"},c.default.createElement(f.Icon,{icon:"info-sign"}))),canClear:!0,key:T.avatar,defaultImage:T.avatar,onNewImage:function(e){return B({avatar:e})},width:150,helperText:c.default.createElement("span",null,"Suggested minimum dimensions: ",c.default.createElement("br",null),"1200px x 800px")}),c.default.createElement(d.Button,{disabled:T.avatar===T.headerBackgroundImage,onClick:function(){return B({avatar:T.headerBackgroundImage})}},"Use header image as preview")))}(),c.default.createElement(f.SettingsSection,{title:"License"},c.default.createElement(f.LicenseSelect,{persistSelections:!1,pubData:T,onSelect:function(e){return B({licenseSlug:e.slug})}},(function(e){var t=e.title,n=e.icon;return c.default.createElement(d.Button,{icon:n,text:t,rightIcon:"caret-down"})}))),c.default.createElement(f.SettingsSection,{title:"Theme"},c.default.createElement(f.PubThemePicker,{updatePubData:B,pubData:T,communityData:i})),c.default.createElement(f.SettingsSection,{title:"Citation Style"},c.default.createElement(_.default,{pubData:T,communityId:i.id,onSetCitations:function(e){return F(e)}})),c.default.createElement(f.SettingsSection,{title:"DOI"},c.default.createElement(g.default,{pubData:O,communityData:i,updatePubData:F,canIssueDoi:u,depositTarget:t.depositTarget})),c.default.createElement(f.SettingsSection,{title:"Attributions"},c.default.createElement(f.PubAttributionEditor,{pubData:T,communityData:i,updatePubData:F,canEdit:P})),c.default.createElement(f.SettingsSection,{title:"Download"},c.default.createElement(f.DownloadChooser,{pubData:T,communityId:i.id,onSetDownloads:function(e){return F({downloads:e})}})),c.default.createElement(f.SettingsSection,{title:"Collections"},c.default.createElement(f.PubCollectionsListing,{pub:T,allCollections:i.collections,collectionPubs:T.collectionPubs,updateCollectionPubs:function(e){return F({collectionPubs:e})},canManage:P})),c.default.createElement(f.SettingsSection,{title:"Item Labels",id:"block-labels"},c.default.createElement(E.default,{pubData:O,updatePubData:B})),c.default.createElement(f.SettingsSection,{title:"Delete"},c.default.createElement(y.default,{communityData:i,pubData:T})))}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var u=l(n(0)),c=n(5),s=n(6),d=n(40),f=n(18),m=function(e){return e.toLowerCase().trim().replace(/\s/g," ")},p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isLoading:!1,title:""},n.updateTitle=n.updateTitle.bind(n),n.handleDelete=n.handleDelete.bind(n),n}return a(t,e),t.prototype.updateTitle=function(e){this.setState({title:e.target.value})},t.prototype.handleDelete=function(){var e=this;return this.setState({isLoading:!0}),(0,f.apiFetch)("/api/pubs",{method:"DELETE",body:JSON.stringify({pubId:this.props.pubData.id,communityId:this.props.communityData.id})}).then((function(){window.location.href=(0,d.getDashUrl)({mode:"overview"})})).catch((function(){e.setState({isLoading:!1})}))},t.prototype.render=function(){var e=m(this.props.pubData.title)===m(this.state.title);return u.default.createElement("div",{className:"bp3-callout bp3-intent-danger"},u.default.createElement("p",null,u.default.createElement("b",null,"Deleting a Pub is permanent - it cannot be undone.")),u.default.createElement("p",null,"This will permanently delete the Pub ",u.default.createElement("b",null,this.props.pubData.title),", its discussions, and associated metadata."),u.default.createElement("p",null,"Please type the title of the Pub below to confirm your intention."),u.default.createElement(s.InputField,{label:u.default.createElement("b",null,"Confirm Pub Title"),value:this.state.title,onChange:this.updateTitle}),u.default.createElement(c.Button,{type:"button",className:"bp3-intent-danger",text:"Delete Pub",loading:this.state.isLoading,onClick:this.handleDelete,disabled:!e}))},t}(u.Component);t.default=p},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var d=n(5),f=l(n(0)),m=n(18),p=n(6),h=n(131),b=n(74),v=n(1372),y=n(471),g=n(280);n(1373);var _=function(e,t){var n,r=null!==(n=null==t?void 0:t.doiPrefix)&&void 0!==n?n:v.PUBPUB_DOI_PREFIX;return e.replace(r+"/","")},E=function(e){function t(t){var n=e.call(this,t)||this,r=s((t.pubData.doi||"").split("/"),2)[1];return n.state={doiSuffix:r,error:!1,justSetDoi:!1,deleting:!1,generating:!1,success:!1,updating:!1},n.handleDeposit=n.handleDeposit.bind(n),n.handleUpdateDoiClick=n.handleUpdateDoiClick.bind(n),n.handleGenerateDoiClick=n.handleGenerateDoiClick.bind(n),n.handleDeleteDoiClick=n.handleDeleteDoiClick.bind(n),n}return a(t,e),t.prototype.getDoiPrefix=function(){var e,t;return null!==(t=null===(e=this.props.depositTarget)||void 0===e?void 0:e.doiPrefix)&&void 0!==t?t:v.PUBPUB_DOI_PREFIX},t.prototype.getFullDoi=function(){return this.getDoiPrefix()+"/"+this.state.doiSuffix},t.prototype.getHelperText=function(e){var t=this.state,n=t.success,r=t.error,a="";return e?a="Invalid DOI suffix":r?a="There was a problem updating the DOI suffix":n&&(a="DOI suffix updated succesfully on PubPub. To take effect, the DOI must be submitted to Crossref."),a},t.prototype.getIntent=function(e){var t=this.state,n=t.success,r=t.error,a="none";return e||r?a="danger":n&&(a="success"),a},t.prototype.findSupplementTo=function(){var e=this.props.pubData;return(0,g.findParentEdgeByRelationTypes)(e,[g.RelationType.Supplement])},t.prototype.findParentPubEdge=function(){var e=this.props.pubData,t=(0,g.findParentEdgeByRelationTypes)(e,[g.RelationType.Supplement,g.RelationType.Review,g.RelationType.Rejoinder,g.RelationType.Preprint]);return!t||t.externalPublication?null:t},t.prototype.disabledDueToParentWithoutDoi=function(){var e=this.findParentPubEdge();if(!e)return!1;var t=e.pubIsParent?e.pub:e.targetPub;return t&&!t.doi},t.prototype.disabledDueToNoReleases=function(){return 0===this.props.pubData.releases.length},t.prototype.disabledDueToUnmanagedPrefix=function(){return this.props.depositTarget&&!(this.props.depositTarget.password&&this.props.depositTarget.username)},t.prototype.handleDeposit=function(e){var t=this.props.updatePubData;this.setState({justSetDoi:!0}),t({doi:e})},t.prototype.updateDoi=function(e,t,n){return u(this,void 0,void 0,(function(){var r,a,i,o,l,u,s,d,f,p,h;return c(this,(function(c){switch(c.label){case 0:if(r=this.state,a=r.updating,i=r.deleting,o=this.props,l=o.communityData,u=o.pubData,s=o.updatePubData,a||i)return[2];this.setState(((f={})[t]=!0,f.error=!1,f.success=!1,f)),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,(0,m.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify({doi:e,pubId:u.id,communityId:l.id})})];case 2:return d=c.sent(),this.setState(((p={})[t]=!1,p.doiSuffix=_(d.doi,this.props.depositTarget),p.error=!1,p.success=!0,p)),s({doi:d.doi}),[3,4];case 3:return c.sent(),this.setState(((h={})[t]=!1,h.doiSuffix=n,h.error=!0,h.success=!1,h)),[3,4];case 4:return[2]}}))}))},t.prototype.handleDeleteDoiClick=function(){return u(this,void 0,void 0,(function(){return c(this,(function(e){return this.updateDoi("","deleting",this.state.doiSuffix),[2]}))}))},t.prototype.handleGenerateDoiClick=function(){return u(this,void 0,void 0,(function(){var e,t,n,r,a,i,o,l,u;return c(this,(function(c){switch(c.label){case 0:if(e=this.state,t=e.updating,n=e.deleting,r=e.generating,a=this.props,i=a.communityData,o=a.pubData,t||n||r)return[2];this.setState({generating:!0,error:!1,success:!1}),c.label=1;case 1:return c.trys.push([1,3,,4]),l=new URLSearchParams({target:"pub",communityId:i.id,pubId:o.id}),[4,(0,m.apiFetch)("/api/generateDoi?"+l.toString())];case 2:return u=c.sent(),this.setState({generating:!1,doiSuffix:_(u.dois.pub,this.props.depositTarget),error:!1,success:!1}),[3,4];case 3:return c.sent(),this.setState({generating:!1,error:!0,success:!1}),[3,4];case 4:return[2]}}))}))},t.prototype.handleUpdateDoiClick=function(){return u(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){return e=this.props.pubData,t=this.getFullDoi(),n=_(e.doi||"",this.props.depositTarget),this.updateDoi(t,"updating",n),[2]}))}))},t.prototype.isDoiEditableWithoutRelations=function(){var e=this.props,t=e.canIssueDoi,n=e.pubData,r=this.state.justSetDoi,a=this.getDoiPrefix();return t&&!(r||n.crossrefDepositRecordId)&&this.props.depositTarget&&a!==v.PUBPUB_DOI_PREFIX},t.prototype.isDoiEditable=function(){return this.isDoiEditableWithoutRelations()&&!this.findSupplementTo()},t.prototype.renderParentEdgeRelation=function(){var e=this.findParentPubEdge();if(!e)return null;var t=g.relationTypeDefinitions[e.relationType],n=t.article,r=t.preposition,a=t.name;return f.default.createElement(f.default.Fragment,null,n," ",f.default.createElement("strong",null,a)," ",r)},t.prototype.renderCollectionContextMessage=function(){var e=this.props.pubData;if(this.state.justSetDoi)return null;var t=(0,h.getPrimaryCollection)(e.collectionPubs);if(t){var n=(0,b.getSchemaForKind)(t.kind);return f.default.createElement("p",null,"This Pub will be cited as a member of the ",n.label.singular,","," ",f.default.createElement("b",null,t.title),". You can change this by updating the"," ",f.default.createElement("em",null,"Primary Collection")," of the Pub from the Collections tab.")}return null},t.prototype.renderStatusMessage=function(){var e=this.props.pubData;return this.state.justSetDoi?f.default.createElement(d.Callout,{intent:"success",title:"Success!"},f.default.createElement("p",null,"Successfully submitted a DOI registration for this Pub."),f.default.createElement("p",null,"Registration may take a few hours to complete in Crossref's system. If DOI URLs do not work immediately, the registration is likely still processing.")):f.default.createElement(f.default.Fragment,null,!e.doi&&f.default.createElement("p",null,"A DOI can be set for each Pub by admins of this community."),this.disabledDueToUnmanagedPrefix()&&f.default.createElement(d.Callout,{intent:"warning"},"This Pub cannot be deposited to Crossref via PubPub because there is no Crossref account connected to PubPub for this Community."),e.doi&&!e.crossrefDepositRecordId&&!this.disabledDueToNoReleases()&&!this.disabledDueToUnmanagedPrefix()&&f.default.createElement(d.Callout,{intent:"warning"},"A DOI has been assigned to this Pub, but it has not yet been deposited to Crossref."),e.crossrefDepositRecordId&&f.default.createElement("p",null,"This Pub has been deposited to Crossref."),this.isDoiEditableWithoutRelations()&&this.findSupplementTo()&&f.default.createElement(d.Callout,{intent:"warning"},"The DOI for this Pub is not editable because it is a"," ",f.default.createElement("strong",null,"Supplement")," to another Pub."))},t.prototype.renderContent=function(){var e=this.props,t=e.pubData,n=e.canIssueDoi,r=this.state.justSetDoi;return n?f.default.createElement(f.default.Fragment,null,this.renderStatusMessage(),this.renderCollectionContextMessage(),this.renderDoi(),f.default.createElement(d.FormGroup,{helperText:t.doi&&!r&&f.default.createElement(f.default.Fragment,null,"If you've changed aspects of this pub and wish to update its DOI deposit, you can do so here. In the future, PubPub will resubmit such changes automatically."," ",this.isDoiEditable()&&f.default.createElement(f.default.Fragment,null," ","PubPub will automatically assign a DOI if the suffix is left blank. Please note that"," ",f.default.createElement("strong",null,"once submitted, the DOI will no longer be editable.")))},this.disabledDueToParentWithoutDoi()&&f.default.createElement(d.Callout,{intent:"warning"},"This Pub cannot be deposited to Crossref because it is"," ",this.renderParentEdgeRelation()," its parent Pub, and its parent Pub does not have a DOI."),this.disabledDueToNoReleases()&&f.default.createElement(d.Callout,{intent:"warning"},"This Pub cannot be deposited to Crossref because it has no published releases."),f.default.createElement(p.AssignDoi,{communityData:this.props.communityData,onDeposit:this.handleDeposit,pubData:this.props.pubData,target:"pub",disabled:this.disabledDueToParentWithoutDoi()||this.disabledDueToNoReleases()||this.disabledDueToUnmanagedPrefix()}))):f.default.createElement(f.default.Fragment,null,this.renderStatusMessage(),this.renderDoi())},t.prototype.renderDoi=function(){var e=this,t=this.props.pubData,n=this.state,r=n.doiSuffix,a=n.updating,i=n.generating,o=n.deleting,l=this.getFullDoi(),u=r&&!(0,y.isDoi)(l),c=this.getIntent(u),s=this.getHelperText(u);return this.isDoiEditable()?f.default.createElement(d.FormGroup,{helperText:s,intent:c,className:"doi",label:"DOI Suffix"},f.default.createElement(d.InputGroup,{placeholder:"Enter a DOI suffix...",value:r,onChange:function(t){return e.setState({doiSuffix:t.target.value})},leftElement:f.default.createElement("span",{className:"doi-prefix"},this.getDoiPrefix(),"/"),style:{zIndex:0}}),f.default.createElement(d.Button,{disabled:!r||u||o||i,text:"Update Suffix",loading:a,onClick:this.handleUpdateDoiClick,intent:"success"}),f.default.createElement(d.Button,{disabled:u||o||a,text:"Generate Suffix",loading:i,onClick:this.handleGenerateDoiClick}),f.default.createElement(d.Button,{disabled:!t.doi||u||a||i,text:"Delete",loading:o,onClick:this.handleDeleteDoiClick,intent:"danger"})):f.default.createElement(f.default.Fragment,null,t.doi&&f.default.createElement("p",null,"Pub DOI:"," ",f.default.createElement("a",{className:"doi-link",href:"https://doi.org/"+t.doi},t.doi)))},t.prototype.render=function(){return f.default.createElement("div",{className:"pub-settings-container_doi-component"},this.renderContent())},t}(f.Component);t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.communityDoiOverrides=t.managedDoiPrefixes=t.PUBPUB_DOI_PREFIX=void 0,t.PUBPUB_DOI_PREFIX="10.21428";t.managedDoiPrefixes=[t.PUBPUB_DOI_PREFIX,"10.1162","10.31274","10.3847","10.32376","10.46470","10.36850","10.1037","10.47761","10.26116","10.21825","10.52750","10.7171","10.47123","10.55167","10.57844"],t.communityDoiOverrides=[{communityIds:["99608f92-d70f-46c1-a72c-df272215f13e","00c13b77-f067-4b53-8f11-c97aa4b024ff","ba67f642-710c-4dec-a683-471946cc5783","2e3983f5-6090-4b15-ac21-3d753c77ca39","a8667414-71c7-4813-bdd7-162a32e00efc"],prefix:"10.1162",key:"MITP"},{communityIds:["3d9ea6a4-25b9-42d3-8ceb-22459c649096","b8136f97-b9c2-442a-95a8-fe1df5c1d209"],prefix:"10.31274",key:"IASTATE"},{communityIds:["25c2cfeb-dc5b-4dd7-9c82-19146688a931"],prefix:"10.3847",key:"AAS"},{communityIds:["3f8575cb-cdf7-48bb-8985-f4eee1b6c624","d895a0ea-f471-4730-9c4a-3d5de1733ccb"],prefix:"10.32376",key:"MEDIASTUDIES"},{communityIds:["03d8ffbd-bc68-45ce-b453-6f10b8ca3476"],prefix:"10.46470",key:"RS"},{communityIds:["27d9a5c8-30f3-44bd-971f-181388d53323"],prefix:"10.36850",key:"JOTE"},{communityIds:["700f6ff1-4acc-4ca4-b740-8d04d89fea9e","67edb85b-3e58-44e5-89ef-dded1f72972c"],prefix:"10.1037",key:"APA"},{communityIds:["494a02f6-55bd-49b5-b0c3-0c0d98a76444"],prefix:"10.47761",key:"ROCHESTER"},{communityIds:["6ffe5cea-8ff9-421f-83dc-29d7d2eef839"],prefix:"10.26116",key:"OPENPRESSTIU"},{communityIds:["86c49e4a-a4bb-4748-8e01-81d8113deb53"],prefix:"10.21825",key:"UGHENT"},{communityIds:["09eba68b-d4ec-462d-a200-960abb62b384","21ff89b9-b3b0-4d3e-9ba7-46ce5c6ceaf2"],prefix:"10.52750",key:"NSCU"},{communityIds:["3fc1f5fe-d4be-419a-9b72-719d9b12169c"],prefix:"10.7171",key:"ABRF"},{communityIds:["f51e9fed-9bfd-465d-8556-65ad9a65f734"],prefix:"10.47123",key:"LAVAL"},{communityIds:["52333846-c54f-4668-ba45-c3124b226fd3"],prefix:"10.55167",key:"FREEMOSCOWU"},{communityIds:["1a71ef4d-f6fe-40d3-8379-42fa2141db58"],prefix:"10.57844",key:"ARCADIASCIENCE"}]},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=n(107),u=n(6),c=n(18),s=n(479);n(1375);t.default=function(e){var t=e.communityId,n=e.pubData,a=e.onSetCitations,d=n.citationStyle,f=n.citationInlineStyle,m=function(e){return a(e),(0,c.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify(r(r({},e),{pubId:n.id,communityId:t}))}).catch((function(e){return console.error("Error Saving Pub Citation Style: ",e)}))},p=s.citationStyles.find((function(e){return e.key===d})),h=s.citationInlineStyles.find((function(e){return e.key===f}));return i.default.createElement("div",{className:"citation-chooser-component"},i.default.createElement(u.InputField,{label:"Citation Style"},i.default.createElement(l.Select,{items:s.citationStyles,itemRenderer:function(e,t){var n=t.handleClick;return i.default.createElement(o.MenuItem,{onClick:n,key:e.key,active:e.key===p.key,text:e.name})},filterable:!1,popoverProps:{minimal:!0},onItemSelect:function(e){m({citationStyle:e.key})}},i.default.createElement(o.Button,{text:p.name,rightIcon:"caret-down"}))),i.default.createElement(u.InputField,{label:"Inline Citation Style"},i.default.createElement(l.Select,{items:s.citationInlineStyles,itemRenderer:function(e,t){var n=t.handleClick;return i.default.createElement(o.MenuItem,{onClick:n,key:e.key,active:e.key===h.key,text:i.default.createElement("span",null,e.title,i.default.createElement("span",{className:"cite-example"},e.example))})},filterable:!1,popoverProps:{minimal:!0},onItemSelect:function(e){m({citationInlineStyle:e.key})}},i.default.createElement(o.Button,{text:i.default.createElement("span",null,h.title,i.default.createElement("span",{className:"cite-example"},h.example)),rightIcon:"caret-down"}))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(5),s=o(n(0)),d=n(137),f=u(n(3)),m=n(6),p=n(115),h=n(212);n(1377);var b,v=function(e){var t=e.enabled,n=e.type,r=e.text,a=e.onTextChange,i=e.onToggle;return s.default.createElement("tr",{className:(0,f.default)(!t&&"disabled")},s.default.createElement("td",null,n),s.default.createElement("td",null,s.default.createElement(c.Checkbox,{checked:t,onChange:function(e){return i(e.target.checked)}})),s.default.createElement("td",null,s.default.createElement(m.InputField,{type:"text",onChange:function(e){return a(e.target.value)},value:r,isDisabled:!t})))};!function(e){e.Toggle="toggle",e.ToggleAll="toggle_all",e.UpdateLabel="update_label"}(b||(b={}));var y=function(e){return Object.values(e).every((function(e){return e.enabled}))},g=function(e,t){var n,a;switch(t.type){case b.Toggle:var i=t.payload,o=i.nodeType,u=i.enabled;return r(r({},e),((n={})[o]=r(r({},e[o]),{enabled:u}),n));case b.ToggleAll:var c=!y(e);return Object.entries(e).reduce((function(e,t){var n,a=l(t,2),i=a[0],o=a[1];return r(r({},e),((n={})[i]=r(r({},o),{enabled:c}),n))}),{});case b.UpdateLabel:var s=t.payload,d=(o=s.nodeType,s.text);return r(r({},e),((a={})[o]=r(r({},e[o]),{text:d}),a));default:return e}};t.default=function(e){var t=e.pubData,n=e.updatePubData,r=function(e){var t=(0,s.useMemo)((function(){return(0,p.getDefaultNodeLabels)(e)}),[]),n=l((0,s.useReducer)(g,t),2),r=n[0],a=n[1],i=(0,s.useCallback)((function(e,t){return a({type:b.Toggle,payload:{nodeType:e,enabled:t}})}),[]),o=(0,s.useCallback)((function(e,t){return a({type:b.UpdateLabel,payload:{nodeType:e,text:t}})}),[]);return{state:r,toggleAll:(0,s.useCallback)((function(){return a({type:b.ToggleAll})}),[]),toggleNode:i,updateLabel:o}}(t),a=r.state,i=r.toggleAll,o=r.toggleNode,u=r.updateLabel,f=l((0,d.useDebounce)(a,500),1)[0],m=(0,s.useMemo)((function(){return a}),[]);return(0,s.useEffect)((function(){f!==m&&n({nodeLabels:f})}),[f]),s.default.createElement("div",{className:"node-label-editor-component"},s.default.createElement("p",null,'You can enable automatic numbering for different types of blocks, and choose the text that will be used to reference them within the Pub. By giving two types of blocks the same name, you can group them into one ordering list (i.e., if you want both images and videos to be "figures" and share the same numbering, give them both the label "Figure").'),s.default.createElement("table",{className:"bp3-html-table bp3-small"},s.default.createElement("thead",null,s.default.createElement("tr",null,s.default.createElement("th",null,"Type"),s.default.createElement("th",null,"Enabled"),s.default.createElement("th",null,"Label"))),s.default.createElement("tbody",null,h.referenceableNodeTypes.map((function(e){var t=a[e],n=t.enabled,r=t.text;return s.default.createElement(v,{key:e,type:p.nodeDefaults[e].text,enabled:n,text:r,onTextChange:function(t){return u(e,t)},onToggle:function(t){return o(e,t)}})})))),s.default.createElement(c.Checkbox,{label:"Toggle All",checked:y(a),onClick:i,className:"toggle-all"}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(6),d=n(9),f=u(n(1380)),m=u(n(1389)),p=u(n(1390));n(1391);t.default=function(e){var t=e.initialPubs,n=e.initiallyLoadedAllPubs,a=e.initialSubmissionWorkflow,i=l((0,c.useState)(a),2),o=i[0],u=i[1],h=(0,d.usePageContext)().scopeData.elements.activeCollection,b=c.default.createElement(m.default,{workflow:o,onUpdateWorkflow:function(e){return u((function(t){return r(r({},t),e)}))}});return c.default.createElement(s.DashboardFrame,{className:"dashboard-submissions-container",title:"Submissions",icon:"manually-entered-data",controls:c.default.createElement(c.default.Fragment,null,c.default.createElement(p.default,null),b)},c.default.createElement(f.default,{initialPubs:t,collection:h,initiallyLoadedAllPubs:n,acceptSubmissionsToggle:o.enabled?null:b}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(5),d=n(133),f=n(182),m=n(35),p=n(9),h=n(184),b=n(223),v=u(n(1381));n(1388);var y={all:{submissionStatuses:["received","accepted","declined"]},received:{submissionStatuses:["received"]},accepted:{submissionStatuses:["accepted"]},declined:{submissionStatuses:["declined"]}},g={id:"received",title:"Received",query:y.received},_=[g,{id:"accepted",title:"Accepted",query:y.accepted},{id:"declined",title:"Declined",query:y.declined},{id:"all",title:"All",query:y.all}];t.default=function(e){var t=e.collection,n=e.initialPubs,a=e.initiallyLoadedAllPubs,i=e.acceptSubmissionsToggle,o=(0,p.usePageContext)().communityData,u=l((0,c.useState)(""),2),y=u[0],E=u[1],P=l((0,c.useState)(g),2),w=P[0],O=P[1],C=!!w||!!y,S=(0,d.useManyPubs)({isEager:C,initialPubs:n,initiallyLoadedAllPubs:a,batchSize:200,cacheQueries:!1,pubOptions:{getSubmissions:!0},query:r({term:y,scopedCollectionId:t.id},null==w?void 0:w.query)}).currentQuery,D=S.pubs,k=S.isLoading,j=S.hasLoadedAllPubs,M=S.loadMorePubs,N=D.filter((function(e){var n,r;return(null===(r=null===(n=e.submission)||void 0===n?void 0:n.submissionWorkflow)||void 0===r?void 0:r.collectionId)===t.id})),I=!j;(0,f.useInfiniteScroll)({enabled:!k&&I,useDocumentElement:!0,onRequestMoreItems:M});return c.default.createElement("div",{className:"submission-items-component"},c.default.createElement(b.OverviewSearchGroup,{placeholder:"Search for submitted Pubs",onUpdateSearchTerm:function(e){return""===e&&E(e)},onCommitSearchTerm:E,onChooseFilter:O,filters:_}),c.default.createElement(h.OverviewRows,null,N.map((function(e){return c.default.createElement(v.default,{pub:e,key:e.id})})),I&&c.default.createElement(h.LoadMorePubsRow,{isLoading:!0}),function(){if(0===N.length&&j){if(w===g&&!y){var e=i||c.default.createElement(s.AnchorButton,{href:(0,m.collectionUrl)(o,t),target:"_blank",outlined:!0,icon:"share"},"Go to layout"),n=i?"Ready to start accepting submissions?":"Guests can visit this Collection's layout to start a submission.";return c.default.createElement(s.NonIdealState,{icon:"clean",title:"There aren't any submissions to review",description:n,action:e})}return c.default.createElement(h.SpecialRow,null,"No matching Submissions.")}return null}()))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(284),d=n(184),f=l(n(1382));n(1387);t.default=function(e){var t=e.pub,n=o((0,u.useState)(t.submission.status),2),r=n[0],a=n[1],i=o((0,u.useState)(!1),2),l=i[0],m=i[1],p=[{label:t.submission.status[0].toUpperCase()+t.submission.status.slice(1),icon:"symbol-square",iconSize:16,iconClass:"status-color-"+t.submission.status},(0,s.getSubmissionTimeLabel)(t)].filter((function(e){return!!e}));return l?null:u.default.createElement(d.PubOverviewRow,{pub:t,leftIconElement:"manually-entered-data",className:(0,c.default)("submission-row-component",r),labels:p,rightElement:u.default.createElement(f.default,{pub:t,onJudgePub:a,onDeletePub:function(){return m(!0)}})})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=n(18),u=n(35),c=n(9),s=r(n(1383));n(1386);t.default=function(e){var t=(0,c.usePageContext)().communityData;return a.default.createElement("div",{className:"arbitration-menu-component"},a.default.createElement(i.Tooltip,{content:"Visit Pub"},a.default.createElement(i.AnchorButton,{minimal:!0,icon:"circle-arrow-right",href:(0,u.pubUrl)(t,e.pub),target:"_blank"})),"accepted"===e.pub.submission.status&&!e.pub.releases.length&&a.default.createElement(o.DialogLauncher,{renderLauncherElement:function(e){var t=e.openDialog;return a.default.createElement(i.Tooltip,{content:"Release Pub"},a.default.createElement(i.Button,{minimal:!0,small:!0,icon:"document-share",onClick:t}))}},(function(t){var n=t.isOpen,r=t.onClose;return a.default.createElement(o.PubReleaseDialog,{isOpen:n,onClose:r,pub:e.pub})})),[{presentTense:"Decline",pastTense:"declined",iconName:"thumbs-down"},{presentTense:"Accept",pastTense:"accepted",iconName:"endorsed"}].map((function(t){var n=t.presentTense,r=t.pastTense,u=t.iconName;return e.pub.submission.status!==r&&a.default.createElement(o.DialogLauncher,{key:r,renderLauncherElement:function(e){var t=e.openDialog;return a.default.createElement(i.Tooltip,{content:n},a.default.createElement(i.Button,{minimal:!0,icon:u,onClick:t}))}},(function(t){var i,o=t.isOpen,u=t.onClose;return a.default.createElement(s.default,{isOpen:o,onClose:u,shouldOfferEmail:!0,actionTitle:n,completedName:r,status:r,initialEmailText:null===(i=e.pub.submission.submissionWorkflow)||void 0===i?void 0:i[r+"Text"],onSubmit:function(t,n){var a;return l.apiFetch.put("/api/submissions",{id:e.pub.submission.id,status:r,skipEmail:!n,customEmailText:t||(null===(a=e.pub.submission.submissionWorkflow)||void 0===a?void 0:a[r+"Text"])})},onJudgePub:e.onJudgePub})}))})),a.default.createElement(o.ConfirmDialog,{confirmLabel:"Delete Pub",title:"Delete this Pub?",text:"If you delete this Pub, it will be gone forever. Neither you nor its submitters will be able to access it.",onConfirm:function(){return l.apiFetch.delete("/api/pubs",{pubId:e.pub.id}).then((function(){return e.onDeletePub()}))}},(function(e){var t=e.open;return a.default.createElement(i.Tooltip,{content:"Delete Pub"},a.default.createElement(i.Button,{minimal:!0,icon:"trash",onClick:t}))})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=n(210),f=l(n(482));n(1385);var m=function(e){var t=o((0,u.useState)(!!e.initialEmailText),2),n=t[0],r=t[1],a=o((0,u.useState)((function(){return e.initialEmailText||(0,d.getEmptyDoc)()})),2),i=a[0],l=a[1];return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:c.Classes.DIALOG_BODY},u.default.createElement("p",null,"Would you like to ",e.actionTitle.toLowerCase()," this submission?"),e.shouldOfferEmail&&u.default.createElement(u.default.Fragment,null,u.default.createElement("p",{className:"email-text-header"},u.default.createElement(s.Icon,{icon:"manually-entered-data",iconSize:12}),"  ","Email to submitters"),u.default.createElement(f.default,{initialContent:i,onContent:l,placeholder:"Specify message to submitter(s)."}))),u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER},u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS},e.shouldOfferEmail&&u.default.createElement(c.Checkbox,{className:"email-toggle",checked:n,disabled:e.isHandlingSubmission,onChange:function(e){r(e.target.checked)},label:"Notify submitters by email"}),u.default.createElement(c.Button,{onClick:e.onClose,disabled:e.isHandlingSubmission},"Cancel"),u.default.createElement(c.Button,{onClick:function(){return e.handleSubmission(i,n)},loading:e.isHandlingSubmission,intent:"primary"},e.shouldOfferEmail&&n&&"Email & ",e.actionTitle))))},p=function(e){return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:c.Classes.DIALOG_BODY},u.default.createElement(c.Callout,{intent:"success",title:"Submission "+e.completedName+"!"},"You successfully ",e.completedName," the submission!")),u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER},u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS},u.default.createElement(c.Button,{onClick:e.onClose,disabled:e.isHandlingSubmission},"Close"))))};t.default=function(e){var t=o((0,u.useState)(!1),2),n=t[0],r=t[1],a=o((0,u.useState)(null),2),i=a[0],l=a[1],s=o((0,u.useState)(null),2),d=s[0],f=s[1];return u.default.createElement(c.Dialog,{lazy:!0,title:e.actionTitle,className:"verdict-dialog-component",isOpen:e.isOpen,onClose:e.onClose},d?u.default.createElement(c.Callout,{intent:"warning",title:"There was an error updating this submission."}):i?u.default.createElement(p,{isHandlingSubmission:n,completedName:e.completedName,onClose:e.onClose}):u.default.createElement(m,{shouldOfferEmail:!!e.shouldOfferEmail,onClose:e.onClose,handleSubmission:function(t,n){r(!0),e.onSubmit(t,n).then((function(e){l(e),r(!1)})).then((function(){return e.onJudgePub(e.status)})).catch((function(e){f(e),r(!1)}))},initialEmailText:e.initialEmailText,isHandlingSubmission:n,actionTitle:e.actionTitle}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=n(5),d=n(57),f=n(289);t.default=function(e){var t=e.workflow,n=e.onUpdateWorkflow,r=t.enabled,a=t.collectionId,i=u((0,c.useState)(!1),2),m=i[0],p=i[1],h=function(e){return o(void 0,void 0,void 0,(function(){var t;return l(this,(function(r){switch(r.label){case 0:return t={enabled:e},p(!0),[4,(0,f.updateSubmissionWorkflow)(t,a)];case 1:return r.sent(),p(!1),n(t),[2]}}))}))};return c.default.createElement(c.default.Fragment,null,!r&&c.default.createElement(s.Button,{intent:"primary",icon:"globe",onClick:function(){return h(!0)},loading:m},"Enable submissions"),r&&c.default.createElement(d.MenuButton,{"aria-label":"Accepting submissions",buttonContent:"Enabled",placement:"bottom-end",buttonProps:{icon:"tick",rightIcon:"caret-down",outlined:!0}},c.default.createElement(d.MenuItem,{text:"Stop accepting submissions",onClick:function(){return h(!1)}})))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(9),l=n(40);t.default=function(){var e=(0,o.usePageContext)().scopeData,t=e.activePermissions.canManage,n=e.elements.activeCollection;return t?a.default.createElement(i.AnchorButton,{outlined:!0,icon:"form",href:(0,l.getDashUrl)({collectionSlug:n.slug,mode:"submissions",subMode:"workflow"})},"Edit Workflow"):null}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(6),c=n(40),s=n(9),d=o(n(1393)),f=o(n(1403));t.default=function(e){var t=e.initialSubmissionWorkflow,n=(0,s.usePageContext)().scopeData.elements.activeCollection,r=(0,l.useCallback)((function(){window.location.href=(0,c.getDashUrl)({collectionSlug:n.slug,mode:"submissions"})}),[n]);return t?l.default.createElement(f.default,{initialWorkflow:t,onWorkflowUpdated:r}):l.default.createElement(u.ClientOnly,null,l.default.createElement(d.default,{onWorkflowCreated:r}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(5),d=n(483),f=n(41),m=n(9),p=n(289),h=u(n(484)),b=u(n(1402)),v=u(n(487)),y=function(){return{title:"",introText:(0,f.getEmptyDoc)(),instructionsText:(0,f.getEmptyDoc)(),acceptedText:(0,f.getEmptyDoc)(),declinedText:(0,f.getEmptyDoc)(),receivedEmailText:(0,f.getEmptyDoc)(),targetEmailAddresses:[],enabled:!1,requireAbstract:!1,requireDescription:!1}};t.default=function(e){var t=e.onWorkflowCreated,n=(0,m.usePageContext)(),a=n.communityData,i=n.scopeData.elements.activeCollection,o=(0,d.useLocalStorage)({initial:y,communityId:a.id,featureName:"new-submission-workflow-editor",path:["collection-"+i.id],debounce:100}),u=o.value,f=o.setValue,g=o.initialValue,_=l((0,c.useState)(!!g),2),E=_[0],P=_[1],w=l((0,c.useState)(!1),2),O=w[0],C=w[1],S=l((0,c.useState)(!1),2),D=S[0],k=S[1],j=(0,c.useCallback)((function(){k(!0),(0,p.createSubmissionWorkflow)(u,i.id).then(t).finally((function(){return k(!1)}))}),[u,i,t]);return c.default.createElement(v.default,{details:"Follow these steps to let visitors submit to this Collection. You can close this tab and your work will be saved in this browser."},E?c.default.createElement(c.default.Fragment,null,c.default.createElement(h.default,{workflow:u,onUpdateWorkflow:function(e){return f((function(t){return r(r({},t),e)}))},onValidateWorkflow:C,collection:i,finalStepButton:c.default.createElement(s.Button,{disabled:!O,onClick:j,loading:D,icon:"tick",intent:"primary",className:"save-changes-button"},"Finish creating workflow")})):c.default.createElement(b.default,{onStartWorkflow:function(){return P(!0)}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCommunityLocalStorage=void 0;var r=function(e){return{setItem:function(t){localStorage.setItem(e,JSON.stringify(t))},getItem:function(){var t;return JSON.parse(null!==(t=localStorage.getItem(e))&&void 0!==t?t:"null")},getChild:function(t){return function(e){if(e.includes("î€€"))throw new Error}(t),r(e+"î€€"+t)}}},a=r("pubpub");t.getCommunityLocalStorage=function(e,t){return a.getChild("community-"+e).getChild(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidEmail=void 0;var r=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;t.isValidEmail=function(e){return r.test(e)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1397);t.default=function(e){var t=e.from,n=e.to,r=e.cc,o=e.body,l=e.community,u=e.kind,c=e.collectionTitle;return a.default.createElement("div",{className:"email-preview-component"},a.default.createElement("div",{className:"address-header"},a.default.createElement("div",{className:"address-box"},a.default.createElement("div",{className:"label"},"From:"),a.default.createElement("div",{className:"address"},t)),a.default.createElement("div",{className:"address-box"},a.default.createElement("div",{className:"label"},"To:"),a.default.createElement("div",{className:"address"},n)),r.length&&a.default.createElement("div",{className:"address-box"},a.default.createElement("div",{className:"label"},"CC:"),a.default.createElement("div",{className:"address"},r.join(", ")))),a.default.createElement("div",{className:"content-box"},a.default.createElement(i.SubmissionEmail,{submitterName:"Submitter Name",submissionTitle:"My Example Submission",collectionTitle:c,community:l,customText:o,kind:u})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(3)),d=n(1399),f=n(6),m=n(486);n(1400);t.default=function(e){var t=e.selectedStep,n=e.onSelectStep,a=e.stepCompletions,i=(0,d.useTabState)({currentId:t}),o=i.selectedId,u=i.select,p=m.submissionWorkflowConfigSteps.indexOf(t);return(0,c.useEffect)((function(){t!==o&&u(t)}),[t,o,u]),c.default.createElement(d.TabList,r({},i,{className:"submission-workflow-step-picker-component","aria-label":"Workflow configuration steps"}),Object.entries(m.submissionWorkflowConfigStepLabels).map((function(e,t){var o=l(e,2),u=o[0],m=o[1],h=p>=t,b=p>t&&!a[u];return c.default.createElement(d.Tab,r({},i,{id:u,key:u,as:"div",className:(0,s.default)("step",h&&"reached",b&&"incomplete"),stopId:u,onClick:function(){return n(u)}}),c.default.createElement("div",{className:"label"},c.default.createElement("div",{className:"icon-container"},b?c.default.createElement(f.Icon,{icon:"warning-sign",intent:"warning",iconSize:22}):c.default.createElement("div",{className:"number"},t+1)),m),c.default.createElement("div",{className:"progress-indicator"}))})))}},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(35),l=n(159),u=n(9),c=n(40);t.default=function(e){var t=e.onStartWorkflow,n=(0,u.usePageContext)(),r=n.communityData,s=n.scopeData.elements.activeCollection,d=(0,c.getDashUrl)({collectionSlug:s.slug,mode:"layout"}),f=(0,l.withValue)((0,o.collectionUrl)(r,s),(function(e){return a.default.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},e)})),m=r.pages.find((function(e){return e.id===s.pageId}));return a.default.createElement(i.Callout,{title:"Enable Submissions",intent:m?"warning":"primary",icon:null},a.default.createElement("p",null,"When you enable Submissions for this Collection, anyone with a PubPub account will be able to visit ",f," to create a Pub and submit it to this Collection. You'll have the chance to approve or reject these submissions before they can be published."),!m&&a.default.createElement(i.Button,{onClick:t},"Let's do it!"),m&&a.default.createElement("p",null,"Before you can start accepting Submissions, you'll need to unlink this Collection from the Page ",a.default.createElement("b",null,m.title)," from the"," ",a.default.createElement("a",{href:d},"Layout tab"),"."))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(0)),d=n(5),f=n(9),m=n(286),p=n(289),h=c(n(484)),b=c(n(487));t.default=function(e){var t=e.onWorkflowUpdated,n=e.initialWorkflow,r=u((0,s.useState)(!1),2),a=r[0],i=r[1],c=(0,f.usePageContext)().scopeData.elements.activeCollection,v=(0,m.usePersistableState)(n,(function(e,n){return o(void 0,void 0,void 0,(function(){return l(this,(function(r){switch(r.label){case 0:return[4,(0,p.updateSubmissionWorkflow)(e,c.id)];case 1:return r.sent(),setTimeout((function(){return t(n)}),0),[2]}}))}))})),y=v.state,g=v.update,_=v.persist,E=v.hasChanges,P=v.isPersisting,w=s.default.createElement(d.Button,{disabled:!a||!E,onClick:_,loading:P,intent:"primary",className:"save-changes-button"},"Save Changes");return s.default.createElement(b.default,{controls:w},s.default.createElement(h.default,{workflow:y,onUpdateWorkflow:g,onValidateWorkflow:i,collection:c,finalStepButton:w}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1405);t.default=function(e){var t=e.exploreData;return a.default.createElement("div",{id:"explore-container"},a.default.createElement("div",{className:"container"},a.default.createElement("div",{className:"row"},a.default.createElement("div",{className:"col-12"},a.default.createElement("h1",null,"Explore communities"),a.default.createElement("div",{className:"details"},"PubPub hosts over 3,000 communities, with more added every day! Anyone can ",a.default.createElement("a",{href:"/community/create"},"create")," a free PubPub community at any time; all you need is an account and some very basic community details. Below are 40 PubPub communities that we think form a good snapshot of what you can create with PubPub's spaces and features. We hope they provide inspiration for your own spaces, designs, and workflows.")),t.activeCommunities.filter((function(e){return e})).sort((function(e,t){return e.updatedAt<t.updatedAt?1:e.updatedAt>t.updatedAt?-1:e.title>t.title?1:e.title<t.title?-1:0})).map((function(e){return a.default.createElement("div",{className:"col-4",key:"active-"+e.id},a.default.createElement(i.CommunityPreview,{subdomain:e.subdomain,domain:e.domain,title:e.title,description:e.description,heroBackgroundImage:e.heroBackgroundImage,heroLogo:e.heroLogo,accentColor:e.accentColor,accentTextColor:e.accentTextColor}))})))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1407);var o=[{icon:"badge",title:"DOI Support",desc:"Generate CrossRef DOIs for your documents in one click."},{icon:"shield",title:"Submissions & Review",desc:"Manage submissions and peer review directly on PubPub."},{icon:"comment",title:"Discussions & Annotations",desc:"Host public and private discussions with your readers and community, whether in your classroom or across the world."},{icon:"page-layout",title:"Easily Customizable Layouts",desc:"Create your custom site without writing a line of code."},{icon:"book",title:"Collection Metadata",desc:"Include article & collection-level metadata for easier organization of content and improved discovery."},{icon:"people",title:"Access Control",desc:"Allow anyone to access your content, or just the people you choose."},{icon:"grouped-bar-chart",title:"Impact Measurement",desc:"Learn about the people visiting your community with a full suite of privacy-respecting analytics."},{icon:"graph",title:"Content Connections",desc:"Add typed relationships â€” reviews, commentary, supplement, etc. â€” to your content and deposit them to Crossref."},{icon:"export",title:"Document Export",desc:"Export your work to PDF, Word, Markdown, LaTeX, JATS XML, and more."}],l=[{name:"Harvard Data Science Review",description:"A microscopic, telescopic & kaleidoscopic view of data science.",logo:"/static/landing/hdsr.png",type:"Journals",category:"Science",link:"https://hdsr.mitpress.mit.edu"},{name:"Frankenbook",description:"A collaborative, multimedia reading experiment with Mary Shelleyâ€™s classic novel.",logo:"/static/landing/frankenbook.png",type:"Books",category:"Literature",link:"https://frankenbook.org"},{name:"Collective Wisdom",description:"The British Library's early access and community review site.",logo:"/static/landing/collective.png",type:"Resources",category:"Reports",link:"https://britishlibrary.pubpub.org/"},{name:"SERC Ethical Computing",description:"A series on the social and ethical responsibilities of computing.",logo:"/static/landing/serc.png",type:"Resources",category:"Case studies",link:"https://mit-serc.pubpub.org"},{name:"Contours Collaborations",description:"A series on the social and ethical responsibilities of computing.",logo:"/static/landing/contours.png",type:"Exhibits",category:"Arts",link:"https://contours.pubpub.org"},{name:"Fermentology",description:"On the culture, history, and novelty of fermented things.",logo:"/static/landing/fermentology.png",type:"Learning Series",category:"Multimedia",link:"https://fermentology.pubpub.org/"},{name:"Grad Journal of Food Studies",description:"An international student-run and refereed platform dedicated to encouraging and promoting interdisciplinary food scholarship at the graduate level",logo:"/static/landing/gafs.png",type:"Student Journals",category:"Interdisciplinary",link:"https://gradfoodstudies.pubpub.org/"},{name:"Critical Distance",description:"A pandemic and games essay jam.",logo:"/static/landing/pgej.png",type:"Conferences",category:"Sprint",link:"https://pandemics-and-games-essay-jam.pubpub.org/"},{name:"MIT Press Open Architecture",description:"An open collection of out-of-print humanities books.",logo:"/static/landing/arch.png",type:"Collections",category:"Open humanities",link:"https://mitp-arch.mitpress.mit.edu/"}];t.default=function(){var e=o.map((function(e){return a.default.createElement("div",{className:"feature",key:e.icon},a.default.createElement(i.Icon,{icon:e.icon,className:"icon"}),a.default.createElement("div",{className:"description"},a.default.createElement("h4",null,e.title),a.default.createElement("p",null,e.desc)))})),t=l.map((function(e){return a.default.createElement("div",{className:"community",ker:e.name},a.default.createElement("div",{className:"type"},a.default.createElement("strong",null,e.type)," / ",e.category),a.default.createElement("h4",{className:"name"},a.default.createElement("a",{href:e.link},e.name)),a.default.createElement("a",{href:e.link},a.default.createElement("img",{className:"logo",src:e.logo,alt:"Logo of "+e.name})),a.default.createElement("p",{className:"description"},e.description))}));return a.default.createElement("div",{id:"landing-container"},a.default.createElement("style",null,"\n\t\t\t\t.header-component.bp3-dark a.bp3-button,\n\t\t\t\t.header-component.bp3-dark a.bp3-button:hover {\n\t\t\t\t\tcolor: #111;\n\t\t\t\t}\n\t\t\t"),a.default.createElement("div",{id:"jumbotron"},a.default.createElement("div",{className:"container"},a.default.createElement("div",{className:"row content"},a.default.createElement("div",{className:"col-4"},a.default.createElement("h1",null,"PubPub"),a.default.createElement("p",{className:"subtitle"},"The open-source, community-led, end-to-end publishing platform for knowledge communities."),a.default.createElement("h2",null,"Create knowledge. Share it with audiences who care."),a.default.createElement("div",{className:"buttons"},a.default.createElement("a",{href:"/community/create",className:"custom-button black"},"Create your community")),a.default.createElement("div",{className:"buttons"},a.default.createElement("a",{href:"/pricing",className:"custom-button"},"Support PubPub")))))),a.default.createElement("div",{id:"main"},a.default.createElement("div",{id:"mission"},a.default.createElement("div",{className:"container restricted-width"},a.default.createElement("div",null,a.default.createElement("h3",null,"Mission")),a.default.createElement("div",null,"As a product of the"," ",a.default.createElement("a",{href:"https://www.knowledgefutures.org"},a.default.createElement("strong",null,"Knowledge Futures Group")),", PubPub is open and accessible to all. That means a free, robust version of PubPub will always be available, operating under a non-profit, sustainable business model."),a.default.createElement("div",null,a.default.createElement("h3",null,"Open & Community-Led")),a.default.createElement("div",null,a.default.createElement("a",{className:"git",href:"https://github.com/pubpub/pubpub"},a.default.createElement(i.Icon,{icon:"git-repo"})," code"),a.default.createElement("a",{className:"git",href:"https://github.com/orgs/pubpub/projects/9"},a.default.createElement(i.Icon,{icon:"map"})," roadmap"),a.default.createElement("a",{className:"git",href:"https://github.com/pubpub/pubpub/discussions"},a.default.createElement(i.Icon,{icon:"comment"})," forum")))),a.default.createElement("div",{id:"features"},a.default.createElement("div",{className:"container key"},a.default.createElement("div",null,a.default.createElement("h3",null,"Key Features"))),a.default.createElement("div",{className:"container reverse"},a.default.createElement("div",null,a.default.createElement("h4",null,"Collaborate & edit with co-authors in real time"),a.default.createElement("img",{src:"/static/landing/authoring.png",alt:"Screenshot of a PubPub editor interface with multiple users editing at the same time."})),a.default.createElement("div",null,a.default.createElement("p",{className:"feature-number"},"01"),a.default.createElement("ul",null,a.default.createElement("li",{key:"01-01"},"Keep everyone in the loop"),a.default.createElement("li",{key:"01-03"},"Assign roles on-the-fly"))),a.default.createElement("div",null,a.default.createElement("h4",null,"Import your work from any source"),a.default.createElement("img",{src:"/static/landing/importing.png",alt:"Screenshot of the PubPub import interface uploading a complex LaTeX document."})),a.default.createElement("div",null,a.default.createElement("p",{className:"feature-number"},"02"),a.default.createElement("ul",null,a.default.createElement("li",{key:"02-01"},"Easy multi-file imports"),a.default.createElement("li",{key:"02-02"},"Complex-content friendly"),a.default.createElement("li",{key:"02-03"},"Word, XML, LaTeX, and Markdown"))),a.default.createElement("div",null,a.default.createElement("h4",null,"Embed rich multimedia in your publication"),a.default.createElement("img",{src:"/static/landing/multimedia.png",alt:"Examples of rich content embedded in Pubs, including an equation, a stem and tree chart, and an interactive song picker."})),a.default.createElement("div",null,a.default.createElement("p",{className:"feature-number"},"03"),a.default.createElement("ul",null,a.default.createElement("li",{key:"03-01"},"Data visualizations"),a.default.createElement("li",{key:"03-02"},"Images, videos, and math"),a.default.createElement("li",{key:"03-03"},"Code, interactives, and more"))),a.default.createElement("div",{className:"other-features"},a.default.createElement("h3",null,"Other Features")),a.default.createElement("div",{className:"feature-grid"},e))),a.default.createElement("div",{id:"case-study"},a.default.createElement("div",{className:"container"},a.default.createElement("div",null,a.default.createElement("h3",null,"Community Services")),a.default.createElement("div",null,a.default.createElement("p",null,"For groups that want personalized support we offer production, training, and strategy services for building high quality, effective publishing communities."),a.default.createElement("blockquote",null,'"The teamâ€™s innovation and experience made for an incredible collaboration."',a.default.createElement("br",null),a.default.createElement("span",{className:"attribution"},"- Jeremy Bailenson, Author, â€œ",a.default.createElement("a",{href:"https://doi.org/10.1037/tmb0000030"},"A Theoretical Argument for the Causes of Zoom Fatigue"),"â€")),a.default.createElement("div",{className:"buttons"},a.default.createElement("a",{href:"/community-services",className:"custom-button light"},"Learn more"))))),a.default.createElement("div",{id:"communities"},a.default.createElement("div",{className:"container"},a.default.createElement("div",null,a.default.createElement("h3",null,"Use Cases")),a.default.createElement("div",null,a.default.createElement("p",null,"Thousands of communities are tailoring PubPub to suit their publishing needs, goals, and content types."),a.default.createElement("div",{className:"community-grid"},t),a.default.createElement("div",{className:"buttons"},a.default.createElement("a",{href:"/explore",className:"custom-button"},"Explore Communities"))))),a.default.createElement("div",{id:"create"},a.default.createElement("div",{className:"container restricted-width"},a.default.createElement("div",null,a.default.createElement("h3",null,"Create")),a.default.createElement("div",null,a.default.createElement("h4",null,"Anyone can start a PubPub Community, anytime, for free."),a.default.createElement("div",{className:"buttons"},a.default.createElement("a",{href:"/community/create",className:"custom-button"},"Create your community")),a.default.createElement("p",{className:"disclaimer"},"* A community can be your individual space to create content, or you can invite others to collaborate with you!")))),a.default.createElement("div",{id:"pitch"},a.default.createElement("div",{className:"container restricted-width reverse"},a.default.createElement("div",null,a.default.createElement("p",null,"PubPub empowers knowledge communities to define their own community engagement models and manage their publishing workflows. Use PubPub to more closely align knowledge sharing with community building."))))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(290)),s=l(n(292)),d=n(5),f=n(6),m=n(9),p=n(18);n(1410);t.default=function(){var e=o((0,u.useState)(!1),2),t=e[0],n=e[1],r=o((0,u.useState)(void 0),2),a=r[0],i=r[1],l=o((0,u.useState)(!1),2),h=l[0],b=l[1],v=(0,u.useRef)(null),y=(0,u.useRef)(null),g=(0,m.usePageContext)(),_=g.locationData,E=g.loginData,P=g.communityData,w=function(e){return e.preventDefault(),v.current&&v.current.value&&y.current&&y.current.value?(n(!0),i(void 0),(0,p.apiFetch)("/api/login",{method:"POST",body:JSON.stringify({email:v.current.value.toLowerCase(),password:(0,c.default)(y.current.value).toString(s.default)})}).then((function(){window.location.href=_.query.redirect?"/"+_.query.redirect.replace(/^\/+/,""):"/"})).catch((function(){n(!1),i("Invalid Email or Password")}))):(n(!1),i("Invalid Email or Password"),null)};return u.default.createElement("div",{id:"login-container"},u.default.createElement(f.GridWrapper,{containerClassName:"small",columnClassName:"bp3-elevation"},!E.id&&u.default.createElement("div",null,u.default.createElement("h1",null,"Login"),!_.isBasePubPub&&u.default.createElement("p",null,"Login to ",u.default.createElement("b",null,P.title)," using your"," ",u.default.createElement("a",{href:"https://www.pubpub.org"},"PubPub")," account."),u.default.createElement("form",{onSubmit:w},u.default.createElement(f.InputField,{label:"Email",placeholder:"example@email.com",autocomplete:"username",inputRef:v}),u.default.createElement(f.InputField,{label:"Password",type:"password",autocomplete:"current-password",helperText:u.default.createElement("a",{href:"/password-reset"},"Forgot Password"),inputRef:y}),u.default.createElement(f.InputField,{error:a},u.default.createElement(d.Button,{name:"login",type:"submit",className:"bp3-button bp3-intent-primary",onClick:w,text:"Login",loading:t}))),u.default.createElement("a",{href:"/signup",className:"switch-message"},"Don't have a PubPub account? Click to Signup")),E.id&&u.default.createElement(d.NonIdealState,{visual:u.default.createElement(f.Avatar,{initials:E.initials,avatar:E.avatar,width:100}),title:"Already Logged In",action:u.default.createElement("div",null,u.default.createElement(d.AnchorButton,{className:"bp3-large action-button",text:"View Profile",href:"/user/"+E.slug}),u.default.createElement(d.Button,{className:"bp3-large action-button",text:"Logout",onClick:function(){b(!0),(0,p.apiFetch)("/api/logout").then((function(){window.location.href="/"}))},loading:h}))})))}},,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(9);n(1412);t.default=function(){var e=(0,o.usePageContext)(),t=e.locationData,n=e.loginData,r="?redirect="+t.path+(t.queryString.length>1?t.queryString:"");return a.default.createElement("div",{id:"no-match-container"},a.default.createElement(i.NonIdealState,{title:"Page Not Found",visual:"path-search",description:n.id?null:"If you believe there should be a page at this URL, it may be private. Try logging in.",action:n.id?null:a.default.createElement(i.AnchorButton,{intent:i.Intent.PRIMARY,outlined:!0,href:"/login"+r,text:"Login"})}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);t.default=function(e){var t=e.pageData;return a.default.createElement(i.Layout,{blocks:t.layout,isNarrow:t.isNarrow||t.isNarrowWidth,layoutPubsByBlock:t.layoutPubsByBlock})}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(290)),s=l(n(292)),d=n(5),f=n(6),m=n(18),p=n(9);n(1415);t.default=function(e){var t=o((0,u.useState)(""),2),n=t[0],r=t[1],a=o((0,u.useState)(""),2),i=a[0],l=a[1],h=o((0,u.useState)(!1),2),b=h[0],v=h[1],y=o((0,u.useState)(!1),2),g=y[0],_=y[1],E=o((0,u.useState)(void 0),2),P=E[0],w=E[1],O=o((0,u.useState)(!1),2),C=O[0],S=O[1],D=o((0,u.useState)(void 0),2),k=D[0],j=D[1],M=e.passwordResetData,N=(0,p.usePageContext)().locationData,I=function(e){return e.preventDefault(),_(!0),(0,m.apiFetch)("/api/password-reset",{method:"POST",body:JSON.stringify({email:n.toLowerCase()})}).then((function(){_(!1),v(!0)})).catch((function(){_(!1),w("Error")}))},x=function(e){return e.preventDefault(),S(!0),(0,m.apiFetch)("/api/password-reset",{method:"PUT",body:JSON.stringify({password:(0,c.default)(i).toString(s.default),slug:N.params.slug,resetHash:N.params.resetHash})}).then((function(){S(!1),v(!0)})).catch((function(){S(!1),j("Error")}))},T=N.params.resetHash;return u.default.createElement("div",{id:"password-reset-container"},u.default.createElement(f.GridWrapper,{containerClassName:"small"},!b&&!T&&u.default.createElement("h1",null,"Reset Password"),!b&&!!T&&u.default.createElement("h1",null,"Set Password"),!T&&!b&&u.default.createElement("form",{onSubmit:I},u.default.createElement("p",null,"Enter your email and a link to reset your password will be sent to you."),u.default.createElement(f.InputField,{label:"Email",type:"email",placeholder:"example@email.com",value:n,onChange:function(e){r(e.target.value)}}),u.default.createElement(f.InputField,{error:P&&"Error Resetting Password"},u.default.createElement(d.Button,{name:"create",type:"submit",className:"bp3-button bp3-intent-primary create-account-button",onClick:I,text:"Reset Password",disabled:!n,loading:g}))),!T&&b&&u.default.createElement(d.NonIdealState,{description:"Check your inbox for an email with a reset link",title:"Reset Password Email Sent",visual:"envelope"}),T&&!M.hashIsValid&&u.default.createElement("div",{className:"bp3-callout bp3-intent-danger"},"Invalid hash. Try ",u.default.createElement("a",{href:"/password-reset"},"resetting your password")," ","again."),T&&M.hashIsValid&&!b&&u.default.createElement("form",{onSubmit:x},u.default.createElement(f.InputField,{label:"Password",type:"password",value:i,onChange:function(e){l(e.target.value)}}),u.default.createElement(f.InputField,{error:k&&"Error Resetting Password"},u.default.createElement(d.Button,{name:"create",type:"submit",className:"bp3-button bp3-intent-primary create-account-button",onClick:x,text:"Set New Password",disabled:!i,loading:C}))),T&&M.hashIsValid&&b&&u.default.createElement(d.NonIdealState,{description:"Your password has been successfully changed.",title:"Reset Password Successful",visual:"tick",action:u.default.createElement(d.AnchorButton,{href:"/login",className:"bp3-intent-primary bp3-large",text:"Login with new password"})})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);n(1417);t.default=function(){return a.default.createElement("div",{id:"pricing-container"},a.default.createElement(i.GridWrapper,null,a.default.createElement("h1",null,"PubPub is free."),a.default.createElement("p",{className:"description top"},"PubPub's goal is to make knowledge creation accessible to everyone. To fulfill this mission, we offer access to PubPub and all features for free.",a.default.createElement("sup",null,"*")," We do not sell data or rely on ancillary business streams. To ensure our work is community-driven and sustainable for the long term, we offer two ways for users to support PubPub."),a.default.createElement("div",{className:"pricing-tiers"},a.default.createElement("div",{className:"option bp3-card bp3-elevation-1"},a.default.createElement("h2",null,"KFG Membership"),a.default.createElement("p",null,"PubPub is built by the"," ",a.default.createElement("a",{href:"https://knowledgefutures.org"},"Knowledge Futures Group"),", a non-profit dedicated to building public knowledge infrastructure. We ask that users who value PubPub consider becoming KFG Members to help ensure its longterm sustainability."),a.default.createElement("p",null,"Membership includes benefits like regular member programming, custom domains, email support, strategy consultation, and discounts on community services. We are dedicated to making membership accessible, and have multiple tiers with pricing based on ability to pay."),a.default.createElement("a",{href:"https://knowledgefutures.org/membership",className:"bp3-button bp3-large bp3-intent-primary"},"Join us")),a.default.createElement("div",{className:"option bp3-card bp3-elevation-1"},a.default.createElement("h2",null,"Community Services"),a.default.createElement("p",null,"For groups that want personalized support we offer production, training, and strategy services for building high quality, effective publishing communities. Services include content production, editorial services, site design, back file import, training, interactive production, branding, and more."),a.default.createElement("p",null,"Our clients include"," ",a.default.createElement("a",{href:"https://academicentrepreneurship.pubpub.org/",target:"_blank",rel:"noopener noreferrer"},"The Children's Hospital of Philadelphia"),","," ",a.default.createElement("a",{href:"https://hdsr.mitpress.mit.edu",target:"_blank",rel:"noopener noreferrer"},"the Harvard Data Science Review"),","," ",a.default.createElement("a",{href:"https://participa.conl.mx/",target:"_blank",rel:"noopener noreferrer"},"Consejo Nuevo LeÃ³n"),","," ",a.default.createElement("a",{href:"https://apaopen.org",target:"_blank",rel:"noopener noreferrer"},"the American Psychological Association"),","," ",a.default.createElement("a",{href:"https://mit-serc.pubpub.org",target:"_blank",rel:"noopener noreferrer"},"MIT's Schwarzman College of Computing"),", and others."),a.default.createElement("a",{href:"/community-services",target:"_blank",rel:"noopener noreferrer",className:"bp3-button bp3-large bp3-intent-primary"},"Learn more"))),a.default.createElement("p",{className:"fine-print"},a.default.createElement("sup",null,"*")," For communities requiring DOIs, we have a limit of 10 free DOI registrations per community per year if published via PubPub's Crossref membership. Once the limit is reached, we ask that you become a"," ",a.default.createElement("a",{href:"https://knowledgefutures.org/membership"},"KFG member"),", at any level, and allow us to pass on the Crossref fee of $1 per DOI registered. For groups with their own Crossref membership, there is no additional fee for creating or depositing DOIs.")))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=n(9),u=r(n(1419)),c=r(n(1420)),s=r(n(1421)),d=r(n(1422));n(1423);t.default=function(){var e=(0,l.usePageContext)(),t=e.locationData,n=e.loginData,r=e.communityData.accentColorDark,f=t.params.tab;return a.default.createElement(a.default.Fragment,null,a.default.createElement("style",null,"#legal-container .main-content a { color: "+r+"; }"),a.default.createElement("div",{id:"legal-container"},a.default.createElement(o.GridWrapper,{containerClassName:"legal",columnClassName:"legal-columns"},a.default.createElement("div",{className:"side-content"},a.default.createElement(i.Menu,{className:"side-menu"},a.default.createElement(i.MenuItem,{key:"terms",text:"Terms of Service",active:"terms"===f,href:"/legal/terms"}),a.default.createElement(i.MenuItem,{key:"privacy",text:"Privacy Policy",active:"privacy"===f,href:"/legal/privacy"}),a.default.createElement(i.MenuItem,{key:"aup",text:"Acceptable Use Policy",active:"aup"===f,href:"/legal/aup"}),a.default.createElement(i.MenuItem,{key:"settings",text:"Privacy settings",active:"settings"===f,href:"/legal/settings"}))),a.default.createElement("div",{className:"main-content"},"terms"===f&&a.default.createElement(c.default,{hostname:t.hostname}),"privacy"===f&&a.default.createElement(s.default,null),"aup"===f&&a.default.createElement(d.default,null),"settings"===f&&a.default.createElement(u.default,{isLoggedIn:!!n.id})))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(9),s=n(219),d=function(){var e=(0,c.usePageContext)().loginData,t=o((0,l.useState)(!1),2),n=t[0],r=t[1],a=o((0,l.useState)(null),2),i=a[0],d=a[1];return(0,l.useEffect)((function(){null===i&&d(!!(0,s.getGdprConsentElection)(e)),n&&(0,s.updateGdprConsent)(e,i)}),[n,i,e]),l.default.createElement(u.Card,null,l.default.createElement("h5",null,"Third-party analytics"),l.default.createElement("p",null,"PubPub uses a third-party analytics service called Heap to store, aggregate and summarize information about user behavior on our platform. We do this to help our engineering team make product decisions and communities who use our service to measure the performance of their content. We do not share any personally identifiable information with communities on PubPub or any other third parties. We pay Heap rather than using a more popular platform like Google Analytics, which is free but allows Google to process your data and re-sell it across the web."),l.default.createElement("p",null,"If you allow us to enable Heap while you browse, we'll send requests to their servers containing things like the URL of the current page, your browser version, and your IP address. If you're logged in, we'll also send your PubPub user ID, which is made of random letters and numbers. We'll never send Heap any identifying information such as your name, affiliation, or email address."),l.default.createElement(u.Switch,{checked:!!i,onChange:function(){r(!0),d(!i)},label:"Third party analytics is "+(i?"enabled":"disabled")}))};t.default=function(e){var t=e.isLoggedIn;return l.default.createElement("div",{className:"privacy-settings"},l.default.createElement(d,null),t&&l.default.createElement(l.default.Fragment,null,l.default.createElement(u.Card,null,l.default.createElement("h5",null,"Data export"),l.default.createElement("p",null,"You can request an export of the data associated with your account on PubPub using the button below."),l.default.createElement(u.AnchorButton,{target:"_blank",href:"mailto:privacy@pubpub.org?subject=Account+data+export+request&body="+"\nHello.\n%0D%0A%0D%0A\nI am writing to request an export of any PubPub account data associated with this email address.\n".trim()},"Request data export")),l.default.createElement(u.Card,null,l.default.createElement("h5",null,"Account deletion"),l.default.createElement("p",null,"You can request that we completely delete your PubPub account using the button below. If you have left comments on notable Pubs, we may reserve the right to continue to display them based on the academic research exception to GDPR."),l.default.createElement(u.AnchorButton,{intent:"danger",target:"_blank",href:"mailto:privacy@pubpub.org?subject=Account+deletion+request&body="+"\nHello.\n%0D%0A%0D%0A\nI am writing to request that the PubPub account associated with this email address, and all%20\ndata associated with that account, be deleted.\n%0D%0A%0D%0A\nI understand that this action may be irreversible.\n".trim()},"Request account deletion"))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i={hostname:r(n(10)).default.string.isRequired},o=function(e){var t=a.default.createElement("a",{href:"mailto:help@pubpub.org?subject=Terms%252520Question",title:""},"help@pubpub.org");return a.default.createElement("div",null,a.default.createElement("h2",null,"Terms of Service"),a.default.createElement("p",null,"PubPub is an end-to-end, open-source publishing platform developed by Knowledge Futures, Inc (KFI). KFI is a community of technologists, information creators, and scholarly publishers that is committed to addressing a core set of pressing and complex issues within research-intensive institutions. PubPubâ€™s goal is to develop open tools, infrastructure, and transparent business models that will bend the arc of knowledge creation and consumption toward equity and independence."),a.default.createElement("p",null,"This is a legal agreement between us, Knowledge Futures, Inc., a Massachusetts nonprofit organization with offices at 245 Main St, Cambridge MA, and you."),a.default.createElement("p",null,"By accessing the PubPub website after those changes have become effective, you agree to be bound by all the modified terms."),a.default.createElement("p",null,"BY ACCESSING CONTENT ON THE PUBPUB WEBSITE, YOU ACCEPT THESE TERMS OF SERVICE. If you are using PubPub on behalf of an entity, â€œyouâ€ refers to that entity."),a.default.createElement("h3",null,"Communities"),a.default.createElement("p",null,"PubPub allows registered users to create a Community. A Community may reside on the PubPub domain or on a domain of the Community administrator's choice but displayed from a PubPub server. You may submit your Content for inclusion in a Community, but it is up to the discretion of the Communityâ€™s administrator to decide whether to include it. PubPub may display in your profile a list of your Content and the Communities in which they appear. We may also send you a notification each time a Community has elected to include your Content, if you have opted in to receiving email from PubPub."),a.default.createElement("h3",null,"Site Content"),a.default.createElement("p",null,"Except where otherwise noted, Site Content is licensed by its owners under the"," ",a.default.createElement("a",{href:"https://creativecommons.org/licenses/by/4.0/",title:""},"Creative Commons Attribution (CC-BY) 4.0 License"),"."),a.default.createElement("h3",null,"Acceptable Use"),a.default.createElement("p",null,"We may establish written policies for your use of the Site, and those policies will be published at"," ",a.default.createElement("a",{href:"https://"+e.hostname+"/legal/aup"},e.hostname+"/legal/aup"),". You must abide by those policies, and if you fail to do so, we may immediately terminate and remove your account and Community or limit your access to it. We may update those policies from time to time. We may also establish policies regarding your Community, such as how long your Community content will be retained on the Site. We have no responsibility or liability for the deletion or failure to store any content."),a.default.createElement("h3",null,"User-Generated Content"),a.default.createElement("p",null,"PubPub includes features that allow you or others to contribute User-Generated Content. The Site, Third Party Publishers, and Communities may solicit and publish User-Generated Content through blogs, video postings, and chat features, among other forums."),a.default.createElement("p",null,"By submitting User-Generated Content, you hereby make that User-Generated Content available under the Creative Commons Attribution 4.0 License, and you represent and warrant that you have the right to provide your User Generated Content under that license, that all of that User Generated Content is either authored by you, or provided by third parties under the Creative Commons Attribution 4.0 License or in the public domain, and that your User Generated Content contains no personally identifiable information of third parties who have not expressly authorized you to provide it as part of your User Generated Content. All of your User-Generated Content must be appropriately marked with licensing and attribution information."),a.default.createElement("p",null,"We, and any Third-Party Publisher or Community,"),a.default.createElement("ul",null,a.default.createElement("li",null,"may monitor User-Generated Content on the Site,"),a.default.createElement("li",null,"may modify, edit, or remove any of said content at our or their discretion, without notice, and for any reason,"),a.default.createElement("li",null,"may prescreen User-Generated Content and may decide, in our or their discretion, without notice, and for any reason, not to publish it,"),a.default.createElement("li",null,"will not modify or edit any scholarly work that you submit for posting on the Site, but may decide, in our or their discretion, to withhold it from publication in its entirety, and"),a.default.createElement("li",null,"will have no liability for monitoring, modifying, removing, or declining to publish User-Generated Content on the Site.")),a.default.createElement("p",null,"At all times, PubPub, in its sole discretion, may decide to assign to any Third-Party Publisher or Community, any or all of the rights to modify, edit, remove, prescreen, or withhold from publication the User-Generated Content on the Site."),a.default.createElement("p",null,"You acknowledge that the views and opinions expressed by other users on the Site are theirs alone and should not be ascribed to us. You understand that by using the Site, you may be exposed to User-Generated Content that might be offensive, harmful, inaccurate or otherwise inappropriate. Under no circumstances will we or any Third-Party Publisher or Community be liable in any way for any User-Generated Content, including, but not limited to, any errors or omissions in any User-Generated Content, or any loss or damage of any kind incurred as a result of the use of any User-Generated Content made available via the Site or disseminated elsewhere."),a.default.createElement("h3",null,"Registration and Termination of Access"),a.default.createElement("p",null,"Certain areas of the Site may require registration or may otherwise ask you to provide information in order to participate. The decision to provide this information is optional; however, if you elect not to provide such information, you may not be able to access certain features of the Site. When you register, you must provide information to PubPub that is accurate, current and complete (excepting the use of a pseudonym). You must keep that information up to date. You must immediately notify PubPub of any unauthorized use of your password or any other breach of security. We will not be liable for any loss or damage arising from your failure to protect your password or account login information."),a.default.createElement("p",null,"We reserve the right to terminate any registration and otherwise deny Site access to any person for any reason. We have the right to refer any suspected fraudulent, abusive or illegal activity that may be grounds for suspension or termination of your account and/or use of the Site, to appropriate law enforcement authorities. You agree that we may terminate your account at any time for any reason or no reason. If we do so other than for breach of these terms or the AUP, we will refund to you a pro-rated portion of fees you have already paid to us, if any, for the remaining term pertaining to those fees."),a.default.createElement("h3",null,"Disclaimer of Warranty / Limitation of Liability"),a.default.createElement("p",null,"Your use of the Site is at your sole risk. TO THE FULLEST EXTENT PERMITTED BY THE LAW, WE AND ALL THIRD-PARTY PUBLISHERS AND COMMUNITIES (COLLECTIVELY, â€œTHE DISCLAIMING PARTIESâ€) DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, IN CONNECTION WITH THE SITE AND YOUR USE THEREOF, INCLUDING BUT NOT LIMITED TO WARRANTIES AS TO MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, OR NON-INFRINGEMENT."),a.default.createElement("p",null,"You agree that the Disclaiming Parties will not be liable to you for any indirect loss or damages, including without limitation consequential or incidental damages, arising out of or relating to these Terms, or your use or inability to use the Site whether based in contract, tort, or other law."),a.default.createElement("h3",null,"Indemnification"),a.default.createElement("p",null,"You will indemnify and defend us, each Third Party Publisher, each Community, and each of our or their affiliates, employees, faculty members, fellows, students, governing board members, contractors and agents (collectively, the â€œIndemnified Partiesâ€), and hold the Indemnified Parties harmless, from and against any claim, and all related loss, damage, damage, or expense, including without limitation reasonable attorneysâ€™ fees, incurred by Indemnified Parties, in connection (1) use of the Site; (2) posting of User-Generated Content; (3) breach of these Terms of Service or any representation or warranty made by you; or (4) violation of applicable law, by you or by any person whom you authorize to use your PubPub account."),a.default.createElement("p",null,"The Indemnified Parties shall have the right, at their own expense, to assume the exclusive defense and control of any matter subject to indemnification by you."),a.default.createElement("h3",null,"Third-Party Beneficiaries"),a.default.createElement("p",null,"All Third-Party Publishers and Communities are third-party beneficiaries of these Terms of Service, to the extent their interests may appear, and the administrators of the Third-Party Publishers and Communities may, by working together with PubPub, enforce the provisions of these Terms of Service only as related to such Third-Party Content or Communities. PupPub will reasonably cooperate with such administrators in enforcing the provisions of these Terms of Service. Third-Party Publishers and Communities may assign or transfer these Terms of Service, as applicable to their relationship with you, without restriction, as part of any assignment of any Third-Party Content or Community, in whole or in part, to any other publisher or platform, and such Terms of Service will be binding on and inure to the benefit of their successors and assigns."),a.default.createElement("h4",null,"Third-Party Policies"),a.default.createElement("p",null,"Third-Party Publishers and Communities may include their own Third-Party Policies on the pages of their Communities, so long as: (i) the Third-Party Policies do not conflict with these Terms of Service, PubPubâ€™s Acceptable Use Policy, PubPubâ€™s Privacy Policy, and any other PubPub terms or policies; and (ii) the Third-Party Publishers and Communities are solely responsible for the enforcement of their Third-Party Policies. To the extent any conflict arises between a Third-Party Policy and any of PubPubâ€™s terms or policies, the relevant PubPub term or policy will control for that conflict."),a.default.createElement("h3",null,"General"),a.default.createElement("p",null,"These Terms of Service (including the Acceptable Use Policy) constitute the entire agreement between you and us with respect to your use of the Site, superseding any prior agreements. KFI reserves the right to these Terms of Service and to modify PubPubâ€™s features at any time by posting changes to these Terms of Service at"," ",a.default.createElement("a",{href:"https://"+e.hostname+"/legal/terms"},e.hostname+"/legal/terms"),", and sending all registered users email notification that changes have been made. KFI will use reasonable efforts to post such changes at least 30 days before their effective date, but non-material changes or changes that are necessary to avoid liability by KFI may take effect more quickly."),a.default.createElement("p",null,"The section titles in these Terms of Service are for convenience only and have no legal or contractual effect."),a.default.createElement("p",null,"The provisions of these terms will survive any termination of services to you."),a.default.createElement("p",null,"These Terms of Service will be governed by the laws of the Commonwealth of Massachusetts without regard to its conflicts of laws provisions. In the case of any dispute arising out of or relating to these Terms of Service or your use of the Site, the state and federal courts located within the Commonwealth of Massachusetts will have exclusive jurisdiction, and both we and you agree to submit to the personal jurisdiction of such courts."),a.default.createElement("p",null,"Any failure to enforce any term or condition of these Terms of Service will not constitute a waiver of rights. If any provision of these Terms of Service is found by a court of competent jurisdiction to be invalid, it will be interpreted to have the broadest validity consistent with law, and the other provisions of these Terms of Service shall remain in effect."),a.default.createElement("p",null,"These Terms of Service are personal to you and non-assignable, except with our prior written permission. If you wish to transfer control of your Community, please contact us at ",t,". PubPub may assign or transfer these Terms of Service and your agreement thereto upon notice to you. These Terms of Service will be binding on, and inure to the benefit of permitted successors and assigns."),a.default.createElement("p",null,"Any notice that we provide to you may be provided to the email address on file for your account. You must inform us of any change in that email address."),a.default.createElement("h3",null,"Questions and Comments"),a.default.createElement("p",null,"If you have any questions about these Terms of Service, please contact ",t,"."),a.default.createElement("h3",null,"Definitions"),a.default.createElement("p",null,"â€œ",a.default.createElement("strong",null,"Acceptable Use Policy"),"â€ means the policy published by us for the Site."),a.default.createElement("p",null,"â€œ",a.default.createElement("strong",null,"Community"),"â€ means a publicly available content repository on PubPub where common disciplinary interests aggregate around content contributed by creators and readers."),a.default.createElement("p",null,"â€œ",a.default.createElement("strong",null,"Site"),"â€ means the PubPub web site."),a.default.createElement("p",null,"â€œ",a.default.createElement("strong",null,"Site Content"),"â€ means all content, features, and functionality posted to or provided via the Site, such as journals, books, and other publications created by persons other than you (â€œThird-Party Contentâ€), all User-Generated Content."),a.default.createElement("p",null,"â€",a.default.createElement("strong",null,"Third-Party Publishers"),"â€ are persons other than you for which we provide hosting services to for the publication of journals, books, or other curated content."),a.default.createElement("p",null,"â€œ",a.default.createElement("strong",null,"Third-Party Policies"),"â€ are the Third-Party Publishersâ€™ and Communitiesâ€™ own policies, such as terms of service or acceptable use policies."),a.default.createElement("p",null,"â€œ",a.default.createElement("strong",null,"User-Generated Content"),"â€ means any content, whether or not copyrightable, that users submit to the Site."))};o.propTypes=i,t.default=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));t.default=function(){return a.default.createElement("div",null,a.default.createElement("h2",null,"Privacy Policy"),a.default.createElement("h3",null,"1. Introduction"),a.default.createElement("p",null,"PubPub (â€œCompany,â€ â€œwe,â€ â€œus,â€ or â€œourâ€) is an open-source publishing platform run by the nonprofit organization Knowledge Futures, Inc. that values your privacy. In this Privacy Policy (â€œPolicyâ€), we describe what information we collect from you as a user of our Site or Service, why we collect and use it, and how you can manage and delete your data."),a.default.createElement("h4",null,"1.1 Definitions"),a.default.createElement("p",null,"â€œPersonal Informationâ€ refers to (i) any information that identifies, relates to, describes, is reasonably capable of being associated with you, or could reasonably be linked, directly or indirectly, with you, and (ii) any information that is associated with you and thus could potentially be used to identify or reidentify you, including when combined with other information from or about you. For the avoidance of doubt, PubPub defines Personal Information broadly, and our definition includes â€œpersonal dataâ€ as this term is used in the EU General Data Protection Regulation and â€œpersonal informationâ€ as it is used in the California Consumer Protection Act. Personal Information does not include (i) information that has been aggregated, excerpted, anonymized, or otherwise deidentified to the point at which an individual can no longer be identified or reidentified using reasonable efforts, technology, and resources and (ii) contact information that is routinely made available in a professional capacity to facilitate business and professional communications, such as the information ordinarily found on a business card, website profile, or CV, when used solely for purposes of professional and business communications."),a.default.createElement("p",null,"â€œSiteâ€ refers to our website, which includes all pages within the pubpub.org host directory and subdomains, all pages hosted on PubPub servers regardless of domain (including but not limited to Journal pages)."),a.default.createElement("p",null,"â€œServiceâ€ means our services available through our Site and any mobile applications we may provide."),a.default.createElement("h4",null,"Data Controller"),a.default.createElement("p",null,"When this Policy mentions â€œPubPub,â€ â€œCompany,â€ â€œwe,â€ â€œus,â€ or â€œour,â€ it refers to PubPub. PubPub is the data controller and responsible for your information under this Policy. The following is our contact information:"),a.default.createElement("p",null,"PubPub",a.default.createElement("br",null),"â„… Knowledge Futures, Inc.",a.default.createElement("br",null),"245 Main street",a.default.createElement("br",null),"Floor 2",a.default.createElement("br",null),"Cambridge, MA 02142",a.default.createElement("br",null)),a.default.createElement("p",null,"By visiting the Site, or using any of our Service, you agree that your Personal Information will be handled as described in this Policy. Before using the Service or submitting any Personal Information to us, please review this Privacy Policy carefully and contact us at"," ",a.default.createElement("a",{href:"mailto:privacy@pubpub.org"},"privacy@pubpub.org")," if you have any questions. If you do not agree to this Privacy Policy, please do not access the Site or otherwise use the Service. Your use of our Site or Service, and any dispute over privacy, is subject to this Policy and the relevant"," ",a.default.createElement("a",{href:"/legal/terms"},"Terms of Service"),", including any applicable limitations on damages and provisions for the resolution of disputes."),a.default.createElement("h3",null,"2. Information We Collect"),a.default.createElement("p",null,"We ask for and collect information about you when you use our Site or Service. We collect this information directly from you, from third parties, and automatically through your use of our Site or Service."),a.default.createElement("h4",null,"2.1 Information we collect directly from you"),a.default.createElement("p",null,"We collect Personal Information when you register or access the Site. The Personal Information collected during these interactions may vary based on what you choose to share with us. To register, you must submit your email address to the Site and a password that you create for user authentication purposes. We also ask you to provide a first and last name, but you may use a pseudonym if you wish. We will only record your email address when you submit it to us as part of the user registration process, our newsletter signup process, or if you send us a message. We do not collect your age or other age-related information."),a.default.createElement("h4",null,"2.2 Information we collect automatically"),a.default.createElement("p",null,"When you visit our Site, we may automatically collect and log the following information about your use of our Site or Service through cookies and other technologies: your domain name; your browser type, device name, and operating system; the URLs you requested to access; the dates, methods, and the status code of requests; your IP address; the time, frequency, and length of time you visit our Site or use our Service; the number of bytes transferred; or the URLs of pages that referred you to the Site."),a.default.createElement("h5",null,"2.2.1 Web Server Logs"),a.default.createElement("p",null,"When you visit the Site, our web server may record some automatically collected information described in Section 2.2 in its server log. We use server log information to help diagnose problems with our server and to administer our Site by identifying which parts or features of our Site are most heavily used. We also use this information to tailor Site content to user needs and to generate aggregate statistical reports. Web server logs are retained on a temporary basis, during which time their contents are accessible to Site administrators, and then deleted completely from our systems. Unless required by legal process, we do not link IP addresses to any Personal Information. This means that user sessions will be tracked by IP address, but a userâ€™s identity will remain anonymous."),a.default.createElement("h5",null,"2.2.2 Cookies and similar technologies"),a.default.createElement("h6",null,"2.2.2.1 Cookies"),a.default.createElement("p",null,"We and our third-party service providers may use cookies, to track information about your use of our Site and Service. Cookies are alphanumeric identifiers that we store on your computer or mobile device. Some cookies allow us to make it easier for you to navigate our Site and Service, while others are used to enable a faster login process or to allow us to track your activities at our Site and Service. There are two types of cookies: session and persistent cookies."),a.default.createElement("ol",null,a.default.createElement("li",null,"Session Cookies. Session cookies exist only during an online session. They disappear from your computer or device when you close your browser or power off your computer or device. We use session cookies to allow our systems to uniquely identify you during a session or while you are logged into the Site. This allows us to process your online transactions and requests and verify your identity, after you have logged in, as you move through our Site."),a.default.createElement("li",null,"Persistent Cookies. Persistent cookies remain on your computer or device after you have closed your browser or turned off your computer or device. We use persistent cookies to track aggregate and statistical information about user activity.")),a.default.createElement("h6",null,"2.2.2.2 Disabling Cookies"),a.default.createElement("p",null,"Most web browsers automatically accept cookies, but if you prefer, you can edit your browser options to block them in the future. The Help portion of the toolbar on most browsers will tell you how to prevent your computer from accepting new cookies, how to have the browser notify you when you receive a new cookie, or how to disable cookies altogether. Separately, you may opt out of our non-essential cookies by following this ",a.default.createElement("a",{href:"/legal/settings"},"link"),". Visitors to our Site who disable cookies will not be able to browse certain areas of the Site or use the Service."),a.default.createElement("h6",null,"2.2.2.3 Other Websites"),a.default.createElement("p",null,"Other websites. This Site may contain links to and embeds of other websites. The websites to which the Site links may also install cookies on your computer, log your access to their web pages, or collect user-identifying information directly from you, once you proceed to browse those websites. We are not responsible for the privacy policies of other websites to which the Site provides links. Please visit the relevant websites to review their privacy policies."),a.default.createElement("h5",null,'2.2.3 "Do Not Track" Signls'),a.default.createElement("p",null,"Currently, our systems do not recognize browser â€œdo-not-trackâ€ requests. You may, however, disable certain tracking as discussed in this section (e.g., by disabling cookies), but such disabling will impair use of the Site and Service."),a.default.createElement("h4",null,"2.3 Legal basis for processing of Personal Information"),a.default.createElement("p",null,"Where required by applicable law, we rely on certain legal bases for our collection and processing of Personal Information, including your consent, necessity to perform a contract, or our legitimate interest. In the case of Personal Information collected to contact you with information and updates about the Company, we rely on your consent and our legitimate interest."),a.default.createElement("h4",null,"2.4 User-generated content"),a.default.createElement("p",null,"The Site allows registered users to post content, images, multimedia presentations, and other scholarly works, as well as reviews, comments and other user-generated content in certain areas. The content you post will be available for all registered users to view and will identify you as the poster by the user name you have selected. If you do not wish to be identified as the source of content you post to the Site, you should select a pseudonymous user name. We create a profile page for each registered user. The profile pages are public-facing. By default, the profile page includes your user name and information about your posted content and other activities on the Site. You may (but do not need to) augment your profile page with additional information, including a picture."),a.default.createElement("p",null,"We do not control the content added by you to our Site and Service during your use of our Site and Service. For example, videos you may choose to embed as a part of your content on our Site and Service may include third-party trackers. You are agreeing that you will be responsible for any such additions, inclusions, or any other embedded content."),a.default.createElement("h4",null,"2.5 Childrenâ€™s Data"),a.default.createElement("p",null,"Our Site and Service are intended for general audiences and not for children under the age of 13."),a.default.createElement("p",null,"If you are under the age of 13, you may not use our Site or Service unless we receive prior verifiable consent from your parent or legal guardian in accordance with the Childrenâ€™s Online Privacy Protection Act (COPPA). If we discover that our Site or Service has collected the Personal Information of a child under the age of 13, we will notify the childâ€™s parent or legal guardian and we will seek verifiable consent for that information from the childâ€™s parent or legal guardian in a manner consistent with COPPA requirements."),a.default.createElement("p",null,"You must be old enough to consent to the processing of your Personal Information in your country (depending on your country, we may allow your parent or guardian to do so on your behalf). If you are a resident of the European Union, you must be at least 16 years old to use the Site or Service, unless we receive a prior verifiable consent from your parent or legal guardian."),a.default.createElement("p",null,"If you are a parent or guardian and discover that your child under the age of 13 has submitted Personal Information to us without your prior, written consent, then you may alert us at privacy@pubpub.org and request that we delete that childâ€™s Personal Information from our systems."),a.default.createElement("h3",null,"3. How We Use Information We Collect"),a.default.createElement("p",null,"We use your information for the following purposes:"),a.default.createElement("h4",null,"3.1 Provide our service"),a.default.createElement("p",null,"We use your information to provide our Site and Service, communicate with you about your use of our Site and Service, to respond to your inquiries, and for other customer service purposes."),a.default.createElement("h4",null,"3.2 Improve and develop our services"),a.default.createElement("p",null,"We use your information to ensure our Site and Service are working as intended, to analyze how users access and use our Site and Service, both on an aggregated and individualized basis, to maintain and improve the content and functionality of our Service, to develop new Service, and for other research and analytical purposes. For example, we may elect to conduct internal programming analytics of anonymized user-generated content."),a.default.createElement("h4",null,"3.3 Offer promotions"),a.default.createElement("p",null,"We use your information for marketing and promotional purposes. For example, we may use your information, such as your email address, to send you news, promotions, or to otherwise contact you about information regarding the Service or information we think may interest you. When you submit your email address to the Site during registration, we will ask you whether you want to receive periodic announcements from the Site by email. Accepting emailed announcements is entirely optional and not a condition of registration, and you may change your email settings at any time to subscribe or unsubscribe to these mailings."),a.default.createElement("h4",null,"3.4 Fraud prevention and compliance"),a.default.createElement("p",null,"We use your information to prevent fraud, criminal activity, or misuses of our Site and Service, and to ensure the security of our IT systems, architecture and networks. We also may use your information to comply with legal obligations and legal process and to protect our rights, privacy, safety or property, and/or that of our affiliates, you, or other third parties."),a.default.createElement("h3",null,"4. How We Share And Disclose Your Information"),a.default.createElement("h4",null,"4.1 Sharing with your consent"),a.default.createElement("p",null,"Where you have provided consent, we share your information, including Personal Information, as described at the time of consent and only for the purpose for which you have provided your information to us. We will not sell, lend, or disclose to third parties any Personal Information collected from users, except as described in this Policy."),a.default.createElement("h4",null,"4.2 Affiliates"),a.default.createElement("p",null,"We may disclose the information we collect from you to our affiliates solely for the purpose of providing Service to you; however, if we do so, their use and disclosure of your Personal Information will be maintained by such affiliates in accordance with this Policy."),a.default.createElement("h4",null,"4.3 Service providers"),a.default.createElement("p",null,"We may disclose the information we collect from you to third-party vendors, service providers, contractors, or agents who perform functions on our behalf, including, but not limited to, providers of hosting services, cloud services and other information technology services providers, email communication software and email newsletter services, and payment processors. Pursuant to our instructions, these parties may access, process or store Personal Information in the course of performing their duties to us. These parties will be prohibited from using or sharing Site user information for any purpose other than performing functions on our behalf."),a.default.createElement("h4",null,"4.4 In response to legal process"),a.default.createElement("p",null,"We ordinarily do not disclose to third parties Site usage by individual IP addresses, but we may do so without further notice to you in very limited circumstances when complying with the law, a judicial proceeding, court order, or other legal process, working with consultants assisting us with fixing or improving the Site, or monitoring and improving the security of our network."),a.default.createElement("h4",null,"4.5 To protect us and others"),a.default.createElement("p",null,"We also may disclose the information we collect from you where we believe it is necessary to investigate, prevent, or take action regarding illegal activities, suspected fraud, situations involving potential threats to the safety of any person, violations of this Policy, of any relevant Terms of Use, or as evidence in litigation in which we are involved."),a.default.createElement("h4",null,"4.6 Aggregate and De-identified information"),a.default.createElement("p",null,"We may share aggregate or de-identified information about users with third parties and publicly for marketing, advertising, research, or similar purposes."),a.default.createElement("p",null,"Please note that except as noted above, we will not sell or share your Personal Information with any third party for their direct marketing purposes without your consent."),a.default.createElement("h3",null,"5. Third-Party Analytics"),a.default.createElement("p",null,"PubPub uses Heap, a third-party analytics service. Heap collects anonymous information from users to help us track Site usage and referrals from other websites. Information collected and processed by Heap includes the userâ€™s IP address, network location, and geographic location. Heap acquires all its information directly from the user, by installing a cookie on JavaScript-enabled computers."),a.default.createElement("p",null,"We use the information collected by Heap to perform Site usage analytics through storing, aggregating and summarizing information about user behavior on our platform. We do this to optimize the website experience for our visitors, to help our engineering team make product decisions, and to help communities who use our service to measure the performance of their content. If you allow us to enable Heap while you browse, we will send requests to Heapâ€™s servers containing things like the URL of the current page, your browser version, and your IP address. If you're logged in, we will also send your PubPub user ID, which is made of random letters and numbers."),a.default.createElement("p",null,"We will never send Heap any identifying information such as your name, affiliation, or email address."),a.default.createElement("p",null,"We do not share with Heap or other third parties any Personal Information, and Heap does not collect any personal identifying information."),a.default.createElement("p",null,"For more information about Heap, please visit https://heap.io/tos/."),a.default.createElement("h3",null,"6. Third-Party Links"),a.default.createElement("p",null,"The Site may contain links to other websites not operated or controlled by us, including social media services (â€œThird Party Sitesâ€). The information that you share with Third Party Sites will be governed by the specific privacy policies and terms of service of the Third Party Sites and not by this Policy. By providing these links we do not imply that we endorse or have reviewed these Third Party Sites and we are not responsible for the information practices of such Third Party Sites. Please contact the Third Party Sites directly for information on their privacy practices and policies."),a.default.createElement("h3",null,"7. Your Rights"),a.default.createElement("p",null,"In certain circumstances, providing Personal Information is optional. However, if you choose not to provide Personal Information that is needed to use some features of our Service, you may be unable to use those features."),a.default.createElement("h4",null,"7.1 Rights relating to my Personal Information"),a.default.createElement("p",null,"You may request access, modification, or deletion of Personal Information that you have submitted to us by contacting us at"," ",a.default.createElement("a",{href:"mailto:privacy@pubpub.org"},"privacy@pubpub.org"),". For example, you may ask us to correct, update, or delete your Personal Information. We will reply to and honor such requests to the extent required by law. We may need to retain some information in order to comply with law, and to defend or exercise our legal claims. Please note that copies of information that you have updated, modified, or deleted may remain viewable in cached and archived pages of the Site for a period of time."),a.default.createElement("p",null,"EU residents may also request to exercise certain additional rights under the General Data Protection Regulation (â€œGDPRâ€) to restrict processing (Art. 18), request data portability (Art. 20), and object to certain processing (Art. 21). We will respond to such requests in the time period and to the extent required by the GDPR. Such requests can be made by contacting us at"," ",a.default.createElement("a",{href:"mailto:privacy@pubpub.org"},"privacy@pubpub.org"),"."),a.default.createElement("h4",null,"7.2 Non-U.S. Users"),a.default.createElement("p",null,"If you use the Site or Service outside of the United States of America, you consent to having your Personal Information transferred to and processed in the United States of America, which may have less protections than your jurisdiction of residence."),a.default.createElement("h4",null,"7.3 What choices do I have regarding use of my Personal Information for marketing?"),a.default.createElement("p",null,"We may send periodic promotional or informational emails to you if you have signed up for such information on the Site. You may opt-out of such communications by following the opt-out instructions contained in the e-mail. Please note that it may take up to 10 business days for us to process opt-out requests. If you opt out of receiving emails about recommendations or other information we think may interest you, we may still send you e-mails about your account or any Service you have requested or received from us."),a.default.createElement("h4",null,"7.4 Data retention"),a.default.createElement("p",null,"We, generally, retain Personal Information as long as necessary to fulfill the purposes for which the Personal Information was collected, including for as long as you use our Service. We may continue to retain such Personal Information even after you cease to use any particular Service, as reasonably necessary to comply with applicable laws and our legal obligations, resolve disputes, prevent fraud and abuse, enforce our agreements, and protect our legitimate interests."),a.default.createElement("h3",null,"8. Security of Your Personal Information"),a.default.createElement("p",null,"You use the Service at your own risk. We implement commercially reasonable technical, administrative, and organizational measures to protect your Personal Information both online and offline from loss, misuse, and unauthorized access, disclosure, alteration or destruction. However, no system or electronic transmission is ever fully secure, impenetrable, or error free. In particular, e-mail sent to or from us may not be secure. We cannot completely guarantee the security of our database, nor can we guarantee that the information you supply will not be intercepted while being transmitted to us over the Internet. Therefore, you should take special care in deciding what information you send to us via the Service or e-mail. Please keep this in mind when disclosing any Personal Information to us via the Internet. In addition, we are not responsible for circumvention of any privacy settings or security measures contained on the Service, or third party websites."),a.default.createElement("p",null,"We have implemented commercially reasonable precautions to protect the information we collect from loss, misuse, and unauthorized access, disclosure, alteration, and destruction. Please be aware that despite our efforts, no data security measures can guarantee 100% security."),a.default.createElement("p",null,"You should take steps to protect against unauthorized access to your password, phone, and computer by, among other things, signing off after using a shared computer, choosing a robust password that nobody else knows or can easily guess, and keeping your log-in and password private. We are not responsible for any lost, stolen, or compromised passwords or for any activity on your account via unauthorized password activity."),a.default.createElement("h3",null,"9. Changes to this Privacy Policy"),a.default.createElement("p",null,"This Policy is current as of the Effective Date set forth above. As we periodically review our security measures and Privacy Policy, the Service may change from time to time. As a result, we may change this Privacy Policy at any time, so please be sure to check back periodically. We will post any changes to this Policy on the Site, unless another type of notice is required by the applicable law. If we make any changes to this Policy that materially affect our practices with regard to the Personal Information we have previously collected from you, we will endeavor to provide you with notice in advance of such change by highlighting the change on our Site or if you have an account with us, providing notice to the email address in your account (for this reason you should make sure to update your account information promptly if it changes). By continuing to use our Service or providing us with Personal Information after we have posted an updated Privacy Policy, or notified you by other means if applicable, you consent to the revised Privacy Policy and practices described in it."),a.default.createElement("h3",null,"10. Contact Us"),a.default.createElement("p",null,"If you have questions or complaints about this Privacy Policy or our information practices, please contact us at"," ",a.default.createElement("a",{href:"mailto:privacy@pubpub.org"},"privacy@pubpub.org"),". If you are an EU resident and believe our processing of your Personal Information violates data protection laws, you have a legal right to lodge a complaint with a supervisory authority responsible for data protection. You may do so in the EU member state of your habitual residence, your place of work, or the place of the alleged violation."))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));t.default=function(){return a.default.createElement("div",null,a.default.createElement("h2",null,"Acceptable User Policy"),a.default.createElement("p",null,"This PubPub Acceptable Use Policy (â€œAUPâ€) is made a part of and is subject to the applicable Terms of Service (â€œAgreementâ€) between you and PubPub. Capitalized terms herein have the same meaning as set forth in the Agreement. We may update these policies from time to time."),a.default.createElement("p",null,"The purpose of the AUP is to help you understand how to use the Site. You must abide by the policies described here, and if you fail to do so, we may immediately terminate and remove your account and Community or limit your access to it. We may also establish policies regarding your Community, such as how long your Community content will be retained on the Site. We have no responsibility or liability for the deletion or failure to store any content."),a.default.createElement("p",null,"Your use of the Site includes the use of features that allow you or others to contribute User-Generated Content. The Site, Third Party Publishers, and Communities may solicit and publish User-Generated Content through blogs, video postings, and chat features, among other forums."),a.default.createElement("p",null,"You agree not to, and not to allow third parties to use the Site:"),a.default.createElement("ul",null,a.default.createElement("li",null,"To make comments that are threatening, knowingly false, or unlawful; or to engage in or promote harassment, hate, violence, discrimination or personal attacks;"),a.default.createElement("li",null,"To impersonate any person or entity or create a false identity on the Site; you are free to use a pseudonym, including to parody others, but you may not pretend to actually be another person or company or undertake actions that would cause confusion between you, your Community, other Communities, or any other company or person."),a.default.createElement("li",null,"To harass, threaten, stalk, embarrass or cause distress, unwanted attention or discomfort to any user of the Site;"),a.default.createElement("li",null,"To disseminate or transmit â€œspam,â€ unsolicited messages, chain letters, advertisements, solicitations, or other unsolicited commercial communications, including (but not limited to) communications describing investment opportunities;"),a.default.createElement("li",null,"To post material that infringes a copyright, trademark or patent right, trade secret, privacy, publicity or other legal right of any person or any corporation, institution, or other entity;"),a.default.createElement("li",null,"To knowingly disseminate or transmit viruses, Trojan horses, worms, defects, date bombs, time bombs, hoaxes, corrupted files, malware, ransomware, spyware, or other items of a destructive nature or any other malicious code or program;"),a.default.createElement("li",null,"To knowingly carry out any action with the intent or effect of disrupting other usersâ€™ experience of the Site, such as intentionally causing a chat screen to scroll faster than other users are able to read, or deploying macros with large amounts of text for the purpose of disrupting the normal flow of user chats."),a.default.createElement("li",null,"To access or use the Site in any manner that could damage or overburden any of our servers, or any network connected to any of our servers."),a.default.createElement("li",null,"To use the Site or take any action in any manner that would interfere with any other partyâ€™s use of or circumvents any aspect of the Site;"),a.default.createElement("li",null,"To not implement any measures to circumvent us blocking you from accessing the Site;")),a.default.createElement("p",null,"You agree that any use of the Site or the Siteâ€™s content other than as specifically authorized in this AUP is strictly prohibited."))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(488)),o=r(n(1460)),l=r(n(1477)),u=n(39),c=n(440),s=n(277);n(1561);var d=function(){var e=(0,u.usePubContext)().submissionState?o.default:i.default;return a.default.createElement(e,null)};t.default=function(e){var t=e.pubData;return a.default.createElement("div",{id:"pub-container"},a.default.createElement(s.PubSuspendWhileTypingProvider,null,a.default.createElement(c.PubContextProvider,{pubData:t},a.default.createElement(d,null),a.default.createElement(l.default,null))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=n(6),d=n(9),f=n(183),m=n(278),p=n(39),h=n(1426),b=l(n(1427)),v=l(n(1431)),y=l(n(224)),g=l(n(492)),_=l(n(1452));n(1459);var E=function(e){var t=e.showingDetails?"Hide details":"Show details",n=e.showingDetails?"cross":"expand-all";return u.default.createElement(y.default,{className:(0,c.default)("details-button",e.showingDetails&&"showing-details"),label:t,labelPosition:"left",icon:n,onClick:e.onClick})};t.default=function(e){var t,n=(0,u.useRef)(null),r=(0,p.usePubContext)(),a=r.pubData,i=r.updateLocalData,l=e.sticky,y=void 0===l||l,P=(0,d.usePageContext)().communityData,w=o((0,u.useState)(!1),2),O=w[0],C=w[1],S=o((0,u.useState)(null),2),D=S[0],k=S[1],j=(0,m.useViewport)().viewportWidth,M=j&&j<=h.mobileViewportCutoff;(0,f.useSticky)({isActive:y&&!!n.current,target:".pub-header-component",offset:(null===(t=null==n?void 0:n.current)||void 0===t?void 0:t.offsetHeight)?37-n.current.offsetHeight:0});var N=function(){if(!O&&n.current)if(M){window.scrollTo(0,0);var e=n.current.getBoundingClientRect();k(1+window.innerHeight-e.top),C(!0)}else{e=n.current.getBoundingClientRect();k(e.height)}C(!O)};return u.default.createElement(s.PubHeaderBackground,{className:(0,c.default)("pub-header-component",O&&"showing-details"),pubData:a,communityData:P,ref:n,style:D&&O?{height:D}:{},safetyLayer:O?"full-height":"enabled"},M&&O&&u.default.createElement("style",null,"body { overflow: hidden }"),u.default.createElement(s.GridWrapper,{containerClassName:"pub",columnClassName:"pub-header-column"},!O&&u.default.createElement(v.default,{pubData:a,updateLocalData:i,onShowHeaderDetails:N}),O&&u.default.createElement(b.default,{pubData:a,communityData:P,onCloseHeaderDetails:N}),u.default.createElement(E,{showingDetails:O,onClick:N})),!a.isReview&&y?u.default.createElement(g.default,null):u.default.createElement(s.ClientOnly,null,u.default.createElement(_.default,null)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mobileViewportCutoff=void 0,t.mobileViewportCutoff=750},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1428);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(87)),o=n(35),l=n(99),u=n(6),c=n(132),s=n(9),d=r(n(224)),f=r(n(287));n(1430);t.default=function(e){var t=e.communityData,n=e.onCloseHeaderDetails,r=e.pubData,m=r.collectionPubs,p=(0,c.getAllPubContributors)(r,"contributors"),h=(0,s.usePageContext)().scopeData.activePermissions.canView,b=(0,l.getPubCreatedDate)(r),v=(0,l.getPubPublishedDateString)(r),y=(0,l.getPubPublishedDate)(r),g=(0,l.getPubUpdatedDate)({pub:r});return a.default.createElement("div",{className:"pub-details-component"},a.default.createElement("h3",{className:"pub-title"},r.title),a.default.createElement(d.default,{className:"mobile-close-details-button",onClick:n,icon:"cross"}),a.default.createElement("div",{className:"sections-wrapper"},a.default.createElement("div",{className:"section contributors"},a.default.createElement("h6",{className:"pub-header-themed-secondary"},"Contributors (",p.length,")"),a.default.createElement(u.ContributorsList,{attributions:p})),a.default.createElement("div",{className:"section publication-dates"},h&&a.default.createElement(a.default.Fragment,null,a.default.createElement("h6",{className:"pub-header-themed-secondary"},"Created"),a.default.createElement("div",{className:"full-height-date"},(0,i.default)(b,"mmm dd, yyyy"))),a.default.createElement("h6",{className:"pub-header-themed-secondary"},"Published"),a.default.createElement("div",{className:"full-height-date"},v||a.default.createElement("i",null,"Unpublished")),g&&g!==y&&a.default.createElement(a.default.Fragment,null,a.default.createElement("h6",{className:"pub-header-themed-secondary"},"Updated"),a.default.createElement("div",{className:"full-height-date"},(0,i.default)(g,"mmm dd, yyyy")))),a.default.createElement("div",{className:"section citation-and-doi"},r.doi&&a.default.createElement(a.default.Fragment,null,a.default.createElement("h6",{className:"pub-header-themed-secondary"},"DOI")," ",a.default.createElement(u.ClickToCopyButton,{copyString:"https://doi.org/"+r.doi,className:"click-to-copy",beforeCopyPrompt:"Copy doi.org link"},r.doi)),a.default.createElement(f.default,{pubData:r})),a.default.createElement("div",{className:"section collections"},a.default.createElement("h6",{className:"pub-header-themed-secondary"},"Appears in Collections (",m.length,")"),a.default.createElement("div",{className:"collection-list"},0===m.length&&a.default.createElement("i",{className:"collection-list-entry"},"This pub doesn't belong to any collections."),m.map((function(e){var n=e.collection;return n?a.default.createElement("a",{key:n.title,className:"collection-list-entry hoverline",href:(0,o.collectionUrl)(t,n)},n.title):null}))))))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(6),l=n(99),u=n(9),c=n(18),s=n(39),d=a(n(1432)),f=a(n(1437)),m=a(n(1442)),p=a(n(1446));t.default=function(e){var t=e.onShowHeaderDetails,n=e.pubData,a=e.updateLocalData,h=n.doi,b=n.isInMaintenanceMode,v=(0,u.usePageContext)().communityData,y=(0,s.usePubContext)(),g=y.submissionState,_=y.historyData,E=(0,l.getPubPublishedDateString)(n),P=!!g,w=function(e){return a("pub",e,{isImmediate:!0})},O=function(e){var t=r({},n);return w(e),(0,c.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify(r(r({},e),{pubId:n.id,communityId:v.id}))}).catch((function(){return a("pub",t)}))};return i.default.createElement("div",{className:"pub-header-content-component"},i.default.createElement("div",{className:"pub-header-top-area has-bottom-hairline"},!P&&i.default.createElement(d.default,{pubData:n,updatePubData:w}),i.default.createElement("div",{className:"basic-details"},i.default.createElement("span",{className:"metadata-pair"},E?i.default.createElement(i.default.Fragment,null,i.default.createElement("b",{className:"pub-header-themed-secondary"},"Published on "),E):i.default.createElement("i",null,"Unpublished")),h&&i.default.createElement("span",{className:"metadata-pair doi-pair"},i.default.createElement("b",{className:"pub-header-themed-secondary"},"DOI"),i.default.createElement(o.ClickToCopyButton,{copyString:"https://doi.org/"+h,className:"click-to-copy",beforeCopyPrompt:"Copy doi.org link",icon:null},h)),i.default.createElement("div",{className:"show-details-placeholder"}))),i.default.createElement(m.default,{pubData:n,updatePubData:O}),i.default.createElement(p.default,{onShowHeaderDetails:t,pubData:n,updatePubData:O}),!b&&i.default.createElement(f.default,{pubData:n,historyData:_,updatePubData:w}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(5),d=n(216),f=n(35),m=n(74),p=n(9),h=n(6),b=n(57),v=u(n(1433)),y=u(n(489));n(1436);t.default=function(e){var t,n,a=e.pubData,i=e.updatePubData,o=a.collectionPubs,u=(0,p.usePageContext)(),g=u.communityData,_=u.locationData,E=u.scopeData.activePermissions.canManage,P=g.collections,w=(0,d.chooseCollectionForPub)(a,_),O=l((0,c.useState)(0===o.length),2),C=O[0],S=O[1],D=a.collectionPubs.filter((function(e){return!(!e.collection||e.collection===w)})).sort((function(e,t){return e.pubRank>t.pubRank?1:-1})).map((function(e){return e.collection})),k=function(){o.length>0&&S(!1)};return 0!==o.length||E?c.default.createElement("div",{className:"collections-bar-component"},w&&c.default.createElement(v.default,{collection:w,currentPub:a}),c.default.createElement(s.OverflowList,{className:"collections-list",collapseFrom:"end",items:D,visibleItemRenderer:function(e){return c.default.createElement(y.default,{key:e.id,href:(0,f.collectionUrl)(g,e),as:"a"},e.title)},overflowRenderer:function(e){var t=e.length===a.collectionPubs.length,n=t?null:"more",r=t?"caret-down":null,i=t?1===e.length?"collection":"collections":"more";return c.default.createElement(b.Menu,{placement:"bottom-end","aria-label":e.length+" "+i,disclosure:c.default.createElement(y.default,{icon:n,rightIcon:r},e.length," ",i)},e.map((function(e){var t=(0,m.getSchemaForKind)(e.kind);return c.default.createElement(b.MenuItem,{icon:t&&t.bpDisplayIcon,key:e.id,text:e.title,href:(0,f.collectionUrl)(g,e)})})))}}),E&&(t={pub:a,collectionPubs:o,canManage:E,updateCollectionPubs:function(e){return i({collectionPubs:e})},allCollections:P,renderDragElementInPortal:!0},n=c.default.createElement(y.default,{icon:"plus","aria-label":"Add or edit Pub Collections"},0===o.length?"Add to Collection":null),C?c.default.createElement(h.PubCollectionsListing,r({},t,{onQueryListClose:k,renderTriggerButtonForQueryList:function(){return n}})):c.default.createElement(h.PopoverButton,r({className:"collections-bar-component_collections-popover",component:h.PubCollectionsListing,"aria-label":"Add or edit Pub Collections"},t),n))):null}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(6),c=n(57),s=n(9),d=n(216),f=n(35),m=n(74),p=n(39),h=i(n(489));n(1435);t.default=function(e){var t=e.collection,n=e.currentPub,i=(0,p.usePubContext)().updateLocalData,b=(0,s.usePageContext)().communityData,v=(0,d.useCollectionPubs)(i,t),y=v.pubs,g=v.error,_=v.isLoading,E=(0,m.getSchemaForKind)(t.kind).bpDisplayIcon,P=function(e){return(0,d.createReadingParamUrl)((0,f.pubUrl)(b,e),t.id)};return o.default.createElement(c.Menu,{className:"collection-browser-component_menu",disclosure:function(e){var n=e.ref,i=a(e,["ref"]);return o.default.createElement(h.default,r({icon:E,className:"collection-browser-button",rightIcon:"caret-down",ref:n},i),t.title)},"aria-label":"Browse this collection"},o.default.createElement(c.MenuItem,{icon:"collection",text:t.title,href:(0,f.collectionUrl)(b,t)}),o.default.createElement(c.MenuItemDivider,null),_&&o.default.createElement(c.MenuItem,{disabled:!0,className:"loading-menu-item",textClassName:"menu-item-text",icon:o.default.createElement(l.Spinner,{size:30}),text:"Loading..."}),y&&!_&&y.map((function(e){return o.default.createElement(c.MenuItem,{active:n.id===e.id,href:P(e),textClassName:"menu-item-text",icon:"pubDoc",key:e.id,text:o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{className:"title"},o.default.createElement(u.PubTitle,{pubData:e})),o.default.createElement(u.PubByline,{pubData:e,linkToUsers:!1}))})})),g&&o.default.createElement(c.MenuItem,{disabled:!0,className:"loading-menu-item",textClassName:"menu-item-text",text:"Error loading Pubs"}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getHistoryButtonLabelForTimestamp=void 0;var o=i(n(0)),l=i(n(117)),u=n(6),c=n(57),s=n(35),d=n(67),f=n(9),m=i(n(1438));n(1441);t.getHistoryButtonLabelForTimestamp=function(e,t,n){return e?{top:t,bottom:Date.now()-e<6e4?"just now":o.default.createElement(l.default,{date:e,minPeriod:60})}:{top:n,bottom:"just now"}};t.default=function(e){var n,i,l,p=e.historyData,h=e.pubData,b=e.updatePubData,v=(0,f.usePageContext)(),y=v.communityData,g=v.scopeData.activePermissions,_=g.canView,E=g.canViewDraft,P=g.canAdmin,w=g.canCreateReviews,O=h.isRelease,C=h.isReview;return o.default.createElement("div",{className:"draft-release-buttons-component"},O?(n=h.releases,i=h.releaseNumber,l=new Date(n[n.length-1].createdAt).valueOf(),o.default.createElement(o.default.Fragment,null,(_||E)&&o.default.createElement(m.default,{icon:"edit",tagName:"a",href:(0,s.pubUrl)(y,h,{isDraft:!0}),outerLabel:{top:"edit this Pub",bottom:"go to draft"}}),!C&&o.default.createElement(c.Menu,{className:"releases-menu","aria-label":"Choose a historical release of this Pub",disclosure:o.default.createElement(m.default,{icon:"history",showCaret:!0,outerLabel:(0,t.getHistoryButtonLabelForTimestamp)(l,"last released")})},n.map((function(e,t){return o.default.createElement(c.MenuItem,{key:e.id,active:t+1===i,icon:t+1===i?"tick":"document-share",href:(0,s.pubUrl)(y,h,{releaseNumber:t+1}),className:"release-menu-item",text:o.default.createElement("div",{className:"release-metadata"},o.default.createElement("p",{className:"number"},"Release #"+(t+1)),o.default.createElement("p",{className:"timestamp"},(0,d.formatDate)(new Date(e.createdAt),{includeTime:!0})))})})).reverse()))):function(){var e=h.releases,n=p.latestKey,i=p.timestamps,l=e[e.length-1],c=i[n],d=function(e,t){if(e){var n=e.historyKey;return"number"!=typeof n||n<t}return-1!==t}(l,n);return o.default.createElement(o.default.Fragment,null,o.default.createElement(m.default,{icon:"history",className:"draft-history-button",active:p.isViewingHistory,outerLabel:(0,t.getHistoryButtonLabelForTimestamp)(c,"draft last updated","draft created"),disabled:p.loadedIntoHistory,onClick:function(){return p.setIsViewingHistory(!p.isViewingHistory)}}),!!l&&o.default.createElement(m.default,{icon:"globe",tagName:"a",href:(0,s.pubUrl)(y,h),outerLabel:{bottom:"view latest release",top:"see published version"}}),P&&!C&&o.default.createElement(u.DialogLauncher,{renderLauncherElement:function(e){var t=e.openDialog;return o.default.createElement(m.default,{disabled:!d,icon:"document-share",onClick:t,label:{bottom:"Create a Release",top:"Publish"}})}},(function(e){var t=e.isOpen,n=e.onClose,i=e.key;return o.default.createElement(u.PubReleaseDialog,{key:i,isOpen:t,onClose:n,pub:h,historyKey:null==p?void 0:p.latestKey,onCreateRelease:function(e){return b((function(t){return{releases:a(a([],r(t.releases),!1),[e],!1)}}))}})})),w&&!C&&o.default.createElement(u.DialogLauncher,{renderLauncherElement:function(e){var t=e.openDialog;return o.default.createElement(m.default,{disabled:!d,icon:"social-media",onClick:t,label:{bottom:"Create a Release Review",top:"Request Publication"}})}},(function(e){var t=e.isOpen,n=e.onClose,r=e.key;return o.default.createElement(u.PubReleaseReviewDialog,{key:r,isOpen:t,onClose:n,pubData:h,updatePubData:b})})))}())}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(6),u=i(n(1439)),c=i(n(224)),s=o.default.forwardRef((function(e,t){var n=e.labelPosition,i=e.outerLabel,s=e.showCaret,d=void 0!==s&&s,f=e.simpleLabel,m=a(e,["labelPosition","outerLabel","showCaret","simpleLabel"]),p={outerLabel:i,showCaret:d},h={labelPosition:n};return o.default.createElement(l.MobileAware,{ref:t,desktop:function(e){return o.default.createElement(u.default,r({},m,p,e,{outerLabel:i}))},mobile:function(e){return o.default.createElement(c.default,r({},m,h,e,{label:f}))}})}));t.default=s},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=i(n(3)),u=n(78),c=n(6);n(1440);var s=o.default.forwardRef((function(e,t){var n=e.active,i=void 0!==n&&n,s=e.className,d=void 0===s?"":s,f=e.disabled,m=void 0!==f&&f,p=e.icon,h=void 0===p?null:p,b=e.label,v=e.onClick,y=void 0===v?null:v,g=e.outerLabel,_=e.showCaret,E=void 0!==_&&_,P=e.tagName,w=void 0===P?"button":P,O=a(e,["active","className","disabled","icon","label","onClick","outerLabel","showCaret","tagName"]),C=b&&b.top&&b.bottom,S=g&&g.top&&g.bottom;return o.default.createElement(u.Button,r({disabled:m,as:w,className:(0,l.default)("large-header-button-component","pub-header-themed-box-hover-target",d),onClick:y,ref:t},O),o.default.createElement("div",{className:(0,l.default)("button-box","pub-header-themed-box",!b&&"no-label",i&&"active")},"string"==typeof h?o.default.createElement(c.Icon,{icon:h,iconSize:22}):h,E&&o.default.createElement(c.Icon,{icon:"caret-down",className:"caret",iconSize:10}),b&&!C&&o.default.createElement("div",{className:"label"},b),C&&o.default.createElement("div",{className:"stacked-label"},o.default.createElement("div",{className:"top"},b.top),o.default.createElement("div",{className:"bottom pub-header-themed-secondary"},b.bottom))),g&&!S&&o.default.createElement("div",{className:"outer-label"},g),S&&o.default.createElement("div",{className:"outer-label"},o.default.createElement("div",{className:"top pub-header-themed-secondary"},g.top),o.default.createElement("div",{className:"bottom"},g.bottom)))}));t.default=s},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(6),c=n(9),s=n(99),d=o(n(1443)),f=o(n(1445)),m=n(39);t.default=function(e){var t=e.pubData,n=e.updatePubData,r=t.title,a=t.htmlTitle,i=t.description,o=t.isRelease,p=t.isReview,h=(0,c.usePageContext)(),b=h.communityData,v=h.scopeData,y=h.featureFlags,g=(0,m.usePubContext)().submissionState,_="incomplete"===(null==g?void 0:g.submission.status),E=v.activePermissions.canManage&&!o&&!_&&!p,P=(0,s.getPubPublishedDateString)(t),w=(0,l.useCallback)((function(e,t){document.title=t,n({title:t,htmlTitle:e})}),[n]);return l.default.createElement("div",{className:"title-group-component"},y.htmlTitles?l.default.createElement("h1",{className:"title"},l.default.createElement(u.TitleEditor,{initialValue:null!=a?a:r,isReadOnly:!E,onChange:w,placeholder:"Add a Pub title"})):l.default.createElement(f.default,{text:r,updateText:function(e){return n({title:e})},canEdit:E,className:"title",placeholder:"Add a Pub title"}),(E||i)&&l.default.createElement(f.default,{text:i,updateText:function(e){return n({description:e})},canEdit:E,tagName:"p",className:"description pub-header-themed-secondary",placeholder:"Add a description for this Pub",maxLength:280}),l.default.createElement(u.PubByline,{pubData:t,renderSuffix:function(){return!o&&(E?l.default.createElement(l.default.Fragment,null,"Â ",l.default.createElement(u.DialogLauncher,{renderLauncherElement:function(e){var t=e.openDialog;return l.default.createElement(d.default,{onClick:t})}},(function(e){var r=e.isOpen,a=e.onClose;return l.default.createElement(u.PubAttributionDialog,{canEdit:!0,isOpen:r,onClose:a,pubData:t,communityData:b,updatePubData:n})}))):null)},renderEmptyState:function(){return E?l.default.createElement("span",{className:"pub-header-themed-secondary"},"Edit byline"):null}}),P&&l.default.createElement("div",{className:"published-date"},l.default.createElement("span",{className:"pub-header-themed-secondary"},"Published on"),l.default.createElement("span",null,P)))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(112),o=n(6);n(1444);t.default=function(e){var t=e.onClick;return a.default.createElement(i.Button,{className:"byline-edit-button-component",onClick:t,"aria-label":"Edit byline"},a.default.createElement("div",{className:"icon-box pub-header-themed-box pub-header-themed-box-hover-target"},a.default.createElement(o.Icon,{icon:"edit2",iconSize:14})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(6);t.default=function(e){var t=e.canEdit,n=e.className,r=void 0===n?"":n,a=e.placeholder,i=e.tagName,s=void 0===i?"h1":i,d=e.text,f=void 0===d?null:d,m=e.updateText,p=e.maxLength,h=void 0===p?1/0:p,b=o((0,l.useState)(!1),2),v=b[0],y=b[1],g=o((0,l.useState)(f||""),2),_=g[0],E=g[1],P=v&&t;return(0,l.useEffect)((function(){return y(!0)}),[]),(0,l.useEffect)((function(){return E(f||"")}),[f]),l.default.createElement(s,{className:r},P?l.default.createElement(l.default.Fragment,null,l.default.createElement(u.EditableText,{placeholder:a,onConfirm:function(e){return m(e.replace(/\n/g,""))},onChange:E,value:_,multiline:!0,confirmOnEnterKey:!0,maxLength:h}),l.default.createElement(c.LengthIndicator,{maxLength:h,length:(_||"").length})):l.default.createElement("span",{className:"text-wrapper"},f))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(9),o=n(40),l=n(6),u=r(n(287)),c=r(n(1447)),s=r(n(491)),d=r(n(224)),f=r(n(1450));t.default=function(e){var t=e.onShowHeaderDetails,n=e.pubData,r=e.updatePubData,m=(0,i.usePageContext)(),p=m.communityData,h=m.scopeData,b=n.isRelease,v=n.membersData,y=h.activePermissions.canManage;return a.default.createElement("div",{className:"utility-buttons-component"},a.default.createElement(d.default,{className:"show-header-details-button",icon:"info-sign",onClick:t}),y&&!b&&a.default.createElement(l.PopoverButton,{component:l.PubThemePicker,className:"pub-header-popover",updatePubData:r,pubData:n,communityData:p,"aria-label":"Pub header theme options"},a.default.createElement(d.default,{label:"Edit theme",labelPosition:"left",icon:"clean"})),y&&a.default.createElement(d.default,{label:"Pub settings",labelPosition:"left",icon:"cog",tagName:"a",href:(0,o.getDashUrl)({pubSlug:n.slug,mode:"settings"})}),v&&a.default.createElement(l.DialogLauncher,{renderLauncherElement:function(e){var t=e.openDialog;return a.default.createElement(d.default,{label:"Sharing",labelPosition:"left",icon:"people",className:"members-button",onClick:t})}},(function(e){var t=e.isOpen,r=e.onClose;return a.default.createElement(l.PubShareDialog,{isOpen:t,onClose:r,pubData:n})})),a.default.createElement(l.PopoverButton,{component:u.default,className:"pub-header-popover",pubData:n,"aria-label":"Cite this Pub"},a.default.createElement(d.default,{label:"Cite",className:"cite-button",labelPosition:"left",icon:"cite"})),b&&a.default.createElement(f.default,{pubData:n},a.default.createElement(d.default,{label:"Social",labelPosition:"left",icon:"share2"})),a.default.createElement(c.default,{pubData:n},a.default.createElement(d.default,{label:"Download",labelPosition:"left",icon:"download2"})),a.default.createElement(s.default,null,a.default.createElement(d.default,{label:"Contents",labelPosition:"left",icon:"toc"})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(57),s=n(18),d=n(490),f=n(9),m=n(39),p=n(257);n(1448);var h=[{format:"pdf",title:"PDF"},{format:"docx",title:"Word"},{format:"markdown",title:"Markdown"},{format:"epub",title:"EPUB"},{format:"html",title:"HTML"},{format:"odt",title:"OpenDocument"},{format:"plain",title:"Plain Text"},{format:"jats",title:"JATS XML"},{format:"tex",title:"LaTeX"}];t.default=function(e){var t=e.pubData,n=e.children,r=t.downloads,a=void 0===r?[]:r,i=o((0,l.useState)(!1),2),b=i[0],v=i[1],y=o((0,l.useState)(!1),2),g=y[0],_=y[1],E=o((0,l.useState)(null),2),P=E[0],w=E[1],O=o((0,l.useState)(null),2),C=O[0],S=O[1],D=o((0,l.useState)(null),2),k=D[0],j=D[1],M=(0,m.usePubHistory)().latestKey,N=(0,f.usePageContext)(),I=N.communityData,x=N.locationData,T=(0,p.getFormattedDownload)(a),A=function(e){v(!1),j(null),window.open(e)};return(0,l.useEffect)((function(){var e=function(e){navigator.userAgent.match(/iP(ad|hone|od)/i)?(j(e),v(!1)):A(e)};b&&(_(!1),(0,s.apiFetch)("/api/export",{method:"POST",body:JSON.stringify({pubId:t.id,communityId:I.id,format:null==P?void 0:P.format,historyKey:C,accessHash:x.query.access})}).then((function(t){var n=t.taskId,r=t.url;return r&&e(r),n?(0,d.pingTask)(n,1500).then((function(t){var n=t.url;return e(n)})):null})).catch((function(){_(!0),v(!1)})))}),[b,P,C,t.id,x.query.access,I.id]),l.default.createElement(c.Menu,{disclosure:n,className:"pub-download-component","aria-label":"Pub download formats",placement:"bottom-end"},T&&l.default.createElement(l.default.Fragment,null,l.default.createElement("li",{className:"bp3-menu-header"},l.default.createElement("h6",{className:"bp3-heading"},"Formatted Download")),l.default.createElement(c.MenuItem,{dismissOnClick:!1,labelElement:l.default.createElement(u.Icon,{icon:"star"}),className:"formatted-button",text:"Formatted "+T.url.split(".").pop().toUpperCase(),loading:b&&"formatted"===(null==P?void 0:P.format),onClick:function(){return window.open(T.url)}})),l.default.createElement("li",{className:"bp3-menu-header"},l.default.createElement("h6",{className:"bp3-heading"},"Auto Generated Download")),h.map((function(e,n){var r=k&&(null==P?void 0:P.format)===e.format;return l.default.createElement(c.MenuItem,{key:n+"-"+e.format,dismissOnClick:!1,disabled:b&&(null==P?void 0:P.format)!==e.format,rightElement:l.default.createElement("span",null,b&&(null==P?void 0:P.format)===e.format&&l.default.createElement(u.Spinner,{size:u.Spinner.SIZE_SMALL})),onClick:function(){return function(e){var n=t.exports.find((function(t){return t.format===e.format&&t.historyKey>=M}));n&&n.url?A(n.url):(w(e),S(M),_(!1),v(!0))}(e)},text:l.default.createElement(u.Tooltip,{key:e.format,isOpen:g&&(null==P?void 0:P.format)===e.format,content:"There was a problem generating the file."},r?l.default.createElement(u.Button,{icon:"download",onClick:function(){return A(k)}},"Download ",e.title," file"):e.title)})})))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6),o=n(9),l=n(35);t.default=function(e){var t,n,r=e.children,u=e.pubData,c=(0,o.usePageContext)().communityData,s=(t=u.title,n=(0,l.pubUrl)(c,u),[{title:"Twitter",icon:a.default.createElement(i.Icon,{icon:"twitter"}),url:"https://twitter.com/intent/tweet?url="+n+"&text="+t},{title:"Reddit",icon:a.default.createElement(i.Icon,{icon:"reddit"}),url:"https://reddit.com/submit?url="+n+"&title="+t},{title:"Facebook",icon:a.default.createElement(i.Icon,{icon:"facebook"}),url:"https://www.facebook.com/sharer.php?u="+n},{title:"LinkedIn",icon:a.default.createElement(i.Icon,{icon:"linkedin"}),url:"https://www.linkedin.com/shareArticle?url="+n+"&title="+t},{title:"Email",icon:a.default.createElement(i.Icon,{icon:"envelope"}),url:"mailto:?subject="+t+"&body="+n}]);return a.default.createElement(i.Menu,{disclosure:r,placement:"bottom-end","aria-label":"Social sharing options"},s.map((function(e){return a.default.createElement(i.MenuItem,{key:e.title,icon:e.icon,text:e.title,href:e.url,target:"_blank"})})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=n(5),d=n(9),f=n(35),m=n(6),p=n(18),h=n(483),b=n(41),v=n(39),y=u(n(1453)),g=u(n(1456));n(1458);t.default=function(){var e=(0,v.usePubContext)(),t=e.pubData,n=e.updatePubData,r=(0,d.usePageContext)(),a=r.communityData,i=r.scopeData,u=i.activePermissions,_=u.canManage,E=u.canEdit,P=i.memberData,w=r.loginData.fullName,O=t.viewHash,C=o((0,c.useState)(!1),2),S=C[0],D=C[1],k=o((0,c.useState)("Untitled Review"),2),j=k[0],M=k[1],N=o((0,c.useState)(""),2),I=N[0],x=N[1],T=o((0,c.useState)(void 0),2),A=T[0],R=T[1],B=o((0,c.useState)(!1),2),F=B[0],L=B[1],U=o((0,c.useState)(!1),2),z=U[0],H=U[1],V=o((0,c.useState)(!1),2),q=V[0],W=V[1],G=o((0,c.useState)(!0),2),K=G[0],J=G[1],Y=o((0,c.useState)(0),2),$=Y[0],Q=Y[1],Z=o((0,c.useState)(!1),2),X=Z[0],ee=Z[1],te=(0,h.useLocalStorage)({initial:b.getEmptyDoc,communityId:a.id,featureName:"new-review-editor",path:["pub-"+t.id],debounce:100}),ne=te.value,re=te.setValue,ae=function(e){re(e),H(!0),setTimeout((function(){ee(!0),H(!1)}),1e3)},ie=new URL(window.location.href),oe=new URLSearchParams(ie.search),le="/dash/pub/"+t.slug+"/reviews/"+$,ue=P.length>0,ce=_&&ue,se=ce?(0,f.pubUrl)(a,t):(0,f.pubUrl)(a,t,{accessHash:O}),de=!(!E&&!w),fe=c.default.createElement(c.default.Fragment,null,c.default.createElement(s.AnchorButton,{href:se},"Return to Pub"),ce&&c.default.createElement(s.AnchorButton,{intent:"primary",href:le},"Go to Review"));return c.default.createElement("div",{className:"review-header-sticky-component container pub"},c.default.createElement("div",{className:"sticky-section"},c.default.createElement("div",{className:"sticky-title"},t.title),c.default.createElement("div",{className:"side-content"},K&&c.default.createElement(y.default,{communityData:a,onSubmit:function(){return D(!0)},isLoading:F,review:ne,updateReview:ae}),c.default.createElement("div",{className:"sticky-buttons"},c.default.createElement("div",{className:"sticky-review-text"},"review"),z&&c.default.createElement("div",{className:"saving-text"},c.default.createElement("em",null,"Saving...")),X&&!z&&c.default.createElement("em",{className:"saving-text"},"Saved"),c.default.createElement(g.default,{isOpen:S,onClose:function(){W(!1),D(!1)},pubData:t,onCreateReviewDoc:function(){L(!0),p.apiFetch.post("/api/reviews",{communityId:a.id,pubId:t.id,reviewContent:ne,title:j,accessHash:oe.get("access"),reviewerName:I}).then((function(e){n((function(t){return t.reviews?{reviews:l(l([],o(t.reviews),!1),[e],!1)}:{reviews:[e]}})),L(!1),Q(e.number),re((0,b.getEmptyDoc)()),W(!0)})).catch((function(e){L(!1),R(e)}))},setReviewTitle:M,reviewTitle:j,reviewerName:I,setReviewerName:x,createdReview:q,createError:A,isUser:de,reviewerFooterButtons:fe}),c.default.createElement(s.Button,{minimal:!0,icon:c.default.createElement(m.Icon,{icon:"expand-all"}),onClick:function(){return J(!K)}})))))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=l(n(80)),d=n(41),f=l(n(1454));n(1455);t.default=function(e){var t=e.communityData,n=e.onSubmit,r=e.isLoading,a=e.review,i=e.updateReview,l=o((0,u.useState)(!1),2),m=l[0],p=l[1],h=(0,u.useMemo)((function(){return(0,s.default)(t.accentColorDark).alpha(.4)}),[t.accentColorDark]),b=(0,d.isEmptyDoc)(a)?"lightgray":m?t.accentColorDark:h;return u.default.createElement("div",{className:"review-component"},u.default.createElement(c.Card,{interactive:!0,elevation:c.Elevation.TWO},u.default.createElement("div",{className:"review-border",style:{borderColor:b}},u.default.createElement(f.default,{setReviewDoc:i,reviewDoc:a})),u.default.createElement("div",{className:"review-button"},u.default.createElement(c.Button,{icon:"document-share",onClick:n,minimal:!0,loading:r,className:"review-submission-button",style:{background:b},intent:"primary",disabled:(0,d.isEmptyDoc)(a),onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)}},"Submit Review"))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6);t.default=function(e){var t=e.setReviewDoc,n=e.reviewDoc;return a.default.createElement("div",{className:"review-editor-component"},a.default.createElement(i.MinimalEditor,{getButtons:function(e){return e.reviewButtonSet},onEdit:function(e){return t(e.toJSON())},useFormattingBar:!0,focusOnLoad:!0,initialContent:n,placeholder:"Compose your review here..."}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5);n(1457);t.default=function(e){var t=e.isOpen,n=e.onClose,r=e.pubData,o=e.onCreateReviewDoc,l=e.setReviewTitle,u=e.reviewTitle,c=e.reviewerName,s=e.setReviewerName,d=e.createdReview,f=e.createError,m=e.isUser,p=e.reviewerFooterButtons,h=function(e){return l(e.target.value.trim())},b=function(e){return s(e.target.value.trim())},v=function(e){"Enter"===e.key&&e.currentTarget.blur()};return a.default.createElement(i.Dialog,{lazy:!0,title:"Create Review",onClose:n,isOpen:t,className:"reviewer-dialog"},d?a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:i.Classes.DIALOG_BODY},a.default.createElement("div",{className:"callout"},a.default.createElement(i.Callout,{intent:"success",title:"Created Review!"},"Your review was successfully submitted!"))),a.default.createElement("div",{className:i.Classes.DIALOG_FOOTER},a.default.createElement("div",{className:i.Classes.DIALOG_FOOTER_ACTIONS},p))):a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:i.Classes.DIALOG_BODY},a.default.createElement("div",{className:"title-input"},a.default.createElement("p",null,"Add a title to your review?"),a.default.createElement(i.InputGroup,{defaultValue:u,onKeyDown:v,onBlur:h})),!m&&a.default.createElement("div",{className:"title-input"},a.default.createElement("p",null,"Add your name?"),a.default.createElement(i.InputGroup,{defaultValue:c,onKeyDown:v,onBlur:b})),a.default.createElement("p",null,"You are about to submit a review for ",a.default.createElement("b",null,r.title),".")),a.default.createElement("div",{className:i.Classes.DIALOG_FOOTER},a.default.createElement("div",{className:i.Classes.DIALOG_FOOTER_ACTIONS},a.default.createElement(i.AnchorButton,{onClick:n},"Cancel"),a.default.createElement(i.AnchorButton,{intent:"primary",onClick:o},"Create Review")))),a.default.createElement("div",{className:"callout"},f&&a.default.createElement(i.Callout,{intent:"danger",title:"There was an error submitting your review"},"Your review was not successfully submitted!")))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1461);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=o(n(0)),f=n(6),m=n(18),p=n(183),h=n(9),b=n(1462),v=n(39),y=s(n(488)),g=s(n(492)),_=s(n(1463)),E=s(n(1466)),P=s(n(1470)),w=s(n(1472));n(1476);var O=function(){var e,t=(0,h.usePendingChanges)().pendingPromise,n=(0,v.usePubContext)(),a=n.updatePubData,i=n.pubData,o=n.updateSubmissionState,s=n.submissionState,f=s.selectedTab,O=s.submission,C=(0,d.useRef)(null),S=c((0,d.useState)((function(){return(0,b.createSubmissionValidator)(O.submissionWorkflow)})),1)[0],D=(0,d.useMemo)((function(){var e;return(0,b.validateSubmission)({title:i.title,description:null!==(e=i.description)&&void 0!==e?e:"",abstract:O.abstract},S)}),[i,O,S]).validatedFields;(0,p.useSticky)({isActive:!!C.current,target:".spub-header-component",offset:(null===(e=null==C?void 0:C.current)||void 0===e?void 0:e.offsetHeight)?37-C.current.offsetHeight:0});var k=function(e){return l(void 0,void 0,void 0,(function(){var n,r;return u(this,(function(o){switch(o.label){case 0:return n=e.title,r=e.description,a(e),n||r?[4,t(m.apiFetch.put("/api/pubs",{pubId:i.id,title:n,description:r}).catch((function(){return a(i)})))]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))},j=function(e){o({selectedTab:e})};return d.default.createElement("div",{className:"spub-header-component",ref:C,"data-tab":f},d.default.createElement("style",null,"\n\t\t\t\tbody { background-color: #f8f8f8; }\n\t\t\t\t.pub-document-component { background-color: white; }\n\t\t\t"),d.default.createElement("div",{className:"content-container"},d.default.createElement(w.default,{validatedFields:D,onSelectTab:function(e){return j(e)},selectedTab:f,submission:O}),"instructions"===f&&d.default.createElement(_.default,{onBeginSubmission:function(){return j("details")},submissionWorkflow:O.submissionWorkflow}),"details"===f&&d.default.createElement(E.default,{submission:O,validatedFields:D,onUpdatePub:k,onUpdateAbstract:function(e){return l(void 0,void 0,void 0,(function(){return u(this,(function(n){return o((function(t){var n=t.submission;return{submission:r(r({},n),{abstract:e})}})),[2,t(m.apiFetch.put("/api/submissions",{abstract:e,id:O.id}))]}))}))},pub:i}),"contributors"===f&&d.default.createElement(P.default,{pubData:i,onUpdatePub:k}),"preview"===f&&d.default.createElement(y.default,{sticky:!1})),d.default.createElement(g.default,null))};t.default=function(){return d.default.createElement(f.PendingChangesProvider,null,d.default.createElement(O,null))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSubmission=t.createSubmissionValidator=void 0;var r=n(485);t.createSubmissionValidator=function(e){var t=e.requireAbstract,n=e.requireDescription;return{title:r.isNonEmptyString,description:n?(0,r.isTruthyAnd)(r.isNonEmptyString):r.isAlwaysValid,abstract:t?(0,r.isTruthyAnd)(r.isNonEmptyDocJson):r.isAlwaysValid}};t.validateSubmission=function(e,t){return(0,r.validate)(e,t)}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=r(n(293));n(1465);t.default=function(e){return a.default.createElement(l.default,{expandToFold:!0,className:"instructions-tab-component"},a.default.createElement("h1",null,e.submissionWorkflow.title),a.default.createElement(o.Editor,{initialContent:e.submissionWorkflow.instructionsText,isReadOnly:!0}),a.default.createElement(i.Button,{intent:"primary",outlined:!0,className:"begin-submission-button",text:"Begin Submission",icon:a.default.createElement(i.Icon,{className:"begin-submission-icon",iconSize:21,icon:"arrow-right"}),onClick:e.onBeginSubmission}))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=n(137),u=n(6),c=a(n(293)),s=a(n(493)),d=a(n(1468));t.default=function(e){var t=e.pub,n=e.onUpdatePub,a=e.onUpdateAbstract,f=e.validatedFields,m=e.submission,p=m.status,h=m.abstract,b=m.submissionWorkflow,v=b.requireAbstract,y=b.requireDescription,g="incomplete"!==p,_=r((0,l.useDebouncedCallback)(a,250),1)[0];return i.default.createElement(c.default,null,i.default.createElement(s.default,{title:"Title",asLabel:!0,valid:f.title,invalidNotice:"Title must not be empty"},i.default.createElement(o.InputGroup,{onBlur:function(e){return n({title:e.target.value})},defaultValue:t.title,fill:!0})),y&&i.default.createElement(s.default,{title:"Description",instructions:"A short subheader that will be shown below your submission's title.",valid:f.description,invalidNotice:"Description must not be empty"},i.default.createElement(o.InputGroup,{onBlur:function(e){return n({description:e.target.value})},defaultValue:t.description,fill:!0,maxLength:280})),v&&i.default.createElement(s.default,{title:"Abstract",instructions:g?f.abstract?"Update the abstract from the submission body.":"The abstract was removed from the submission body after submission and may need to be re-added before release.":null,valid:f.abstract,invalidNotice:"Abstract must not be empty"},i.default.createElement(d.default,{isReadOnly:g,submissionAbstract:h,onUpdateAbstract:_})),i.default.createElement(s.default,{title:"Attached file",instructions:i.default.createElement(i.default.Fragment,null,"You can upload a file, like a PDF with custom styling, to associate with this submission.")},i.default.createElement(u.DownloadChooser,{pubData:t,communityId:t.communityId,onSetDownloads:n,text:"Upload new file"})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),u=n(6),c=n(1469),s=n(39);t.default=function(e){var t=e.isReadOnly,n=e.submissionAbstract,a=e.onUpdateAbstract,i=(0,s.usePubContext)(),o=i.collabData.editorChangeObject,d=i.pubData.initialDoc,f=(0,l.useMemo)((function(){var e;if(t){var n=null===(e=null==o?void 0:o.view)||void 0===e?void 0:e.state.doc.toJSON();return{readOnlyAbstractDoc:(0,c.getAbstractDocFromPubDoc)(n||d),readOnlyEditorKey:Date.now()}}return{readOnlyAbstractDoc:null,readOnlyEditorKey:Date.now()}}),[t,o,d]),m=f.readOnlyAbstractDoc,p=f.readOnlyEditorKey;(0,l.useEffect)((function(){t&&a(m)}),[t,m]);var h={customNodes:{doc:{content:"paragraph"}},constrainHeight:!0,noMinHeight:!0};return t?l.default.createElement(u.MinimalEditor,r({},h,{key:p,initialContent:m,isReadOnly:!0})):l.default.createElement(u.MinimalEditor,r({},h,{initialContent:n,getButtons:function(e){return e.abstractButtonSet},onEdit:function(e){return a(e.toJSON())},debounceEditsMs:300,useFormattingBar:!0}))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.getAbstractDocFromPubDoc=void 0;t.getAbstractDocFromPubDoc=function(e){var t,n,a,i=r(e.content,2),o=i[0],l=i[1];if(o&&l){var u=o.type,c=o.attrs,s=o.content;if("heading"===u&&1===(null==c?void 0:c.level)&&"abstract"===(null===(a=null===(n=null===(t=null==s?void 0:s[0])||void 0===t?void 0:t.text)||void 0===n?void 0:n.toLowerCase())||void 0===a?void 0:a.trim())&&"paragraph"===l.type)return{type:"doc",attrs:{},content:[l]}}return null}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(6),o=n(9),l=r(n(493)),u=r(n(293));n(1471);t.default=function(e){var t=e.onUpdatePub,n=e.pubData,r=(0,o.usePageContext)().communityData,c=n.attributions.length,s=a.default.createElement(a.default.Fragment,null,"Contributors ",c?"("+c+")":null);return a.default.createElement(u.default,null,a.default.createElement(l.default,{title:s,fullWidth:!0},a.default.createElement(i.PubAttributionEditor,{pubData:n,communityData:r,updatePubData:t,canEdit:!0})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1473);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=n(5),f=c(n(80)),m=n(6),p=n(9),h=n(64),b=c(n(1474));n(1475);var v=function(e,t){return s.default.createElement(s.default.Fragment,null,s.default.createElement(d.Icon,{icon:e,iconSize:13})," ",t)};t.default=function(e){var t,n=e.selectedTab,a=e.submission,i=e.onSelectTab,o=e.validatedFields,c=l((0,s.useState)(!1),2),y=c[0],g=c[1],_=(0,p.usePageContext)().communityData,E=(0,p.usePendingChanges)().pendingCount,P=(0,s.useMemo)((function(){return(0,f.default)(_.accentColorDark).alpha(.1)}),[_.accentColorDark]),w=(0,s.useMemo)((function(){var e=Object.entries(o).reduce((function(e,t){var n=l(t,2),r=n[0];return n[1]?e:u(u([],l(e),!1),[r],!1)}),[]);return e.length?s.default.createElement(s.default.Fragment,null,"Please correct these fields before submitting:"," ",s.default.createElement("em",null,e.join(", "))):null}),[o]),O=v("align-left","Instructions"),C=v("manually-entered-data","Submission"),S=v("people","Contributors"),D=v("eye-open","Preview"),k=E>0?s.default.createElement("em",null,"Saving"):null,j="incomplete"===a.status&&"instructions"!==n;return s.default.createElement("div",{style:{background:P},className:"spub-header-toolbar-component"},s.default.createElement(m.GridWrapper,{containerClassName:"toolbar-container pub"},s.default.createElement("div",{className:"toolbar-items"},s.default.createElement(d.Tabs,{id:"spubHeaderToolbar",onChange:i,selectedTabId:n},s.default.createElement(d.Tab,{id:"instructions",title:O}),s.default.createElement(d.Tab,{id:"details",title:C}),s.default.createElement(d.Tab,{id:"contributors",title:S}),s.default.createElement(d.Tab,{id:"preview",title:D})),j?(t={minimal:!0,outlined:!0,intent:"primary",className:"submit-button",children:k||"Submit",disabled:!!k},w?s.default.createElement(d.Tooltip,{content:w},s.default.createElement(d.Button,r({},t,{disabled:!0}))):s.default.createElement(d.Button,r({},t,{onClick:function(){return g(!0)}}))):function(){var e=a.status;if(k)return k;if("incomplete"!==e){var t="received"===e?"Received":(0,h.capitalize)(e);return s.default.createElement("div",{className:"status"},s.default.createElement(d.Icon,{icon:"symbol-square",iconSize:18,className:"status-color-"+a.status}),t)}return null}(),s.default.createElement(b.default,{submission:a,isOpen:y,onClose:function(){return g(!1)}}))))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(0)),c=n(5),s=n(18),d=n(9),f=n(39);t.default=function(e){var t=(0,d.usePendingChanges)().pendingPromise,n=l((0,u.useState)(!1),2),a=n[0],i=n[1],o=l((0,u.useState)(null),2),m=o[0],p=o[1],h=l((0,u.useState)(null),2),b=h[0],v=h[1],y=(0,f.usePubContext)().updateSubmissionState;return u.default.createElement(c.Dialog,{isOpen:e.isOpen,onClose:e.onClose},b?u.default.createElement(c.Callout,{intent:"warning",title:"There was an error submitting this Pub."}):m?u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:c.Classes.DIALOG_BODY},u.default.createElement(c.Callout,{intent:"success",title:"Submitted!"},"Your Pub has been submitted for review.")),u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER},u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS},u.default.createElement(c.Button,{onClick:e.onClose,disabled:a},"Close"),u.default.createElement(c.Button,{onClick:function(){return window.location.reload()},loading:a,intent:"primary"},"View Submission")))):u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:c.Classes.DIALOG_BODY},u.default.createElement(c.Callout,{title:"Submit Pub?"},"Are you ready to submit this Pub?")),u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER},u.default.createElement("div",{className:c.Classes.DIALOG_FOOTER_ACTIONS},u.default.createElement(c.Button,{onClick:e.onClose,disabled:a},"Cancel"),u.default.createElement(c.Button,{onClick:function(){i(!0),t(s.apiFetch.put("/api/submissions",{id:e.submission.id,status:"received"}).then((function(e){p(e),y((function(t){var n=t.submission;return{submission:r(r({},n),{status:e.status})}}))})).catch((function(e){return v(e)})).finally((function(){return i(!1)})))},loading:a,intent:"primary"},"Submit")))))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1478);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(9),c=n(6),s=n(1479),d=n(39),f=n(1480),m=n(1481),p=o(n(1482)),h=o(n(1490)),b=o(n(1534)),v=o(n(1544)),y=o(n(1551)),g=o(n(1553)),_=o(n(1555)),E=o(n(1558));n(1560);t.default=function(){var e=(0,d.usePubContext)(),t=e.pubData,n=e.historyData,r=e.collabData,a=e.updatePubData,i=e.updateLocalData,o=e.pubBodyState,P=o.isReadOnly,w=o.hidePubBody,O=n.isViewingHistory,C=(0,u.usePageContext)(),S=C.communityData,D=C.scopeData.activePermissions,k=D.canEdit,j=D.canEditDraft,M=t.isReview,N=(0,l.useRef)(null),I=(0,l.useRef)(null),x=(0,l.useRef)(null);(0,f.usePermalinkOnMount)(),(0,m.usePubHrefs)({enabled:!P});var T=(k||j)&&!P;return w?null:l.default.createElement("div",{className:"pub-document-component"},(!P||O)&&l.default.createElement(v.default,{disabled:O,editorWrapperRef:x}),l.default.createElement("div",{className:"pub-grid"},l.default.createElement("div",{className:"main-content",ref:N},l.default.createElement(E.default,{pubData:t}),!M&&l.default.createElement(y.default,{pubData:t,historyData:n}),l.default.createElement(s.PubEdgeListing,{className:"top-pub-edges",pubData:t,accentColor:S.accentColorDark,initialFilters:[s.Filter.Parent],isolated:!0}),l.default.createElement(p.default,{editorWrapperRef:x}),T&&l.default.createElement(b.default,{editorChangeObject:r.editorChangeObject,updatePubData:a}),!O&&l.default.createElement(g.default,null),l.default.createElement(s.PubEdgeListing,{className:"bottom-pub-edges",pubData:t,accentColor:S.accentColorDark,initialFilters:[s.Filter.Child,s.Filter.Sibling],initialMode:t.pubEdgeListingDefaultsToCarousel?s.Mode.Carousel:s.Mode.List})),l.default.createElement("div",{className:"side-content",ref:I},O&&!M&&l.default.createElement(c.PubHistoryViewer,{historyData:n,pubData:t,onClose:function(){return n.setIsViewingHistory(!1)},onSetCurrentHistoryKey:n.setCurrentHistoryKey}))),l.default.createElement(h.default,{pubData:t,updateLocalData:i,sideContentRef:I,mainContentRef:N}),l.default.createElement(_.default,{mainContentRef:N}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PubEdgeListingCard=t.PubEdgeListing=void 0;var o=n(456);Object.defineProperty(t,"PubEdgeListing",{enumerable:!0,get:function(){return i(o).default}});var l=n(283);Object.defineProperty(t,"PubEdgeListingCard",{enumerable:!0,get:function(){return i(l).default}}),a(n(282),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.usePermalinkOnMount=void 0;var r=n(0),a=n(9),i=n(41),o=n(39);t.usePermalinkOnMount=function(){var e=(0,a.usePageContext)().locationData.query,t=e.from,n=e.to,l=(0,o.usePubContext)().collabData.editorChangeObject,u=null==l?void 0:l.view;(0,r.useEffect)((function(){var e=document.getElementsByClassName("permanent")[0];u&&t&&n&&!e&&setTimeout((function(){(0,i.setLocalHighlight)(u,parseInt(t,10),parseInt(n,10),"permanent"),setTimeout((function(){var e=document.getElementsByClassName("permanent")[0];e&&e.scrollIntoView({block:"center"})}),0)}),0)}),[u,t,n])}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubHrefs=void 0;var a=n(0),i=function(e,t){var n;void 0===t&&(t=0);try{n=document.getElementById(e.replace("#",""))}catch(e){return}n&&setTimeout((function(){var e=n.getBoundingClientRect();(function(e,t){void 0===t&&(t={});var n=e.top,a=e.left,i=e.bottom,o=e.right,l=window.innerWidth,u=window.innerHeight,c=document.documentElement,s=c.clientWidth,d=c.clientHeight,f=r({top:0,left:0},t),m=f.top,p=f.left;return n>=m&&a>=p&&i<=(u||d)&&o<=(l||s)})(e,{top:50})||(document.body.scrollTop+=e.top-80)}),t)};t.usePubHrefs=function(e){var t=e.enabled;(0,a.useEffect)((function(){var e=window.location.hash;e&&i(e,500)}),[]),(0,a.useEffect)((function(){var e=function(e){var t=e.target,n=e.metaKey;if(t instanceof HTMLAnchorElement&&!n){var r=t.getAttribute("href");r&&0===r.indexOf("#")&&(e.preventDefault(),window.location.hash=r,i(r))}};return t?(document.addEventListener("click",e),function(){return document.removeEventListener("click",e)}):function(){}}),[t])}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(71),s=i(n(297)),d=n(1483),f=n(6),m=l(n(1485)),p=l(n(1486)),h=n(39),b=n(277),v=l(n(1487));n(1489);t.default=function(e){var t=e.editorWrapperRef,n=(0,h.usePubContext)(),r=n.noteManager,a=n.updateCollabData,i=n.pubData.nodeLabels,l=n.historyData.setLatestHistoryKey,y=n.collabData,g=y.status,_=y.firebaseDraftRef,E=y.localCollabUser,P=n.pubBodyState,w=P.editorKey,O=P.initialContent,C=P.initialHistoryKey,S=P.isReadOnly,D=P.includeCollabPlugin,k=P.includeDiscussionsPlugin,j=P.discussionAnchors,M=o((0,u.useState)(null),2),N=M[0],I=M[1],x=o((0,u.useState)(null),2),T=x[0],A=x[1],R=(0,u.useContext)(b.PubSuspendWhileTypingContext).markLastInput;(0,c.useBeforeUnload)(("saving"===g||"disconnected"===g)&&!N,"Your Pub has changes that are still unsaved. Are you sure you wish to leave?");var B=(0,u.useCallback)((function(){return R(),!1}),[R]),F=(0,u.useCallback)((function(e){I(Date.now()),function(e){"undefined"!=typeof window&&window.sentryIsActive&&(s.configureScope((function(e){return e.setTag("error_source","editor")})),s.captureException(e))}(e)}),[]),L=o((0,d.useDebouncedCallback)((function(e){"saved"===e&&A(Date.now()),a({status:e})}),250),1)[0],U=(0,u.useCallback)((function(e){a({editorChangeObject:e})}),[a]),z=D&&!!_&&{initialDocKey:C,firebaseRef:_,clientData:E,onStatusChange:L,onUpdateLatestKey:l},H=k&&{draftRef:_,initialHistoryKey:C,discussionAnchors:j||[]};return u.default.createElement("main",{className:"pub-body-component",ref:t},u.default.createElement(f.Editor,{key:w,customNodes:m.default,enableSuggestions:!0,nodeLabels:i,noteManager:r,placeholder:S?void 0:"Begin writing here...",initialContent:O,isReadOnly:S,onKeyPress:B,onChange:U,onError:F,discussionsOptions:H,collaborativeOptions:z,customPlugins:{malformedDocPlugin:p.default}}),u.default.createElement(v.default,{pubErrorOccurredAt:N,lastSaveOccurredAt:T}))}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={discussion:{atom:!0,attrs:{threadNumber:{default:null},align:{default:"center"}},parseDOM:[{tag:"discussion",getAttrs:function(e){return{threadNumber:e.getAttribute("data-thread-number")||null,align:e.getAttribute("data-align")||null}}}],toDOM:function(e){return["discussion",{"data-thread-number":e.attrs.threadNumber,"data-align":e.attrs.align}]},inline:!1,group:"block",draggable:!1,isNodeView:!0,onInsert:function(e){var t=e.state.schema.nodes.discussion.create(),n=e.state.tr.replaceSelectionWith(t);e.dispatch(n)},defaultOptions:{getThreads:function(){return[]},getPubData:function(){},getLocationData:function(){},getLoginData:function(){},getOnPostDiscussion:function(){},getOnPutDiscussion:function(){},getGetHighlightContent:function(){},getHandleQuotePermalink:function(){}}}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(297)),u=n(8),c=n(160),s=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n=""),Object.entries(e).forEach((function(e){var r=o(e,2),a=r[0],i=r[1],l=""===n?a:n+"."+a;i&&"object"==typeof i?s(i,t,l):t[l]=i})),t};t.default=function(){var e=!1;return new u.Plugin({filterTransaction:function(t,n){var r=function(e){if(1===e.childCount){var t=e.child(0);if("paragraph"===(null==t?void 0:t.type.name))for(var n=0;n<t.childCount;n++){if("paragraph"===t.child(n).type.name)return!0}}return!1}(t.doc);if(r){var a=function(e,t){var n=e.steps,r=e.selection,a=e.mapping,i=e.docChanged,o=e.isGeneric,l=c.collabDocPluginKey.getState(t).mostRecentRemoteKey,u=e.meta;return s({meta:u,mostRecentRemoteKey:l,steps:n.map((function(e){return e.toJSON()})),selection:r.toJSON(),mapping:a,docChanged:i,isGeneric:o})}(t,n);if(!e){e=!0;var i=void 0;try{throw new Error("Uh-oh!")}catch(e){i=e}l.captureEvent({message:"Evil Prosemirror Transaction",contexts:{transactionMetadata:a,error:i}})}}return!r}})}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(1488),l=n(41),u=n(6),c=n(39);t.default=function(e){var t=e.pubErrorOccurredAt,n=e.lastSaveOccurredAt,r=(0,c.usePubContext)(),s=r.pubData.title,d=r.collabData.editorChangeObject;if(!t||window&&"URLSearchParams"in window&&new URLSearchParams(window.location.search).get("suppressEditorErrors"))return null;var f=n&&t-n>500;return a.default.createElement(i.Alert,{isOpen:!0,icon:"error",confirmButtonText:"Refresh Page",onConfirm:function(){window.location.reload()},cancelButtonText:f?"Download backup":void 0,onCancel:f?function(){var e,t,n,r;e=d.view,t=s,n=(0,l.getJSON)(e),r=new Blob([JSON.stringify(n,null,2)],{type:"text/plain;charset=utf-8"}),(0,o.saveAs)(r,t+"_backup.json")}:void 0,className:"pub-body-alert"},a.default.createElement("h5",null,"An error has occured in the editor."),a.default.createElement("p",null,"We've logged the error and will look into the cause right away."),f&&a.default.createElement(a.default.Fragment,null,a.default.createElement("p",{className:"error-time"},"Your changes were last saved"," ",a.default.createElement(u.TimeAgo,{date:n,now:t}),"."),a.default.createElement("p",null,"If you are concerned about unsaved changes being lost, please download a backup copy of your document below.")),!f&&a.default.createElement("p",{className:"error-time"},"All previous changes have been successfully saved."),a.default.createElement("p",null,"To continue editing, please refresh the page."))}},,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(1491),o=r(n(1493)),l=r(n(1495)),u=r(n(1498)),c=r(n(1532));n(1533);t.default=function(e){var t=e.pubData,n=e.showDiscussions,r=void 0===n||n,s=e.updateLocalData,d=e.sideContentRef,f=e.mainContentRef,m=(0,i.usePubNotes)(),p=m.footnotes,h=m.citations;return a.default.createElement("div",{className:"pub-bottom-component"},a.default.createElement("div",{className:"inner"},p.length>0&&a.default.createElement(l.default,{title:"Footnotes",notes:p,searchPlaceholder:"Search footnotes..."}),h.length>0&&a.default.createElement(l.default,{title:"References",notes:h,searchPlaceholder:"Search references..."}),a.default.createElement(o.default,{pubData:t,updateLocalData:s}),r&&a.default.createElement(u.default,{pubData:t,updateLocalData:s,sideContentRef:d,mainContentRef:f}),a.default.createElement(c.default,{pubData:t})))}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.usePubNotes=void 0;var a=n(0),i=n(77),o=n(1492),l=n(39);t.usePubNotes=function(){var e=(0,l.usePubContext)(),t=e.noteManager,n=e.collabData.editorChangeObject,u=r((0,a.useState)(t.notes),2),c=u[0],s=u[1],d=t.citationInlineStyleKind,f=n.view,m=f?(0,i.getNotesByKindFromDoc)(f.state.doc):{},p=m.citations,h=void 0===p?[]:p,b=m.footnotes,v=void 0===b?[]:b,y=(0,a.useMemo)((function(){return(0,o.renderNotesForListing)({citations:h,footnotes:v,citationInlineStyle:d,renderedStructuredValues:c})}),[h,v,d,c]);return(0,a.useEffect)((function(){return t.subscribe(s)}),[t]),y}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.renderNotesForListing=void 0;var a=n(62),i=function(e,t,n){return(0,a.unique)(e,(function(e){return e.fingerprint})).map((function(e,a){return r(r(r({},e),n&&{number:a+1}),{renderedStructuredValue:t[e.structuredValue]})}))},o=function(e){return e.map((function(e){return r(r({},e),{sortOn:(t=e,(((null===(a=null===(n=t.renderedStructuredValue)||void 0===n?void 0:n.json)||void 0===a?void 0:a.length)?null===(i=t.renderedStructuredValue)||void 0===i?void 0:i.html:t.unstructuredValue)||"").replace(/(<([^>]+)>)/gi,"").toLowerCase().trim())});var t,n,a,i})).sort((function(e,t){return e.sortOn.localeCompare(t.sortOn)}))};t.renderNotesForListing=function(e){var t=e.citations,n=e.footnotes,r=e.citationInlineStyle,a=e.renderedStructuredValues,l="count"!==r,u=i(n,a,!0),c=i(t,a,!l);return{footnotes:u,citations:l?o(c):c}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),u=n(6),c=n(9),s=n(448),d=i(n(225));t.default=function(e){var t=e.pubData,n=e.updateLocalData,r=(0,c.usePageContext)(),a=r.communityData,i=r.scopeData,o=(0,s.getLicenseForPub)(t,a),f=o.link,m=o.full,p=o.slug,h=o.summary;return l.default.createElement(d.default,{accentColor:a.accentColorDark,isExpandable:!1,className:"pub-bottom-license",title:"License",centerItems:l.default.createElement(l.default.Fragment,null,l.default.createElement(d.SectionBullets,null,l.default.createElement("a",{target:"_blank",rel:"license noopener noreferrer",className:"license-link",href:f},l.default.createElement("img",{width:75,alt:"",src:"/static/license/"+p+".svg",className:"license-image"}),m," ",h&&"("+h+")"))),iconItems:function(e){var r=e.iconColor;return i.activePermissions.canManage?l.default.createElement(u.LicenseSelect,{pubData:t,updateLocalData:n},(function(e){var t=e.isPersisting;return l.default.createElement(d.AccentedIconButton,{accentColor:r,icon:"edit",title:"Select Pub license",loading:t})})):null}})}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(0)),s=n(9),d=u(n(1496)),f=o(n(225)),m=function(e){return function(t){var n;return!e||[null===(n=t.renderedStructuredValue)||void 0===n?void 0:n.html,t.unstructuredValue].filter((function(e){return!!e})).map((function(e){return e.toLowerCase()})).some((function(t){return t.includes(e.toLowerCase())}))}};t.default=function(e){var t=e.notes,n=l(e,["notes"]),a=(0,s.usePageContext)().communityData;return c.default.createElement(f.default,r({accentColor:a.accentColorDark,isSearchable:!0,centerItems:c.default.createElement(f.SectionBullets,null,t.length)},n),(function(e){var n=e.searchTerm;return c.default.createElement(d.default,{accentColor:a.accentColorDark,notes:t.filter(m(n))})}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),d=c(n(31)),f=c(n(3)),m=n(6);n(1497);var p=function(e){var t,n=e.note,r=e.accentColor,a=(0,s.useRef)(),i=u((0,s.useState)(null),2),o=i[0],l=i[1];return(0,s.useLayoutEffect)((function(){var e=a.current;if(e){var t=function(e){for(var t=e;;){var n=t.lastElementChild,r=t.lastChild;if(!n||n!==r)break;t=n}return t}(e);if(t){var n=document.createElement("span");t.appendChild(n),l(n)}}}),[n.unstructuredValue]),s.default.createElement("li",{className:"note"},n.number&&s.default.createElement("div",{className:"number"},n.number,"."),s.default.createElement("div",{className:"inner"},s.default.createElement(m.PubNoteContent,{ref:a,structured:null===(t=n.renderedStructuredValue)||void 0===t?void 0:t.html,unstructured:n.unstructuredValue}),o&&d.default.createPortal(s.default.createElement("span",{role:"button","aria-label":"Jump back to source",tabIndex:0,style:{cursor:"pointer"},onClick:function(){return function(e){if(e){e.scrollIntoView();var t=document.body.scrollTop||document.documentElement.scrollTop;document.body.scrollTop=t-75,document.documentElement.scrollTop=t-75}}(document.getElementById(n.id))}},s.default.createElement(m.Icon,{className:"jump-back-icon",icon:"return",color:r,iconSize:10})),o)))};t.default=function(e){var t=e.notes,n=l(e,["notes"]),a=t.some((function(e){return!!e.number}));return s.default.createElement("ul",{className:(0,f.default)("notes-component",!a&&"no-padding")},t.map((function(e){return s.default.createElement(p,r({key:e.id,note:e},n))})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=n(5),d=n(9),f=n(261),m=n(6),p=n(39),h=u(n(1499)),b=u(n(1501)),v=u(n(1505)),y=u(n(1518)),g=i(n(225)),_=n(295);t.default=function(e){var t=e.pubData,n=e.updateLocalData,r=e.sideContentRef,a=e.mainContentRef,i=t.discussions,u=t.isRelease,E=(0,d.usePageContext)(),P=E.communityData,w=E.scopeData,O=E.featureFlags,C=E.loginData.id,S=(0,p.usePubContext)(),D=S.pubData.subscription,k=S.updatePubData,j=S.collabData.editorChangeObject,M=w.activePermissions,N=M.canView,I=M.canManage,x=M.canCreateDiscussions,T=o((0,c.useState)(!1),2),A=T[0],R=T[1],B=o((0,c.useState)(!0),2),F=B[0],L=B[1],U=o((0,c.useState)("newestThread"),2),z=U[0],H=U[1],V=o((0,c.useState)([]),2),q=V[0],W=V[1],G=i.filter((function(e){return!e.isClosed})),K=function(e){return function(t){var n=F?null:(0,f.getAnchoredDiscussionIds)(j.view);return(0,_.filterAndSortDiscussions)(t,A,z,q,e,n)}};return c.default.createElement(g.default,{accentColor:P.accentColorDark,isSearchable:!0,title:"Comments",centerItems:function(){return c.default.createElement(g.SectionBullets,null,G.length)},iconItems:function(e){var r=e.isExpanded,a=e.iconColor;return r?c.default.createElement(c.default.Fragment,null,c.default.createElement(s.Popover,{minimal:!0,content:c.default.createElement(h.default,{selected:z,onSelect:function(e){H(e)}}),position:s.Position.BOTTOM_RIGHT,transitionDuration:-1},c.default.createElement(g.AccentedIconButton,{accentColor:a,icon:"sort",title:"Sort comments"})),c.default.createElement(s.Popover,{minimal:!0,content:c.default.createElement(b.default,{pubData:t,communityData:P,labelsData:t.labels||[],selectedLabels:q,isManager:I,onBrowseArchive:R,isBrowsingArchive:A,onShowAnchoredComments:L,isShowingAnchoredComments:F,onLabelSelect:function(e){var t=q.indexOf(e)>-1?q.filter((function(t){return t!==e})):l(l([],o(q),!1),[e],!1);W(t)},updateLocalData:n}),transitionDuration:-1,position:s.Position.BOTTOM_RIGHT,close:!0},c.default.createElement(g.AccentedIconButton,{accentColor:a,icon:"filter",title:"Filter comments"})),C&&O.notifications&&c.default.createElement(m.SubscriptionButton,{subscription:D,onUpdateSubscription:function(e){return k({subscription:e})},target:{pubId:t.id},menuLabel:"Follow Pub discussion"},c.default.createElement(g.AccentedIconButton,{accentColor:a,title:"Manage subscription",icon:"notifications"})),I&&O.releaseDiscussionsDialog&&!u&&i.length>0&&c.default.createElement(m.DialogLauncher,{renderLauncherElement:function(e){var t=e.openDialog;return c.default.createElement(g.AccentedIconButton,{accentColor:a,icon:"share",title:"Release Discussions",onClick:t})}},(function(e){var n=e.isOpen,r=e.onClose,a=e.key;return c.default.createElement(v.default,{key:a,isOpen:n,onClose:r,pubData:t})}))):null},defaultExpanded:!0,searchPlaceholder:"Search comments..."},(function(e){var n=e.searchTerm,i=e.isSearching;return c.default.createElement(y.default,{sideContentRef:r,mainContentRef:a,pubData:t,filterDiscussions:K(n),searchTerm:n,showBottomInput:(N||x)&&!i&&!A})}))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6);n(1500);t.default=function(e){var t=e.onSelect;return a.default.createElement(i.Menu,{className:"sort-list-component bp3-elevation-1"},a.default.createElement("li",{className:"bp3-menu-header"},a.default.createElement("h6",null,"Sort")),[{id:0,slug:"newestThread",title:"Newest Thread"},{id:1,slug:"oldestThread",title:"Oldest Thread"},{id:2,slug:"newestReply",title:"Most Recent Reply"},{id:3,slug:"oldestReply",title:"Least Recent Reply"},{id:4,slug:"mostReplies",title:"Most Replies"},{id:5,slug:"leastReplies",title:"Least Replies"}].map((function(n){return a.default.createElement(i.MenuItem,{key:"option-"+n.id,onClick:function(){t(n.slug)},labelElement:e.selected===n.slug?a.default.createElement(o.Icon,{icon:"small-tick"}):void 0,text:n.title})})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0)),o=n(5),l=a(n(1502));n(1504);t.default=function(e){var t=e.isBrowsingArchive,n=e.isShowingAnchoredComments,a=e.onBrowseArchive,u=e.onShowAnchoredComments;return i.default.createElement("div",{className:"filter-menu-component"},i.default.createElement(o.Switch,{label:"Browse archived comments",checked:t,onChange:function(e){return a(e.target.checked)}}),i.default.createElement(o.Switch,{label:"Show anchored comments",checked:n,onChange:function(e){return u(e.target.checked)}}),i.default.createElement(l.default,r({},e)))}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return l(t,e),t},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=u(n(0)),m=n(5),p=d(n(260)),h=d(n(58)),b=n(18);n(1503);var v={labelsData:[]},y=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isEditMode:!1,labelsData:t.labelsData,isSaving:!1,labelsDataChanged:!1},n.toggleEditMode=n.toggleEditMode.bind(n),n.updateTitle=n.updateTitle.bind(n),n.updateColor=n.updateColor.bind(n),n.removeLabel=n.removeLabel.bind(n),n.togglePublicApply=n.togglePublicApply.bind(n),n.addLabel=n.addLabel.bind(n),n.handleSave=n.handleSave.bind(n),n}return a(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({labelsData:e.labelsData,isSaving:!1,isEditMode:!1,labelsDataChanged:!1})},t.prototype.toggleEditMode=function(){this.setState((function(e){return{isEditMode:!e.isEditMode}}))},t.prototype.updateTitle=function(e,t){this.setState((function(n){return{labelsData:n.labelsData.map((function(n){return n.id!==e?n:i(i({},n),{title:t})})),labelsDataChanged:!0}}))},t.prototype.updateColor=function(e,t){this.setState((function(n){return{labelsData:n.labelsData.map((function(n){return n.id!==e?n:i(i({},n),{color:t})})),labelsDataChanged:!0}}))},t.prototype.togglePublicApply=function(e){this.setState((function(t){return{labelsData:t.labelsData.map((function(t){return t.id!==e?t:i(i({},t),{publicApply:!t.publicApply})})),labelsDataChanged:!0}}))},t.prototype.removeLabel=function(e){this.setState((function(t){return{labelsData:t.labelsData.filter((function(t){return t.id!==e})),labelsDataChanged:!0}}))},t.prototype.addLabel=function(){this.setState((function(e){return{labelsData:s(s([],c(e.labelsData),!1),[{id:(0,p.default)(),title:"New Label",color:"#b71540",publicApply:!1}],!1),labelsDataChanged:!0}}))},t.prototype.handleSave=function(){var e=this;return this.setState({isSaving:!0}),(0,b.apiFetch)("/api/pubs",{method:"PUT",body:JSON.stringify({labels:this.state.labelsData,pubId:this.props.pubData.id,communityId:this.props.communityData.id})}).then((function(t){e.props.updateLocalData("pub",t),e.setState({isSaving:!1})})).catch((function(e){console.error("Error saving labels",e)}))},t.prototype.render=function(){var e=this,t=this.state.isEditMode||!this.props.labelsData.length&&this.props.isManager;return f.default.createElement("div",{className:"label-filter-component"},f.default.createElement("h6",null,"Filter by label"),f.default.createElement("div",{className:"labels"},!t&&this.state.labelsData.sort((function(e,t){return e.title.toLowerCase()<t.title.toLowerCase()?-1:e.title.toLowerCase()>t.title.toLowerCase()?1:0})).map((function(t){return f.default.createElement("li",{key:"label-"+t.id},f.default.createElement("div",{role:"button",tabIndex:-1,className:"label",onClick:function(){e.props.onLabelSelect(t.id)}},f.default.createElement("div",{className:"color",style:{backgroundColor:t.color}},e.props.selectedLabels.indexOf(t.id)>-1&&f.default.createElement("span",{className:"bp3-icon-standard bp3-icon-small-tick"})),f.default.createElement("div",{className:"title"},t.title),f.default.createElement(m.Tooltip,{content:t.publicApply?f.default.createElement("span",null,"All discussion authors can apply this label."):f.default.createElement("span",null,"Only managers can apply this label."),tooltipClassName:"bp3-dark",position:m.Position.TOP},f.default.createElement("span",{className:"bp3-icon-standard bp3-icon-endorsed "+(t.publicApply?"":"active")}))))})),!t&&!this.state.labelsData.length&&f.default.createElement("div",{className:"bp3-menu-item empty"},"No Labels to Filter by"),t&&this.state.labelsData.map((function(t){return f.default.createElement("div",{key:"label-edit-"+t.id,className:"label edit"},f.default.createElement(m.Popover,{content:f.default.createElement("div",{className:"bp3-menu color-select-menu"},["#eb2f06","#b71540","#fa983a","#e58e26","#38ada9","#079992","#009432","#006266","#0652DD","#1B1464","#833471","#6F1E51"].map((function(n){return f.default.createElement("span",{"aria-label":"Select color",role:"button",tabIndex:-1,key:n,className:"color-select",style:{backgroundColor:n},onClick:function(){e.updateColor(t.id,n)}})}))),interactionKind:m.PopoverInteractionKind.CLICK,position:m.Position.TOP_LEFT,popoverClassName:"color-select-popover",transitionDuration:-1,inline:!0,inheritDarkTheme:!1},f.default.createElement("div",{className:"color edit",style:{backgroundColor:t.color}})),f.default.createElement("input",{className:"bp3-input",type:"text",value:t.title,onChange:function(n){e.updateTitle(t.id,n.target.value)}}),f.default.createElement(m.Tooltip,{content:t.publicApply?f.default.createElement("span",null,"All discussion authors can apply this label."):f.default.createElement("span",null,"Only managers can apply this label."),tooltipClassName:"bp3-dark",position:m.Position.TOP},f.default.createElement(m.Button,{onClick:function(){e.togglePublicApply(t.id)},className:"bp3-minimal bp3-icon-endorsed "+(t.publicApply?"":"active")})),f.default.createElement(m.Button,{onClick:function(){e.removeLabel(t.id)},className:"bp3-icon-trash bp3-minimal"}))}))),t&&f.default.createElement(m.ButtonGroup,null,f.default.createElement(m.Button,{onClick:this.addLabel,text:"Add Label",icon:"plus"}),f.default.createElement(m.Button,{onClick:this.handleSave,text:"Save",intent:"primary",icon:"tick",loading:this.state.isSaving,disabled:!this.state.labelsDataChanged})),!t&&this.props.isManager&&f.default.createElement(m.Button,{icon:f.default.createElement(h.default,{icon:"edit2"}),text:"Edit labels",onClick:this.toggleEditMode}))},t.defaultProps=v,t}(f.Component);t.default=y},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(n(0)),s=n(5),d=n(18),f=n(9),m=n(35),p=u(n(294));n(1517);t.default=function(e){var t=e.pubData,n=e.onClose,r=e.isOpen,a=t.discussions,i=o((0,c.useState)([]),2),u=i[0],h=i[1],b=o((0,c.useState)("ready"),2),v=b[0],y=b[1],g=(0,f.usePageContext)().communityData,_=(0,c.useCallback)((function(e){h((function(t){return t.includes(e)?t.filter((function(t){return t!==e})):l(l([],o(t),!1),[e],!1)}))}),[]);return c.default.createElement(s.Dialog,{className:"discussions-release-dialog-component",onClose:n,isOpen:r,title:"Release Discussions"},c.default.createElement("div",{className:s.Classes.DIALOG_BODY},c.default.createElement("p",null,"Select discussions to move from the draft to the latest Release. Once they're moved, you won't be able to undo this action (though you may be able to ask Ian to do it for you ðŸ˜Š)"),c.default.createElement("div",{className:"discussions-listing"},a.map((function(e){var n=u.includes(e.id);return c.default.createElement(s.Label,{key:e.id,className:"discussion-entry"},c.default.createElement(s.Checkbox,{checked:n,onClick:function(){return _(e.id)}}),c.default.createElement(p.default,{discussionData:e,pubData:t,updateLocalData:function(){},canPreview:!0}))}))),"error"===v&&c.default.createElement(s.Callout,{intent:"warning",title:"An error occurred."})),c.default.createElement("div",{className:s.Classes.DIALOG_FOOTER},c.default.createElement(s.Button,{intent:"primary",onClick:function(){y("releasing"),d.apiFetch.put("/api/discussions/release",{pubId:t.id,discussionIds:u}).then((function(){return e=g,n=t,void(window.location.href=(0,m.pubUrl)(e,n));var e,n})).catch((function(){return y("error")}))},loading:"releasing"===v},"Fire away!")))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(3)),d=n(5),f=n(6),m=n(18),p=n(9),h=n(295),b=u(n(495)),v=u(n(1507)),y=u(n(1509)),g=u(n(1514));n(1516);t.default=function(e){var t=e.pubData,n=e.discussionData,a=e.canPreview,i=void 0!==a&&a,o=e.searchTerm,u=void 0===o?null:o,_=e.updateLocalData,E=(0,p.usePageContext)(),P=E.communityData,w=E.scopeData,O=E.locationData,C=E.loginData,S=w.activePermissions,D=S.canView,k=S.canCreateDiscussions,j=S.canAdmin,M=l((0,c.useState)(!1),2),N=M[0],I=M[1],x=l((0,c.useState)(!1),2),T=x[0],A=x[1],R=l((0,c.useState)("chronological"),2),B=R[0],F=R[1],L=i&&!N,U=D||k,z=C.id===n.userId,H=j||z&&!n.isClosed,V=n.id;(0,c.useEffect)((function(){(function(e){return window.location.hash==="#discussion-"+e})(V)&&(I(!0),A(!0))}),[V]);var q,W,G,K,J,Y;return c.default.createElement("div",{tabIndex:-1,role:"button",id:"discussion-"+n.id,className:(0,s.default)("discussion-component",L&&"preview",N&&"expanded-preview",H&&"has-manage-tools",T&&"emphasized"),onClick:function(){A(!1),L&&I(L)}},i&&!L&&c.default.createElement(d.Button,{minimal:!0,small:!0,className:"collapse-button",onClick:function(){return I(!1)},icon:c.default.createElement(f.Icon,{icon:"collapse-all",iconSize:12,color:P.accentColorDark})}),c.default.createElement(v.default,{pubData:t,discussionData:n}),!L&&c.default.createElement(c.default.Fragment,null,H&&c.default.createElement(y.default,{pubData:t,discussionData:n,onUpdateDiscussion:function(e){return(0,m.apiFetch)("/api/discussions",{method:"PUT",body:JSON.stringify(r(r({},e),{accessHash:O.query.access,discussionId:n.id,pubId:t.id,communityId:P.id}))}).then((function(e){_("pub",{discussions:t.discussions.map((function(t){return t.id===n.id?r(r({},t),e):t}))})}))},sortType:B,setSortType:F}),function(){var e=n.anchors;if(e){var t=l(e.sort((function(e,t){return e.historyKey-t.historyKey})),1)[0];if(t){var r=t.originalTextPrefix,a=t.originalText,i=t.originalTextSuffix;return c.default.createElement("div",{className:"anchor-text"},r,c.default.createElement("span",{className:"exact"},a),i)}}return null}()),(Y=n.thread.comments,L?(q=2,W=0,G=0,K=[],J=function(e){G>0&&K.push(c.default.createElement("div",{key:e,className:"overflow-listing"}," ","+ ",G," more...")),G=0},Y.forEach((function(e,r){var a=0===r,i=W<q,o=(0,h.discussionMatchesSearchTerm)(e,u),l=a||!o;a||i||o?(++W,J(e.id),K.push(c.default.createElement(g.default,{key:e.id,discussionData:n,isPreview:l,updateLocalData:_,threadCommentData:e,pubData:t}))):++G})),J("root"),K):function(e,t){return"alphabetical"===t?e.concat().sort((function(e,t){return e.author.lastName>t.author.lastName?1:-1})):e.concat().sort((function(e,t){return e.createdAt>t.createdAt?1:-1}))}(Y,B).map((function(e){return c.default.createElement(g.default,{key:e.id,discussionData:n,updateLocalData:_,threadCommentData:e,isPreview:L,pubData:t})}))),!L&&(U?c.default.createElement(b.default,{key:n.thread.comments.length,discussionData:n}):null))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0));n(1508);t.default=function(e){var t=e.pubData,n=e.discussionData,r=t.labels||[],i={};r.forEach((function(e){i[e.id]=e}));var o=n.labels||[];return o.length?a.default.createElement("div",{className:"label-list-component"},o.sort((function(e,t){return i[e].title<i[t].title?-1:i[e].title>i[t].title?1:0})).map((function(e){var t=i[e];return t?a.default.createElement("span",{key:e,className:"bp3-tag",style:{backgroundColor:t.color}},t.title):null}))):null}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=n(5),s=n(6),d=n(57),f=n(9),m=l(n(1510)),p=l(n(1512)),h={chronological:"Sort chronologically",alphabetical:"Sort by author surname"};t.default=function(e){var t=e.pubData,n=e.discussionData,r=e.onUpdateDiscussion,a=e.sortType,i=e.setSortType,l=(0,f.usePageContext)().scopeData.activePermissions,b=l.canAdmin,v=l.isSuperAdmin,y=n.isClosed,g=o((0,u.useState)(!1),2),_=g[0],E=g[1],P=function(){E(!0),r({isClosed:!y})};return u.default.createElement("div",{className:"manage-tools-component"},u.default.createElement(m.default,{availableLabels:t.labels||[],labelsData:n.labels||[],onPutDiscussion:r,canAdminPub:b}),function(){if(n.isClosed&&!b)return null;var e=y?"Unarchive":"Archive";return u.default.createElement(s.ConfirmDialog,{onConfirm:P,confirmLabel:e,text:"Are you sure you want to "+e.toLowerCase()+" this discussion?"},(function(t){var n=t.open;return u.default.createElement(c.Button,{icon:u.default.createElement(s.Icon,{icon:y?"export":"import",iconSize:12}),minimal:!0,small:!0,loading:_,onClick:n},e)}))}(),b?u.default.createElement(d.MenuButton,{buttonContent:"Sort","aria-label":"Sort comments by",buttonProps:{icon:u.default.createElement(s.Icon,{icon:"sort",iconSize:14}),minimal:!0,small:!0}},Object.keys(h).map((function(e){return u.default.createElement(d.MenuItem,{text:h[e],icon:e===a?"tick":"blank",onClick:function(){return i(e)},key:e})}))):null,v&&u.default.createElement(p.default,{discussionData:n}))}},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var s=l(n(0)),d=n(5),f=n(6);n(1511);var m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={labelsData:t.labelsData,isSaving:!1,labelsDataChanged:!1},n.applyLabel=n.applyLabel.bind(n),n.removeLabel=n.removeLabel.bind(n),n.handleSave=n.handleSave.bind(n),n}return a(t,e),t.prototype.applyLabel=function(e){this.setState((function(t){return{labelsData:c(c([],u(t.labelsData),!1),[e],!1),labelsDataChanged:!0}}))},t.prototype.removeLabel=function(e){this.setState((function(t){return{labelsData:t.labelsData.filter((function(t){return t!==e})),labelsDataChanged:!0}}))},t.prototype.handleSave=function(){var e=this;this.setState({isSaving:!0}),this.props.onPutDiscussion({labels:this.state.labelsData}).then((function(){e.setState({isSaving:!1,labelsDataChanged:!1})}))},t.prototype.render=function(){var e=this,t={};this.props.availableLabels.forEach((function(e){t[e.id]=e}));var n=this.props.availableLabels.filter((function(t){return e.props.canAdminPub||t.publicApply}));return 0===n.length?null:s.default.createElement(d.Popover,{popoverClassName:"label-select-component",content:s.default.createElement(d.Menu,null,s.default.createElement(d.Button,{fill:!0,className:"save-button",text:"Save",onClick:this.handleSave,loading:this.state.isSaving,disabled:!this.state.labelsDataChanged}),n.sort((function(e,t){return e.title<t.title?-1:e.title>t.title?1:0})).map((function(t){var n=e.state.labelsData.indexOf(t.id)>-1;return s.default.createElement(d.MenuItem,{key:t.id,shouldDismissPopover:!1,onClick:function(){return n?e.removeLabel(t.id):e.applyLabel(t.id)},icon:s.default.createElement("div",{className:"color",style:{backgroundColor:t.color}},n&&s.default.createElement(f.Icon,{icon:"tick",iconSize:14})),text:t.title,labelElement:e.props.canAdminPub&&s.default.createElement(d.Tooltip,{content:t.publicApply?"All discussion authors can apply this label.":"Only managers can apply this label."},s.default.createElement(f.Icon,{icon:"endorsed",className:t.publicApply?"":"active"}))})}))),position:d.Position.BOTTOM_RIGHT,transitionDuration:-1,minimal:!0,target:s.default.createElement(d.Button,{minimal:!0,small:!0,onClick:this.toggleEditMode,icon:s.default.createElement(f.Icon,{icon:"tag2",iconSize:12})},"Labels")})},t}(s.Component);t.default=m},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(31)),s=n(5),d=n(41),f=n(39);n(1513);t.default=function(e){var t=e.discussionData,n=(0,f.usePubContext)().collabData,r=o((0,u.useState)(!1),2),a=r[0],i=r[1],l=n.editorChangeObject.selection,m=t.anchor,p=o((0,u.useState)(null),2),h=p[0],b=p[1];return(0,u.useEffect)((function(){return b(document.querySelector("body"))}),[]),u.default.createElement(u.default.Fragment,null,u.default.createElement(s.Button,{small:!0,minimal:!0,disabled:a,onClick:function(){return i(!0)},icon:u.default.createElement(s.Icon,{icon:"text-highlight",iconSize:12})},"Re-anchor"),a&&h&&c.default.createPortal(u.default.createElement(s.Card,{className:"discussion-reanchor-component"},u.default.createElement("p",null,'Make a highlight in the document and then click "Re-anchor".'),m&&u.default.createElement("p",null,m.prefix,u.default.createElement("em",{style:{fontWeight:"bold"}},m.exact),m.suffix),u.default.createElement(s.ButtonGroup,null,u.default.createElement(s.Button,{onClick:function(){return i(!1)},style:{marginRight:10}},"Cancel"),u.default.createElement(s.Button,{onClick:function(){var e=n.editorChangeObject.view;(0,d.reanchorDiscussion)(e,n.firebaseDraftRef,t.id),i(!1)},disabled:!l||l.empty,intent:"primary"},"Re-anchor"))),h))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(117)),d=u(n(3)),f=n(5),m=o(n(41)),p=n(116),h=n(6),b=n(9),v=n(18);n(1515);t.default=function(e){var t=e.discussionData,n=e.threadCommentData,a=e.pubData,i=e.updateLocalData,o=e.isPreview,u=void 0!==o&&o,y=(0,b.usePageContext)(),g=y.loginData,_=y.communityData,E=y.locationData,P=l((0,c.useState)(!1),2),w=P[0],O=P[1],C=l((0,c.useState)(null),2),S=C[0],D=C[1],k=l((0,c.useState)(!1),2),j=k[0],M=k[1],N=g.id===n.userId,I=function(e,t,r){return c.default.createElement(m.default,{key:e,isReadOnly:t,initialContent:n.content,onChange:r})};return c.default.createElement("div",{className:(0,d.default)("thread-comment-component",u&&"is-preview")},c.default.createElement("div",{className:"avatar-wrapper"},c.default.createElement(h.Avatar,{width:18,initials:n.author.initials,avatar:n.author.avatar})),c.default.createElement("div",{className:"content-wrapper"},c.default.createElement("div",{className:"item-header"},c.default.createElement("span",{className:"name"},n.author.fullName,u?": ":""),u&&c.default.createElement("span",{className:"preview-text"},I("preview-"+n.text,!0)),!u&&c.default.createElement("span",{className:"time"},!w&&c.default.createElement(s.default,{minPeriod:60,formatter:function(e,t,n){if("second"===t)return"just now";var r=t;return e>1&&(r+="s"),e+" "+r+" "+n},date:n.createdAt})),c.default.createElement("span",{className:"actions"},!u&&N&&c.default.createElement(f.Button,{icon:w?void 0:c.default.createElement(h.Icon,{icon:"edit2",iconSize:12}),text:w?"Cancel":void 0,minimal:!0,small:!0,onClick:function(){O(!w)}}))),!u&&c.default.createElement("div",{className:(0,d.default)({"discussion-body-wrapper":!0,editable:w})},w&&S&&c.default.createElement(p.FormattingBar,{editorChangeObject:S,buttons:p.buttons.discussionButtonSet,isSmall:!0}),I(w+"-"+n.text,!w,(function(e){w&&D(e)}))),w&&c.default.createElement(f.Button,{small:!0,className:"discussion-primary-button",intent:f.Intent.PRIMARY,text:"Update Discussion",loading:j,disabled:!!S&&(0,m.viewIsEmpty)(S.view.state),onClick:function(){var e;M(!0),(e={content:(0,m.getJSON)(S.view),text:(0,m.getText)(S.view)||""},(0,v.apiFetch)("/api/threadComment",{method:"PUT",body:JSON.stringify(r(r({},e),{accessHash:E.query.access,parentId:t.id,threadId:t.threadId,threadCommentId:n.id,pubId:a.id,communityId:_.id}))}).then((function(e){i("pub",{discussions:a.discussions.map((function(a){return a.id===t.id?r(r({},a),{thread:r(r({},a.thread),{comments:a.thread.comments.map((function(t){return t.id===n.id?r(r({},t),e):t}))})}):a}))})}))).then((function(){O(!1),D(null),M(!1)}))}})))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=o(n(31)),c=o(n(1519)),s=n(41),d=n(5),f=n(9),m=n(39),p=o(n(1524)),h=o(n(294)),b=o(n(495)),v=n(295);n(1531);var y=function(){return[]};t.default=function(e){var t=e.pubData,n=e.filterDiscussions,r=void 0===n?y:n,a=e.mainContentRef,i=e.sideContentRef,o=e.searchTerm,g=void 0===o?null:o,_=e.showBottomInput,E=void 0!==_&&_,P=(0,m.usePubContext)(),w=P.collabData,O=P.updateLocalData,C=P.historyData,S=(0,f.usePageContext)(),D=S.communityData,k=S.scopeData,j=(0,c.default)().width,M=(0,l.useRef)([]),N=(0,l.useRef)([]),I=t.discussions,x=k.activePermissions,T=x.canView,A=x.canCreateDiscussions,R=w.editorChangeObject.decorations||[],B=(0,v.groupDiscussionsByLine)(R,I);(0,l.useEffect)((function(){w.editorChangeObject.view&&(0,s.dispatchEmptyTransaction)(w.editorChangeObject.view)}),[j]);var F,L;return l.default.createElement("div",{className:"pub-discussions-component"},l.default.createElement("style",null,"\n\t\t\t\t\t.discussion-list .discussion-thread-component.preview:hover,\n\t\t\t\t\t.discussion-list .discussion-thread-component.expanded-preview {\n\t\t\t\t\t\tborder-left: 3px solid "+D.accentColorDark+";\n\t\t\t\t\t\tpadding-left: calc(1em - 2px);\n\t\t\t\t\t}\n\t\t\t\t"),B.map((function(e){var n=document.getElementsByClassName(e.mountClassName)[0];return n?u.default.createPortal(l.default.createElement(p.default,{key:e.mountClassName,pubData:t,historyData:C,discussions:e.discussions,mountClassName:e.mountClassName,updateLocalData:O,sideContentRef:i,mainContentRef:a,prevNewDiscussionIds:M,prevConvertedDiscussionIds:N}),n):null})),l.default.createElement("div",{className:"discussion-list"},(F=r(I),L=I.filter((function(e){return e&&!e.isClosed})).length>0?"No matching comments (some are hidden by filters)":T||A?" Why not start the discussion?":"",l.default.createElement(l.default.Fragment,null,E&&l.default.createElement(b.default,{discussionData:{id:void 0},isPubBottomInput:!0}),0===F.length&&l.default.createElement(d.NonIdealState,{className:"empty-state",icon:"comment",title:"No comments here",description:L}),F.map((function(e){return l.default.createElement(h.default,{key:e.id,pubData:t,discussionData:e,updateLocalData:O,canPreview:!0,searchTerm:g||void 0})}))))))}},,,,,,function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1525);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(3)),s=l(n(1526)),d=l(n(294));n(1530);t.default=function(e){var t=e.pubData,n=e.updateLocalData,r=e.discussions,a=e.sideContentRef,i=e.mainContentRef,l=e.mountClassName,f=e.prevNewDiscussionIds,m=e.prevConvertedDiscussionIds,p=o((0,u.useState)(void 0),2),h=p[0],b=p[1],v=o((0,u.useState)(void 0),2),y=v[0],g=v[1],_=o((0,u.useState)(!1),2),E=_[0],P=_[1],w=i.current.getBoundingClientRect(),O=a.current.getBoundingClientRect();(0,u.useEffect)((function(){var e=r.reduce((function(e,t){var n=!t.number,r=f.current.includes(t.id);return n&&!r?t.id:e}),void 0);e&&(f.current.push(e),g(e));var t=r.reduce((function(e,t){var n=!t.number,r=f.current.includes(t.id),a=m.current.includes(t.id);return n||!r||a?e:t.id}),void 0);t&&(m.current.push(t),g(t))}),[f,m,r]),(0,u.useEffect)((function(){document.getElementsByClassName(l)[0].style.display=y&&E?"block":"inline"}),[l,E,y]);var C=r.find((function(e){return e.id===y})),S={left:O.left-w.left,width:O.width};return u.default.createElement("span",{className:(0,c.default)({"discussion-group-component":!0,active:y,expanded:E&&y}),style:S,tabIndex:-1},u.default.createElement(s.default,{key:E&&y,discussions:r,activeThreadHover:h,setActiveThreadHover:b,activeThread:y,setActiveThread:g,isExpanded:E,setExpanded:P}),C&&u.default.createElement(d.default,{pubData:t,discussionData:C,updateLocalData:n}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(80)),d=n(5),f=n(6),m=n(9),p=u(n(1527));n(1529);var h=function(e){return e.thread.comments.map((function(e){return e.author.fullName})).filter((function(e,t,n){return n.indexOf(e)===t})).join(", ")},b=function(e){var t=e.discussions,n=e.activeThreadHover,a=e.activeThread,i=e.setActiveThread,o=e.setActiveThreadHover,u=e.isExpanded,b=e.setExpanded,v=(0,m.usePageContext)(),y=v.communityData,g=v.loginData,_=l((0,c.useState)(!1),2),E=_[0],P=_[1],w=l((0,c.useState)(!1),2),O=w[0],C=w[1],S={color:y.accentColorDark,borderBottom:a?"1px solid "+y.accentColorDark:"1px solid transparent"},D=(0,s.default)(y.accentColorDark).fade(.5).rgb().string(),k=function(e){return{onMouseEnter:function(){o(e.id)},onMouseLeave:function(){o(void 0)},onClick:function(){var t=a===e.id?void 0:e.id;i(t)}}},j=function(e){var t=e.discussions,n=e.loginData,a=e.communityData,i=e.activeThreadHover,o=e.activeThread,l=e.getHandlersForDiscussion;return function(e){var u=i===e.id||o===e.id,s=e.thread.comments.some((function(e){return e.userId===n.id})),d=e.number&&e.thread.comments.length,f=1===t.length&&e.number&&h(t[0]);return c.default.createElement(p.default,r({},l(e),{key:e.id,color:a.accentColorDark,count:d,isActive:u,label:f,showDot:s}))}}({discussions:t,loginData:g,communityData:y,activeThreadHover:n,activeThread:a,getHandlersForDiscussion:k}),M=t.slice(0,7),N=t.slice(7);return c.default.createElement("span",{className:"discussion-nav-component",style:S},c.default.createElement("style",null,".d-"+n+", .lh-"+n+" { background-color: rgba(0, 0, 0, 0.2) !important; }"),c.default.createElement("style",null,".d-"+a+", .lh-"+a+" { background-color: "+D+" !important; }"),M.map(j),!!N.length&&c.default.createElement(d.Popover,{minimal:!0,transitionDuration:-1,isOpen:O,onClose:function(){return C(!1)},content:c.default.createElement(d.Menu,null,N.map((function(e,t){return c.default.createElement(d.MenuItem,r({},k(e),{key:t,icon:j(e),text:h(e)}))})))},c.default.createElement(p.default,{isActive:!!E||!!O||!(!a||!N.some((function(e){return e.id===a.id}))),onMouseEnter:function(){return P(!0)},onMouseLeave:function(){return P(!1)},onClick:function(){return C(!0)},color:y.accentColorDark,count:c.default.createElement(f.Icon,{icon:"more",iconSize:10,className:"overflow-icon"}),showDot:N.some((function(e){return e.thread.comments.some((function(e){return e.userId===g.id}))}))})),a&&t.length>1&&c.default.createElement(c.default.Fragment,null,c.default.createElement(d.Button,{minimal:!0,small:!0,className:"caret-button",icon:c.default.createElement(f.Icon,{icon:"caret-left",color:y.accentColorDark}),onClick:function(){var e=t.reduce((function(e,t,n){return a===t.id?n:e}),0),n=t[(t.length+e-1)%t.length].id;i(n)}}),c.default.createElement(d.Button,{minimal:!0,small:!0,className:"caret-button",icon:c.default.createElement(f.Icon,{icon:"caret-right",color:y.accentColorDark}),onClick:function(){var e=t.reduce((function(e,t,n){return a===t.id?n:e}),0),n=t[(t.length+e+1)%t.length].id;i(n)}})),a&&c.default.createElement("div",{className:"close-wrapper"},c.default.createElement(d.Button,{className:"expand-button",minimal:!0,small:!0,icon:c.default.createElement(f.Icon,{className:"expand-icon",icon:u?"collapse-all":"expand-all",iconSize:12,color:y.accentColorDark}),onClick:function(){b(!u)}}),c.default.createElement(d.Button,{minimal:!0,small:!0,icon:c.default.createElement(f.Icon,{icon:"small-cross",color:y.accentColorDark}),onClick:function(){i(void 0)}})))};b.defaultProps={activeThreadHover:void 0,activeThread:void 0},t.default=b},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5);n(1528);var o=function(e){var t=e.color,n=e.count,r=e.isActive,o=e.label,l=e.onClick,u=e.onMouseEnter,c=e.onMouseLeave,s=e.showDot,d=r?{border:"1px solid "+t,background:t,color:"white"}:{border:"1px solid "+t};return a.default.createElement("span",{className:"discussion-bubble-component",role:"button",tabIndex:0,onMouseEnter:u,onMouseLeave:c,onClick:l},a.default.createElement("span",{className:"bubble",style:d},n||a.default.createElement(i.Icon,{icon:"dot",color:r?"white":t}),s&&a.default.createElement("span",{className:"bubble-dot",style:{border:"1px solid "+t}})),o&&a.default.createElement("span",{className:"label"},o))};o.defaultProps={count:null,label:null,onClick:null,onMouseEnter:null,onMouseLeave:null},t.default=o},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),u=n(35),c=n(9),s=n(6),d=n(216),f=n(39),m=i(n(225));t.default=function(e){var t=e.pubData,n=(0,c.usePageContext)(),r=n.locationData,a=n.communityData,i=(0,f.usePubContext)().updateLocalData,o=(0,d.chooseCollectionForPub)(t,r),p=(0,d.useCollectionPubs)(i,o).pubs,h=(0,d.getNeighborsInCollectionPub)(p,t).nextPub,b=(o||{}).readNextPreviewSize;return"none"!==(void 0===b?"choose-best":b)&&h&&o&&h?l.default.createElement(m.default,{isExpandable:!1,title:"Read Next",centerItems:l.default.createElement(m.SectionBullets,null,l.default.createElement("a",{href:(0,d.createReadingParamUrl)((0,u.pubUrl)(a,h),o.id)},l.default.createElement(s.PubTitle,{pubData:h})))}):null}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1535);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=n(5),d=n(41),f=u(n(1536));n(1543);t.default=function(e){var t=e.editorChangeObject.view,n=l((0,c.useState)(Date.now()),2),a=n[0],i=n[1],o=l((0,c.useState)(!1),2),u=o[0],m=o[1],p=l((0,c.useState)(!1),2),h=p[0],b=p[1],v=t&&t.state;return(0,c.useEffect)((function(){!!v&&(0,d.viewIsEmpty)(v)?m(!0):h||(i(Date.now()),m(!1))}),[v,h]),c.default.createElement(c.default.Fragment,null,u&&c.default.createElement("div",{className:"pub-file-import-component"},c.default.createElement(s.AnchorButton,{type:"button",className:"bp3-intent-primary bp3-large",outlined:!0,onClick:function(){return b(!0)},text:c.default.createElement("div",null,c.default.createElement("div",null,"Import Files"),c.default.createElement("div",null,".docx, .epub, .html, .md, .odt, .txt, .xml, or .tex"))})),c.default.createElement(f.default,r({},e,{key:a,isOpen:h,onClose:function(){return b(!1)},onClosed:function(){return i(Date.now())}})))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=o(n(0)),m=d(n(3)),p=d(n(185)),h=n(71),b=n(5),v=n(57),y=n(496),g=n(18),_=n(490),E=n(41),P=n(1537),w=n(296),O=d(n(1538)),C=d(n(1540));n(1542);var S=["extractEndnotes","keepStraightQuotes","skipJatsBibExtraction"],D=Object.keys(y.extensionToPandocFormat).map((function(e){return"."+e})),k=y.bibliographyFormats.map((function(e){return"."+e})),j=s(s(s([],c(D),!1),c(k),!1),["image/*","application/pdf"],!1).join(","),M=function(e){return e.map((function(e){return e.clientPath+"_"+e.label})).sort((function(e,t){return e-t})).join("___")};t.default=function(e){var t=e.editorChangeObject,n=e.updatePubData,a=e.isOpen,i=e.onClose,o=e.onClosed,s=(0,P.useFileManager)(),d=s.addFile,y=s.getFiles,N=s.deleteFileById,I=s.labelFileById,x=y(),T=x.filter((function(e){return"complete"!==e.state})),A=x.some((function(e){return"document"===e.label})),R=c((0,f.useState)({}),2),B=R[0],F=R[1],L=c((0,f.useState)({}),2),U=L[0],z=L[1],H=c((0,f.useState)(!1),2),V=H[0],q=H[1],W=c((0,f.useState)(!1),2),G=W[0],K=W[1],J=c((0,f.useState)(!1),2),Y=J[0],$=J[1],Q=c((0,f.useState)(""),2),Z=Q[0],X=Q[1],ee=c((0,f.useState)(null),2),te=ee[0],ne=ee[1],re=!!U&&Z===M(x),ae=!A||T.length>0||V,ie=U.doc,oe=U.warnings,le=void 0===oe?[]:oe,ue=U.pandocErrorOutput,ce=U.error,se=U.proposedMetadata,de=se&&Object.keys(se).length>0;(0,h.useKeyPressEvent)("/",(function(e){e.metaKey&&$(!0)}));var fe=function(){z({}),ne(null)},me=function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return K(!0),te?[4,te()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[4,(0,E.importDocJson)(t.view,ie)];case 3:return e.sent(),i(),[2]}}))}))},pe=function(){q(!0),(0,g.apiFetch)("/api/import",{method:"POST",body:JSON.stringify({sourceFiles:x,importerFlags:B,useNewImporter:!0})}).then((function(e){return(0,_.pingTask)(e,1e3)})).then((function(e){q(!1),z(e),X(M(x))})).catch((function(e){return z({error:{message:e.toString(),stack:e.stack}})}))},he=function(e){return f.default.createElement(p.default,{accept:j,onDrop:function(e){return e.map(d)},children:e})};return f.default.createElement(b.Drawer,{className:"file-import-dialog-component",title:"Import to Pub",isOpen:a,onClose:i,onClosed:o,canOutsideClickClose:!1},f.default.createElement(v.MenuConfigProvider,{config:{usePortal:!1}},f.default.createElement("div",{className:b.Classes.DRAWER_BODY},f.default.createElement("div",{className:b.Classes.DIALOG_BODY},!de&&(V?f.default.createElement("div",{className:"in-progress"},f.default.createElement(b.Spinner,{size:50,className:"drop-area-icon"}),f.default.createElement("span",{"aria-live":"assertive"},"Importing your document...")):f.default.createElement(b.ButtonGroup,{className:"drop-area-container",vertical:!0},he((function(e){var t,n=e.getRootProps,a=e.getInputProps;return f.default.createElement(f.default.Fragment,null,f.default.createElement(b.Button,r({},n(),{className:"file-drop-area"}),f.default.createElement(b.NonIdealState,{icon:"paperclip",description:f.default.createElement(f.default.Fragment,null,"Click here or drag in files to upload them",f.default.createElement("div",{className:"supported-formats"},(t=f.default.createElement("ul",{className:"supported-formats-tooltip"},f.default.createElement("li",null,"Supports ",f.default.createElement("i",null,"documents")," in these formats: ",D.join(", "),". You can also use one or more documents as ",f.default.createElement("i",null,"supplements")," to be passed to the converter, for instance if your document is a .tex file and relies on one or more other .tex files."),f.default.createElement("li",null,"Supports ",f.default.createElement("i",null,"bibliographies")," in these formats:"," ",k.join(", "),"."),f.default.createElement("li",null,"Supports all image formats, though you may wish to convert your images to a format with wide browser support (.jpeg, .jpg, .png, .svg, or .gif).")),f.default.createElement(f.default.Fragment,null,f.default.createElement(b.Tooltip,{content:t},f.default.createElement("span",{className:b.Classes.TOOLTIP_INDICATOR},"What can I import?")),f.default.createElement("div",{className:"screenreader-only"},t)))))})),f.default.createElement("input",r({},a(),{multiple:!0})))})),he((function(e){var t=e.getRootProps,n=e.getInputProps;return f.default.createElement(f.default.Fragment,null,f.default.createElement("input",r({},n(),{webkitdirectory:""})),f.default.createElement(b.Button,r({},t(),{className:"directory-drop-area",text:"Or, click here to upload an entire directory"})))})))),!V&&function(){if(ce)return f.default.createElement(b.Callout,{className:"import-result",title:"Import error",intent:"danger"},ce.message?ce.message:ce.toString(),ce.stack&&f.default.createElement("details",null,f.default.createElement("summary",null,"Technical details"),f.default.createElement("pre",null,ce.stack)));if(ie){var e=le.filter((function(e){return"missingImage"===e.type})).map((function(e){return e.path})),t=le.filter((function(e){return"missingCitation"===e.type})).map((function(e){return e.id}));return e.length>0||t.length>0||ue?f.default.createElement(b.Callout,{"aria-live":"assertive",className:"import-message",title:"Import warnings",intent:"warning"},f.default.createElement("ul",null,e.length>0&&f.default.createElement("li",null,f.default.createElement("i",null,"Your document contains references external images which you may wish to upload."),f.default.createElement("details",null,f.default.createElement("summary",null,"Missing images"),e.join(", "),".")),t.length>0&&f.default.createElement("li",null,f.default.createElement("i",null,"Some citations in the document could not be matched to a bibliography item. You may wish to upload an external bibliography (e.g. a .bib file)."),f.default.createElement("details",null,f.default.createElement("summary",null,"Missing citation IDs"),t.join(", "),".")),ue&&f.default.createElement("li",null,f.default.createElement("i",null,"Conversion from LaTeX to HTML succeeded, with information (",f.default.createElement("a",{href:"https://help.pubpub.org/pub/latex-compatibility"},"more about PubPub and LaTeX"),"):"),f.default.createElement("details",null,f.default.createElement("pre",null,ue)))),f.default.createElement(b.Button,{onClick:fe},"Add more files")):f.default.createElement(b.Callout,{"aria-live":"polite",className:"import-message",title:"Import succeeded",intent:"success"})}return x.length>0&&x.every((function(e){return"pdf"===(0,w.extensionFor)(e.clientPath)}))?f.default.createElement(b.Callout,{"aria-live":"polite",className:"import-message",title:"PDFs are supported as images only",intent:"primary"},"PubPub does not import text content from PDFs; they may only be imported as images referenced from another document."):null}(),!de&&f.default.createElement("div",{className:"files-listing"},f.default.createElement("div",{className:"screenreader-only","aria-live":"polite"},T.length>0?x.length-T.length+" of "+x.length+" files uploaded.":x.length+" files uploaded."),x.map((function(e,t){return f.default.createElement(O.default,{key:t,file:e,onDelete:function(){return N(e.id)},onLabelFile:function(t){return I(e.id,t)}})}))),de&&f.default.createElement(f.default.Fragment,null,f.default.createElement("p",{className:"metadata-info"},"Some metadata was found in the imported document that you may wish to apply to your Pub. You can always change these values later."),f.default.createElement(C.default,{proposedMetadata:se,onSetMetadataUpdater:ne,updatePubData:n})))),f.default.createElement("div",{className:(0,m.default)(b.Classes.DRAWER_FOOTER,"dialog-footer")},Y?f.default.createElement(b.Popover,{minimal:!0,content:f.default.createElement(b.Menu,null,f.default.createElement(b.MenuItem,{onClick:pe,icon:"refresh",text:"Force retry import"}),f.default.createElement("li",{className:"bp3-menu-header"},f.default.createElement("h6",{className:"bp3-heading"},"Experimental flags")),S.map((function(e){var t=!!B[e];return f.default.createElement(b.MenuItem,{key:e,icon:t?"tick":"blank",onClick:function(){return F((function(n){var a;return r(r({},n),((a={})[e]=!t,a))}))},text:e})})))},f.default.createElement(b.Button,{icon:"flame"},"Extras")):null,f.default.createElement(b.Button,{onClick:i},"Cancel"),de&&f.default.createElement(b.Button,{onClick:fe,icon:"chevron-left"},"Add files"),(!ie||!re)&&f.default.createElement(b.Button,{intent:"primary",icon:ie?"refresh":"import",onClick:pe,disabled:ae},ie?"Retry import":"Import"),ie&&re&&f.default.createElement(b.Button,{intent:"success",icon:"tick",onClick:me,disabled:V,loading:G},"Complete import"))))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.useFileManager=void 0;var o=n(0),l=n(98),u=n(296),c=0;t.useFileManager=function(){var e=a((0,o.useState)([]),2),t=e[0],n=e[1],s=function(e,t){return n((function(n){return n.some((function(t){return t.id===e}))?(0,u.labelFiles)(n.map((function(n){return n.id===e?r(r({},n),t):n}))):n}))};return{addFile:function(e){var t=c,r=e.path||e.name;c+=1,(0,l.s3Upload)(e,function(e){return function(t){var n=t.loaded,r=t.total;return s(e,{state:"uploading",loaded:n,total:r})}}(t),function(e){return function(t,n,r,a){return s(e,{state:"complete",assetKey:a})}}(t)),n((function(e){return i(i([],a(e),!1),[{id:t,state:"waiting",clientPath:r}],!1)}))},getFiles:function(){return t},deleteFileById:function(e){return n((function(t){return(0,u.labelFiles)(t.filter((function(t){return t.id!==e})))}))},labelFileById:function(e,t){var a=u.exclusiveFileLabels.includes(t);n((function(n){return(0,u.labelFiles)(n.map((function(n){var i=n.label,o=e===n.id?t:i===t&&a?null:i;return r(r({},n),{label:o})})))}))}}}},function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(5),u=n(296);n(1539);t.default=function(e){var t,n,i=e.file,c=e.onDelete,s=e.onLabelFile,d=i.loaded,f=i.total,m=i.state,p=i.clientPath,h=i.label,b=Math.max(p.length-5,0),v=p.slice(0,b),y=p.slice(b);return o.default.createElement("div",{className:"file-import-entry"},o.default.createElement("div",{className:"file-title",title:p},o.default.createElement("span",{className:"start","aria-label":p},o.default.createElement("span",{"aria-hidden":"true"},v)),o.default.createElement("span",{className:"end","aria-hidden":"true"},y),o.default.createElement("div",{className:"file-label"},(t=(0,u.getPotentialLabelsForFile)(i),n=h&&"none"!==h,0===t.length?null:o.default.createElement(l.Popover,{content:o.default.createElement(l.Menu,null,o.default.createElement("h6",{className:l.Classes.MENU_HEADER},"Use as..."),a(["none"],r(t),!1).map((function(e){var t="none"===e?o.default.createElement("i",null,"(none)"):e;return o.default.createElement(l.MenuItem,{key:t,text:t,onClick:function(){return s(e)}})})))},n?o.default.createElement(l.Tag,{interactive:!0,intent:"success"},h):o.default.createElement(l.Tag,{interactive:!0,icon:"locate"},"use as..."))))),o.default.createElement("div",{className:"file-progress"},"complete"===m?o.default.createElement(o.default.Fragment,null,o.default.createElement(l.Icon,{icon:"tick",iconSize:14}),"Uploaded"):"waiting"===m?"Preparing to upload":o.default.createElement(o.default.Fragment,null,o.default.createElement("span",{className:"screenreader-only"},Math.round(100*d/f),"% complete"),o.default.createElement(l.ProgressBar,{value:"uploading"===m?d/f:void 0}))),o.default.createElement(l.Button,{"aria-label":"delete",onClick:c,className:"file-delete-button",icon:"small-cross",small:!0,minimal:!0}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function l(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}u((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=o(n(0)),m=d(n(3)),p=n(5),h=n(6),b=n(57),v=n(9),y=n(35),g=n(342),_=n(18),E=n(39);n(1541);var P=function(e){var t=e.attribution,n=e.onUpdateAttribution,r=t.name,a=t.users,i=t.matchedUser,o=t.ignored,l=function(){n(o?{ignored:!1}:{ignored:!0,matchedUser:null})};return f.default.createElement("div",{className:"proposed-attribution"},f.default.createElement(h.Avatar,{width:20,initials:i?i.initials:(0,g.getPartsOfFullName)(r).initials,avatar:i&&i.avatar}),f.default.createElement("div",{className:(0,m.default)("name",o&&"ignored")},i?f.default.createElement("a",{href:(0,y.profileUrl)(i.slug),target:"_blank",rel:"noopener noreferrer"},i.fullName):r),f.default.createElement("div",{className:"controls"},!a||0===a.length||o?null:i?f.default.createElement(p.Button,{small:!0,minimal:!0,onClick:function(){return n({matchedUser:null})}},"Unmatch user"):f.default.createElement(b.MenuButton,{"aria-label":"Match to PubPub user",buttonProps:{minimal:!0,small:!0,rightIcon:"chevron-down",icon:f.default.createElement("span",{className:"matched-users-avatars"},a.slice(0,3).map((function(e){return f.default.createElement(h.Avatar,{width:20,avatar:e.avatar,borderColor:"white",doesOverlap:!0})})))},buttonContent:a.length+" matching "+(1===a.length?"user":"users"),placement:"bottom-end"},a.map((function(e){return f.default.createElement(b.MenuItem,{text:e.fullName,icon:f.default.createElement(h.Avatar,{width:20,avatar:e.avatar,initials:e.initials}),key:e.id,onClick:function(){return n({matchedUser:e})}})}))),f.default.createElement(p.Button,{"aria-label":o?"Add "+r+" to Pub attribution":"Remove "+r+" from Pub attribution",onClick:l,icon:o?"small-plus":"small-cross",small:!0,minimal:!0})))};t.default=function(e){var t=e.onSetMetadataUpdater,n=e.proposedMetadata,a=s((0,f.useState)(n),2),i=a[0],o=a[1],d=(0,v.usePageContext)().communityData,m=(0,E.usePubContext)(),h=m.pubData,b=m.updatePubData,y=s((0,f.useState)({}),2),g=y[0],w=y[1],O=i.attributions,C=c(i,["attributions"]);(0,f.useEffect)((function(){o(n),w({})}),[n]),(0,f.useEffect)((function(){t((function(){return function(){return Promise.all([l(void 0,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e={},Object.keys(C).forEach((function(t){g[t]||(e[t]=C[t])})),Object.keys(e).length>0?[4,_.apiFetch.put("/api/pubs",r({pubId:h.id,communityId:d.id},e))]:[3,2];case 1:t.sent(),b(e),t.label=2;case 2:return[2]}}))})),l(void 0,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return O&&(e=O.filter((function(e){return!e.ignored})).map((function(e){var t=e.name,n=e.matchedUser;return{name:t,userId:n&&n.id,isAuthor:!0}}))).length>0?[4,_.apiFetch.post("/api/pubAttributions/batch",{communityId:d.id,pubId:h.id,attributions:e})]:[3,2];case 1:t=n.sent(),b({attributions:t}),n.label=2;case 2:return[2]}}))}))])}}))}),[g,i]);var S=function(e,t){void 0===t&&(t=!1);var n=t?p.TextArea:p.InputGroup,a=i[e],l=g[e];return null==a?null:f.default.createElement("div",{className:"field-entry"},f.default.createElement(p.Checkbox,{checked:!l,label:"Use imported "+e,onChange:function(){return w((function(t){var n;return r(r({},t),((n={})[e]=!l,n))}))}}),f.default.createElement(n,{disabled:l,value:a,onChange:function(t){var n=t.target.value;o((function(t){var a;return r(r({},t),((a={})[e]=n,a))}))}}))};return f.default.createElement("div",{className:"metadata-editor-component"},f.default.createElement("h6",null,"Metadata"),S("title"),S("description"),O&&O.length?f.default.createElement(f.default.Fragment,null,f.default.createElement("h6",null,"Authors"),O.map((function(e,t){return f.default.createElement(P,{key:t,attribution:e,onUpdateAttribution:function(e){return n=t,a=e,(l=O.concat()).splice(n,1,r(r({},O[n]),a)),void o(r(r({},i),{attributions:l}));var n,a,l}})}))):null)}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(3)),o=n(183),l=n(116),u=n(9),c=n(39),s=r(n(1545)),d=r(n(1546)),f=r(n(1548));n(1550);t.default=function(e){var t,n=e.disabled,r=e.editorWrapperRef,m=(0,u.usePageContext)().scopeData.activePermissions,p=m.canEdit,h=m.canEditDraft,b=(0,c.usePubContext)({immediate:!0}),v=b.pubBodyState.isReadOnly,y=b.collabData,g=y.editorChangeObject;if((0,o.useSticky)({target:".pub-draft-header-component",isActive:!n,offset:37}),!p&&!h||v)return null;var _=null===(t=null==g?void 0:g.view)||void 0===t?void 0:t.state;return a.default.createElement("div",{className:(0,i.default)("pub-draft-header-component",n&&"disabled")},a.default.createElement(l.FormattingBar,{buttons:l.buttons.fullButtonSet,editorChangeObject:g||{},controlsConfiguration:{container:r.current,isAbsolutelyPositioned:!0,isFullScreenWidth:!0}}),a.default.createElement("div",{className:"right-content"},_&&a.default.createElement(f.default,{doc:_.doc}),a.default.createElement(s.default,{collabData:y}),a.default.createElement(d.default,null)))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6);t.default=function(e){var t=e.collabData,n=function(e,t){var n={};e.forEach((function(e){"?"!==e.initials&&(n[e.id]=e)}));var r=Math.max(0,e.reduce((function(e,t){return"?"===t.initials?e+1:e}),0)-(t?1:0));return r&&(n.anon={backgroundColor:"rgba(96,96,96, 0.2)",cursorColor:"rgba(96,96,96, 1.0)",id:"anon",initials:r,name:r+" anonymous user"+(1===r?"":"s")}),n}(t.remoteCollabUsers,!t.localCollabUser.id);return a.default.createElement("div",null,Object.keys(n).map((function(e){return n[e]})).filter((function(e){return e})).map((function(e){return a.default.createElement("div",{className:"avatar-wrapper",key:"present-avatar-"+e.id},a.default.createElement(i.Tooltip,{content:e.name,tooltipClassName:"bp3-dark"},a.default.createElement(o.Avatar,{initials:String(e.initials),avatar:e.image,borderColor:e.cursorColor,borderWidth:"2px",width:24})))})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(71),c=n(39);n(1547);t.default=function(){var e=(0,c.usePubContext)().collabData.status,t=(0,l.useRef)(null),n=(0,u.usePrevious)(e),r=o((0,l.useState)(e),2),a=r[0],i=r[1];return(0,l.useEffect)((function(){t.current&&clearTimeout(t.current),"connecting"===n&&"connected"===e&&i(e),"connecting"!==n&&"disconnected"!==n&&("saving"===a?t.current=setTimeout((function(){return i(e)}),250):i(e)),"disconnected"===n&&"connected"===e&&i(e)}),[n,e,a]),l.default.createElement("span",{className:"pub-connection-status-indicator-component "+a},a,"saving"===a||"connecting"===a?"...":"")}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5);n(1549);t.default=function(e){var t=e.doc,n=o((0,l.useState)(!1),2),r=n[0],a=n[1],i=(0,l.useMemo)((function(){return r?[(n=(e=t).textBetween(0,e.content.size," "," ")).split(" ").filter((function(e){return""!==e})).length,n.length]:null;var e,n}),[r,t]),c=l.default.createElement("div",{className:"pub-word-count-button-popover-content"},l.default.createElement("dl",null,l.default.createElement("dt",null,"Words"),l.default.createElement("dd",null,null==i?void 0:i[0].toLocaleString()),l.default.createElement("dt",null,"Characters"),l.default.createElement("dd",null,null==i?void 0:i[1].toLocaleString())));return l.default.createElement(u.Popover,{content:c,isOpen:r,minimal:!0,position:"bottom-right",popoverClassName:"pub-word-count-button-popover",targetClassName:"pub-word-count-button-target"},l.default.createElement(u.Button,{role:"button",className:"bp3-button bp3-minimal",onClick:function(){return a(!r)},onBlur:function(){return a(!1)}},l.default.createElement(u.Icon,{icon:"timeline-line-chart"})))}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(n(0)),s=u(n(3)),d=n(5),f=u(n(117)),m=n(35),p=n(67),h=n(9),b=n(99),v=n(6);n(1552);t.default=function(e){var t=e.pubData,n=e.historyData,a=(0,h.usePageContext)().communityData,i=t.releases,o=t.releaseNumber,u=t.isRelease,y=n.currentKey,g=n.latestKey,_=n.timestamps,E=n.loadedIntoHistory,P=u&&o!==i.length,w=E,O=u?"Release (#"+o+")":"draft",C=l((0,c.useState)(!1),2),S=C[0],D=C[1];if(!w&&!P)return null;var k=function(){return D(!S)};return c.default.createElement("div",{className:"pub-historical-notice-component"},c.default.createElement(d.Callout,{icon:"history",intent:"warning",title:"You're viewing an older "+O+" of this Pub."},function(){if(u&&"number"==typeof o){var e=new Date(i[o-1].createdAt),n=(0,b.getPubLatestReleasedDate)(t),a=(0,p.datesAreSameCalendarDate)(e,n);return c.default.createElement("ul",{className:"warning-desc"},c.default.createElement("li",null,"This Release ",c.default.createElement("b",null,"(#",o,")")," was created"," ",(0,p.formatDate)(e,{includeTime:a,includePreposition:!0})," ",c.default.createElement("span",{className:"humanized-time"},"(",c.default.createElement(f.default,r({},p.timeAgoBaseProps,{date:e})),")")),c.default.createElement("li",null,"The latest Release ",c.default.createElement("b",null,"(#",t.releases.length,")")," was created"," ",(0,p.formatDate)(n,{includeTime:a,includePreposition:!0})," ",c.default.createElement("span",{className:"humanized-time"}," (",c.default.createElement(f.default,r({},p.timeAgoBaseProps,{date:n})),").")))}var l=new Date(_[y]),s=new Date(_[g]),d=(0,p.datesAreSameCalendarDate)(l,s);return c.default.createElement("p",null,"You're viewing a draft of this Pub as it appeared"," ",(0,p.formatDate)(l,{includeTime:d,includePreposition:!0}),". It was most recently updated"," ",(0,p.formatDate)(s,{includeTime:d,includePreposition:!0}),". See the latest draft to make changes and view comments.")}(),c.default.createElement("div",null,c.default.createElement(d.AnchorButton,{className:"callout-button",intent:"primary",outlined:!0,href:(0,m.pubUrl)(a,t,{isDraft:!u})},u?"Go to latest Release":"Go to latest draft"),u&&c.default.createElement(d.AnchorButton,{className:"callout-button changelog-button",intent:"primary",outlined:!0,onClick:k,rightIcon:S?"collapse-all":"expand-all"},S?"Hide Changelog":"Show Changelog"))),function(){if(u){var e=i.map((function(e,n){var l=n+1,u=l===i.length,h=l===o,b=(0,m.pubUrl)(a,t,{releaseNumber:l}),y=e.noteText||"",g=(0,p.formatDate)(new Date(e.createdAt),{includeTime:!0});return c.default.createElement("div",{className:"release-item",key:e.createdAt},c.default.createElement("div",{className:"item-block"},c.default.createElement("div",{className:"icon-button"},c.default.createElement(d.Icon,{className:"release-icon",icon:h?"tick":"document-share"}),c.default.createElement(v.ClickToCopyButton,{minimal:!0,className:"copy-button",icon:"duplicate",tooltipPosition:"right",beforeCopyPrompt:"Copy link to Release #"+l,afterCopyPrompt:"Copied link!",copyString:b})),c.default.createElement("div",{className:"release-metadata"},c.default.createElement("a",{className:"release-num",href:b},"Release #",l),c.default.createElement("p",{className:"release-timestamp-humanized"},c.default.createElement(f.default,r({},p.timeAgoBaseProps,{date:e.createdAt}))),c.default.createElement("p",{className:"release-timestamp"},g),(h||u)&&c.default.createElement("p",{className:"release-label"},u&&"latest",h&&"now viewing"))),c.default.createElement("div",{className:"item-block"},c.default.createElement(d.Icon,{className:"note-icon",icon:"manually-entered-data",iconSize:12}),c.default.createElement("div",{className:(0,s.default)("note",!y&&"empty"),dangerouslySetInnerHTML:{__html:y||"No Release Note"}})))})).reverse();return c.default.createElement(d.Collapse,{className:"changelog",isOpen:S},c.default.createElement(d.Callout,{icon:"properties",intent:"primary",className:"changelog-callout",title:"Changelog"},e))}return null}())}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(260)),o=n(5),l=n(35),u=n(9),c=n(6),s=n(116),d=n(41),f=n(39);n(1554);t.default=function(){var e=(0,f.usePubContext)(),t=e.pubData,n=e.collabData,r=e.historyData,m=e.pubBodyState,p=(0,u.usePageContext)(),h=p.communityData,b=p.scopeData.activePermissions,v=b.canView,y=b.canCreateDiscussions,g=n.editorChangeObject.selection||{},_=n.editorChangeObject.selectionBoundingBox||{};if(!n.editorChangeObject.selection||g.empty||g.$anchorCell||n.editorChangeObject.selectedNode)return null;var E=window.scrollY+(["Android","iPad","iPhone"].some((function(e){return navigator.userAgent.toLowerCase().includes(e.toLowerCase())}))?_.bottom+10:_.top-50);return a.default.createElement("div",{className:"pub-inline-menu-component bp3-elevation-2",style:{position:"absolute",top:E,left:_.left}},m.isReadOnly?null:a.default.createElement(s.FormattingBar,{buttons:s.buttons.inlineMenuButtonSet,isTranslucent:!0,editorChangeObject:n.editorChangeObject,showBlockTypes:!1,controlsConfiguration:{kind:"none"}}),(v||y)&&m.canCreateAnchoredDiscussions&&a.default.createElement(o.Button,{"aria-label":"Start a discussion",title:"Start a discussion",minimal:!0,icon:a.default.createElement(c.Icon,{icon:"chat"}),onClick:function(){var e=n.editorChangeObject.view;(0,d.setLocalHighlight)(e,g.from,g.to,(0,i.default)()),(0,d.moveToEndOfSelection)(n.editorChangeObject.view)}}),a.default.createElement(c.ClickToCopyButton,{className:"click-to-copy",icon:"clipboard",copyString:(0,l.pubUrl)(h,t,{isDraft:!t.isRelease,releaseNumber:t.releaseNumber,historyKey:r.currentKey,query:{from:g.from,to:g.to}}),beforeCopyPrompt:"Copy a permalink"}))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(1556);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r(a).default}})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c,s=o(n(0)),d=n(497),f=u(n(1557));function m(e){return!!e&&("P"!==e.tagName||""!==e.textContent)}!function(e){e.ClickToCopy="click-to-copy"}(c||(c={}));t.default=function(e){var t=e.mainContentRef,n=l((0,s.useReducer)((function(e,t){var n;return r(r({},e),((n={})[t.type]=t.element,n))}),{}),2),a=n[0],i=n[1];(0,s.useEffect)((function(){var e,t=function(t){var n=t.target;if(n){var r=(0,d.getHighestAncestorWithId)(n,document.querySelector(".pub-body-component > .editor"));m(r)?(i({type:c.ClickToCopy,element:r}),clearTimeout(e)):n.matches(".click-to-copy, .click-to-copy *")&&clearTimeout(e)}},n=function(t){var n=t.target;n&&((m((0,d.getHighestAncestorWithId)(n,document.querySelector(".pub-body-component > .editor")))||n.matches(".click-to-copy, .click-to-copy *"))&&(e=setTimeout((function(){i({type:c.ClickToCopy})}),250)))};return document.addEventListener("mouseover",t),document.addEventListener("mouseout",n),function(){document.removeEventListener("mouseover",t),document.removeEventListener("mouseout",n)}}),[]);var o=a[c.ClickToCopy];return s.default.createElement("div",{className:"pub-link-controller-component"},o&&s.default.createElement(f.default,{element:o,mainContentRef:t}))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),l=n(499),u=n(6),c=n(497),s=n(9),d=n(35),f=n(39);t.default=function(e){var t=e.element,n=e.mainContentRef,r=(0,c.getLowestAncestorWithId)(t),a=(0,o.useRef)(null),i=(0,f.usePubContext)(),m=i.pubData,p=i.pubBodyState,h=(0,s.usePageContext)(),b=h.communityData,v=h.scopeData.activePermissions.canManage;(0,o.useEffect)((function(){var e=a.current;if(r&&e){var t=(0,l.createPopper)(r,e,{placement:r.matches("h1, h2, h3, h4, h5, h6")?"left":"left-start"});return function(){t.destroy()}}return function(){}}),[r,n]);var y=Boolean(r&&/^r[0-9]*$/.test(r.id)),g=m.releaseNumber===m.releases.length,_=p.isReadOnly&&g&&y&&v?"You must create a new Release to link to this block.":"";return!y||_?o.default.createElement("div",{ref:a,style:{position:"absolute",top:"-9999px"},className:"click-to-copy"},o.default.createElement(u.ClickToCopyButton,{copyString:(0,d.pubUrl)(b,m,{hash:null==r?void 0:r.id}),beforeCopyPrompt:_,disabled:y})):null}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(9);n(1559);t.default=function(e){var t=e.pubData.isInMaintenanceMode,n=(0,o.usePageContext)().scopeData.activePermissions.canManage;if(!t||!n)return null;return a.default.createElement(i.Callout,{icon:"diagnosis",intent:"warning",className:"pub-maintenance-notice-component",title:"This Pub is under maintenance."},a.default.createElement("p",null,"The PubPub team has identified a problem with this Pub and has placed it into read-only maintenance mode while we work to fix it. We apologize for the inconvenience and appreciate your patience!"),a.default.createElement(i.AnchorButton,{href:"mailto:help@pubpub.org"},"Contact us"))}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(1563)),s=n(5),d=n(6),f=n(88),m=n(433),p=n(451),h=n(9);n(1564);var b=function(e,t,n){var r=new URLSearchParams;e&&r.append("q",e),t&&r.append("page",t+1),"pubs"!==n&&r.append("mode",n);var a=r.toString();return"/search"+(a.length>0?"?"+a:"")};t.default=function(e){var t=e.searchData,n=(0,h.usePageContext)(),r=n.locationData,a=n.communityData,i=o((0,u.useState)(r.query.q||""),2),l=i[0],v=i[1],y=o((0,u.useState)([]),2),g=y[0],_=y[1],E=o((0,u.useState)(!!r.query.q||!1),2),P=E[0],w=E[1],O=o((0,u.useState)(r.query.page?Number(r.query.page)-1:0),2),C=O[0],S=O[1],D=o((0,u.useState)(0),2),k=D[0],j=D[1],M=o((0,u.useState)(r.query.mode||"pubs"),2),N=M[0],I=M[1],x=(0,h.useThrottled)(l,1e3,!1),T=(0,u.useRef)(null),A=(0,u.useRef)(null),R=(0,u.useRef)(null);(0,u.useEffect)((function(){var e=T.current;if(e){e.focus();var t=T.current.value;e.value="",e.value=t}}),[]),(0,u.useEffect)((function(){if(["pubs","pages"].indexOf(N)>-1){var e=void 0;"pubs"===N&&(e=t.pubsSearchKey),"pages"===N&&(e=t.pagesSearchKey),A.current=(0,c.default)(t.searchId,e),R.current=A.current.initIndex(N)}}),[N]),(0,u.useEffect)((function(){x.length>0&&(w(!0),R.current.search(x,{page:C}).then((function(e){w(!1),_(e.hits),j(Math.min(e.nbPages,10))}))),function(e,t,n){window.history.replaceState({},"",b(e,t,n))}(x,C,N)}),[x,C,N]);var B=new Array(k).fill(""),F=b(x,C,N);return u.default.createElement("div",{id:"search-container"},u.default.createElement("div",{className:"container narrow"},u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col-12"},u.default.createElement("div",{className:"search-header"},u.default.createElement("h2",null,"Search ",a.title),!r.isBasePubPub&&u.default.createElement("a",{href:"https://www.pubpub.org"+F},"Search all PubPub Communities")),u.default.createElement(s.InputGroup,{placeholder:"search...",value:l,onChange:function(e){v(e.target.value),S(0)},rightElement:P?u.default.createElement(s.Spinner,{size:35}):void 0,inputRef:T}))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col-12"},u.default.createElement(s.Tabs,{onChange:function(e){I(e),S(0),_([])},selectedTabId:N,large:!0,animate:!1},u.default.createElement(s.Tab,{id:"pubs",title:"Pubs"}),u.default.createElement(s.Tab,{id:"pages",title:"Pages"})))),u.default.createElement("div",{className:"row"},u.default.createElement("div",{className:"col-12"},!g.length&&l&&!P&&u.default.createElement(s.NonIdealState,{title:"No Results",visual:"search"}),!!g.length&&u.default.createElement("div",null,g.map((function(e){var t,n,a,i,o=(0,f.getResizedUrl)(e.avatar,"inside",800),l=(0,f.getResizedUrl)(e.communityAvatar,"inside",125,35);return"pubs"===N&&(t="https://"+e.communityDomain+"/pub/"+e.slug,n=e.avatar?{backgroundImage:'url("'+o+'")'}:{background:(0,p.generatePubBackground)(e.pubId)},a=e.pubId,i=e.isPublic||e.branchIsPublic),"pages"===N&&(t="https://"+e.communityDomain+"/"+e.slug,n=e.avatar?{backgroundImage:'url("'+o+'")'}:{background:(0,m.generatePageBackground)(e.pageId)},a=e.pageId,i=e.isPublic),u.default.createElement("div",{className:"result "+N,key:"result-"+a},u.default.createElement("div",null,u.default.createElement("a",{href:t,alt:e.title},u.default.createElement("div",{className:"banner-image",style:n}))),u.default.createElement("div",{className:"content"},u.default.createElement("div",{className:"title"},u.default.createElement("a",{href:t,alt:e.title,className:"pub-title"},e.title,!i&&u.default.createElement(d.Icon,{icon:"lock2"})),r.isBasePubPub&&u.default.createElement("div",{className:"community-title"},u.default.createElement("a",{href:"https://"+e.communityDomain,alt:e.communityTitle,style:{backgroundColor:e.communityColor,color:e.communityTextColor}},l&&u.default.createElement("img",{alt:e.communityTitle+" logo",src:l}),!l&&u.default.createElement("span",null,": ",e.communityTitle)))),"pubs"===N&&e.byline&&u.default.createElement("div",{className:"byline"},e.byline),u.default.createElement("div",{className:"description"},e.description)))})),k>1&&u.default.createElement("div",{className:"bp3-button-group bp3-large"},B.map((function(e,t){var n="page-button-"+t;return u.default.createElement(s.Button,{key:n,text:t+1,active:t===e,onClick:function(){S(t),window.scrollTo(0,0),_([])}})}))))))))}},,function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0});var l=i(n(0)),u=n(5),c=n(6),s=n(9),d=n(18);n(1566);t.default=function(){var e=(0,s.usePageContext)(),t=e.locationData,n=e.communityData,r=o((0,l.useState)(""),2),a=r[0],i=r[1],f=o((0,l.useState)(!1),2),m=f[0],p=f[1],h=o((0,l.useState)(!1),2),b=h[0],v=h[1],y=o((0,l.useState)(void 0),2),g=y[0],_=y[1],E=o((0,l.useState)(""),2),P=E[0],w=E[1],O=function(e){return e.preventDefault(),v(!0),_(void 0),(0,d.apiFetch)("/api/signup",{method:"POST",body:JSON.stringify({email:a.toLowerCase(),communityId:n.id,confirmEmail:P})}).then((function(){v(!1),p(!0)})).catch((function(e){v(!1),_(e)}))};return l.default.createElement("div",{id:"signup-container"},l.default.createElement(c.GridWrapper,{containerClassName:"small"},!m&&l.default.createElement("div",null,l.default.createElement("h1",null,"Signup"),!t.isBasePubPub&&l.default.createElement("p",null,"Signup to create a ",l.default.createElement("a",{href:"https://www.pubpub.org"},"PubPub")," ","account, which will work on ",l.default.createElement("b",null,n.title)," and all other PubPub communities."),l.default.createElement("form",{onSubmit:O},l.default.createElement(c.InputField,{label:"Email",placeholder:"example@email.com",value:a,onChange:function(e){i(e.target.value)},error:g}),l.default.createElement("input",{type:"search",className:"confirm-email",name:"confirmEmail",tabIndex:"-1",autoComplete:"new-user-street-address",onChange:function(e){return w(e.target.value)}}),l.default.createElement(u.Button,{name:"signup",type:"submit",className:"bp3-button bp3-intent-primary",onClick:O,text:"Signup",disabled:!a,loading:b})),l.default.createElement("a",{href:"/login",className:"switch-message"},"Already have a PubPub account? Click to Login")),m&&l.default.createElement(u.NonIdealState,{title:"Signup Successful",description:l.default.createElement("div",{className:"success"},l.default.createElement("p",null,"An email has been sent to ",l.default.createElement("b",null,a)),l.default.createElement("p",null,"Follow the link in that email to create your account.")),visual:"tick-circle",action:l.default.createElement(u.Button,{name:"resendEmail",type:"button",className:"bp3-button",onClick:O,text:"Resend Email",loading:b})})))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=n(5),o=n(6),l=n(9),u=r(n(1568)),c=r(n(1570)),s=r(n(1572));n(1574);t.default=function(e){var t=e.userData,n=(0,l.usePageContext)(),r=n.locationData,d=n.communityData,f=n.loginData,m=(t.attributions||[]).map((function(e){return e.pub})),p=!!f.id&&t.id===f.id,h=r.params.mode,b=d.id,v=m.filter((function(e){return!b||e.communityId===b})),y=m.filter((function(e){return b&&e.communityId!==b})),g=v.filter((function(e){return(e.attributions||[]).some((function(e){return e.user.id===t.id&&e.isAuthor}))})),_="authored"===h?g:v;return a.default.createElement("div",{id:"user-container"},"edit"===h&&a.default.createElement(s.default,{userData:t}),"edit"!==h&&a.default.createElement("div",null,a.default.createElement(o.GridWrapper,{containerClassName:"narrow"},a.default.createElement(u.default,{userData:t,isUser:p})),a.default.createElement(o.GridWrapper,{containerClassName:"narrow nav"},a.default.createElement(c.default,{userSlug:t.slug,activeTab:h,allPubsCount:v.length,authoredPubsCount:g.length})),!!y.length&&a.default.createElement(o.GridWrapper,{containerClassName:"narrow nav"},a.default.createElement("div",{className:"bp3-callout external-pubs-wrapper"},a.default.createElement("a",{href:"https://www.pubpub.org/user/"+t.slug,className:"bp3-button bp3-intent-primary"},"Go to Full Profile"),a.default.createElement("h5",null,y.length," pub",1===y.length?"":"s"," in other communities."),a.default.createElement("div",null,t.firstName," has published in other PubPub communities. Click to go to their full profile."))),a.default.createElement("div",{className:"container narrow content"},_.map((function(e){return a.default.createElement("div",{key:"pub-"+e.id,className:"row"},a.default.createElement("div",{className:"col-12"},a.default.createElement(o.PubPreview,{pubData:e,communityData:b?void 0:e.community,size:"medium"})))})),!_.length&&a.default.createElement(i.NonIdealState,{visual:"widget",title:"No Pubs",action:p&&!r.isBasePubPub?a.default.createElement("a",{href:"/pub/create",className:"bp3-button"},"Create New pub"):void 0}))))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10)),o=r(n(237)),l=r(n(58));n(1569);var u={userData:i.default.object.isRequired,isUser:i.default.bool},c=function(e){var t=[{id:0,value:e.userData.location,icon:a.default.createElement(l.default,{icon:"map-marker"})},{id:1,value:e.userData.website,icon:a.default.createElement(l.default,{icon:"link"}),href:e.userData.website},{id:2,value:e.userData.orcid,icon:a.default.createElement(l.default,{icon:"orcid"}),href:"https://www.orcid.org/"+e.userData.orcid},{id:3,value:e.userData.github,icon:a.default.createElement(l.default,{icon:"github"}),href:"https://github.com/"+e.userData.github},{id:4,value:e.userData.facebook,icon:a.default.createElement(l.default,{icon:"facebook"}),href:"https://www.facebook.com/"+e.userData.facebook},{id:5,value:e.userData.twitter,icon:a.default.createElement(l.default,{icon:"twitter"}),href:"https://twitter.com/"+e.userData.twitter},{id:6,value:e.userData.googleScholar,icon:a.default.createElement(l.default,{icon:"google-scholar"}),href:"https://scholar.google.com/citations?user="+e.userData.googleScholar}];return a.default.createElement("div",{className:"user-header-component"},a.default.createElement("div",{className:"avatar-wrapper"},a.default.createElement(o.default,{avatar:e.userData.avatar,initials:e.userData.initials,width:150}),e.isUser&&a.default.createElement("div",null,a.default.createElement("a",{href:"/user/"+e.userData.slug+"/edit",className:"bp3-button bp3-intent-primary"},"Edit Profile"))),a.default.createElement("div",{className:"details"},a.default.createElement("h1",null,e.userData.fullName),e.userData.title&&a.default.createElement("div",{className:"title"},e.userData.title),e.userData.bio&&a.default.createElement("div",{className:"bio"},e.userData.bio),a.default.createElement("div",{className:"links"},t.filter((function(e){return e.value})).map((function(e){return a.default.createElement("a",{key:"link-"+e.id,className:"bp3-button bp3-minimal "+(e.href?"":"no-click"),href:e.href,rel:"noopener noreferrer"},e.icon,e.value)})))))};c.defaultProps={isUser:!1},c.propTypes=u,t.default=c},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(0)),i=r(n(10));n(1571);var o={userSlug:i.default.string,activeTab:i.default.string,allPubsCount:i.default.number,authoredPubsCount:i.default.number},l=function(e){var t=[{id:0,label:"All Pubs ("+e.allPubsCount+")",path:""},{id:1,label:"Authored Pubs ("+e.authoredPubsCount+")",path:"/authored"}];return a.default.createElement("div",{className:"user-nav-component"},a.default.createElement("div",{className:"bp3-tabs"},a.default.createElement("div",{className:"bp3-tab-list bp3-large",role:"tablist"},t.map((function(t){return a.default.createElement("a",{key:"tab-"+t.id,href:"/user/"+e.userSlug+t.path,className:"bp3-tab",role:"tab","aria-selected":t.path.indexOf(e.activeTab)>-1||!t.path&&!e.activeTab?"true":"false"},t.label)})))))};l.defaultProps={activeTab:void 0,userSlug:"",allPubsCount:0,authoredPubsCount:0},l.propTypes=o,t.default=l},function(e,t,n){},function(e,t,n){"use strict";var r,a=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=l(n(0)),s=n(5),d=n(6),f=u(n(215)),m=u(n(270)),p=n(18);n(1573);var h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasChanged:!1,firstName:t.userData.firstName||"",lastName:t.userData.lastName||"",title:t.userData.title||"",bio:t.userData.bio||"",avatar:t.userData.avatar,location:t.userData.location||"",website:t.userData.website||"",orcid:t.userData.orcid||"",github:t.userData.github||"",twitter:t.userData.twitter||"",facebook:t.userData.facebook||"",googleScholar:t.userData.googleScholar||"",putUserIsLoading:!1,putUserError:void 0,postResetIsLoading:!1,postResetError:void 0,showResetConfirmation:!1},n.onFirstNameChange=n.onFirstNameChange.bind(n),n.onLastNameChange=n.onLastNameChange.bind(n),n.onTitleChange=n.onTitleChange.bind(n),n.onBioChange=n.onBioChange.bind(n),n.onAvatarChange=n.onAvatarChange.bind(n),n.handleSaveDetails=n.handleSaveDetails.bind(n),n.handlePasswordReset=n.handlePasswordReset.bind(n),n}return a(t,e),t.prototype.onFirstNameChange=function(e){this.setState({firstName:e.target.value,hasChanged:!0})},t.prototype.onLastNameChange=function(e){this.setState({lastName:e.target.value,hasChanged:!0})},t.prototype.onTitleChange=function(e){this.setState({title:e.target.value.substring(0,70).replace(/\n/g," "),hasChanged:!0})},t.prototype.onBioChange=function(e){this.setState({bio:e.target.value.substring(0,280).replace(/\n/g," "),hasChanged:!0})},t.prototype.onAvatarChange=function(e){this.setState({avatar:e,hasChanged:!0})},t.prototype.handleSaveDetails=function(e){var t=this;e.preventDefault();var n={userId:this.props.userData.id,firstName:this.state.firstName,lastName:this.state.lastName,avatar:this.state.avatar,title:this.state.title,bio:this.state.bio,location:this.state.location,website:this.state.website,orcid:this.state.orcid,github:this.state.github,twitter:this.state.twitter,facebook:this.state.facebook,googleScholar:this.state.googleScholar};return this.setState({putUserIsLoading:!0,putUserError:void 0}),(0,p.apiFetch)("/api/users",{method:"PUT",body:JSON.stringify(n)}).then((function(){window.location.href="/user/"+t.props.userData.slug})).catch((function(e){t.setState({putUserIsLoading:!1,putUserError:e})}))},t.prototype.handlePasswordReset=function(){var e=this;return this.setState({postResetIsLoading:!0}),(0,p.apiFetch)("/api/password-reset",{method:"POST",body:JSON.stringify({})}).then((function(){e.setState({postResetIsLoading:!1,showResetConfirmation:!0})})).catch((function(){e.setState({postResetIsLoading:!1,postResetError:"Error"})}))},t.prototype.render=function(){var e=this,t=[{label:"Location",showTextOnButton:!0,value:this.state.location,onChange:function(t){e.setState({location:t.target.value,hasChanged:!0})}},{label:"Website",showTextOnButton:!0,value:this.state.website,onChange:function(t){e.setState({website:t.target.value,hasChanged:!0})}},{label:"Orcid",helperText:"https://orcid.org/"+this.state.orcid,value:this.state.orcid,onChange:function(t){e.setState({orcid:t.target.value,hasChanged:!0})}},{label:"Github",helperText:"https://github.com/"+this.state.github,value:this.state.github,onChange:function(t){e.setState({github:t.target.value,hasChanged:!0})}},{label:"Twitter",helperText:"https://twitter.com/"+this.state.twitter,value:this.state.twitter,onChange:function(t){e.setState({twitter:t.target.value,hasChanged:!0})}},{label:"Facebook",helperText:"https://facebook.com/"+this.state.facebook,value:this.state.facebook,onChange:function(t){e.setState({facebook:t.target.value,hasChanged:!0})}},{label:"Google Scholar",helperText:"https://scholar.google.com/citations?user="+this.state.googleScholar,value:this.state.googleScholar,onChange:function(t){e.setState({googleScholar:t.target.value,hasChanged:!0})}}];return c.default.createElement("div",{className:"user-edit-component"},c.default.createElement(d.GridWrapper,{containerClassName:"narrow nav"},c.default.createElement("h1",null,"Edit User Details"),c.default.createElement("form",{onSubmit:this.handleSaveDetails},c.default.createElement(f.default,{label:"First Name",isRequired:!0,value:this.state.firstName,onChange:this.onFirstNameChange}),c.default.createElement(f.default,{label:"Last Name",isRequired:!0,value:this.state.lastName,onChange:this.onLastNameChange}),c.default.createElement(f.default,{label:"Password"},this.state.showResetConfirmation?c.default.createElement(s.Callout,{icon:"tick",intent:s.Intent.SUCCESS},"Password reset requested. Check your email for reset instructions."):c.default.createElement(f.default,{error:this.state.postResetError&&"Error Requesting Reset"},c.default.createElement(s.Button,{text:"Request Password Reset",onClick:this.handlePasswordReset,disabled:this.state.showResetConfirmation,loading:this.state.postResetIsLoading}))),c.default.createElement(m.default,{htmlFor:"avatar-upload",label:"Avatar Image",defaultImage:this.state.avatar,onNewImage:this.onAvatarChange,useCrop:!0}),c.default.createElement(f.default,{label:"Title",value:this.state.title,onChange:this.onTitleChange,helperText:this.state.title.length+"/70 characters. Displayed by your name on discussions."}),c.default.createElement(f.default,{label:"Bio",isTextarea:!0,value:this.state.bio,onChange:this.onBioChange,helperText:this.state.bio.length+"/280 characters"}),t.map((function(e){return c.default.createElement(f.default,{key:"input-field-"+e.label,label:e.label,value:e.value,onChange:e.onChange,helperText:e.helperText})})),c.default.createElement("p",null,"Privacy"),c.default.createElement("p",{className:"privacy"},"To request account deletion or data export, visit your"," ",c.default.createElement("a",{href:"/legal/settings"},"privacy settings page"),"."),c.default.createElement("div",{className:"buttons"},c.default.createElement(f.default,{error:this.state.putUserError&&"Error Saving Details"},c.default.createElement(s.Button,{type:"submit",intent:s.Intent.PRIMARY,text:"Save Details",onClick:this.handleSaveDetails,disabled:!this.state.firstName||!this.state.lastName||!this.state.hasChanged,loading:this.state.putUserIsLoading}))))))},t}(c.Component);t.default=h},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(0)),c=l(n(290)),s=l(n(292)),d=n(5),f=n(6),m=n(18),p=n(219);n(1576);t.default=function(e){var t=e.signupData,n=o((0,u.useState)(!1),2),r=n[0],a=n[1],i=o((0,u.useState)(void 0),2),l=i[0],h=i[1],b=o((0,u.useState)(!1),2),v=b[0],y=b[1],g=o((0,u.useState)(""),2),_=g[0],E=g[1],P=o((0,u.useState)(""),2),w=P[0],O=P[1],C=o((0,u.useState)(""),2),S=C[0],D=C[1],k=o((0,u.useState)(""),2),j=k[0],M=k[1],N=o((0,u.useState)(""),2),I=N[0],x=N[1],T=o((0,u.useState)(void 0),2),A=T[0],R=T[1],B=o((0,u.useState)(""),2),F=B[0],L=B[1],U=o((0,u.useState)(""),2),z=U[0],H=U[1],V=o((0,u.useState)(""),2),q=V[0],W=V[1],G=o((0,u.useState)(""),2),K=G[0],J=G[1],Y=o((0,u.useState)(""),2),$=Y[0],Q=Y[1],Z=o((0,u.useState)(""),2),X=Z[0],ee=Z[1],te=o((0,u.useState)(""),2),ne=te[0],re=te[1],ae=o((0,u.useState)(!1),2),ie=ae[0],oe=ae[1],le=o((0,u.useState)(!1),2),ue=le[0],ce=le[1],se=o((0,u.useState)(!1),2),de=se[0],fe=se[1],me=o((0,u.useState)(!1),2),pe=me[0],he=me[1],be=o((0,u.useState)(!1),2),ve=be[0],ye=be[1],ge=o((0,u.useState)(!1),2),_e=ge[0],Ee=ge[1],Pe=o((0,u.useState)(!1),2),we=Pe[0],Oe=Pe[1],Ce=o((0,u.useState)(""),2),Se=Ce[0],De=Ce[1],ke=o((0,u.useState)(!1),2),je=ke[0],Me=ke[1],Ne=function(e){return e.preventDefault(),a(!0),h(void 0),!!je&&(0,m.apiFetch)("/api/users",{method:"POST",body:JSON.stringify({email:t.email,hash:t.hash,subscribed:v,firstName:_,lastName:w,password:(0,c.default)(S).toString(s.default),avatar:A,title:j,bio:I,location:F,website:z,orcid:q,github:K,twitter:$,facebook:X,googleScholar:ne,confirmPassword:Se,gdprConsent:(0,p.gdprCookiePersistsSignup)()?(0,p.getGdprConsentElection)():null})}).then((function(){window.location.href="/"})).catch((function(e){a(!1),h(e)}))},Ie=[{label:"Location",showTextOnButton:!0,icon:u.default.createElement(f.Icon,{icon:"map-marker"}),action:function(){oe(!0)},isVisible:ie,value:F,onChange:function(e){L(e.target.value)}},{label:"Website",showTextOnButton:!0,icon:u.default.createElement(f.Icon,{icon:"link"}),action:function(){ce(!0)},isVisible:ue,value:z,onChange:function(e){H(e.target.value)}},{label:"Orcid",icon:u.default.createElement(f.Icon,{icon:"orcid"}),action:function(){fe(!0)},isVisible:de,helperText:"https://orcid.org/"+q,value:q,onChange:function(e){W(e.target.value)}},{label:"Github",icon:u.default.createElement(f.Icon,{icon:"github"}),action:function(){he(!0)},helperText:"https://github.com/"+K,isVisible:pe,value:K,onChange:function(e){J(e.target.value)}},{label:"Twitter",icon:u.default.createElement(f.Icon,{icon:"twitter"}),action:function(){ye(!0)},helperText:"https://twitter.com/"+$,isVisible:ve,value:$,onChange:function(e){Q(e.target.value)}},{label:"Facebook",icon:u.default.createElement(f.Icon,{icon:"facebook"}),action:function(){Ee(!0)},helperText:"https://facebook.com/"+X,isVisible:_e,value:X,onChange:function(e){ee(e.target.value)}},{label:"Google Scholar",icon:u.default.createElement(f.Icon,{icon:"google-scholar"}),action:function(){Oe(!0)},helperText:"https://scholar.google.com/citations?user="+ne,isVisible:we,value:ne,onChange:function(e){re(e.target.value)}}];return u.default.createElement("div",{id:"user-create-container"},t.hashError&&u.default.createElement(d.NonIdealState,{title:"Signup URL Invalid",description:u.default.createElement("div",{className:"success"},u.default.createElement("p",null,"This URL cannot be used to signup."),u.default.createElement("p",null,"Click below to restart the signup process.")),visual:"error",action:u.default.createElement("a",{href:"/signup",className:"bp3-button"},"Signup")}),!t.hashError&&u.default.createElement(f.GridWrapper,{containerClassName:"small"},u.default.createElement("h1",null,"Create Account"),u.default.createElement("form",{onSubmit:Ne},u.default.createElement(f.InputField,{label:"Email",isDisabled:!0,value:t.email}),u.default.createElement(f.InputField,{label:"First Name",isRequired:!0,value:_,onChange:function(e){E(e.target.value)}}),u.default.createElement(f.InputField,{label:"Last Name",isRequired:!0,value:w,onChange:function(e){O(e.target.value)}}),u.default.createElement(f.InputField,{label:"Password",type:"password",isRequired:!0,value:S,onChange:function(e){D(e.target.value)}}),u.default.createElement("input",{type:"password",name:"confirmPassword",className:"confirm-password",tabIndex:"-1",autoComplete:"new-user-street-address",onChange:function(e){return De(e.target.value)}}),u.default.createElement(f.ImageUpload,{htmlFor:"avatar-upload",label:"Avatar Image",onNewImage:function(e){R(e)},useCrop:!0}),u.default.createElement(f.InputField,{label:"Title",value:j,onChange:function(e){M(e.target.value.substring(0,70).replace(/\n/g," "))},helperText:j.length+"/70 characters. Displayed by your name on discussions."}),u.default.createElement(f.InputField,{label:"Bio",isTextarea:!0,value:I,onChange:function(e){x(e.target.value.substring(0,280).replace(/\n/g," "))},helperText:I.length+"/280 characters"}),Ie.filter((function(e){return e.isVisible})).map((function(e){return u.default.createElement(f.InputField,{key:"input-field-"+e.label,label:e.label,value:e.value,onChange:e.onChange,helperText:e.helperText})})),!!Ie.filter((function(e){return!e.isVisible})).length&&u.default.createElement(f.InputField,{label:"Add More"},u.default.createElement("div",{className:"bp3-button-group"},Ie.filter((function(e){return!e.isVisible})).map((function(e){return u.default.createElement("button",{type:"button",key:"button-"+e.label,className:"bp3-button expandable",onClick:e.action},e.icon,e.showTextOnButton?e.label:"")})))),u.default.createElement(f.InputField,{wrapperClassName:"bp3-callout",label:"Stay Up To Date"},u.default.createElement(d.Checkbox,{label:"Subscribe to our feature release & community newsletter.",checked:v,onChange:function(){y(!v)}}),u.default.createElement("p",{className:"notice"},u.default.createElement("em",null,"We use a third party provider, Mailchimp, to deliver newsletters. We never share your data with anyone, and you can unsubscribe using the link at the bottom of every email. Learn more by visiting yourÂ ",u.default.createElement("a",{href:"/legal/privacy"},"privacy settings"),"."))),u.default.createElement(f.InputField,null,u.default.createElement(d.Checkbox,{checked:je,onChange:function(){Me(!je)}},"I have read and agree to the PubPub"," ",u.default.createElement("a",{href:"/legal/terms",target:"_blank"},"Terms of Service")," ","and"," ",u.default.createElement("a",{href:"/legal/privacy",target:"_blank"},"Privacy Policy"),".")),u.default.createElement(f.InputField,{error:l&&"Error Creating User"},u.default.createElement(d.Button,{name:"create",type:"submit",className:"bp3-button bp3-intent-primary create-account-button",onClick:Ne,text:"Create Account",disabled:!(_&&w&&S&&je),loading:r})))))}},function(e,t,n){},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};Object.defineProperty(t,"__esModule",{value:!0}),t.usePageState=void 0;var i=n(0),o=n(441),l=n(163);t.usePageState=function(e,t){var n=e.loginData,u=e.communityData,c=e.locationData,s=e.scopeData,d=e.featureFlags,f=e.initialNotificationsData,m=e.dismissedUserDismissables,p=t.pageData,h=a((0,i.useState)(n),1)[0],b=a((0,i.useState)(c),1)[0],v=a((0,i.useState)(p),1)[0],y=a((0,i.useState)(u),2),g=y[0],_=y[1],E=a((0,i.useState)(s),2),P=E[0],w=E[1],O=a((0,i.useState)((function(){return new o.NoteManager("apa-7","count",{})})),1)[0],C=(0,i.useMemo)((function(){return(0,l.getDashboardMenuState)({scopeData:P,locationData:b,featureFlags:d})}),[P,b,d]);return{loginData:h,locationData:b,communityData:g,scopeData:P,pageData:v,updateCommunity:function(e){"function"==typeof e&&(e=e(g)),_((function(t){return r(r({},t),e)}))},updateCollection:function(e){var t=P.elements.activeCollection;if(t){"function"==typeof e&&(e=e(t));var n=r(r({},t),e);w((function(e){return r(r({},e),{elements:r(r({},P.elements),{activeCollection:n})})}))}},noteManager:O,featureFlags:d,initialNotificationsData:f,dashboardMenu:C,dismissedUserDismissables:m}}},function(e,t,n){},function(e,t,n){}]);
//# sourceMappingURL=main.bfc4d5e9397383c7e131.js.map